import{d as B,y as d,aw as T,h as L,j as b,ad as m,M as P,S as V,m as H,r as J,c as M,a as l,b as o,w as a,u as s,k as j,aU as U,aT as z,aV as I,o as w,t as G,z as W,f as p,v as g,E as $}from"./mainapp-08e4e16e.js";import{E as K}from"./el-overlay-55487daf.js";import{E as Y,a as q}from"./el-form-item-37c9ded7.js";import{_ as Q,H as X,a as Z,E as ee}from"./HeaderToolsTop.vue_vue_type_script_setup_true_lang-6a0b24b1.js";import"./el-tooltip-4ed993c7.js";import{E as te}from"./el-popper-5620694e.js";import{i as oe,a as ae,b as E,c as le,d as re,o as se,f as ie,g as ne}from"./listener-service-07ec6576.js";import{D as ce}from"./date-7db10ed7.js";import{j as ue,b as _e}from"./api-flowchart-488ff946.js";import"./vnode-c2d158cc.js";import"./el-dropdown-item-1395b2e6.js";import"./_plugin-vue_export-helper-5392fbfa.js";import"./error-3ede30a0.js";import"./event-9519ab40.js";import"./el-select-e493f370.js";import"./el-input-2e028abd.js";import"./el-tag-d377eb68.js";import"./strings-13348aef.js";import"./_Uint8Array-876a1517.js";import"./MenuAvatar.vue_vue_type_script_setup_true_lang-f1256a3a.js";import"./el-popover-025678fc.js";import"./EditInput.vue_vue_type_script_setup_true_lang-d58dab5f.js";import"./bleuon-icon-ae86a734.js";import"./index-98915564.js";const de={class:"bleuon__flowchart-container h-100vh"},me={class:"bleuon__flowchart-header h-22vh border-border-primary border-b-1 border-b-solid bg-bg-primary px-4 py-4"},pe={class:"bleuon__flowchart-wrapper f-c-b"},fe=l("div",{class:"left"},null,-1),he={class:"right"},ve=l("div",{id:"bleuon__flowchart-content"},null,-1),ke={class:"bleuon__flowchart-extra"},Ie=B({__name:"ShareFlowchart",async setup(be){let f,h;const r=d(),c=d(),y=T(),C=L(),e=b({}),u=d();m(U,r),m(z,c),m(I,e);const N=localStorage.getToken(P);async function S(){const i=await ue({id:y.params.id.toString()},()=>{C.back()});e.value=i}function x(){r.value.freeze(),e.value.json&&c.value.fromJSON(JSON.parse(e.value.json)),r.value.options.defaultConnector=JSON.parse(e.value.connectorDefault),r.value.options.defaultRouter=JSON.parse(e.value.routerDefault),r.value.unfreeze()}V(()=>{const i=oe({el:"bleuon__flowchart-content",width:"100vw",height:"75vh",gridSize:e.value.gridSize,bgColor:e.value.bgColor,drawGrid:JSON.parse(e.value.drawGrid)});r.value=i.paper,c.value=i.graph,x(),r.value.on({"element:pointerclick":t=>ae(t),"element:pointerdblclick":t=>E(t,u.value),"link:pointerclick":t=>le(t),"link:pointerdblclick":t=>E(t,u.value),"blank:pointerclick":()=>re(),"blank:mousewheel":t=>se(t,r.value)})});const n=b(!1);function O(){e.value.fileName="模板_"+e.value.fileName,_e(e.value,i=>$.success(i.message))}return[f,h]=H(()=>S()),await f,h(),(i,t)=>{const v=te,_=Y,R=ee,D=J("router-link"),F=q,A=K;return w(),M("div",de,[l("div",me,[o(Q,{data:s(e),class:"mb-4"},{tools:a(()=>[o(v,{content:"分享"},{default:a(()=>[l("div",{class:"hover i-tabler-share mr-4",onClick:t[0]||(t[0]=k=>n.value=!s(n))})]),_:1}),s(N)?(w(),G(v,{key:0,content:"导入模板"},{default:a(()=>[l("div",null,[l("div",{class:"hover i-tabler-file-import",onClick:O})])]),_:1})):W("",!0)]),_:1},8,["data"]),o(X,{"is-clicked-element":ie.value,"is-clicked-link":ne.value},null,8,["is-clicked-element","is-clicked-link"])]),l("div",pe,[fe,l("div",he,[ve,o(Z,{class:"h-3vh"})]),l("div",ke,[l("input",{ref_key:"textInputRef",ref:u,class:"bleuon__flowchart-input absolute hidden",type:"text"},null,512)])]),o(A,{modelValue:s(n),"onUpdate:modelValue":t[1]||(t[1]=k=>j(n)?n.value=k:null),title:"分享流程图",width:"40%"},{default:a(()=>[o(F,{ref:"shareFormRef","label-position":"right","label-width":"100px"},{default:a(()=>[o(_,{label:"状态"},{default:a(()=>[p("流程图已经公开，点击链接浏览")]),_:1}),o(_,{label:"链接地址"},{default:a(()=>[o(D,{to:"/share/flowchart/"+s(e).id},{default:a(()=>[o(R,{type:"primary"},{default:a(()=>[p(" http://localhost:5173/#/share/flowchart/"+g(s(e).id),1)]),_:1})]),_:1},8,["to"])]),_:1}),o(_,{label:"截止日期"},{default:a(()=>[p(g(s(ce).formatted("yyyy-MM-dd HH:mm:ss",s(e).deadShareDate)),1)]),_:1})]),_:1},512)]),_:1},8,["modelValue"])])}}});export{Ie as default};
//# sourceMappingURL=ShareFlowchart-ad499024.js.map
