{"version":3,"file":"FooterTools.vue_vue_type_script_setup_true_lang-b8c8b4f9.js","sources":["../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/utils/dom/position.mjs","../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_isFlattenable.js","../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseFlatten.js","../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/flatten.js","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/constants/date.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/utils/arrays.mjs","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/dayjs.min.js","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/plugin/customParseFormat.js","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/constants.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/utils.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/props/shared.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/common/props.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/common/picker.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/props/panel-time-picker.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/composables/use-time-panel.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/composables/use-time-picker.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/directives/repeat-click/index.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/props/basic-time-spinner.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/time-picker-com/basic-time-spinner.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/time-picker/src/time-picker-com/panel-time-pick.mjs","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/plugin/localeData.js","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/props/alpha-slider.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/utils/draggable.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/composables/use-alpha-slider.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/components/alpha-slider.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/components/hue-slider.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/color-picker.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/utils/color.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/components/predefine.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/components/sv-panel.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/src/color-picker2.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/color-picker/index.mjs","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/plugin/advancedFormat.js","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/plugin/weekOfYear.js","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/plugin/weekYear.js","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/plugin/dayOfYear.js","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/plugin/isSameOrAfter.js","../../../node_modules/.pnpm/dayjs@1.11.8/node_modules/dayjs/plugin/isSameOrBefore.js","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/constants.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/date-picker.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/shared.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/panel-date-pick.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/basic-date-table.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/utils.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/composables/use-basic-date-table.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/basic-cell.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/date-picker-com/basic-cell-render.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/date-picker-com/basic-date-table.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/basic-month-table.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/date-picker-com/basic-month-table.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/basic-year-table.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/date-picker-com/basic-year-table.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/date-picker-com/panel-date-pick.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/panel-date-range.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/composables/use-shortcut.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/composables/use-range-picker.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/date-picker-com/panel-date-range.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/props/panel-month-range.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/composables/use-month-range-header.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/date-picker-com/panel-month-range.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/panel-utils.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/src/date-picker.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/date-picker/index.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/input-number/src/input-number.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/input-number/src/input-number2.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/input-number/index.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/link/src/link.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/link/src/link2.mjs","../../../node_modules/.pnpm/element-plus@2.3.14_vue@3.3.4/node_modules/element-plus/es/components/link/index.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/attributes/calc.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/util/cloneCells.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/attributes/props.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/attributes/index.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/Cell.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/util/wrappers.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/util/getRectPoint.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/layout/ports/port.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/layout/ports/portLabel.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/Link.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/ports.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/Element.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/Graph.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/PaperLayer.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/HighlighterView.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/CellView.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/ElementView.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/routers/normal.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/routers/oneSide.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/routers/orthogonal.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/routers/manhattan.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/routers/metro.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/routers/rightAngle.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/connectors/straight.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/connectors/jumpover.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/connectors/normal.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/connectors/rounded.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/connectors/smooth.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/connectors/curve.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/LinkView.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/highlighters/stroke.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/highlighters/mask.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/highlighters/opacity.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/highlighters/addClass.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/highlighters/list.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/linkAnchors/index.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/connectionPoints/index.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/anchors/index.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/Paper.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/dia/ToolsView.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/env/index.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/basic.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/standard.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/devs.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/logic.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/chess.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/erd.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/fsa.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/org.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/pn.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/shapes/uml.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/linkTools/helpers.mjs","../../../node_modules/.pnpm/jointjs@3.7.5/node_modules/jointjs/src/linkTools/Boundary.mjs","../../../apps/mainapp/lib/namespace.ts","../../../apps/mainapp/lib/init.ts","../../../apps/mainapp/service/diagraming/flowchart/utils.ts","../../../apps/mainapp/service/diagraming/flowchart/cell-service.ts","../../../apps/mainapp/data/diagraming/flowchart/index.ts","../../../apps/mainapp/service/diagraming/flowchart/listener-service.ts","../../../apps/mainapp/components/diagraming/flowchart/HeaderToolsBottom.vue","../../../common/data/el-components.ts","../../../apps/mainapp/components/diagraming/flowchart/HeaderToolsTop.vue","../../../apps/mainapp/components/diagraming/flowchart/FooterTools.vue"],"sourcesContent":["import '../browser.mjs';\nimport { isClient } from '@vueuse/core';\n\nconst isInContainer = (el, container) => {\n  if (!isClient || !el || !container)\n    return false;\n  const elRect = el.getBoundingClientRect();\n  let containerRect;\n  if (container instanceof Element) {\n    containerRect = container.getBoundingClientRect();\n  } else {\n    containerRect = {\n      top: 0,\n      right: window.innerWidth,\n      bottom: window.innerHeight,\n      left: 0\n    };\n  }\n  return elRect.top < containerRect.bottom && elRect.bottom > containerRect.top && elRect.right > containerRect.left && elRect.left < containerRect.right;\n};\nconst getOffsetTop = (el) => {\n  let offset = 0;\n  let parent = el;\n  while (parent) {\n    offset += parent.offsetTop;\n    parent = parent.offsetParent;\n  }\n  return offset;\n};\nconst getOffsetTopDistance = (el, containerEl) => {\n  return Math.abs(getOffsetTop(el) - getOffsetTop(containerEl));\n};\nconst getClientXY = (event) => {\n  let clientX;\n  let clientY;\n  if (event.type === \"touchend\") {\n    clientY = event.changedTouches[0].clientY;\n    clientX = event.changedTouches[0].clientX;\n  } else if (event.type.startsWith(\"touch\")) {\n    clientY = event.touches[0].clientY;\n    clientX = event.touches[0].clientX;\n  } else {\n    clientY = event.clientY;\n    clientX = event.clientX;\n  }\n  return {\n    clientX,\n    clientY\n  };\n};\n\nexport { getClientXY, getOffsetTop, getOffsetTopDistance, isInContainer };\n//# sourceMappingURL=position.mjs.map\n","import Symbol from './_Symbol.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nexport default isFlattenable;\n","import arrayPush from './_arrayPush.js';\nimport isFlattenable from './_isFlattenable.js';\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nexport default baseFlatten;\n","import baseFlatten from './_baseFlatten.js';\n\n/**\n * Flattens `array` a single level deep.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flatten([1, [2, [3, [4]], 5]]);\n * // => [1, 2, [3, [4]], 5]\n */\nfunction flatten(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, 1) : [];\n}\n\nexport default flatten;\n","const datePickTypes = [\n  \"year\",\n  \"month\",\n  \"date\",\n  \"dates\",\n  \"week\",\n  \"datetime\",\n  \"datetimerange\",\n  \"daterange\",\n  \"monthrange\"\n];\nconst WEEK_DAYS = [\n  \"sun\",\n  \"mon\",\n  \"tue\",\n  \"wed\",\n  \"thu\",\n  \"fri\",\n  \"sat\"\n];\n\nexport { WEEK_DAYS, datePickTypes };\n//# sourceMappingURL=date.mjs.map\n","export { castArray as ensureArray } from 'lodash-unified';\n\nconst unique = (arr) => [...new Set(arr)];\nconst castArray = (arr) => {\n  if (!arr && arr !== 0)\n    return [];\n  return Array.isArray(arr) ? arr : [arr];\n};\n\nexport { castArray, unique };\n//# sourceMappingURL=arrays.mjs.map\n","!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(t=\"undefined\"!=typeof globalThis?globalThis:t||self).dayjs=e()}(this,(function(){\"use strict\";var t=1e3,e=6e4,n=36e5,r=\"millisecond\",i=\"second\",s=\"minute\",u=\"hour\",a=\"day\",o=\"week\",f=\"month\",h=\"quarter\",c=\"year\",d=\"date\",l=\"Invalid Date\",$=/^(\\d{4})[-/]?(\\d{1,2})?[-/]?(\\d{0,2})[Tt\\s]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?[.:]?(\\d+)?$/,y=/\\[([^\\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M={name:\"en\",weekdays:\"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),months:\"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\"),ordinal:function(t){var e=[\"th\",\"st\",\"nd\",\"rd\"],n=t%100;return\"[\"+t+(e[(n-20)%10]||e[n]||e[0])+\"]\"}},m=function(t,e,n){var r=String(t);return!r||r.length>=e?t:\"\"+Array(e+1-r.length).join(n)+t},v={s:m,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?\"+\":\"-\")+m(r,2,\"0\")+\":\"+m(i,2,\"0\")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,f),s=n-i<0,u=e.clone().add(r+(s?-1:1),f);return+(-(r+(n-i)/(s?i-u:u-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:f,y:c,w:o,d:a,D:d,h:u,m:s,s:i,ms:r,Q:h}[t]||String(t||\"\").toLowerCase().replace(/s$/,\"\")},u:function(t){return void 0===t}},g=\"en\",D={};D[g]=M;var p=function(t){return t instanceof _},S=function t(e,n,r){var i;if(!e)return g;if(\"string\"==typeof e){var s=e.toLowerCase();D[s]&&(i=s),n&&(D[s]=n,i=s);var u=e.split(\"-\");if(!i&&u.length>1)return t(u[0])}else{var a=e.name;D[a]=e,i=a}return!r&&i&&(g=i),i||!r&&g},w=function(t,e){if(p(t))return t.clone();var n=\"object\"==typeof e?e:{};return n.date=t,n.args=arguments,new _(n)},O=v;O.l=S,O.i=p,O.w=function(t,e){return w(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var _=function(){function M(t){this.$L=S(t.locale,null,!0),this.parse(t)}var m=M.prototype;return m.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(O.u(e))return new Date;if(e instanceof Date)return new Date(e);if(\"string\"==typeof e&&!/Z$/i.test(e)){var r=e.match($);if(r){var i=r[2]-1||0,s=(r[7]||\"0\").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,s)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},m.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},m.$utils=function(){return O},m.isValid=function(){return!(this.$d.toString()===l)},m.isSame=function(t,e){var n=w(t);return this.startOf(e)<=n&&n<=this.endOf(e)},m.isAfter=function(t,e){return w(t)<this.startOf(e)},m.isBefore=function(t,e){return this.endOf(e)<w(t)},m.$g=function(t,e,n){return O.u(t)?this[e]:this.set(n,t)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(t,e){var n=this,r=!!O.u(e)||e,h=O.p(t),l=function(t,e){var i=O.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},$=function(t,e){return O.w(n.toDate()[t].apply(n.toDate(\"s\"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},y=this.$W,M=this.$M,m=this.$D,v=\"set\"+(this.$u?\"UTC\":\"\");switch(h){case c:return r?l(1,0):l(31,11);case f:return r?l(1,M):l(0,M+1);case o:var g=this.$locale().weekStart||0,D=(y<g?y+7:y)-g;return l(r?m-D:m+(6-D),M);case a:case d:return $(v+\"Hours\",0);case u:return $(v+\"Minutes\",1);case s:return $(v+\"Seconds\",2);case i:return $(v+\"Milliseconds\",3);default:return this.clone()}},m.endOf=function(t){return this.startOf(t,!1)},m.$set=function(t,e){var n,o=O.p(t),h=\"set\"+(this.$u?\"UTC\":\"\"),l=(n={},n[a]=h+\"Date\",n[d]=h+\"Date\",n[f]=h+\"Month\",n[c]=h+\"FullYear\",n[u]=h+\"Hours\",n[s]=h+\"Minutes\",n[i]=h+\"Seconds\",n[r]=h+\"Milliseconds\",n)[o],$=o===a?this.$D+(e-this.$W):e;if(o===f||o===c){var y=this.clone().set(d,1);y.$d[l]($),y.init(),this.$d=y.set(d,Math.min(this.$D,y.daysInMonth())).$d}else l&&this.$d[l]($);return this.init(),this},m.set=function(t,e){return this.clone().$set(t,e)},m.get=function(t){return this[O.p(t)]()},m.add=function(r,h){var d,l=this;r=Number(r);var $=O.p(h),y=function(t){var e=w(l);return O.w(e.date(e.date()+Math.round(t*r)),l)};if($===f)return this.set(f,this.$M+r);if($===c)return this.set(c,this.$y+r);if($===a)return y(1);if($===o)return y(7);var M=(d={},d[s]=e,d[u]=n,d[i]=t,d)[$]||1,m=this.$d.getTime()+r*M;return O.w(m,this)},m.subtract=function(t,e){return this.add(-1*t,e)},m.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||l;var r=t||\"YYYY-MM-DDTHH:mm:ssZ\",i=O.z(this),s=this.$H,u=this.$m,a=this.$M,o=n.weekdays,f=n.months,h=function(t,n,i,s){return t&&(t[n]||t(e,r))||i[n].slice(0,s)},c=function(t){return O.s(s%12||12,t,\"0\")},d=n.meridiem||function(t,e,n){var r=t<12?\"AM\":\"PM\";return n?r.toLowerCase():r},$={YY:String(this.$y).slice(-2),YYYY:O.s(this.$y,4,\"0\"),M:a+1,MM:O.s(a+1,2,\"0\"),MMM:h(n.monthsShort,a,f,3),MMMM:h(f,a),D:this.$D,DD:O.s(this.$D,2,\"0\"),d:String(this.$W),dd:h(n.weekdaysMin,this.$W,o,2),ddd:h(n.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:O.s(s,2,\"0\"),h:c(1),hh:c(2),a:d(s,u,!0),A:d(s,u,!1),m:String(u),mm:O.s(u,2,\"0\"),s:String(this.$s),ss:O.s(this.$s,2,\"0\"),SSS:O.s(this.$ms,3,\"0\"),Z:i};return r.replace(y,(function(t,e){return e||$[t]||i.replace(\":\",\"\")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,l){var $,y=O.p(d),M=w(r),m=(M.utcOffset()-this.utcOffset())*e,v=this-M,g=O.m(this,M);return g=($={},$[c]=g/12,$[f]=g,$[h]=g/3,$[o]=(v-m)/6048e5,$[a]=(v-m)/864e5,$[u]=v/n,$[s]=v/e,$[i]=v/t,$)[y]||v,l?g:O.a(g)},m.daysInMonth=function(){return this.endOf(f).$D},m.$locale=function(){return D[this.$L]},m.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=S(t,e,!0);return r&&(n.$L=r),n},m.clone=function(){return O.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},M}(),T=_.prototype;return w.prototype=T,[[\"$ms\",r],[\"$s\",i],[\"$m\",s],[\"$H\",u],[\"$W\",a],[\"$M\",f],[\"$y\",c],[\"$D\",d]].forEach((function(t){T[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),w.extend=function(t,e){return t.$i||(t(e,_,w),t.$i=!0),w},w.locale=S,w.isDayjs=p,w.unix=function(t){return w(1e3*t)},w.en=D[g],w.Ls=D,w.p={},w}));","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_customParseFormat=t()}(this,(function(){\"use strict\";var e={LTS:\"h:mm:ss A\",LT:\"h:mm A\",L:\"MM/DD/YYYY\",LL:\"MMMM D, YYYY\",LLL:\"MMMM D, YYYY h:mm A\",LLLL:\"dddd, MMMM D, YYYY h:mm A\"},t=/(\\[[^[]*\\])|([-_:/.,()\\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,n=/\\d\\d/,r=/\\d\\d?/,i=/\\d*[^-_:/,()\\s\\d]+/,o={},s=function(e){return(e=+e)+(e>68?1900:2e3)};var a=function(e){return function(t){this[e]=+t}},f=[/[+-]\\d\\d:?(\\d\\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if(\"Z\"===e)return 0;var t=e.match(/([+-]|\\d\\d)/g),n=60*t[1]+(+t[2]||0);return 0===n?0:\"+\"===t[0]?-n:n}(e)}],h=function(e){var t=o[e];return t&&(t.indexOf?t:t.s.concat(t.f))},u=function(e,t){var n,r=o.meridiem;if(r){for(var i=1;i<=24;i+=1)if(e.indexOf(r(i,0,t))>-1){n=i>12;break}}else n=e===(t?\"pm\":\"PM\");return n},d={A:[i,function(e){this.afternoon=u(e,!1)}],a:[i,function(e){this.afternoon=u(e,!0)}],S:[/\\d/,function(e){this.milliseconds=100*+e}],SS:[n,function(e){this.milliseconds=10*+e}],SSS:[/\\d{3}/,function(e){this.milliseconds=+e}],s:[r,a(\"seconds\")],ss:[r,a(\"seconds\")],m:[r,a(\"minutes\")],mm:[r,a(\"minutes\")],H:[r,a(\"hours\")],h:[r,a(\"hours\")],HH:[r,a(\"hours\")],hh:[r,a(\"hours\")],D:[r,a(\"day\")],DD:[n,a(\"day\")],Do:[i,function(e){var t=o.ordinal,n=e.match(/\\d+/);if(this.day=n[0],t)for(var r=1;r<=31;r+=1)t(r).replace(/\\[|\\]/g,\"\")===e&&(this.day=r)}],M:[r,a(\"month\")],MM:[n,a(\"month\")],MMM:[i,function(e){var t=h(\"months\"),n=(h(\"monthsShort\")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],MMMM:[i,function(e){var t=h(\"months\").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\\d+/,a(\"year\")],YY:[n,function(e){this.year=s(e)}],YYYY:[/\\d{4}/,a(\"year\")],Z:f,ZZ:f};function c(n){var r,i;r=n,i=o&&o.formats;for(var s=(n=r.replace(/(\\[[^\\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,n,r){var o=r&&r.toUpperCase();return n||i[r]||e[r]||i[o].replace(/(\\[[^\\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))).match(t),a=s.length,f=0;f<a;f+=1){var h=s[f],u=d[h],c=u&&u[0],l=u&&u[1];s[f]=l?{regex:c,parser:l}:h.replace(/^\\[|\\]$/g,\"\")}return function(e){for(var t={},n=0,r=0;n<a;n+=1){var i=s[n];if(\"string\"==typeof i)r+=i.length;else{var o=i.regex,f=i.parser,h=e.slice(r),u=o.exec(h)[0];f.call(t,u),e=e.replace(u,\"\")}}return function(e){var t=e.afternoon;if(void 0!==t){var n=e.hours;t?n<12&&(e.hours+=12):12===n&&(e.hours=0),delete e.afternoon}}(t),t}}return function(e,t,n){n.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(s=e.parseTwoDigitYear);var r=t.prototype,i=r.parse;r.parse=function(e){var t=e.date,r=e.utc,s=e.args;this.$u=r;var a=s[1];if(\"string\"==typeof a){var f=!0===s[2],h=!0===s[3],u=f||h,d=s[2];h&&(d=s[2]),o=this.$locale(),!f&&d&&(o=n.Ls[d]),this.$d=function(e,t,n){try{if([\"x\",\"X\"].indexOf(t)>-1)return new Date((\"X\"===t?1e3:1)*e);var r=c(t)(e),i=r.year,o=r.month,s=r.day,a=r.hours,f=r.minutes,h=r.seconds,u=r.milliseconds,d=r.zone,l=new Date,m=s||(i||o?1:l.getDate()),M=i||l.getFullYear(),Y=0;i&&!o||(Y=o>0?o-1:l.getMonth());var p=a||0,v=f||0,D=h||0,g=u||0;return d?new Date(Date.UTC(M,Y,m,p,v,D,g+60*d.offset*1e3)):n?new Date(Date.UTC(M,Y,m,p,v,D,g)):new Date(M,Y,m,p,v,D,g)}catch(e){return new Date(\"\")}}(t,a,r),this.init(),d&&!0!==d&&(this.$L=this.locale(d).$L),u&&t!=this.format(a)&&(this.$d=new Date(\"\")),o={}}else if(a instanceof Array)for(var l=a.length,m=1;m<=l;m+=1){s[1]=a[m-1];var M=n.apply(this,s);if(M.isValid()){this.$d=M.$d,this.$L=M.$L,this.init();break}m===l&&(this.$d=new Date(\"\"))}else i.call(this,e)}}}));","const timeUnits = [\"hours\", \"minutes\", \"seconds\"];\nconst DEFAULT_FORMATS_TIME = \"HH:mm:ss\";\nconst DEFAULT_FORMATS_DATE = \"YYYY-MM-DD\";\nconst DEFAULT_FORMATS_DATEPICKER = {\n  date: DEFAULT_FORMATS_DATE,\n  dates: DEFAULT_FORMATS_DATE,\n  week: \"gggg[w]ww\",\n  year: \"YYYY\",\n  month: \"YYYY-MM\",\n  datetime: `${DEFAULT_FORMATS_DATE} ${DEFAULT_FORMATS_TIME}`,\n  monthrange: \"YYYY-MM\",\n  daterange: DEFAULT_FORMATS_DATE,\n  datetimerange: `${DEFAULT_FORMATS_DATE} ${DEFAULT_FORMATS_TIME}`\n};\n\nexport { DEFAULT_FORMATS_DATE, DEFAULT_FORMATS_DATEPICKER, DEFAULT_FORMATS_TIME, timeUnits };\n//# sourceMappingURL=constants.mjs.map\n","import dayjs from 'dayjs';\nimport '../../../utils/index.mjs';\nimport { isDate, isArray } from '@vue/shared';\nimport { isEmpty } from '../../../utils/types.mjs';\n\nconst buildTimeList = (value, bound) => {\n  return [\n    value > 0 ? value - 1 : void 0,\n    value,\n    value < bound ? value + 1 : void 0\n  ];\n};\nconst rangeArr = (n) => Array.from(Array.from({ length: n }).keys());\nconst extractDateFormat = (format) => {\n  return format.replace(/\\W?m{1,2}|\\W?ZZ/g, \"\").replace(/\\W?h{1,2}|\\W?s{1,3}|\\W?a/gi, \"\").trim();\n};\nconst extractTimeFormat = (format) => {\n  return format.replace(/\\W?D{1,2}|\\W?Do|\\W?d{1,4}|\\W?M{1,4}|\\W?Y{2,4}/g, \"\").trim();\n};\nconst dateEquals = function(a, b) {\n  const aIsDate = isDate(a);\n  const bIsDate = isDate(b);\n  if (aIsDate && bIsDate) {\n    return a.getTime() === b.getTime();\n  }\n  if (!aIsDate && !bIsDate) {\n    return a === b;\n  }\n  return false;\n};\nconst valueEquals = function(a, b) {\n  const aIsArray = isArray(a);\n  const bIsArray = isArray(b);\n  if (aIsArray && bIsArray) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    return a.every((item, index) => dateEquals(item, b[index]));\n  }\n  if (!aIsArray && !bIsArray) {\n    return dateEquals(a, b);\n  }\n  return false;\n};\nconst parseDate = function(date, format, lang) {\n  const day = isEmpty(format) || format === \"x\" ? dayjs(date).locale(lang) : dayjs(date, format).locale(lang);\n  return day.isValid() ? day : void 0;\n};\nconst formatter = function(date, format, lang) {\n  if (isEmpty(format))\n    return date;\n  if (format === \"x\")\n    return +date;\n  return dayjs(date).locale(lang).format(format);\n};\nconst makeList = (total, method) => {\n  var _a;\n  const arr = [];\n  const disabledArr = method == null ? void 0 : method();\n  for (let i = 0; i < total; i++) {\n    arr.push((_a = disabledArr == null ? void 0 : disabledArr.includes(i)) != null ? _a : false);\n  }\n  return arr;\n};\n\nexport { buildTimeList, dateEquals, extractDateFormat, extractTimeFormat, formatter, makeList, parseDate, rangeArr, valueEquals };\n//# sourceMappingURL=utils.mjs.map\n","import '../../../../utils/index.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\n\nconst disabledTimeListsProps = buildProps({\n  disabledHours: {\n    type: definePropType(Function)\n  },\n  disabledMinutes: {\n    type: definePropType(Function)\n  },\n  disabledSeconds: {\n    type: definePropType(Function)\n  }\n});\nconst timePanelSharedProps = buildProps({\n  visible: Boolean,\n  actualVisible: {\n    type: Boolean,\n    default: void 0\n  },\n  format: {\n    type: String,\n    default: \"\"\n  }\n});\n\nexport { disabledTimeListsProps, timePanelSharedProps };\n//# sourceMappingURL=shared.mjs.map\n","import '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { CircleClose } from '@element-plus/icons-vue';\nimport { disabledTimeListsProps } from '../props/shared.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\nimport { useSizeProp } from '../../../../hooks/use-size/index.mjs';\n\nconst timePickerDefaultProps = buildProps({\n  id: {\n    type: definePropType([Array, String])\n  },\n  name: {\n    type: definePropType([Array, String]),\n    default: \"\"\n  },\n  popperClass: {\n    type: String,\n    default: \"\"\n  },\n  format: String,\n  valueFormat: String,\n  type: {\n    type: String,\n    default: \"\"\n  },\n  clearable: {\n    type: Boolean,\n    default: true\n  },\n  clearIcon: {\n    type: definePropType([String, Object]),\n    default: CircleClose\n  },\n  editable: {\n    type: Boolean,\n    default: true\n  },\n  prefixIcon: {\n    type: definePropType([String, Object]),\n    default: \"\"\n  },\n  size: useSizeProp,\n  readonly: {\n    type: Boolean,\n    default: false\n  },\n  disabled: {\n    type: Boolean,\n    default: false\n  },\n  placeholder: {\n    type: String,\n    default: \"\"\n  },\n  popperOptions: {\n    type: definePropType(Object),\n    default: () => ({})\n  },\n  modelValue: {\n    type: definePropType([Date, Array, String, Number]),\n    default: \"\"\n  },\n  rangeSeparator: {\n    type: String,\n    default: \"-\"\n  },\n  startPlaceholder: String,\n  endPlaceholder: String,\n  defaultValue: {\n    type: definePropType([Date, Array])\n  },\n  defaultTime: {\n    type: definePropType([Date, Array])\n  },\n  isRange: {\n    type: Boolean,\n    default: false\n  },\n  ...disabledTimeListsProps,\n  disabledDate: {\n    type: Function\n  },\n  cellClassName: {\n    type: Function\n  },\n  shortcuts: {\n    type: Array,\n    default: () => []\n  },\n  arrowControl: {\n    type: Boolean,\n    default: false\n  },\n  label: {\n    type: String,\n    default: void 0\n  },\n  tabindex: {\n    type: definePropType([String, Number]),\n    default: 0\n  },\n  validateEvent: {\n    type: Boolean,\n    default: true\n  },\n  unlinkPanels: Boolean\n});\n\nexport { timePickerDefaultProps };\n//# sourceMappingURL=props.mjs.map\n","import { defineComponent, useAttrs, inject, ref, computed, watch, nextTick, unref, provide, openBlock, createBlock, mergeProps, withCtx, normalizeClass, normalizeStyle, withModifiers, resolveDynamicComponent, createCommentVNode, createElementBlock, createElementVNode, renderSlot, toDisplayString } from 'vue';\nimport { isEqual } from 'lodash-unified';\nimport { onClickOutside } from '@vueuse/core';\nimport '../../../../hooks/index.mjs';\nimport '../../../form/index.mjs';\nimport { ElInput } from '../../../input/index.mjs';\nimport { ElIcon } from '../../../icon/index.mjs';\nimport { ElTooltip } from '../../../tooltip/index.mjs';\nimport '../../../../utils/index.mjs';\nimport '../../../../constants/index.mjs';\nimport { Clock, Calendar } from '@element-plus/icons-vue';\nimport { valueEquals, formatter, parseDate } from '../utils.mjs';\nimport { timePickerDefaultProps } from './props.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { useFormItem } from '../../../form/src/hooks/use-form-item.mjs';\nimport { debugWarn } from '../../../../utils/error.mjs';\nimport { isArray } from '@vue/shared';\nimport { EVENT_CODE } from '../../../../constants/aria.mjs';\nimport { useFormSize } from '../../../form/src/hooks/use-form-common-props.mjs';\n\nconst _hoisted_1 = [\"id\", \"name\", \"placeholder\", \"value\", \"disabled\", \"readonly\"];\nconst _hoisted_2 = [\"id\", \"name\", \"placeholder\", \"value\", \"disabled\", \"readonly\"];\nconst __default__ = defineComponent({\n  name: \"Picker\"\n});\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  ...__default__,\n  props: timePickerDefaultProps,\n  emits: [\n    \"update:modelValue\",\n    \"change\",\n    \"focus\",\n    \"blur\",\n    \"calendar-change\",\n    \"panel-change\",\n    \"visible-change\",\n    \"keydown\"\n  ],\n  setup(__props, { expose, emit }) {\n    const props = __props;\n    const attrs = useAttrs();\n    const { lang } = useLocale();\n    const nsDate = useNamespace(\"date\");\n    const nsInput = useNamespace(\"input\");\n    const nsRange = useNamespace(\"range\");\n    const { form, formItem } = useFormItem();\n    const elPopperOptions = inject(\"ElPopperOptions\", {});\n    const refPopper = ref();\n    const inputRef = ref();\n    const pickerVisible = ref(false);\n    const pickerActualVisible = ref(false);\n    const valueOnOpen = ref(null);\n    let hasJustTabExitedInput = false;\n    let ignoreFocusEvent = false;\n    const rangeInputKls = computed(() => [\n      nsDate.b(\"editor\"),\n      nsDate.bm(\"editor\", props.type),\n      nsInput.e(\"wrapper\"),\n      nsDate.is(\"disabled\", pickerDisabled.value),\n      nsDate.is(\"active\", pickerVisible.value),\n      nsRange.b(\"editor\"),\n      pickerSize ? nsRange.bm(\"editor\", pickerSize.value) : \"\",\n      attrs.class\n    ]);\n    const clearIconKls = computed(() => [\n      nsInput.e(\"icon\"),\n      nsRange.e(\"close-icon\"),\n      !showClose.value ? nsRange.e(\"close-icon--hidden\") : \"\"\n    ]);\n    watch(pickerVisible, (val) => {\n      if (!val) {\n        userInput.value = null;\n        nextTick(() => {\n          emitChange(props.modelValue);\n        });\n      } else {\n        nextTick(() => {\n          if (val) {\n            valueOnOpen.value = props.modelValue;\n          }\n        });\n      }\n    });\n    const emitChange = (val, isClear) => {\n      if (isClear || !valueEquals(val, valueOnOpen.value)) {\n        emit(\"change\", val);\n        props.validateEvent && (formItem == null ? void 0 : formItem.validate(\"change\").catch((err) => debugWarn(err)));\n      }\n    };\n    const emitInput = (input) => {\n      if (!valueEquals(props.modelValue, input)) {\n        let formatted;\n        if (isArray(input)) {\n          formatted = input.map((item) => formatter(item, props.valueFormat, lang.value));\n        } else if (input) {\n          formatted = formatter(input, props.valueFormat, lang.value);\n        }\n        emit(\"update:modelValue\", input ? formatted : input, lang.value);\n      }\n    };\n    const emitKeydown = (e) => {\n      emit(\"keydown\", e);\n    };\n    const refInput = computed(() => {\n      if (inputRef.value) {\n        const _r = isRangeInput.value ? inputRef.value : inputRef.value.$el;\n        return Array.from(_r.querySelectorAll(\"input\"));\n      }\n      return [];\n    });\n    const setSelectionRange = (start, end, pos) => {\n      const _inputs = refInput.value;\n      if (!_inputs.length)\n        return;\n      if (!pos || pos === \"min\") {\n        _inputs[0].setSelectionRange(start, end);\n        _inputs[0].focus();\n      } else if (pos === \"max\") {\n        _inputs[1].setSelectionRange(start, end);\n        _inputs[1].focus();\n      }\n    };\n    const focusOnInputBox = () => {\n      focus(true, true);\n      nextTick(() => {\n        ignoreFocusEvent = false;\n      });\n    };\n    const onPick = (date = \"\", visible = false) => {\n      if (!visible) {\n        ignoreFocusEvent = true;\n      }\n      pickerVisible.value = visible;\n      let result;\n      if (isArray(date)) {\n        result = date.map((_) => _.toDate());\n      } else {\n        result = date ? date.toDate() : date;\n      }\n      userInput.value = null;\n      emitInput(result);\n    };\n    const onBeforeShow = () => {\n      pickerActualVisible.value = true;\n    };\n    const onShow = () => {\n      emit(\"visible-change\", true);\n    };\n    const onKeydownPopperContent = (event) => {\n      if ((event == null ? void 0 : event.key) === EVENT_CODE.esc) {\n        focus(true, true);\n      }\n    };\n    const onHide = () => {\n      pickerActualVisible.value = false;\n      pickerVisible.value = false;\n      ignoreFocusEvent = false;\n      emit(\"visible-change\", false);\n    };\n    const handleOpen = () => {\n      pickerVisible.value = true;\n    };\n    const handleClose = () => {\n      pickerVisible.value = false;\n    };\n    const focus = (focusStartInput = true, isIgnoreFocusEvent = false) => {\n      ignoreFocusEvent = isIgnoreFocusEvent;\n      const [leftInput, rightInput] = unref(refInput);\n      let input = leftInput;\n      if (!focusStartInput && isRangeInput.value) {\n        input = rightInput;\n      }\n      if (input) {\n        input.focus();\n      }\n    };\n    const handleFocusInput = (e) => {\n      if (props.readonly || pickerDisabled.value || pickerVisible.value || ignoreFocusEvent) {\n        return;\n      }\n      pickerVisible.value = true;\n      emit(\"focus\", e);\n    };\n    let currentHandleBlurDeferCallback = void 0;\n    const handleBlurInput = (e) => {\n      const handleBlurDefer = async () => {\n        setTimeout(() => {\n          var _a;\n          if (currentHandleBlurDeferCallback === handleBlurDefer) {\n            if (!(((_a = refPopper.value) == null ? void 0 : _a.isFocusInsideContent()) && !hasJustTabExitedInput) && refInput.value.filter((input) => {\n              return input.contains(document.activeElement);\n            }).length === 0) {\n              handleChange();\n              pickerVisible.value = false;\n              emit(\"blur\", e);\n              props.validateEvent && (formItem == null ? void 0 : formItem.validate(\"blur\").catch((err) => debugWarn(err)));\n            }\n            hasJustTabExitedInput = false;\n          }\n        }, 0);\n      };\n      currentHandleBlurDeferCallback = handleBlurDefer;\n      handleBlurDefer();\n    };\n    const pickerDisabled = computed(() => {\n      return props.disabled || (form == null ? void 0 : form.disabled);\n    });\n    const parsedValue = computed(() => {\n      let dayOrDays;\n      if (valueIsEmpty.value) {\n        if (pickerOptions.value.getDefaultValue) {\n          dayOrDays = pickerOptions.value.getDefaultValue();\n        }\n      } else {\n        if (isArray(props.modelValue)) {\n          dayOrDays = props.modelValue.map((d) => parseDate(d, props.valueFormat, lang.value));\n        } else {\n          dayOrDays = parseDate(props.modelValue, props.valueFormat, lang.value);\n        }\n      }\n      if (pickerOptions.value.getRangeAvailableTime) {\n        const availableResult = pickerOptions.value.getRangeAvailableTime(dayOrDays);\n        if (!isEqual(availableResult, dayOrDays)) {\n          dayOrDays = availableResult;\n          emitInput(isArray(dayOrDays) ? dayOrDays.map((_) => _.toDate()) : dayOrDays.toDate());\n        }\n      }\n      if (isArray(dayOrDays) && dayOrDays.some((day) => !day)) {\n        dayOrDays = [];\n      }\n      return dayOrDays;\n    });\n    const displayValue = computed(() => {\n      if (!pickerOptions.value.panelReady)\n        return \"\";\n      const formattedValue = formatDayjsToString(parsedValue.value);\n      if (isArray(userInput.value)) {\n        return [\n          userInput.value[0] || formattedValue && formattedValue[0] || \"\",\n          userInput.value[1] || formattedValue && formattedValue[1] || \"\"\n        ];\n      } else if (userInput.value !== null) {\n        return userInput.value;\n      }\n      if (!isTimePicker.value && valueIsEmpty.value)\n        return \"\";\n      if (!pickerVisible.value && valueIsEmpty.value)\n        return \"\";\n      if (formattedValue) {\n        return isDatesPicker.value ? formattedValue.join(\", \") : formattedValue;\n      }\n      return \"\";\n    });\n    const isTimeLikePicker = computed(() => props.type.includes(\"time\"));\n    const isTimePicker = computed(() => props.type.startsWith(\"time\"));\n    const isDatesPicker = computed(() => props.type === \"dates\");\n    const triggerIcon = computed(() => props.prefixIcon || (isTimeLikePicker.value ? Clock : Calendar));\n    const showClose = ref(false);\n    const onClearIconClick = (event) => {\n      if (props.readonly || pickerDisabled.value)\n        return;\n      if (showClose.value) {\n        event.stopPropagation();\n        focusOnInputBox();\n        emitInput(null);\n        emitChange(null, true);\n        showClose.value = false;\n        pickerVisible.value = false;\n        pickerOptions.value.handleClear && pickerOptions.value.handleClear();\n      }\n    };\n    const valueIsEmpty = computed(() => {\n      const { modelValue } = props;\n      return !modelValue || isArray(modelValue) && !modelValue.filter(Boolean).length;\n    });\n    const onMouseDownInput = async (event) => {\n      var _a;\n      if (props.readonly || pickerDisabled.value)\n        return;\n      if (((_a = event.target) == null ? void 0 : _a.tagName) !== \"INPUT\" || refInput.value.includes(document.activeElement)) {\n        pickerVisible.value = true;\n      }\n    };\n    const onMouseEnter = () => {\n      if (props.readonly || pickerDisabled.value)\n        return;\n      if (!valueIsEmpty.value && props.clearable) {\n        showClose.value = true;\n      }\n    };\n    const onMouseLeave = () => {\n      showClose.value = false;\n    };\n    const onTouchStartInput = (event) => {\n      var _a;\n      if (props.readonly || pickerDisabled.value)\n        return;\n      if (((_a = event.touches[0].target) == null ? void 0 : _a.tagName) !== \"INPUT\" || refInput.value.includes(document.activeElement)) {\n        pickerVisible.value = true;\n      }\n    };\n    const isRangeInput = computed(() => {\n      return props.type.includes(\"range\");\n    });\n    const pickerSize = useFormSize();\n    const popperEl = computed(() => {\n      var _a, _b;\n      return (_b = (_a = unref(refPopper)) == null ? void 0 : _a.popperRef) == null ? void 0 : _b.contentRef;\n    });\n    const actualInputRef = computed(() => {\n      var _a;\n      if (unref(isRangeInput)) {\n        return unref(inputRef);\n      }\n      return (_a = unref(inputRef)) == null ? void 0 : _a.$el;\n    });\n    onClickOutside(actualInputRef, (e) => {\n      const unrefedPopperEl = unref(popperEl);\n      const inputEl = unref(actualInputRef);\n      if (unrefedPopperEl && (e.target === unrefedPopperEl || e.composedPath().includes(unrefedPopperEl)) || e.target === inputEl || e.composedPath().includes(inputEl))\n        return;\n      pickerVisible.value = false;\n    });\n    const userInput = ref(null);\n    const handleChange = () => {\n      if (userInput.value) {\n        const value = parseUserInputToDayjs(displayValue.value);\n        if (value) {\n          if (isValidValue(value)) {\n            emitInput(isArray(value) ? value.map((_) => _.toDate()) : value.toDate());\n            userInput.value = null;\n          }\n        }\n      }\n      if (userInput.value === \"\") {\n        emitInput(null);\n        emitChange(null);\n        userInput.value = null;\n      }\n    };\n    const parseUserInputToDayjs = (value) => {\n      if (!value)\n        return null;\n      return pickerOptions.value.parseUserInput(value);\n    };\n    const formatDayjsToString = (value) => {\n      if (!value)\n        return null;\n      return pickerOptions.value.formatToString(value);\n    };\n    const isValidValue = (value) => {\n      return pickerOptions.value.isValidValue(value);\n    };\n    const handleKeydownInput = async (event) => {\n      if (props.readonly || pickerDisabled.value)\n        return;\n      const { code } = event;\n      emitKeydown(event);\n      if (code === EVENT_CODE.esc) {\n        if (pickerVisible.value === true) {\n          pickerVisible.value = false;\n          event.preventDefault();\n          event.stopPropagation();\n        }\n        return;\n      }\n      if (code === EVENT_CODE.down) {\n        if (pickerOptions.value.handleFocusPicker) {\n          event.preventDefault();\n          event.stopPropagation();\n        }\n        if (pickerVisible.value === false) {\n          pickerVisible.value = true;\n          await nextTick();\n        }\n        if (pickerOptions.value.handleFocusPicker) {\n          pickerOptions.value.handleFocusPicker();\n          return;\n        }\n      }\n      if (code === EVENT_CODE.tab) {\n        hasJustTabExitedInput = true;\n        return;\n      }\n      if (code === EVENT_CODE.enter || code === EVENT_CODE.numpadEnter) {\n        if (userInput.value === null || userInput.value === \"\" || isValidValue(parseUserInputToDayjs(displayValue.value))) {\n          handleChange();\n          pickerVisible.value = false;\n        }\n        event.stopPropagation();\n        return;\n      }\n      if (userInput.value) {\n        event.stopPropagation();\n        return;\n      }\n      if (pickerOptions.value.handleKeydownInput) {\n        pickerOptions.value.handleKeydownInput(event);\n      }\n    };\n    const onUserInput = (e) => {\n      userInput.value = e;\n      if (!pickerVisible.value) {\n        pickerVisible.value = true;\n      }\n    };\n    const handleStartInput = (event) => {\n      const target = event.target;\n      if (userInput.value) {\n        userInput.value = [target.value, userInput.value[1]];\n      } else {\n        userInput.value = [target.value, null];\n      }\n    };\n    const handleEndInput = (event) => {\n      const target = event.target;\n      if (userInput.value) {\n        userInput.value = [userInput.value[0], target.value];\n      } else {\n        userInput.value = [null, target.value];\n      }\n    };\n    const handleStartChange = () => {\n      var _a;\n      const values = userInput.value;\n      const value = parseUserInputToDayjs(values && values[0]);\n      const parsedVal = unref(parsedValue);\n      if (value && value.isValid()) {\n        userInput.value = [\n          formatDayjsToString(value),\n          ((_a = displayValue.value) == null ? void 0 : _a[1]) || null\n        ];\n        const newValue = [value, parsedVal && (parsedVal[1] || null)];\n        if (isValidValue(newValue)) {\n          emitInput(newValue);\n          userInput.value = null;\n        }\n      }\n    };\n    const handleEndChange = () => {\n      var _a;\n      const values = unref(userInput);\n      const value = parseUserInputToDayjs(values && values[1]);\n      const parsedVal = unref(parsedValue);\n      if (value && value.isValid()) {\n        userInput.value = [\n          ((_a = unref(displayValue)) == null ? void 0 : _a[0]) || null,\n          formatDayjsToString(value)\n        ];\n        const newValue = [parsedVal && parsedVal[0], value];\n        if (isValidValue(newValue)) {\n          emitInput(newValue);\n          userInput.value = null;\n        }\n      }\n    };\n    const pickerOptions = ref({});\n    const onSetPickerOption = (e) => {\n      pickerOptions.value[e[0]] = e[1];\n      pickerOptions.value.panelReady = true;\n    };\n    const onCalendarChange = (e) => {\n      emit(\"calendar-change\", e);\n    };\n    const onPanelChange = (value, mode, view) => {\n      emit(\"panel-change\", value, mode, view);\n    };\n    provide(\"EP_PICKER_BASE\", {\n      props\n    });\n    expose({\n      focus,\n      handleFocusInput,\n      handleBlurInput,\n      handleOpen,\n      handleClose,\n      onPick\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(unref(ElTooltip), mergeProps({\n        ref_key: \"refPopper\",\n        ref: refPopper,\n        visible: pickerVisible.value,\n        effect: \"light\",\n        pure: \"\",\n        trigger: \"click\"\n      }, _ctx.$attrs, {\n        role: \"dialog\",\n        teleported: \"\",\n        transition: `${unref(nsDate).namespace.value}-zoom-in-top`,\n        \"popper-class\": [`${unref(nsDate).namespace.value}-picker__popper`, _ctx.popperClass],\n        \"popper-options\": unref(elPopperOptions),\n        \"fallback-placements\": [\"bottom\", \"top\", \"right\", \"left\"],\n        \"gpu-acceleration\": false,\n        \"stop-popper-mouse-event\": false,\n        \"hide-after\": 0,\n        persistent: \"\",\n        onBeforeShow,\n        onShow,\n        onHide\n      }), {\n        default: withCtx(() => [\n          !unref(isRangeInput) ? (openBlock(), createBlock(unref(ElInput), {\n            key: 0,\n            id: _ctx.id,\n            ref_key: \"inputRef\",\n            ref: inputRef,\n            \"container-role\": \"combobox\",\n            \"model-value\": unref(displayValue),\n            name: _ctx.name,\n            size: unref(pickerSize),\n            disabled: unref(pickerDisabled),\n            placeholder: _ctx.placeholder,\n            class: normalizeClass([unref(nsDate).b(\"editor\"), unref(nsDate).bm(\"editor\", _ctx.type), _ctx.$attrs.class]),\n            style: normalizeStyle(_ctx.$attrs.style),\n            readonly: !_ctx.editable || _ctx.readonly || unref(isDatesPicker) || _ctx.type === \"week\",\n            label: _ctx.label,\n            tabindex: _ctx.tabindex,\n            \"validate-event\": false,\n            onInput: onUserInput,\n            onFocus: handleFocusInput,\n            onBlur: handleBlurInput,\n            onKeydown: handleKeydownInput,\n            onChange: handleChange,\n            onMousedown: onMouseDownInput,\n            onMouseenter: onMouseEnter,\n            onMouseleave: onMouseLeave,\n            onTouchstart: onTouchStartInput,\n            onClick: _cache[0] || (_cache[0] = withModifiers(() => {\n            }, [\"stop\"]))\n          }, {\n            prefix: withCtx(() => [\n              unref(triggerIcon) ? (openBlock(), createBlock(unref(ElIcon), {\n                key: 0,\n                class: normalizeClass(unref(nsInput).e(\"icon\")),\n                onMousedown: withModifiers(onMouseDownInput, [\"prevent\"]),\n                onTouchstart: onTouchStartInput\n              }, {\n                default: withCtx(() => [\n                  (openBlock(), createBlock(resolveDynamicComponent(unref(triggerIcon))))\n                ]),\n                _: 1\n              }, 8, [\"class\", \"onMousedown\"])) : createCommentVNode(\"v-if\", true)\n            ]),\n            suffix: withCtx(() => [\n              showClose.value && _ctx.clearIcon ? (openBlock(), createBlock(unref(ElIcon), {\n                key: 0,\n                class: normalizeClass(`${unref(nsInput).e(\"icon\")} clear-icon`),\n                onClick: withModifiers(onClearIconClick, [\"stop\"])\n              }, {\n                default: withCtx(() => [\n                  (openBlock(), createBlock(resolveDynamicComponent(_ctx.clearIcon)))\n                ]),\n                _: 1\n              }, 8, [\"class\", \"onClick\"])) : createCommentVNode(\"v-if\", true)\n            ]),\n            _: 1\n          }, 8, [\"id\", \"model-value\", \"name\", \"size\", \"disabled\", \"placeholder\", \"class\", \"style\", \"readonly\", \"label\", \"tabindex\", \"onKeydown\"])) : (openBlock(), createElementBlock(\"div\", {\n            key: 1,\n            ref_key: \"inputRef\",\n            ref: inputRef,\n            class: normalizeClass(unref(rangeInputKls)),\n            style: normalizeStyle(_ctx.$attrs.style),\n            onClick: handleFocusInput,\n            onMouseenter: onMouseEnter,\n            onMouseleave: onMouseLeave,\n            onTouchstart: onTouchStartInput,\n            onKeydown: handleKeydownInput\n          }, [\n            unref(triggerIcon) ? (openBlock(), createBlock(unref(ElIcon), {\n              key: 0,\n              class: normalizeClass([unref(nsInput).e(\"icon\"), unref(nsRange).e(\"icon\")]),\n              onMousedown: withModifiers(onMouseDownInput, [\"prevent\"]),\n              onTouchstart: onTouchStartInput\n            }, {\n              default: withCtx(() => [\n                (openBlock(), createBlock(resolveDynamicComponent(unref(triggerIcon))))\n              ]),\n              _: 1\n            }, 8, [\"class\", \"onMousedown\"])) : createCommentVNode(\"v-if\", true),\n            createElementVNode(\"input\", {\n              id: _ctx.id && _ctx.id[0],\n              autocomplete: \"off\",\n              name: _ctx.name && _ctx.name[0],\n              placeholder: _ctx.startPlaceholder,\n              value: unref(displayValue) && unref(displayValue)[0],\n              disabled: unref(pickerDisabled),\n              readonly: !_ctx.editable || _ctx.readonly,\n              class: normalizeClass(unref(nsRange).b(\"input\")),\n              onMousedown: onMouseDownInput,\n              onInput: handleStartInput,\n              onChange: handleStartChange,\n              onFocus: handleFocusInput,\n              onBlur: handleBlurInput\n            }, null, 42, _hoisted_1),\n            renderSlot(_ctx.$slots, \"range-separator\", {}, () => [\n              createElementVNode(\"span\", {\n                class: normalizeClass(unref(nsRange).b(\"separator\"))\n              }, toDisplayString(_ctx.rangeSeparator), 3)\n            ]),\n            createElementVNode(\"input\", {\n              id: _ctx.id && _ctx.id[1],\n              autocomplete: \"off\",\n              name: _ctx.name && _ctx.name[1],\n              placeholder: _ctx.endPlaceholder,\n              value: unref(displayValue) && unref(displayValue)[1],\n              disabled: unref(pickerDisabled),\n              readonly: !_ctx.editable || _ctx.readonly,\n              class: normalizeClass(unref(nsRange).b(\"input\")),\n              onMousedown: onMouseDownInput,\n              onFocus: handleFocusInput,\n              onBlur: handleBlurInput,\n              onInput: handleEndInput,\n              onChange: handleEndChange\n            }, null, 42, _hoisted_2),\n            _ctx.clearIcon ? (openBlock(), createBlock(unref(ElIcon), {\n              key: 1,\n              class: normalizeClass(unref(clearIconKls)),\n              onClick: onClearIconClick\n            }, {\n              default: withCtx(() => [\n                (openBlock(), createBlock(resolveDynamicComponent(_ctx.clearIcon)))\n              ]),\n              _: 1\n            }, 8, [\"class\"])) : createCommentVNode(\"v-if\", true)\n          ], 38))\n        ]),\n        content: withCtx(() => [\n          renderSlot(_ctx.$slots, \"default\", {\n            visible: pickerVisible.value,\n            actualVisible: pickerActualVisible.value,\n            parsedValue: unref(parsedValue),\n            format: _ctx.format,\n            unlinkPanels: _ctx.unlinkPanels,\n            type: _ctx.type,\n            defaultValue: _ctx.defaultValue,\n            onPick,\n            onSelectRange: setSelectionRange,\n            onSetPickerOption,\n            onCalendarChange,\n            onPanelChange,\n            onKeydown: onKeydownPopperContent,\n            onMousedown: _cache[1] || (_cache[1] = withModifiers(() => {\n            }, [\"stop\"]))\n          })\n        ]),\n        _: 3\n      }, 16, [\"visible\", \"transition\", \"popper-class\", \"popper-options\"]);\n    };\n  }\n});\nvar CommonPicker = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/common/picker.vue\"]]);\n\nexport { CommonPicker as default };\n//# sourceMappingURL=picker.mjs.map\n","import '../../../../utils/index.mjs';\nimport { timePanelSharedProps } from './shared.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\n\nconst panelTimePickerProps = buildProps({\n  ...timePanelSharedProps,\n  datetimeRole: String,\n  parsedValue: {\n    type: definePropType(Object)\n  }\n});\n\nexport { panelTimePickerProps };\n//# sourceMappingURL=panel-time-picker.mjs.map\n","const useTimePanel = ({\n  getAvailableHours,\n  getAvailableMinutes,\n  getAvailableSeconds\n}) => {\n  const getAvailableTime = (date, role, first, compareDate) => {\n    const availableTimeGetters = {\n      hour: getAvailableHours,\n      minute: getAvailableMinutes,\n      second: getAvailableSeconds\n    };\n    let result = date;\n    [\"hour\", \"minute\", \"second\"].forEach((type) => {\n      if (availableTimeGetters[type]) {\n        let availableTimeSlots;\n        const method = availableTimeGetters[type];\n        switch (type) {\n          case \"minute\": {\n            availableTimeSlots = method(result.hour(), role, compareDate);\n            break;\n          }\n          case \"second\": {\n            availableTimeSlots = method(result.hour(), result.minute(), role, compareDate);\n            break;\n          }\n          default: {\n            availableTimeSlots = method(role, compareDate);\n            break;\n          }\n        }\n        if ((availableTimeSlots == null ? void 0 : availableTimeSlots.length) && !availableTimeSlots.includes(result[type]())) {\n          const pos = first ? 0 : availableTimeSlots.length - 1;\n          result = result[type](availableTimeSlots[pos]);\n        }\n      }\n    });\n    return result;\n  };\n  const timePickerOptions = {};\n  const onSetOption = ([key, val]) => {\n    timePickerOptions[key] = val;\n  };\n  return {\n    timePickerOptions,\n    getAvailableTime,\n    onSetOption\n  };\n};\n\nexport { useTimePanel };\n//# sourceMappingURL=use-time-panel.mjs.map\n","import { ref, watch } from 'vue';\nimport { makeList } from '../utils.mjs';\n\nconst makeAvailableArr = (disabledList) => {\n  const trueOrNumber = (isDisabled, index) => isDisabled || index;\n  const getNumber = (predicate) => predicate !== true;\n  return disabledList.map(trueOrNumber).filter(getNumber);\n};\nconst getTimeLists = (disabledHours, disabledMinutes, disabledSeconds) => {\n  const getHoursList = (role, compare) => {\n    return makeList(24, disabledHours && (() => disabledHours == null ? void 0 : disabledHours(role, compare)));\n  };\n  const getMinutesList = (hour, role, compare) => {\n    return makeList(60, disabledMinutes && (() => disabledMinutes == null ? void 0 : disabledMinutes(hour, role, compare)));\n  };\n  const getSecondsList = (hour, minute, role, compare) => {\n    return makeList(60, disabledSeconds && (() => disabledSeconds == null ? void 0 : disabledSeconds(hour, minute, role, compare)));\n  };\n  return {\n    getHoursList,\n    getMinutesList,\n    getSecondsList\n  };\n};\nconst buildAvailableTimeSlotGetter = (disabledHours, disabledMinutes, disabledSeconds) => {\n  const { getHoursList, getMinutesList, getSecondsList } = getTimeLists(disabledHours, disabledMinutes, disabledSeconds);\n  const getAvailableHours = (role, compare) => {\n    return makeAvailableArr(getHoursList(role, compare));\n  };\n  const getAvailableMinutes = (hour, role, compare) => {\n    return makeAvailableArr(getMinutesList(hour, role, compare));\n  };\n  const getAvailableSeconds = (hour, minute, role, compare) => {\n    return makeAvailableArr(getSecondsList(hour, minute, role, compare));\n  };\n  return {\n    getAvailableHours,\n    getAvailableMinutes,\n    getAvailableSeconds\n  };\n};\nconst useOldValue = (props) => {\n  const oldValue = ref(props.parsedValue);\n  watch(() => props.visible, (val) => {\n    if (!val) {\n      oldValue.value = props.parsedValue;\n    }\n  });\n  return oldValue;\n};\n\nexport { buildAvailableTimeSlotGetter, getTimeLists, useOldValue };\n//# sourceMappingURL=use-time-picker.mjs.map\n","import '../../utils/index.mjs';\nimport { isFunction } from '@vue/shared';\n\nconst REPEAT_INTERVAL = 100;\nconst REPEAT_DELAY = 600;\nconst vRepeatClick = {\n  beforeMount(el, binding) {\n    const value = binding.value;\n    const { interval = REPEAT_INTERVAL, delay = REPEAT_DELAY } = isFunction(value) ? {} : value;\n    let intervalId;\n    let delayId;\n    const handler = () => isFunction(value) ? value() : value.handler();\n    const clear = () => {\n      if (delayId) {\n        clearTimeout(delayId);\n        delayId = void 0;\n      }\n      if (intervalId) {\n        clearInterval(intervalId);\n        intervalId = void 0;\n      }\n    };\n    el.addEventListener(\"mousedown\", (evt) => {\n      if (evt.button !== 0)\n        return;\n      clear();\n      handler();\n      document.addEventListener(\"mouseup\", () => clear(), {\n        once: true\n      });\n      delayId = setTimeout(() => {\n        intervalId = setInterval(() => {\n          handler();\n        }, interval);\n      }, delay);\n    });\n  }\n};\n\nexport { REPEAT_DELAY, REPEAT_INTERVAL, vRepeatClick };\n//# sourceMappingURL=index.mjs.map\n","import '../../../../utils/index.mjs';\nimport { disabledTimeListsProps } from './shared.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\n\nconst basicTimeSpinnerProps = buildProps({\n  role: {\n    type: String,\n    required: true\n  },\n  spinnerDate: {\n    type: definePropType(Object),\n    required: true\n  },\n  showSeconds: {\n    type: Boolean,\n    default: true\n  },\n  arrowControl: Boolean,\n  amPmMode: {\n    type: definePropType(String),\n    default: \"\"\n  },\n  ...disabledTimeListsProps\n});\n\nexport { basicTimeSpinnerProps };\n//# sourceMappingURL=basic-time-spinner.mjs.map\n","import { defineComponent, ref, computed, unref, nextTick, onMounted, watch, openBlock, createElementBlock, normalizeClass, Fragment, renderList, createBlock, withCtx, createTextVNode, toDisplayString, createCommentVNode, withDirectives, createVNode, createElementVNode } from 'vue';\nimport { debounce } from 'lodash-unified';\nimport '../../../../directives/index.mjs';\nimport { ElScrollbar } from '../../../scrollbar/index.mjs';\nimport { ElIcon } from '../../../icon/index.mjs';\nimport { ArrowUp, ArrowDown } from '@element-plus/icons-vue';\nimport '../../../../hooks/index.mjs';\nimport '../../../../utils/index.mjs';\nimport { timeUnits } from '../constants.mjs';\nimport { buildTimeList } from '../utils.mjs';\nimport { basicTimeSpinnerProps } from '../props/basic-time-spinner.mjs';\nimport { getTimeLists } from '../composables/use-time-picker.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { getStyle } from '../../../../utils/dom/style.mjs';\nimport { vRepeatClick } from '../../../../directives/repeat-click/index.mjs';\n\nconst _hoisted_1 = [\"onClick\"];\nconst _hoisted_2 = [\"onMouseenter\"];\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"basic-time-spinner\",\n  props: basicTimeSpinnerProps,\n  emits: [\"change\", \"select-range\", \"set-option\"],\n  setup(__props, { emit }) {\n    const props = __props;\n    const ns = useNamespace(\"time\");\n    const { getHoursList, getMinutesList, getSecondsList } = getTimeLists(props.disabledHours, props.disabledMinutes, props.disabledSeconds);\n    let isScrolling = false;\n    const currentScrollbar = ref();\n    const listHoursRef = ref();\n    const listMinutesRef = ref();\n    const listSecondsRef = ref();\n    const listRefsMap = {\n      hours: listHoursRef,\n      minutes: listMinutesRef,\n      seconds: listSecondsRef\n    };\n    const spinnerItems = computed(() => {\n      return props.showSeconds ? timeUnits : timeUnits.slice(0, 2);\n    });\n    const timePartials = computed(() => {\n      const { spinnerDate } = props;\n      const hours = spinnerDate.hour();\n      const minutes = spinnerDate.minute();\n      const seconds = spinnerDate.second();\n      return { hours, minutes, seconds };\n    });\n    const timeList = computed(() => {\n      const { hours, minutes } = unref(timePartials);\n      return {\n        hours: getHoursList(props.role),\n        minutes: getMinutesList(hours, props.role),\n        seconds: getSecondsList(hours, minutes, props.role)\n      };\n    });\n    const arrowControlTimeList = computed(() => {\n      const { hours, minutes, seconds } = unref(timePartials);\n      return {\n        hours: buildTimeList(hours, 23),\n        minutes: buildTimeList(minutes, 59),\n        seconds: buildTimeList(seconds, 59)\n      };\n    });\n    const debouncedResetScroll = debounce((type) => {\n      isScrolling = false;\n      adjustCurrentSpinner(type);\n    }, 200);\n    const getAmPmFlag = (hour) => {\n      const shouldShowAmPm = !!props.amPmMode;\n      if (!shouldShowAmPm)\n        return \"\";\n      const isCapital = props.amPmMode === \"A\";\n      let content = hour < 12 ? \" am\" : \" pm\";\n      if (isCapital)\n        content = content.toUpperCase();\n      return content;\n    };\n    const emitSelectRange = (type) => {\n      let range;\n      switch (type) {\n        case \"hours\":\n          range = [0, 2];\n          break;\n        case \"minutes\":\n          range = [3, 5];\n          break;\n        case \"seconds\":\n          range = [6, 8];\n          break;\n      }\n      const [left, right] = range;\n      emit(\"select-range\", left, right);\n      currentScrollbar.value = type;\n    };\n    const adjustCurrentSpinner = (type) => {\n      adjustSpinner(type, unref(timePartials)[type]);\n    };\n    const adjustSpinners = () => {\n      adjustCurrentSpinner(\"hours\");\n      adjustCurrentSpinner(\"minutes\");\n      adjustCurrentSpinner(\"seconds\");\n    };\n    const getScrollbarElement = (el) => el.querySelector(`.${ns.namespace.value}-scrollbar__wrap`);\n    const adjustSpinner = (type, value) => {\n      if (props.arrowControl)\n        return;\n      const scrollbar = unref(listRefsMap[type]);\n      if (scrollbar && scrollbar.$el) {\n        getScrollbarElement(scrollbar.$el).scrollTop = Math.max(0, value * typeItemHeight(type));\n      }\n    };\n    const typeItemHeight = (type) => {\n      const scrollbar = unref(listRefsMap[type]);\n      const listItem = scrollbar == null ? void 0 : scrollbar.$el.querySelector(\"li\");\n      if (listItem) {\n        return Number.parseFloat(getStyle(listItem, \"height\")) || 0;\n      }\n      return 0;\n    };\n    const onIncrement = () => {\n      scrollDown(1);\n    };\n    const onDecrement = () => {\n      scrollDown(-1);\n    };\n    const scrollDown = (step) => {\n      if (!currentScrollbar.value) {\n        emitSelectRange(\"hours\");\n      }\n      const label = currentScrollbar.value;\n      const now = unref(timePartials)[label];\n      const total = currentScrollbar.value === \"hours\" ? 24 : 60;\n      const next = findNextUnDisabled(label, now, step, total);\n      modifyDateField(label, next);\n      adjustSpinner(label, next);\n      nextTick(() => emitSelectRange(label));\n    };\n    const findNextUnDisabled = (type, now, step, total) => {\n      let next = (now + step + total) % total;\n      const list = unref(timeList)[type];\n      while (list[next] && next !== now) {\n        next = (next + step + total) % total;\n      }\n      return next;\n    };\n    const modifyDateField = (type, value) => {\n      const list = unref(timeList)[type];\n      const isDisabled = list[value];\n      if (isDisabled)\n        return;\n      const { hours, minutes, seconds } = unref(timePartials);\n      let changeTo;\n      switch (type) {\n        case \"hours\":\n          changeTo = props.spinnerDate.hour(value).minute(minutes).second(seconds);\n          break;\n        case \"minutes\":\n          changeTo = props.spinnerDate.hour(hours).minute(value).second(seconds);\n          break;\n        case \"seconds\":\n          changeTo = props.spinnerDate.hour(hours).minute(minutes).second(value);\n          break;\n      }\n      emit(\"change\", changeTo);\n    };\n    const handleClick = (type, { value, disabled }) => {\n      if (!disabled) {\n        modifyDateField(type, value);\n        emitSelectRange(type);\n        adjustSpinner(type, value);\n      }\n    };\n    const handleScroll = (type) => {\n      isScrolling = true;\n      debouncedResetScroll(type);\n      const value = Math.min(Math.round((getScrollbarElement(unref(listRefsMap[type]).$el).scrollTop - (scrollBarHeight(type) * 0.5 - 10) / typeItemHeight(type) + 3) / typeItemHeight(type)), type === \"hours\" ? 23 : 59);\n      modifyDateField(type, value);\n    };\n    const scrollBarHeight = (type) => {\n      return unref(listRefsMap[type]).$el.offsetHeight;\n    };\n    const bindScrollEvent = () => {\n      const bindFunction = (type) => {\n        const scrollbar = unref(listRefsMap[type]);\n        if (scrollbar && scrollbar.$el) {\n          getScrollbarElement(scrollbar.$el).onscroll = () => {\n            handleScroll(type);\n          };\n        }\n      };\n      bindFunction(\"hours\");\n      bindFunction(\"minutes\");\n      bindFunction(\"seconds\");\n    };\n    onMounted(() => {\n      nextTick(() => {\n        !props.arrowControl && bindScrollEvent();\n        adjustSpinners();\n        if (props.role === \"start\")\n          emitSelectRange(\"hours\");\n      });\n    });\n    const setRef = (scrollbar, type) => {\n      listRefsMap[type].value = scrollbar;\n    };\n    emit(\"set-option\", [`${props.role}_scrollDown`, scrollDown]);\n    emit(\"set-option\", [`${props.role}_emitSelectRange`, emitSelectRange]);\n    watch(() => props.spinnerDate, () => {\n      if (isScrolling)\n        return;\n      adjustSpinners();\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        class: normalizeClass([unref(ns).b(\"spinner\"), { \"has-seconds\": _ctx.showSeconds }])\n      }, [\n        !_ctx.arrowControl ? (openBlock(true), createElementBlock(Fragment, { key: 0 }, renderList(unref(spinnerItems), (item) => {\n          return openBlock(), createBlock(unref(ElScrollbar), {\n            key: item,\n            ref_for: true,\n            ref: (scrollbar) => setRef(scrollbar, item),\n            class: normalizeClass(unref(ns).be(\"spinner\", \"wrapper\")),\n            \"wrap-style\": \"max-height: inherit;\",\n            \"view-class\": unref(ns).be(\"spinner\", \"list\"),\n            noresize: \"\",\n            tag: \"ul\",\n            onMouseenter: ($event) => emitSelectRange(item),\n            onMousemove: ($event) => adjustCurrentSpinner(item)\n          }, {\n            default: withCtx(() => [\n              (openBlock(true), createElementBlock(Fragment, null, renderList(unref(timeList)[item], (disabled, key) => {\n                return openBlock(), createElementBlock(\"li\", {\n                  key,\n                  class: normalizeClass([\n                    unref(ns).be(\"spinner\", \"item\"),\n                    unref(ns).is(\"active\", key === unref(timePartials)[item]),\n                    unref(ns).is(\"disabled\", disabled)\n                  ]),\n                  onClick: ($event) => handleClick(item, { value: key, disabled })\n                }, [\n                  item === \"hours\" ? (openBlock(), createElementBlock(Fragment, { key: 0 }, [\n                    createTextVNode(toDisplayString((\"0\" + (_ctx.amPmMode ? key % 12 || 12 : key)).slice(-2)) + toDisplayString(getAmPmFlag(key)), 1)\n                  ], 64)) : (openBlock(), createElementBlock(Fragment, { key: 1 }, [\n                    createTextVNode(toDisplayString((\"0\" + key).slice(-2)), 1)\n                  ], 64))\n                ], 10, _hoisted_1);\n              }), 128))\n            ]),\n            _: 2\n          }, 1032, [\"class\", \"view-class\", \"onMouseenter\", \"onMousemove\"]);\n        }), 128)) : createCommentVNode(\"v-if\", true),\n        _ctx.arrowControl ? (openBlock(true), createElementBlock(Fragment, { key: 1 }, renderList(unref(spinnerItems), (item) => {\n          return openBlock(), createElementBlock(\"div\", {\n            key: item,\n            class: normalizeClass([unref(ns).be(\"spinner\", \"wrapper\"), unref(ns).is(\"arrow\")]),\n            onMouseenter: ($event) => emitSelectRange(item)\n          }, [\n            withDirectives((openBlock(), createBlock(unref(ElIcon), {\n              class: normalizeClass([\"arrow-up\", unref(ns).be(\"spinner\", \"arrow\")])\n            }, {\n              default: withCtx(() => [\n                createVNode(unref(ArrowUp))\n              ]),\n              _: 1\n            }, 8, [\"class\"])), [\n              [unref(vRepeatClick), onDecrement]\n            ]),\n            withDirectives((openBlock(), createBlock(unref(ElIcon), {\n              class: normalizeClass([\"arrow-down\", unref(ns).be(\"spinner\", \"arrow\")])\n            }, {\n              default: withCtx(() => [\n                createVNode(unref(ArrowDown))\n              ]),\n              _: 1\n            }, 8, [\"class\"])), [\n              [unref(vRepeatClick), onIncrement]\n            ]),\n            createElementVNode(\"ul\", {\n              class: normalizeClass(unref(ns).be(\"spinner\", \"list\"))\n            }, [\n              (openBlock(true), createElementBlock(Fragment, null, renderList(unref(arrowControlTimeList)[item], (time, key) => {\n                return openBlock(), createElementBlock(\"li\", {\n                  key,\n                  class: normalizeClass([\n                    unref(ns).be(\"spinner\", \"item\"),\n                    unref(ns).is(\"active\", time === unref(timePartials)[item]),\n                    unref(ns).is(\"disabled\", unref(timeList)[item][time])\n                  ])\n                }, [\n                  typeof time === \"number\" ? (openBlock(), createElementBlock(Fragment, { key: 0 }, [\n                    item === \"hours\" ? (openBlock(), createElementBlock(Fragment, { key: 0 }, [\n                      createTextVNode(toDisplayString((\"0\" + (_ctx.amPmMode ? time % 12 || 12 : time)).slice(-2)) + toDisplayString(getAmPmFlag(time)), 1)\n                    ], 64)) : (openBlock(), createElementBlock(Fragment, { key: 1 }, [\n                      createTextVNode(toDisplayString((\"0\" + time).slice(-2)), 1)\n                    ], 64))\n                  ], 64)) : createCommentVNode(\"v-if\", true)\n                ], 2);\n              }), 128))\n            ], 2)\n          ], 42, _hoisted_2);\n        }), 128)) : createCommentVNode(\"v-if\", true)\n      ], 2);\n    };\n  }\n});\nvar TimeSpinner = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/basic-time-spinner.vue\"]]);\n\nexport { TimeSpinner as default };\n//# sourceMappingURL=basic-time-spinner.mjs.map\n","import { defineComponent, inject, ref, computed, openBlock, createBlock, Transition, unref, withCtx, createElementBlock, normalizeClass, createElementVNode, createVNode, toDisplayString, createCommentVNode } from 'vue';\nimport dayjs from 'dayjs';\nimport '../../../../constants/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport '../../../../utils/index.mjs';\nimport { panelTimePickerProps } from '../props/panel-time-picker.mjs';\nimport { useTimePanel } from '../composables/use-time-panel.mjs';\nimport { buildAvailableTimeSlotGetter, useOldValue } from '../composables/use-time-picker.mjs';\nimport TimeSpinner from './basic-time-spinner.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\nimport { isUndefined } from '../../../../utils/types.mjs';\nimport { EVENT_CODE } from '../../../../constants/aria.mjs';\n\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"panel-time-pick\",\n  props: panelTimePickerProps,\n  emits: [\"pick\", \"select-range\", \"set-picker-option\"],\n  setup(__props, { emit }) {\n    const props = __props;\n    const pickerBase = inject(\"EP_PICKER_BASE\");\n    const {\n      arrowControl,\n      disabledHours,\n      disabledMinutes,\n      disabledSeconds,\n      defaultValue\n    } = pickerBase.props;\n    const { getAvailableHours, getAvailableMinutes, getAvailableSeconds } = buildAvailableTimeSlotGetter(disabledHours, disabledMinutes, disabledSeconds);\n    const ns = useNamespace(\"time\");\n    const { t, lang } = useLocale();\n    const selectionRange = ref([0, 2]);\n    const oldValue = useOldValue(props);\n    const transitionName = computed(() => {\n      return isUndefined(props.actualVisible) ? `${ns.namespace.value}-zoom-in-top` : \"\";\n    });\n    const showSeconds = computed(() => {\n      return props.format.includes(\"ss\");\n    });\n    const amPmMode = computed(() => {\n      if (props.format.includes(\"A\"))\n        return \"A\";\n      if (props.format.includes(\"a\"))\n        return \"a\";\n      return \"\";\n    });\n    const isValidValue = (_date) => {\n      const parsedDate = dayjs(_date).locale(lang.value);\n      const result = getRangeAvailableTime(parsedDate);\n      return parsedDate.isSame(result);\n    };\n    const handleCancel = () => {\n      emit(\"pick\", oldValue.value, false);\n    };\n    const handleConfirm = (visible = false, first = false) => {\n      if (first)\n        return;\n      emit(\"pick\", props.parsedValue, visible);\n    };\n    const handleChange = (_date) => {\n      if (!props.visible) {\n        return;\n      }\n      const result = getRangeAvailableTime(_date).millisecond(0);\n      emit(\"pick\", result, true);\n    };\n    const setSelectionRange = (start, end) => {\n      emit(\"select-range\", start, end);\n      selectionRange.value = [start, end];\n    };\n    const changeSelectionRange = (step) => {\n      const list = [0, 3].concat(showSeconds.value ? [6] : []);\n      const mapping = [\"hours\", \"minutes\"].concat(showSeconds.value ? [\"seconds\"] : []);\n      const index = list.indexOf(selectionRange.value[0]);\n      const next = (index + step + list.length) % list.length;\n      timePickerOptions[\"start_emitSelectRange\"](mapping[next]);\n    };\n    const handleKeydown = (event) => {\n      const code = event.code;\n      const { left, right, up, down } = EVENT_CODE;\n      if ([left, right].includes(code)) {\n        const step = code === left ? -1 : 1;\n        changeSelectionRange(step);\n        event.preventDefault();\n        return;\n      }\n      if ([up, down].includes(code)) {\n        const step = code === up ? -1 : 1;\n        timePickerOptions[\"start_scrollDown\"](step);\n        event.preventDefault();\n        return;\n      }\n    };\n    const { timePickerOptions, onSetOption, getAvailableTime } = useTimePanel({\n      getAvailableHours,\n      getAvailableMinutes,\n      getAvailableSeconds\n    });\n    const getRangeAvailableTime = (date) => {\n      return getAvailableTime(date, props.datetimeRole || \"\", true);\n    };\n    const parseUserInput = (value) => {\n      if (!value)\n        return null;\n      return dayjs(value, props.format).locale(lang.value);\n    };\n    const formatToString = (value) => {\n      if (!value)\n        return null;\n      return value.format(props.format);\n    };\n    const getDefaultValue = () => {\n      return dayjs(defaultValue).locale(lang.value);\n    };\n    emit(\"set-picker-option\", [\"isValidValue\", isValidValue]);\n    emit(\"set-picker-option\", [\"formatToString\", formatToString]);\n    emit(\"set-picker-option\", [\"parseUserInput\", parseUserInput]);\n    emit(\"set-picker-option\", [\"handleKeydownInput\", handleKeydown]);\n    emit(\"set-picker-option\", [\"getRangeAvailableTime\", getRangeAvailableTime]);\n    emit(\"set-picker-option\", [\"getDefaultValue\", getDefaultValue]);\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(Transition, { name: unref(transitionName) }, {\n        default: withCtx(() => [\n          _ctx.actualVisible || _ctx.visible ? (openBlock(), createElementBlock(\"div\", {\n            key: 0,\n            class: normalizeClass(unref(ns).b(\"panel\"))\n          }, [\n            createElementVNode(\"div\", {\n              class: normalizeClass([unref(ns).be(\"panel\", \"content\"), { \"has-seconds\": unref(showSeconds) }])\n            }, [\n              createVNode(TimeSpinner, {\n                ref: \"spinner\",\n                role: _ctx.datetimeRole || \"start\",\n                \"arrow-control\": unref(arrowControl),\n                \"show-seconds\": unref(showSeconds),\n                \"am-pm-mode\": unref(amPmMode),\n                \"spinner-date\": _ctx.parsedValue,\n                \"disabled-hours\": unref(disabledHours),\n                \"disabled-minutes\": unref(disabledMinutes),\n                \"disabled-seconds\": unref(disabledSeconds),\n                onChange: handleChange,\n                onSetOption: unref(onSetOption),\n                onSelectRange: setSelectionRange\n              }, null, 8, [\"role\", \"arrow-control\", \"show-seconds\", \"am-pm-mode\", \"spinner-date\", \"disabled-hours\", \"disabled-minutes\", \"disabled-seconds\", \"onSetOption\"])\n            ], 2),\n            createElementVNode(\"div\", {\n              class: normalizeClass(unref(ns).be(\"panel\", \"footer\"))\n            }, [\n              createElementVNode(\"button\", {\n                type: \"button\",\n                class: normalizeClass([unref(ns).be(\"panel\", \"btn\"), \"cancel\"]),\n                onClick: handleCancel\n              }, toDisplayString(unref(t)(\"el.datepicker.cancel\")), 3),\n              createElementVNode(\"button\", {\n                type: \"button\",\n                class: normalizeClass([unref(ns).be(\"panel\", \"btn\"), \"confirm\"]),\n                onClick: _cache[0] || (_cache[0] = ($event) => handleConfirm())\n              }, toDisplayString(unref(t)(\"el.datepicker.confirm\")), 3)\n            ], 2)\n          ], 2)) : createCommentVNode(\"v-if\", true)\n        ]),\n        _: 1\n      }, 8, [\"name\"]);\n    };\n  }\n});\nvar TimePickPanel = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/panel-time-pick.vue\"]]);\n\nexport { TimePickPanel as default };\n//# sourceMappingURL=panel-time-pick.mjs.map\n","!function(n,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):(n=\"undefined\"!=typeof globalThis?globalThis:n||self).dayjs_plugin_localeData=e()}(this,(function(){\"use strict\";return function(n,e,t){var r=e.prototype,o=function(n){return n&&(n.indexOf?n:n.s)},u=function(n,e,t,r,u){var i=n.name?n:n.$locale(),a=o(i[e]),s=o(i[t]),f=a||s.map((function(n){return n.slice(0,r)}));if(!u)return f;var d=i.weekStart;return f.map((function(n,e){return f[(e+(d||0))%7]}))},i=function(){return t.Ls[t.locale()]},a=function(n,e){return n.formats[e]||function(n){return n.replace(/(\\[[^\\]]+])|(MMMM|MM|DD|dddd)/g,(function(n,e,t){return e||t.slice(1)}))}(n.formats[e.toUpperCase()])},s=function(){var n=this;return{months:function(e){return e?e.format(\"MMMM\"):u(n,\"months\")},monthsShort:function(e){return e?e.format(\"MMM\"):u(n,\"monthsShort\",\"months\",3)},firstDayOfWeek:function(){return n.$locale().weekStart||0},weekdays:function(e){return e?e.format(\"dddd\"):u(n,\"weekdays\")},weekdaysMin:function(e){return e?e.format(\"dd\"):u(n,\"weekdaysMin\",\"weekdays\",2)},weekdaysShort:function(e){return e?e.format(\"ddd\"):u(n,\"weekdaysShort\",\"weekdays\",3)},longDateFormat:function(e){return a(n.$locale(),e)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};r.localeData=function(){return s.bind(this)()},t.localeData=function(){var n=i();return{firstDayOfWeek:function(){return n.weekStart||0},weekdays:function(){return t.weekdays()},weekdaysShort:function(){return t.weekdaysShort()},weekdaysMin:function(){return t.weekdaysMin()},months:function(){return t.months()},monthsShort:function(){return t.monthsShort()},longDateFormat:function(e){return a(n,e)},meridiem:n.meridiem,ordinal:n.ordinal}},t.months=function(){return u(i(),\"months\")},t.monthsShort=function(){return u(i(),\"monthsShort\",\"months\",3)},t.weekdays=function(n){return u(i(),\"weekdays\",null,null,n)},t.weekdaysShort=function(n){return u(i(),\"weekdaysShort\",\"weekdays\",3,n)},t.weekdaysMin=function(n){return u(i(),\"weekdaysMin\",\"weekdays\",2,n)}}}));","import '../../../../utils/index.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\n\nconst alphaSliderProps = buildProps({\n  color: {\n    type: definePropType(Object),\n    required: true\n  },\n  vertical: {\n    type: Boolean,\n    default: false\n  }\n});\n\nexport { alphaSliderProps };\n//# sourceMappingURL=alpha-slider.mjs.map\n","import '../../../../utils/index.mjs';\nimport { isClient } from '@vueuse/core';\n\nlet isDragging = false;\nfunction draggable(element, options) {\n  if (!isClient)\n    return;\n  const moveFn = function(event) {\n    var _a;\n    (_a = options.drag) == null ? void 0 : _a.call(options, event);\n  };\n  const upFn = function(event) {\n    var _a;\n    document.removeEventListener(\"mousemove\", moveFn);\n    document.removeEventListener(\"mouseup\", upFn);\n    document.removeEventListener(\"touchmove\", moveFn);\n    document.removeEventListener(\"touchend\", upFn);\n    document.onselectstart = null;\n    document.ondragstart = null;\n    isDragging = false;\n    (_a = options.end) == null ? void 0 : _a.call(options, event);\n  };\n  const downFn = function(event) {\n    var _a;\n    if (isDragging)\n      return;\n    event.preventDefault();\n    document.onselectstart = () => false;\n    document.ondragstart = () => false;\n    document.addEventListener(\"mousemove\", moveFn);\n    document.addEventListener(\"mouseup\", upFn);\n    document.addEventListener(\"touchmove\", moveFn);\n    document.addEventListener(\"touchend\", upFn);\n    isDragging = true;\n    (_a = options.start) == null ? void 0 : _a.call(options, event);\n  };\n  element.addEventListener(\"mousedown\", downFn);\n  element.addEventListener(\"touchstart\", downFn);\n}\n\nexport { draggable };\n//# sourceMappingURL=draggable.mjs.map\n","import { getCurrentInstance, shallowRef, ref, onMounted, watch, computed } from 'vue';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { draggable } from '../utils/draggable.mjs';\nimport { getClientXY } from '../../../../utils/dom/position.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { addUnit } from '../../../../utils/dom/style.mjs';\n\nconst useAlphaSlider = (props) => {\n  const instance = getCurrentInstance();\n  const thumb = shallowRef();\n  const bar = shallowRef();\n  function handleClick(event) {\n    const target = event.target;\n    if (target !== thumb.value) {\n      handleDrag(event);\n    }\n  }\n  function handleDrag(event) {\n    if (!bar.value || !thumb.value)\n      return;\n    const el = instance.vnode.el;\n    const rect = el.getBoundingClientRect();\n    const { clientX, clientY } = getClientXY(event);\n    if (!props.vertical) {\n      let left = clientX - rect.left;\n      left = Math.max(thumb.value.offsetWidth / 2, left);\n      left = Math.min(left, rect.width - thumb.value.offsetWidth / 2);\n      props.color.set(\"alpha\", Math.round((left - thumb.value.offsetWidth / 2) / (rect.width - thumb.value.offsetWidth) * 100));\n    } else {\n      let top = clientY - rect.top;\n      top = Math.max(thumb.value.offsetHeight / 2, top);\n      top = Math.min(top, rect.height - thumb.value.offsetHeight / 2);\n      props.color.set(\"alpha\", Math.round((top - thumb.value.offsetHeight / 2) / (rect.height - thumb.value.offsetHeight) * 100));\n    }\n  }\n  return {\n    thumb,\n    bar,\n    handleDrag,\n    handleClick\n  };\n};\nconst useAlphaSliderDOM = (props, {\n  bar,\n  thumb,\n  handleDrag\n}) => {\n  const instance = getCurrentInstance();\n  const ns = useNamespace(\"color-alpha-slider\");\n  const thumbLeft = ref(0);\n  const thumbTop = ref(0);\n  const background = ref();\n  function getThumbLeft() {\n    if (!thumb.value)\n      return 0;\n    if (props.vertical)\n      return 0;\n    const el = instance.vnode.el;\n    const alpha = props.color.get(\"alpha\");\n    if (!el)\n      return 0;\n    return Math.round(alpha * (el.offsetWidth - thumb.value.offsetWidth / 2) / 100);\n  }\n  function getThumbTop() {\n    if (!thumb.value)\n      return 0;\n    const el = instance.vnode.el;\n    if (!props.vertical)\n      return 0;\n    const alpha = props.color.get(\"alpha\");\n    if (!el)\n      return 0;\n    return Math.round(alpha * (el.offsetHeight - thumb.value.offsetHeight / 2) / 100);\n  }\n  function getBackground() {\n    if (props.color && props.color.value) {\n      const { r, g, b } = props.color.toRgb();\n      return `linear-gradient(to right, rgba(${r}, ${g}, ${b}, 0) 0%, rgba(${r}, ${g}, ${b}, 1) 100%)`;\n    }\n    return \"\";\n  }\n  function update() {\n    thumbLeft.value = getThumbLeft();\n    thumbTop.value = getThumbTop();\n    background.value = getBackground();\n  }\n  onMounted(() => {\n    if (!bar.value || !thumb.value)\n      return;\n    const dragConfig = {\n      drag: (event) => {\n        handleDrag(event);\n      },\n      end: (event) => {\n        handleDrag(event);\n      }\n    };\n    draggable(bar.value, dragConfig);\n    draggable(thumb.value, dragConfig);\n    update();\n  });\n  watch(() => props.color.get(\"alpha\"), () => update());\n  watch(() => props.color.value, () => update());\n  const rootKls = computed(() => [ns.b(), ns.is(\"vertical\", props.vertical)]);\n  const barKls = computed(() => ns.e(\"bar\"));\n  const thumbKls = computed(() => ns.e(\"thumb\"));\n  const barStyle = computed(() => ({ background: background.value }));\n  const thumbStyle = computed(() => ({\n    left: addUnit(thumbLeft.value),\n    top: addUnit(thumbTop.value)\n  }));\n  return { rootKls, barKls, barStyle, thumbKls, thumbStyle, update };\n};\n\nexport { useAlphaSlider, useAlphaSliderDOM };\n//# sourceMappingURL=use-alpha-slider.mjs.map\n","import { defineComponent, openBlock, createElementBlock, normalizeClass, unref, createElementVNode, normalizeStyle } from 'vue';\nimport { alphaSliderProps } from '../props/alpha-slider.mjs';\nimport { useAlphaSlider, useAlphaSliderDOM } from '../composables/use-alpha-slider.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\n\nconst COMPONENT_NAME = \"ElColorAlphaSlider\";\nconst __default__ = defineComponent({\n  name: COMPONENT_NAME\n});\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  ...__default__,\n  props: alphaSliderProps,\n  setup(__props, { expose }) {\n    const props = __props;\n    const { bar, thumb, handleDrag, handleClick } = useAlphaSlider(props);\n    const { rootKls, barKls, barStyle, thumbKls, thumbStyle, update } = useAlphaSliderDOM(props, {\n      bar,\n      thumb,\n      handleDrag\n    });\n    expose({\n      update,\n      bar,\n      thumb\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        class: normalizeClass(unref(rootKls))\n      }, [\n        createElementVNode(\"div\", {\n          ref_key: \"bar\",\n          ref: bar,\n          class: normalizeClass(unref(barKls)),\n          style: normalizeStyle(unref(barStyle)),\n          onClick: _cache[0] || (_cache[0] = (...args) => unref(handleClick) && unref(handleClick)(...args))\n        }, null, 6),\n        createElementVNode(\"div\", {\n          ref_key: \"thumb\",\n          ref: thumb,\n          class: normalizeClass(unref(thumbKls)),\n          style: normalizeStyle(unref(thumbStyle))\n        }, null, 6)\n      ], 2);\n    };\n  }\n});\nvar AlphaSlider = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue\"]]);\n\nexport { AlphaSlider as default };\n//# sourceMappingURL=alpha-slider.mjs.map\n","import { defineComponent, getCurrentInstance, ref, computed, watch, onMounted, openBlock, createElementBlock, normalizeClass, createElementVNode, normalizeStyle } from 'vue';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { draggable } from '../utils/draggable.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { getClientXY } from '../../../../utils/dom/position.mjs';\n\nconst _sfc_main = defineComponent({\n  name: \"ElColorHueSlider\",\n  props: {\n    color: {\n      type: Object,\n      required: true\n    },\n    vertical: Boolean\n  },\n  setup(props) {\n    const ns = useNamespace(\"color-hue-slider\");\n    const instance = getCurrentInstance();\n    const thumb = ref();\n    const bar = ref();\n    const thumbLeft = ref(0);\n    const thumbTop = ref(0);\n    const hueValue = computed(() => {\n      return props.color.get(\"hue\");\n    });\n    watch(() => hueValue.value, () => {\n      update();\n    });\n    function handleClick(event) {\n      const target = event.target;\n      if (target !== thumb.value) {\n        handleDrag(event);\n      }\n    }\n    function handleDrag(event) {\n      if (!bar.value || !thumb.value)\n        return;\n      const el = instance.vnode.el;\n      const rect = el.getBoundingClientRect();\n      const { clientX, clientY } = getClientXY(event);\n      let hue;\n      if (!props.vertical) {\n        let left = clientX - rect.left;\n        left = Math.min(left, rect.width - thumb.value.offsetWidth / 2);\n        left = Math.max(thumb.value.offsetWidth / 2, left);\n        hue = Math.round((left - thumb.value.offsetWidth / 2) / (rect.width - thumb.value.offsetWidth) * 360);\n      } else {\n        let top = clientY - rect.top;\n        top = Math.min(top, rect.height - thumb.value.offsetHeight / 2);\n        top = Math.max(thumb.value.offsetHeight / 2, top);\n        hue = Math.round((top - thumb.value.offsetHeight / 2) / (rect.height - thumb.value.offsetHeight) * 360);\n      }\n      props.color.set(\"hue\", hue);\n    }\n    function getThumbLeft() {\n      if (!thumb.value)\n        return 0;\n      const el = instance.vnode.el;\n      if (props.vertical)\n        return 0;\n      const hue = props.color.get(\"hue\");\n      if (!el)\n        return 0;\n      return Math.round(hue * (el.offsetWidth - thumb.value.offsetWidth / 2) / 360);\n    }\n    function getThumbTop() {\n      if (!thumb.value)\n        return 0;\n      const el = instance.vnode.el;\n      if (!props.vertical)\n        return 0;\n      const hue = props.color.get(\"hue\");\n      if (!el)\n        return 0;\n      return Math.round(hue * (el.offsetHeight - thumb.value.offsetHeight / 2) / 360);\n    }\n    function update() {\n      thumbLeft.value = getThumbLeft();\n      thumbTop.value = getThumbTop();\n    }\n    onMounted(() => {\n      if (!bar.value || !thumb.value)\n        return;\n      const dragConfig = {\n        drag: (event) => {\n          handleDrag(event);\n        },\n        end: (event) => {\n          handleDrag(event);\n        }\n      };\n      draggable(bar.value, dragConfig);\n      draggable(thumb.value, dragConfig);\n      update();\n    });\n    return {\n      bar,\n      thumb,\n      thumbLeft,\n      thumbTop,\n      hueValue,\n      handleClick,\n      update,\n      ns\n    };\n  }\n});\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", {\n    class: normalizeClass([_ctx.ns.b(), _ctx.ns.is(\"vertical\", _ctx.vertical)])\n  }, [\n    createElementVNode(\"div\", {\n      ref: \"bar\",\n      class: normalizeClass(_ctx.ns.e(\"bar\")),\n      onClick: _cache[0] || (_cache[0] = (...args) => _ctx.handleClick && _ctx.handleClick(...args))\n    }, null, 2),\n    createElementVNode(\"div\", {\n      ref: \"thumb\",\n      class: normalizeClass(_ctx.ns.e(\"thumb\")),\n      style: normalizeStyle({\n        left: _ctx.thumbLeft + \"px\",\n        top: _ctx.thumbTop + \"px\"\n      })\n    }, null, 6)\n  ], 2);\n}\nvar HueSlider = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"render\", _sfc_render], [\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue\"]]);\n\nexport { HueSlider as default };\n//# sourceMappingURL=hue-slider.mjs.map\n","import { isNil } from 'lodash-unified';\nimport '../../../utils/index.mjs';\nimport '../../../hooks/index.mjs';\nimport '../../../constants/index.mjs';\nimport { buildProps, definePropType } from '../../../utils/vue/props/runtime.mjs';\nimport { useSizeProp } from '../../../hooks/use-size/index.mjs';\nimport { UPDATE_MODEL_EVENT, CHANGE_EVENT } from '../../../constants/event.mjs';\nimport { isString } from '@vue/shared';\n\nconst colorPickerProps = buildProps({\n  modelValue: String,\n  id: String,\n  showAlpha: Boolean,\n  colorFormat: String,\n  disabled: Boolean,\n  size: useSizeProp,\n  popperClass: {\n    type: String,\n    default: \"\"\n  },\n  label: {\n    type: String,\n    default: void 0\n  },\n  tabindex: {\n    type: [String, Number],\n    default: 0\n  },\n  predefine: {\n    type: definePropType(Array)\n  },\n  validateEvent: {\n    type: Boolean,\n    default: true\n  }\n});\nconst colorPickerEmits = {\n  [UPDATE_MODEL_EVENT]: (val) => isString(val) || isNil(val),\n  [CHANGE_EVENT]: (val) => isString(val) || isNil(val),\n  activeChange: (val) => isString(val) || isNil(val)\n};\nconst colorPickerContextKey = Symbol(\"colorPickerContextKey\");\n\nexport { colorPickerContextKey, colorPickerEmits, colorPickerProps };\n//# sourceMappingURL=color-picker.mjs.map\n","import '../../../../utils/index.mjs';\nimport { hasOwn } from '@vue/shared';\n\nconst hsv2hsl = function(hue, sat, val) {\n  return [\n    hue,\n    sat * val / ((hue = (2 - sat) * val) < 1 ? hue : 2 - hue) || 0,\n    hue / 2\n  ];\n};\nconst isOnePointZero = function(n) {\n  return typeof n === \"string\" && n.includes(\".\") && Number.parseFloat(n) === 1;\n};\nconst isPercentage = function(n) {\n  return typeof n === \"string\" && n.includes(\"%\");\n};\nconst bound01 = function(value, max) {\n  if (isOnePointZero(value))\n    value = \"100%\";\n  const processPercent = isPercentage(value);\n  value = Math.min(max, Math.max(0, Number.parseFloat(`${value}`)));\n  if (processPercent) {\n    value = Number.parseInt(`${value * max}`, 10) / 100;\n  }\n  if (Math.abs(value - max) < 1e-6) {\n    return 1;\n  }\n  return value % max / Number.parseFloat(max);\n};\nconst INT_HEX_MAP = {\n  10: \"A\",\n  11: \"B\",\n  12: \"C\",\n  13: \"D\",\n  14: \"E\",\n  15: \"F\"\n};\nconst hexOne = (value) => {\n  value = Math.min(Math.round(value), 255);\n  const high = Math.floor(value / 16);\n  const low = value % 16;\n  return `${INT_HEX_MAP[high] || high}${INT_HEX_MAP[low] || low}`;\n};\nconst toHex = function({ r, g, b }) {\n  if (Number.isNaN(+r) || Number.isNaN(+g) || Number.isNaN(+b))\n    return \"\";\n  return `#${hexOne(r)}${hexOne(g)}${hexOne(b)}`;\n};\nconst HEX_INT_MAP = {\n  A: 10,\n  B: 11,\n  C: 12,\n  D: 13,\n  E: 14,\n  F: 15\n};\nconst parseHexChannel = function(hex) {\n  if (hex.length === 2) {\n    return (HEX_INT_MAP[hex[0].toUpperCase()] || +hex[0]) * 16 + (HEX_INT_MAP[hex[1].toUpperCase()] || +hex[1]);\n  }\n  return HEX_INT_MAP[hex[1].toUpperCase()] || +hex[1];\n};\nconst hsl2hsv = function(hue, sat, light) {\n  sat = sat / 100;\n  light = light / 100;\n  let smin = sat;\n  const lmin = Math.max(light, 0.01);\n  light *= 2;\n  sat *= light <= 1 ? light : 2 - light;\n  smin *= lmin <= 1 ? lmin : 2 - lmin;\n  const v = (light + sat) / 2;\n  const sv = light === 0 ? 2 * smin / (lmin + smin) : 2 * sat / (light + sat);\n  return {\n    h: hue,\n    s: sv * 100,\n    v: v * 100\n  };\n};\nconst rgb2hsv = (r, g, b) => {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  const max = Math.max(r, g, b);\n  const min = Math.min(r, g, b);\n  let h;\n  const v = max;\n  const d = max - min;\n  const s = max === 0 ? 0 : d / max;\n  if (max === min) {\n    h = 0;\n  } else {\n    switch (max) {\n      case r: {\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      }\n      case g: {\n        h = (b - r) / d + 2;\n        break;\n      }\n      case b: {\n        h = (r - g) / d + 4;\n        break;\n      }\n    }\n    h /= 6;\n  }\n  return { h: h * 360, s: s * 100, v: v * 100 };\n};\nconst hsv2rgb = function(h, s, v) {\n  h = bound01(h, 360) * 6;\n  s = bound01(s, 100);\n  v = bound01(v, 100);\n  const i = Math.floor(h);\n  const f = h - i;\n  const p = v * (1 - s);\n  const q = v * (1 - f * s);\n  const t = v * (1 - (1 - f) * s);\n  const mod = i % 6;\n  const r = [v, q, p, p, t, v][mod];\n  const g = [t, v, v, q, p, p][mod];\n  const b = [p, p, t, v, v, q][mod];\n  return {\n    r: Math.round(r * 255),\n    g: Math.round(g * 255),\n    b: Math.round(b * 255)\n  };\n};\nclass Color {\n  constructor(options = {}) {\n    this._hue = 0;\n    this._saturation = 100;\n    this._value = 100;\n    this._alpha = 100;\n    this.enableAlpha = false;\n    this.format = \"hex\";\n    this.value = \"\";\n    for (const option in options) {\n      if (hasOwn(options, option)) {\n        this[option] = options[option];\n      }\n    }\n    if (options.value) {\n      this.fromString(options.value);\n    } else {\n      this.doOnChange();\n    }\n  }\n  set(prop, value) {\n    if (arguments.length === 1 && typeof prop === \"object\") {\n      for (const p in prop) {\n        if (hasOwn(prop, p)) {\n          this.set(p, prop[p]);\n        }\n      }\n      return;\n    }\n    ;\n    this[`_${prop}`] = value;\n    this.doOnChange();\n  }\n  get(prop) {\n    if (prop === \"alpha\") {\n      return Math.floor(this[`_${prop}`]);\n    }\n    return this[`_${prop}`];\n  }\n  toRgb() {\n    return hsv2rgb(this._hue, this._saturation, this._value);\n  }\n  fromString(value) {\n    if (!value) {\n      this._hue = 0;\n      this._saturation = 100;\n      this._value = 100;\n      this.doOnChange();\n      return;\n    }\n    const fromHSV = (h, s, v) => {\n      this._hue = Math.max(0, Math.min(360, h));\n      this._saturation = Math.max(0, Math.min(100, s));\n      this._value = Math.max(0, Math.min(100, v));\n      this.doOnChange();\n    };\n    if (value.includes(\"hsl\")) {\n      const parts = value.replace(/hsla|hsl|\\(|\\)/gm, \"\").split(/\\s|,/g).filter((val) => val !== \"\").map((val, index) => index > 2 ? Number.parseFloat(val) : Number.parseInt(val, 10));\n      if (parts.length === 4) {\n        this._alpha = Number.parseFloat(parts[3]) * 100;\n      } else if (parts.length === 3) {\n        this._alpha = 100;\n      }\n      if (parts.length >= 3) {\n        const { h, s, v } = hsl2hsv(parts[0], parts[1], parts[2]);\n        fromHSV(h, s, v);\n      }\n    } else if (value.includes(\"hsv\")) {\n      const parts = value.replace(/hsva|hsv|\\(|\\)/gm, \"\").split(/\\s|,/g).filter((val) => val !== \"\").map((val, index) => index > 2 ? Number.parseFloat(val) : Number.parseInt(val, 10));\n      if (parts.length === 4) {\n        this._alpha = Number.parseFloat(parts[3]) * 100;\n      } else if (parts.length === 3) {\n        this._alpha = 100;\n      }\n      if (parts.length >= 3) {\n        fromHSV(parts[0], parts[1], parts[2]);\n      }\n    } else if (value.includes(\"rgb\")) {\n      const parts = value.replace(/rgba|rgb|\\(|\\)/gm, \"\").split(/\\s|,/g).filter((val) => val !== \"\").map((val, index) => index > 2 ? Number.parseFloat(val) : Number.parseInt(val, 10));\n      if (parts.length === 4) {\n        this._alpha = Number.parseFloat(parts[3]) * 100;\n      } else if (parts.length === 3) {\n        this._alpha = 100;\n      }\n      if (parts.length >= 3) {\n        const { h, s, v } = rgb2hsv(parts[0], parts[1], parts[2]);\n        fromHSV(h, s, v);\n      }\n    } else if (value.includes(\"#\")) {\n      const hex = value.replace(\"#\", \"\").trim();\n      if (!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(hex))\n        return;\n      let r, g, b;\n      if (hex.length === 3) {\n        r = parseHexChannel(hex[0] + hex[0]);\n        g = parseHexChannel(hex[1] + hex[1]);\n        b = parseHexChannel(hex[2] + hex[2]);\n      } else if (hex.length === 6 || hex.length === 8) {\n        r = parseHexChannel(hex.slice(0, 2));\n        g = parseHexChannel(hex.slice(2, 4));\n        b = parseHexChannel(hex.slice(4, 6));\n      }\n      if (hex.length === 8) {\n        this._alpha = parseHexChannel(hex.slice(6)) / 255 * 100;\n      } else if (hex.length === 3 || hex.length === 6) {\n        this._alpha = 100;\n      }\n      const { h, s, v } = rgb2hsv(r, g, b);\n      fromHSV(h, s, v);\n    }\n  }\n  compare(color) {\n    return Math.abs(color._hue - this._hue) < 2 && Math.abs(color._saturation - this._saturation) < 1 && Math.abs(color._value - this._value) < 1 && Math.abs(color._alpha - this._alpha) < 1;\n  }\n  doOnChange() {\n    const { _hue, _saturation, _value, _alpha, format } = this;\n    if (this.enableAlpha) {\n      switch (format) {\n        case \"hsl\": {\n          const hsl = hsv2hsl(_hue, _saturation / 100, _value / 100);\n          this.value = `hsla(${_hue}, ${Math.round(hsl[1] * 100)}%, ${Math.round(hsl[2] * 100)}%, ${this.get(\"alpha\") / 100})`;\n          break;\n        }\n        case \"hsv\": {\n          this.value = `hsva(${_hue}, ${Math.round(_saturation)}%, ${Math.round(_value)}%, ${this.get(\"alpha\") / 100})`;\n          break;\n        }\n        case \"hex\": {\n          this.value = `${toHex(hsv2rgb(_hue, _saturation, _value))}${hexOne(_alpha * 255 / 100)}`;\n          break;\n        }\n        default: {\n          const { r, g, b } = hsv2rgb(_hue, _saturation, _value);\n          this.value = `rgba(${r}, ${g}, ${b}, ${this.get(\"alpha\") / 100})`;\n        }\n      }\n    } else {\n      switch (format) {\n        case \"hsl\": {\n          const hsl = hsv2hsl(_hue, _saturation / 100, _value / 100);\n          this.value = `hsl(${_hue}, ${Math.round(hsl[1] * 100)}%, ${Math.round(hsl[2] * 100)}%)`;\n          break;\n        }\n        case \"hsv\": {\n          this.value = `hsv(${_hue}, ${Math.round(_saturation)}%, ${Math.round(_value)}%)`;\n          break;\n        }\n        case \"rgb\": {\n          const { r, g, b } = hsv2rgb(_hue, _saturation, _value);\n          this.value = `rgb(${r}, ${g}, ${b})`;\n          break;\n        }\n        default: {\n          this.value = toHex(hsv2rgb(_hue, _saturation, _value));\n        }\n      }\n    }\n  }\n}\n\nexport { Color as default };\n//# sourceMappingURL=color.mjs.map\n","import { defineComponent, inject, ref, watch, watchEffect, openBlock, createElementBlock, normalizeClass, createElementVNode, Fragment, renderList, normalizeStyle } from 'vue';\nimport '../../../../hooks/index.mjs';\nimport { colorPickerContextKey } from '../color-picker.mjs';\nimport Color from '../utils/color.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\n\nconst _sfc_main = defineComponent({\n  props: {\n    colors: {\n      type: Array,\n      required: true\n    },\n    color: {\n      type: Object,\n      required: true\n    }\n  },\n  setup(props) {\n    const ns = useNamespace(\"color-predefine\");\n    const { currentColor } = inject(colorPickerContextKey);\n    const rgbaColors = ref(parseColors(props.colors, props.color));\n    watch(() => currentColor.value, (val) => {\n      const color = new Color();\n      color.fromString(val);\n      rgbaColors.value.forEach((item) => {\n        item.selected = color.compare(item);\n      });\n    });\n    watchEffect(() => {\n      rgbaColors.value = parseColors(props.colors, props.color);\n    });\n    function handleSelect(index) {\n      props.color.fromString(props.colors[index]);\n    }\n    function parseColors(colors, color) {\n      return colors.map((value) => {\n        const c = new Color();\n        c.enableAlpha = true;\n        c.format = \"rgba\";\n        c.fromString(value);\n        c.selected = c.value === color.value;\n        return c;\n      });\n    }\n    return {\n      rgbaColors,\n      handleSelect,\n      ns\n    };\n  }\n});\nconst _hoisted_1 = [\"onClick\"];\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", {\n    class: normalizeClass(_ctx.ns.b())\n  }, [\n    createElementVNode(\"div\", {\n      class: normalizeClass(_ctx.ns.e(\"colors\"))\n    }, [\n      (openBlock(true), createElementBlock(Fragment, null, renderList(_ctx.rgbaColors, (item, index) => {\n        return openBlock(), createElementBlock(\"div\", {\n          key: _ctx.colors[index],\n          class: normalizeClass([\n            _ctx.ns.e(\"color-selector\"),\n            _ctx.ns.is(\"alpha\", item._alpha < 100),\n            { selected: item.selected }\n          ]),\n          onClick: ($event) => _ctx.handleSelect(index)\n        }, [\n          createElementVNode(\"div\", {\n            style: normalizeStyle({ backgroundColor: item.value })\n          }, null, 4)\n        ], 10, _hoisted_1);\n      }), 128))\n    ], 2)\n  ], 2);\n}\nvar Predefine = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"render\", _sfc_render], [\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue\"]]);\n\nexport { Predefine as default };\n//# sourceMappingURL=predefine.mjs.map\n","import { defineComponent, getCurrentInstance, ref, computed, watch, onMounted, createElementVNode, openBlock, createElementBlock, normalizeClass, normalizeStyle } from 'vue';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { draggable } from '../utils/draggable.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { getClientXY } from '../../../../utils/dom/position.mjs';\n\nconst _sfc_main = defineComponent({\n  name: \"ElSlPanel\",\n  props: {\n    color: {\n      type: Object,\n      required: true\n    }\n  },\n  setup(props) {\n    const ns = useNamespace(\"color-svpanel\");\n    const instance = getCurrentInstance();\n    const cursorTop = ref(0);\n    const cursorLeft = ref(0);\n    const background = ref(\"hsl(0, 100%, 50%)\");\n    const colorValue = computed(() => {\n      const hue = props.color.get(\"hue\");\n      const value = props.color.get(\"value\");\n      return { hue, value };\n    });\n    function update() {\n      const saturation = props.color.get(\"saturation\");\n      const value = props.color.get(\"value\");\n      const el = instance.vnode.el;\n      const { clientWidth: width, clientHeight: height } = el;\n      cursorLeft.value = saturation * width / 100;\n      cursorTop.value = (100 - value) * height / 100;\n      background.value = `hsl(${props.color.get(\"hue\")}, 100%, 50%)`;\n    }\n    function handleDrag(event) {\n      const el = instance.vnode.el;\n      const rect = el.getBoundingClientRect();\n      const { clientX, clientY } = getClientXY(event);\n      let left = clientX - rect.left;\n      let top = clientY - rect.top;\n      left = Math.max(0, left);\n      left = Math.min(left, rect.width);\n      top = Math.max(0, top);\n      top = Math.min(top, rect.height);\n      cursorLeft.value = left;\n      cursorTop.value = top;\n      props.color.set({\n        saturation: left / rect.width * 100,\n        value: 100 - top / rect.height * 100\n      });\n    }\n    watch(() => colorValue.value, () => {\n      update();\n    });\n    onMounted(() => {\n      draggable(instance.vnode.el, {\n        drag: (event) => {\n          handleDrag(event);\n        },\n        end: (event) => {\n          handleDrag(event);\n        }\n      });\n      update();\n    });\n    return {\n      cursorTop,\n      cursorLeft,\n      background,\n      colorValue,\n      handleDrag,\n      update,\n      ns\n    };\n  }\n});\nconst _hoisted_1 = /* @__PURE__ */ createElementVNode(\"div\", null, null, -1);\nconst _hoisted_2 = [\n  _hoisted_1\n];\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  return openBlock(), createElementBlock(\"div\", {\n    class: normalizeClass(_ctx.ns.b()),\n    style: normalizeStyle({\n      backgroundColor: _ctx.background\n    })\n  }, [\n    createElementVNode(\"div\", {\n      class: normalizeClass(_ctx.ns.e(\"white\"))\n    }, null, 2),\n    createElementVNode(\"div\", {\n      class: normalizeClass(_ctx.ns.e(\"black\"))\n    }, null, 2),\n    createElementVNode(\"div\", {\n      class: normalizeClass(_ctx.ns.e(\"cursor\")),\n      style: normalizeStyle({\n        top: _ctx.cursorTop + \"px\",\n        left: _ctx.cursorLeft + \"px\"\n      })\n    }, _hoisted_2, 6)\n  ], 6);\n}\nvar SvPanel = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"render\", _sfc_render], [\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue\"]]);\n\nexport { SvPanel as default };\n//# sourceMappingURL=sv-panel.mjs.map\n","import { defineComponent, ref, reactive, computed, nextTick, onMounted, watch, provide, openBlock, createBlock, unref, withCtx, withDirectives, createElementBlock, createElementVNode, normalizeClass, createVNode, createCommentVNode, withKeys, createTextVNode, toDisplayString, normalizeStyle, vShow } from 'vue';\nimport { debounce } from 'lodash-unified';\nimport { ElButton } from '../../button/index.mjs';\nimport { ElIcon } from '../../icon/index.mjs';\nimport '../../../directives/index.mjs';\nimport { ElTooltip } from '../../tooltip/index.mjs';\nimport { ElInput } from '../../input/index.mjs';\nimport '../../form/index.mjs';\nimport '../../../hooks/index.mjs';\nimport '../../../constants/index.mjs';\nimport '../../../utils/index.mjs';\nimport { ArrowDown, Close } from '@element-plus/icons-vue';\nimport AlphaSlider from './components/alpha-slider.mjs';\nimport HueSlider from './components/hue-slider.mjs';\nimport Predefine from './components/predefine.mjs';\nimport SvPanel from './components/sv-panel.mjs';\nimport Color from './utils/color.mjs';\nimport { colorPickerProps, colorPickerEmits, colorPickerContextKey } from './color-picker.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useLocale } from '../../../hooks/use-locale/index.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useFormItem, useFormItemInputId } from '../../form/src/hooks/use-form-item.mjs';\nimport { useFormSize, useFormDisabled } from '../../form/src/hooks/use-form-common-props.mjs';\nimport { UPDATE_MODEL_EVENT } from '../../../constants/event.mjs';\nimport { debugWarn } from '../../../utils/error.mjs';\nimport ClickOutside from '../../../directives/click-outside/index.mjs';\n\nconst _hoisted_1 = [\"id\", \"aria-label\", \"aria-labelledby\", \"aria-description\", \"tabindex\", \"onKeydown\"];\nconst __default__ = defineComponent({\n  name: \"ElColorPicker\"\n});\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  ...__default__,\n  props: colorPickerProps,\n  emits: colorPickerEmits,\n  setup(__props, { expose, emit }) {\n    const props = __props;\n    const { t } = useLocale();\n    const ns = useNamespace(\"color\");\n    const { formItem } = useFormItem();\n    const colorSize = useFormSize();\n    const colorDisabled = useFormDisabled();\n    const { inputId: buttonId, isLabeledByFormItem } = useFormItemInputId(props, {\n      formItemContext: formItem\n    });\n    const hue = ref();\n    const sv = ref();\n    const alpha = ref();\n    const popper = ref();\n    let shouldActiveChange = true;\n    const color = reactive(new Color({\n      enableAlpha: props.showAlpha,\n      format: props.colorFormat || \"\",\n      value: props.modelValue\n    }));\n    const showPicker = ref(false);\n    const showPanelColor = ref(false);\n    const customInput = ref(\"\");\n    const displayedColor = computed(() => {\n      if (!props.modelValue && !showPanelColor.value) {\n        return \"transparent\";\n      }\n      return displayedRgb(color, props.showAlpha);\n    });\n    const currentColor = computed(() => {\n      return !props.modelValue && !showPanelColor.value ? \"\" : color.value;\n    });\n    const buttonAriaLabel = computed(() => {\n      return !isLabeledByFormItem.value ? props.label || t(\"el.colorpicker.defaultLabel\") : void 0;\n    });\n    const buttonAriaLabelledby = computed(() => {\n      return isLabeledByFormItem.value ? formItem == null ? void 0 : formItem.labelId : void 0;\n    });\n    const btnKls = computed(() => {\n      return [\n        ns.b(\"picker\"),\n        ns.is(\"disabled\", colorDisabled.value),\n        ns.bm(\"picker\", colorSize.value)\n      ];\n    });\n    function displayedRgb(color2, showAlpha) {\n      if (!(color2 instanceof Color)) {\n        throw new TypeError(\"color should be instance of _color Class\");\n      }\n      const { r, g, b } = color2.toRgb();\n      return showAlpha ? `rgba(${r}, ${g}, ${b}, ${color2.get(\"alpha\") / 100})` : `rgb(${r}, ${g}, ${b})`;\n    }\n    function setShowPicker(value) {\n      showPicker.value = value;\n    }\n    const debounceSetShowPicker = debounce(setShowPicker, 100);\n    function show() {\n      if (colorDisabled.value)\n        return;\n      setShowPicker(true);\n    }\n    function hide() {\n      debounceSetShowPicker(false);\n      resetColor();\n    }\n    function resetColor() {\n      nextTick(() => {\n        if (props.modelValue) {\n          color.fromString(props.modelValue);\n        } else {\n          color.value = \"\";\n          nextTick(() => {\n            showPanelColor.value = false;\n          });\n        }\n      });\n    }\n    function handleTrigger() {\n      if (colorDisabled.value)\n        return;\n      debounceSetShowPicker(!showPicker.value);\n    }\n    function handleConfirm() {\n      color.fromString(customInput.value);\n    }\n    function confirmValue() {\n      const value = color.value;\n      emit(UPDATE_MODEL_EVENT, value);\n      emit(\"change\", value);\n      if (props.validateEvent) {\n        formItem == null ? void 0 : formItem.validate(\"change\").catch((err) => debugWarn(err));\n      }\n      debounceSetShowPicker(false);\n      nextTick(() => {\n        const newColor = new Color({\n          enableAlpha: props.showAlpha,\n          format: props.colorFormat || \"\",\n          value: props.modelValue\n        });\n        if (!color.compare(newColor)) {\n          resetColor();\n        }\n      });\n    }\n    function clear() {\n      debounceSetShowPicker(false);\n      emit(UPDATE_MODEL_EVENT, null);\n      emit(\"change\", null);\n      if (props.modelValue !== null && props.validateEvent) {\n        formItem == null ? void 0 : formItem.validate(\"change\").catch((err) => debugWarn(err));\n      }\n      resetColor();\n    }\n    onMounted(() => {\n      if (props.modelValue) {\n        customInput.value = currentColor.value;\n      }\n    });\n    watch(() => props.modelValue, (newVal) => {\n      if (!newVal) {\n        showPanelColor.value = false;\n      } else if (newVal && newVal !== color.value) {\n        shouldActiveChange = false;\n        color.fromString(newVal);\n      }\n    });\n    watch(() => currentColor.value, (val) => {\n      customInput.value = val;\n      shouldActiveChange && emit(\"activeChange\", val);\n      shouldActiveChange = true;\n    });\n    watch(() => color.value, () => {\n      if (!props.modelValue && !showPanelColor.value) {\n        showPanelColor.value = true;\n      }\n    });\n    watch(() => showPicker.value, () => {\n      nextTick(() => {\n        var _a, _b, _c;\n        (_a = hue.value) == null ? void 0 : _a.update();\n        (_b = sv.value) == null ? void 0 : _b.update();\n        (_c = alpha.value) == null ? void 0 : _c.update();\n      });\n    });\n    provide(colorPickerContextKey, {\n      currentColor\n    });\n    expose({\n      color,\n      show,\n      hide\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(unref(ElTooltip), {\n        ref_key: \"popper\",\n        ref: popper,\n        visible: showPicker.value,\n        \"show-arrow\": false,\n        \"fallback-placements\": [\"bottom\", \"top\", \"right\", \"left\"],\n        offset: 0,\n        \"gpu-acceleration\": false,\n        \"popper-class\": [unref(ns).be(\"picker\", \"panel\"), unref(ns).b(\"dropdown\"), _ctx.popperClass],\n        \"stop-popper-mouse-event\": false,\n        effect: \"light\",\n        trigger: \"click\",\n        transition: `${unref(ns).namespace.value}-zoom-in-top`,\n        persistent: \"\"\n      }, {\n        content: withCtx(() => [\n          withDirectives((openBlock(), createElementBlock(\"div\", null, [\n            createElementVNode(\"div\", {\n              class: normalizeClass(unref(ns).be(\"dropdown\", \"main-wrapper\"))\n            }, [\n              createVNode(HueSlider, {\n                ref_key: \"hue\",\n                ref: hue,\n                class: \"hue-slider\",\n                color: unref(color),\n                vertical: \"\"\n              }, null, 8, [\"color\"]),\n              createVNode(SvPanel, {\n                ref_key: \"sv\",\n                ref: sv,\n                color: unref(color)\n              }, null, 8, [\"color\"])\n            ], 2),\n            _ctx.showAlpha ? (openBlock(), createBlock(AlphaSlider, {\n              key: 0,\n              ref_key: \"alpha\",\n              ref: alpha,\n              color: unref(color)\n            }, null, 8, [\"color\"])) : createCommentVNode(\"v-if\", true),\n            _ctx.predefine ? (openBlock(), createBlock(Predefine, {\n              key: 1,\n              ref: \"predefine\",\n              color: unref(color),\n              colors: _ctx.predefine\n            }, null, 8, [\"color\", \"colors\"])) : createCommentVNode(\"v-if\", true),\n            createElementVNode(\"div\", {\n              class: normalizeClass(unref(ns).be(\"dropdown\", \"btns\"))\n            }, [\n              createElementVNode(\"span\", {\n                class: normalizeClass(unref(ns).be(\"dropdown\", \"value\"))\n              }, [\n                createVNode(unref(ElInput), {\n                  modelValue: customInput.value,\n                  \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event) => customInput.value = $event),\n                  \"validate-event\": false,\n                  size: \"small\",\n                  onKeyup: withKeys(handleConfirm, [\"enter\"]),\n                  onBlur: handleConfirm\n                }, null, 8, [\"modelValue\", \"onKeyup\"])\n              ], 2),\n              createVNode(unref(ElButton), {\n                class: normalizeClass(unref(ns).be(\"dropdown\", \"link-btn\")),\n                text: \"\",\n                size: \"small\",\n                onClick: clear\n              }, {\n                default: withCtx(() => [\n                  createTextVNode(toDisplayString(unref(t)(\"el.colorpicker.clear\")), 1)\n                ]),\n                _: 1\n              }, 8, [\"class\"]),\n              createVNode(unref(ElButton), {\n                plain: \"\",\n                size: \"small\",\n                class: normalizeClass(unref(ns).be(\"dropdown\", \"btn\")),\n                onClick: confirmValue\n              }, {\n                default: withCtx(() => [\n                  createTextVNode(toDisplayString(unref(t)(\"el.colorpicker.confirm\")), 1)\n                ]),\n                _: 1\n              }, 8, [\"class\"])\n            ], 2)\n          ])), [\n            [unref(ClickOutside), hide]\n          ])\n        ]),\n        default: withCtx(() => [\n          createElementVNode(\"div\", {\n            id: unref(buttonId),\n            class: normalizeClass(unref(btnKls)),\n            role: \"button\",\n            \"aria-label\": unref(buttonAriaLabel),\n            \"aria-labelledby\": unref(buttonAriaLabelledby),\n            \"aria-description\": unref(t)(\"el.colorpicker.description\", { color: _ctx.modelValue || \"\" }),\n            tabindex: _ctx.tabindex,\n            onKeydown: withKeys(handleTrigger, [\"enter\"])\n          }, [\n            unref(colorDisabled) ? (openBlock(), createElementBlock(\"div\", {\n              key: 0,\n              class: normalizeClass(unref(ns).be(\"picker\", \"mask\"))\n            }, null, 2)) : createCommentVNode(\"v-if\", true),\n            createElementVNode(\"div\", {\n              class: normalizeClass(unref(ns).be(\"picker\", \"trigger\")),\n              onClick: handleTrigger\n            }, [\n              createElementVNode(\"span\", {\n                class: normalizeClass([unref(ns).be(\"picker\", \"color\"), unref(ns).is(\"alpha\", _ctx.showAlpha)])\n              }, [\n                createElementVNode(\"span\", {\n                  class: normalizeClass(unref(ns).be(\"picker\", \"color-inner\")),\n                  style: normalizeStyle({\n                    backgroundColor: unref(displayedColor)\n                  })\n                }, [\n                  withDirectives(createVNode(unref(ElIcon), {\n                    class: normalizeClass([unref(ns).be(\"picker\", \"icon\"), unref(ns).is(\"icon-arrow-down\")])\n                  }, {\n                    default: withCtx(() => [\n                      createVNode(unref(ArrowDown))\n                    ]),\n                    _: 1\n                  }, 8, [\"class\"]), [\n                    [vShow, _ctx.modelValue || showPanelColor.value]\n                  ]),\n                  withDirectives(createVNode(unref(ElIcon), {\n                    class: normalizeClass([unref(ns).be(\"picker\", \"empty\"), unref(ns).is(\"icon-close\")])\n                  }, {\n                    default: withCtx(() => [\n                      createVNode(unref(Close))\n                    ]),\n                    _: 1\n                  }, 8, [\"class\"]), [\n                    [vShow, !_ctx.modelValue && !showPanelColor.value]\n                  ])\n                ], 6)\n              ], 2)\n            ], 2)\n          ], 42, _hoisted_1)\n        ]),\n        _: 1\n      }, 8, [\"visible\", \"popper-class\", \"transition\"]);\n    };\n  }\n});\nvar ColorPicker = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue\"]]);\n\nexport { ColorPicker as default };\n//# sourceMappingURL=color-picker2.mjs.map\n","import '../../utils/index.mjs';\nimport ColorPicker from './src/color-picker2.mjs';\nexport { colorPickerContextKey, colorPickerEmits, colorPickerProps } from './src/color-picker.mjs';\nimport { withInstall } from '../../utils/vue/install.mjs';\n\nconst ElColorPicker = withInstall(ColorPicker);\n\nexport { ElColorPicker, ElColorPicker as default };\n//# sourceMappingURL=index.mjs.map\n","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_advancedFormat=t()}(this,(function(){\"use strict\";return function(e,t){var r=t.prototype,n=r.format;r.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return n.bind(this)(e);var s=this.$utils(),a=(e||\"YYYY-MM-DDTHH:mm:ssZ\").replace(/\\[([^\\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,(function(e){switch(e){case\"Q\":return Math.ceil((t.$M+1)/3);case\"Do\":return r.ordinal(t.$D);case\"gggg\":return t.weekYear();case\"GGGG\":return t.isoWeekYear();case\"wo\":return r.ordinal(t.week(),\"W\");case\"w\":case\"ww\":return s.s(t.week(),\"w\"===e?1:2,\"0\");case\"W\":case\"WW\":return s.s(t.isoWeek(),\"W\"===e?1:2,\"0\");case\"k\":case\"kk\":return s.s(String(0===t.$H?24:t.$H),\"k\"===e?1:2,\"0\");case\"X\":return Math.floor(t.$d.getTime()/1e3);case\"x\":return t.$d.getTime();case\"z\":return\"[\"+t.offsetName()+\"]\";case\"zzz\":return\"[\"+t.offsetName(\"long\")+\"]\";default:return e}}));return n.bind(this)(a)}}}));","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_weekOfYear=t()}(this,(function(){\"use strict\";var e=\"week\",t=\"year\";return function(i,n,r){var f=n.prototype;f.week=function(i){if(void 0===i&&(i=null),null!==i)return this.add(7*(i-this.week()),\"day\");var n=this.$locale().yearStart||1;if(11===this.month()&&this.date()>25){var f=r(this).startOf(t).add(1,t).date(n),s=r(this).endOf(e);if(f.isBefore(s))return 1}var a=r(this).startOf(t).date(n).startOf(e).subtract(1,\"millisecond\"),o=this.diff(a,e,!0);return o<0?r(this).startOf(\"week\").week():Math.ceil(o)},f.weeks=function(e){return void 0===e&&(e=null),this.week(e)}}}));","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_weekYear=t()}(this,(function(){\"use strict\";return function(e,t){t.prototype.weekYear=function(){var e=this.month(),t=this.week(),n=this.year();return 1===t&&11===e?n+1:0===e&&t>=52?n-1:n}}}));","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_dayOfYear=t()}(this,(function(){\"use strict\";return function(e,t,n){t.prototype.dayOfYear=function(e){var t=Math.round((n(this).startOf(\"day\")-n(this).startOf(\"year\"))/864e5)+1;return null==e?t:this.add(e-t,\"day\")}}}));","!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(t):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_isSameOrAfter=t()}(this,(function(){\"use strict\";return function(e,t){t.prototype.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)}}}));","!function(e,i){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=i():\"function\"==typeof define&&define.amd?define(i):(e=\"undefined\"!=typeof globalThis?globalThis:e||self).dayjs_plugin_isSameOrBefore=i()}(this,(function(){\"use strict\";return function(e,i){i.prototype.isSameOrBefore=function(e,i){return this.isSame(e,i)||this.isBefore(e,i)}}}));","const ROOT_PICKER_INJECTION_KEY = Symbol();\n\nexport { ROOT_PICKER_INJECTION_KEY };\n//# sourceMappingURL=constants.mjs.map\n","import '../../../time-picker/index.mjs';\nimport '../../../../utils/index.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\nimport { timePickerDefaultProps } from '../../../time-picker/src/common/props.mjs';\n\nconst datePickerProps = buildProps({\n  ...timePickerDefaultProps,\n  type: {\n    type: definePropType(String),\n    default: \"date\"\n  }\n});\n\nexport { datePickerProps };\n//# sourceMappingURL=date-picker.mjs.map\n","import '../../../../utils/index.mjs';\nimport '../../../../constants/index.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\nimport { datePickTypes } from '../../../../constants/date.mjs';\nimport { isArray } from '@vue/shared';\n\nconst selectionModes = [\"date\", \"dates\", \"year\", \"month\", \"week\", \"range\"];\nconst datePickerSharedProps = buildProps({\n  disabledDate: {\n    type: definePropType(Function)\n  },\n  date: {\n    type: definePropType(Object),\n    required: true\n  },\n  minDate: {\n    type: definePropType(Object)\n  },\n  maxDate: {\n    type: definePropType(Object)\n  },\n  parsedValue: {\n    type: definePropType([Object, Array])\n  },\n  rangeState: {\n    type: definePropType(Object),\n    default: () => ({\n      endDate: null,\n      selecting: false\n    })\n  }\n});\nconst panelSharedProps = buildProps({\n  type: {\n    type: definePropType(String),\n    required: true,\n    values: datePickTypes\n  }\n});\nconst panelRangeSharedProps = buildProps({\n  unlinkPanels: Boolean,\n  parsedValue: {\n    type: definePropType(Array)\n  }\n});\nconst selectionModeWithDefault = (mode) => {\n  return {\n    type: String,\n    values: selectionModes,\n    default: mode\n  };\n};\nconst rangePickerSharedEmits = {\n  pick: (range) => isArray(range)\n};\n\nexport { datePickerSharedProps, panelRangeSharedProps, panelSharedProps, rangePickerSharedEmits, selectionModeWithDefault };\n//# sourceMappingURL=shared.mjs.map\n","import '../../../../utils/index.mjs';\nimport { panelSharedProps } from './shared.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\n\nconst panelDatePickProps = buildProps({\n  ...panelSharedProps,\n  parsedValue: {\n    type: definePropType([Object, Array])\n  },\n  visible: {\n    type: Boolean\n  },\n  format: {\n    type: String,\n    default: \"\"\n  }\n});\n\nexport { panelDatePickProps };\n//# sourceMappingURL=panel-date-pick.mjs.map\n","import '../../../../utils/index.mjs';\nimport { datePickerSharedProps, selectionModeWithDefault } from './shared.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\n\nconst basicDateTableProps = buildProps({\n  ...datePickerSharedProps,\n  cellClassName: {\n    type: definePropType(Function)\n  },\n  showWeekNumber: Boolean,\n  selectionMode: selectionModeWithDefault(\"date\")\n});\nconst basicDateTableEmits = [\"changerange\", \"pick\", \"select\"];\n\nexport { basicDateTableEmits, basicDateTableProps };\n//# sourceMappingURL=basic-date-table.mjs.map\n","import dayjs from 'dayjs';\nimport '../../../utils/index.mjs';\nimport { isArray } from '@vue/shared';\n\nconst isValidRange = (range) => {\n  if (!isArray(range))\n    return false;\n  const [left, right] = range;\n  return dayjs.isDayjs(left) && dayjs.isDayjs(right) && left.isSameOrBefore(right);\n};\nconst getDefaultValue = (defaultValue, { lang, unit, unlinkPanels }) => {\n  let start;\n  if (isArray(defaultValue)) {\n    let [left, right] = defaultValue.map((d) => dayjs(d).locale(lang));\n    if (!unlinkPanels) {\n      right = left.add(1, unit);\n    }\n    return [left, right];\n  } else if (defaultValue) {\n    start = dayjs(defaultValue);\n  } else {\n    start = dayjs();\n  }\n  start = start.locale(lang);\n  return [start, start.add(1, unit)];\n};\nconst buildPickerTable = (dimension, rows, {\n  columnIndexOffset,\n  startDate,\n  nextEndDate,\n  now,\n  unit,\n  relativeDateGetter,\n  setCellMetadata,\n  setRowMetadata\n}) => {\n  for (let rowIndex = 0; rowIndex < dimension.row; rowIndex++) {\n    const row = rows[rowIndex];\n    for (let columnIndex = 0; columnIndex < dimension.column; columnIndex++) {\n      let cell = row[columnIndex + columnIndexOffset];\n      if (!cell) {\n        cell = {\n          row: rowIndex,\n          column: columnIndex,\n          type: \"normal\",\n          inRange: false,\n          start: false,\n          end: false\n        };\n      }\n      const index = rowIndex * dimension.column + columnIndex;\n      const nextStartDate = relativeDateGetter(index);\n      cell.dayjs = nextStartDate;\n      cell.date = nextStartDate.toDate();\n      cell.timestamp = nextStartDate.valueOf();\n      cell.type = \"normal\";\n      cell.inRange = !!(startDate && nextStartDate.isSameOrAfter(startDate, unit) && nextEndDate && nextStartDate.isSameOrBefore(nextEndDate, unit)) || !!(startDate && nextStartDate.isSameOrBefore(startDate, unit) && nextEndDate && nextStartDate.isSameOrAfter(nextEndDate, unit));\n      if (startDate == null ? void 0 : startDate.isSameOrAfter(nextEndDate)) {\n        cell.start = !!nextEndDate && nextStartDate.isSame(nextEndDate, unit);\n        cell.end = startDate && nextStartDate.isSame(startDate, unit);\n      } else {\n        cell.start = !!startDate && nextStartDate.isSame(startDate, unit);\n        cell.end = !!nextEndDate && nextStartDate.isSame(nextEndDate, unit);\n      }\n      const isToday = nextStartDate.isSame(now, unit);\n      if (isToday) {\n        cell.type = \"today\";\n      }\n      setCellMetadata == null ? void 0 : setCellMetadata(cell, { rowIndex, columnIndex });\n      row[columnIndex + columnIndexOffset] = cell;\n    }\n    setRowMetadata == null ? void 0 : setRowMetadata(row);\n  }\n};\n\nexport { buildPickerTable, getDefaultValue, isValidRange };\n//# sourceMappingURL=utils.mjs.map\n","import { ref, computed, unref, watch, nextTick } from 'vue';\nimport dayjs from 'dayjs';\nimport { flatten } from 'lodash-unified';\nimport '../../../../hooks/index.mjs';\nimport '../../../../utils/index.mjs';\nimport { buildPickerTable } from '../utils.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\nimport { castArray } from '../../../../utils/arrays.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\n\nconst isNormalDay = (type = \"\") => {\n  return [\"normal\", \"today\"].includes(type);\n};\nconst useBasicDateTable = (props, emit) => {\n  const { lang } = useLocale();\n  const tbodyRef = ref();\n  const currentCellRef = ref();\n  const lastRow = ref();\n  const lastColumn = ref();\n  const tableRows = ref([[], [], [], [], [], []]);\n  let focusWithClick = false;\n  const firstDayOfWeek = props.date.$locale().weekStart || 7;\n  const WEEKS_CONSTANT = props.date.locale(\"en\").localeData().weekdaysShort().map((_) => _.toLowerCase());\n  const offsetDay = computed(() => {\n    return firstDayOfWeek > 3 ? 7 - firstDayOfWeek : -firstDayOfWeek;\n  });\n  const startDate = computed(() => {\n    const startDayOfMonth = props.date.startOf(\"month\");\n    return startDayOfMonth.subtract(startDayOfMonth.day() || 7, \"day\");\n  });\n  const WEEKS = computed(() => {\n    return WEEKS_CONSTANT.concat(WEEKS_CONSTANT).slice(firstDayOfWeek, firstDayOfWeek + 7);\n  });\n  const hasCurrent = computed(() => {\n    return flatten(unref(rows)).some((row) => {\n      return row.isCurrent;\n    });\n  });\n  const days = computed(() => {\n    const startOfMonth = props.date.startOf(\"month\");\n    const startOfMonthDay = startOfMonth.day() || 7;\n    const dateCountOfMonth = startOfMonth.daysInMonth();\n    const dateCountOfLastMonth = startOfMonth.subtract(1, \"month\").daysInMonth();\n    return {\n      startOfMonthDay,\n      dateCountOfMonth,\n      dateCountOfLastMonth\n    };\n  });\n  const selectedDate = computed(() => {\n    return props.selectionMode === \"dates\" ? castArray(props.parsedValue) : [];\n  });\n  const setDateText = (cell, { count, rowIndex, columnIndex }) => {\n    const { startOfMonthDay, dateCountOfMonth, dateCountOfLastMonth } = unref(days);\n    const offset = unref(offsetDay);\n    if (rowIndex >= 0 && rowIndex <= 1) {\n      const numberOfDaysFromPreviousMonth = startOfMonthDay + offset < 0 ? 7 + startOfMonthDay + offset : startOfMonthDay + offset;\n      if (columnIndex + rowIndex * 7 >= numberOfDaysFromPreviousMonth) {\n        cell.text = count;\n        return true;\n      } else {\n        cell.text = dateCountOfLastMonth - (numberOfDaysFromPreviousMonth - columnIndex % 7) + 1 + rowIndex * 7;\n        cell.type = \"prev-month\";\n      }\n    } else {\n      if (count <= dateCountOfMonth) {\n        cell.text = count;\n      } else {\n        cell.text = count - dateCountOfMonth;\n        cell.type = \"next-month\";\n      }\n      return true;\n    }\n    return false;\n  };\n  const setCellMetadata = (cell, { columnIndex, rowIndex }, count) => {\n    const { disabledDate, cellClassName } = props;\n    const _selectedDate = unref(selectedDate);\n    const shouldIncrement = setDateText(cell, { count, rowIndex, columnIndex });\n    const cellDate = cell.dayjs.toDate();\n    cell.selected = _selectedDate.find((d) => d.valueOf() === cell.dayjs.valueOf());\n    cell.isSelected = !!cell.selected;\n    cell.isCurrent = isCurrent(cell);\n    cell.disabled = disabledDate == null ? void 0 : disabledDate(cellDate);\n    cell.customClass = cellClassName == null ? void 0 : cellClassName(cellDate);\n    return shouldIncrement;\n  };\n  const setRowMetadata = (row) => {\n    if (props.selectionMode === \"week\") {\n      const [start, end] = props.showWeekNumber ? [1, 7] : [0, 6];\n      const isActive = isWeekActive(row[start + 1]);\n      row[start].inRange = isActive;\n      row[start].start = isActive;\n      row[end].inRange = isActive;\n      row[end].end = isActive;\n    }\n  };\n  const rows = computed(() => {\n    const { minDate, maxDate, rangeState, showWeekNumber } = props;\n    const offset = unref(offsetDay);\n    const rows_ = unref(tableRows);\n    const dateUnit = \"day\";\n    let count = 1;\n    if (showWeekNumber) {\n      for (let rowIndex = 0; rowIndex < 6; rowIndex++) {\n        if (!rows_[rowIndex][0]) {\n          rows_[rowIndex][0] = {\n            type: \"week\",\n            text: unref(startDate).add(rowIndex * 7 + 1, dateUnit).week()\n          };\n        }\n      }\n    }\n    buildPickerTable({ row: 6, column: 7 }, rows_, {\n      startDate: minDate,\n      columnIndexOffset: showWeekNumber ? 1 : 0,\n      nextEndDate: rangeState.endDate || maxDate || rangeState.selecting && minDate || null,\n      now: dayjs().locale(unref(lang)).startOf(dateUnit),\n      unit: dateUnit,\n      relativeDateGetter: (idx) => unref(startDate).add(idx - offset, dateUnit),\n      setCellMetadata: (...args) => {\n        if (setCellMetadata(...args, count)) {\n          count += 1;\n        }\n      },\n      setRowMetadata\n    });\n    return rows_;\n  });\n  watch(() => props.date, async () => {\n    var _a;\n    if ((_a = unref(tbodyRef)) == null ? void 0 : _a.contains(document.activeElement)) {\n      await nextTick();\n      await focus();\n    }\n  });\n  const focus = async () => {\n    var _a;\n    return (_a = unref(currentCellRef)) == null ? void 0 : _a.focus();\n  };\n  const isCurrent = (cell) => {\n    return props.selectionMode === \"date\" && isNormalDay(cell.type) && cellMatchesDate(cell, props.parsedValue);\n  };\n  const cellMatchesDate = (cell, date) => {\n    if (!date)\n      return false;\n    return dayjs(date).locale(unref(lang)).isSame(props.date.date(Number(cell.text)), \"day\");\n  };\n  const getDateOfCell = (row, column) => {\n    const offsetFromStart = row * 7 + (column - (props.showWeekNumber ? 1 : 0)) - unref(offsetDay);\n    return unref(startDate).add(offsetFromStart, \"day\");\n  };\n  const handleMouseMove = (event) => {\n    var _a;\n    if (!props.rangeState.selecting)\n      return;\n    let target = event.target;\n    if (target.tagName === \"SPAN\") {\n      target = (_a = target.parentNode) == null ? void 0 : _a.parentNode;\n    }\n    if (target.tagName === \"DIV\") {\n      target = target.parentNode;\n    }\n    if (target.tagName !== \"TD\")\n      return;\n    const row = target.parentNode.rowIndex - 1;\n    const column = target.cellIndex;\n    if (unref(rows)[row][column].disabled)\n      return;\n    if (row !== unref(lastRow) || column !== unref(lastColumn)) {\n      lastRow.value = row;\n      lastColumn.value = column;\n      emit(\"changerange\", {\n        selecting: true,\n        endDate: getDateOfCell(row, column)\n      });\n    }\n  };\n  const isSelectedCell = (cell) => {\n    return !unref(hasCurrent) && (cell == null ? void 0 : cell.text) === 1 && cell.type === \"normal\" || cell.isCurrent;\n  };\n  const handleFocus = (event) => {\n    if (focusWithClick || unref(hasCurrent) || props.selectionMode !== \"date\")\n      return;\n    handlePickDate(event, true);\n  };\n  const handleMouseDown = (event) => {\n    const target = event.target.closest(\"td\");\n    if (!target)\n      return;\n    focusWithClick = true;\n  };\n  const handleMouseUp = (event) => {\n    const target = event.target.closest(\"td\");\n    if (!target)\n      return;\n    focusWithClick = false;\n  };\n  const handleRangePick = (newDate) => {\n    if (!props.rangeState.selecting || !props.minDate) {\n      emit(\"pick\", { minDate: newDate, maxDate: null });\n      emit(\"select\", true);\n    } else {\n      if (newDate >= props.minDate) {\n        emit(\"pick\", { minDate: props.minDate, maxDate: newDate });\n      } else {\n        emit(\"pick\", { minDate: newDate, maxDate: props.minDate });\n      }\n      emit(\"select\", false);\n    }\n  };\n  const handleWeekPick = (newDate) => {\n    const weekNumber = newDate.week();\n    const value = `${newDate.year()}w${weekNumber}`;\n    emit(\"pick\", {\n      year: newDate.year(),\n      week: weekNumber,\n      value,\n      date: newDate.startOf(\"week\")\n    });\n  };\n  const handleDatesPick = (newDate, selected) => {\n    const newValue = selected ? castArray(props.parsedValue).filter((d) => (d == null ? void 0 : d.valueOf()) !== newDate.valueOf()) : castArray(props.parsedValue).concat([newDate]);\n    emit(\"pick\", newValue);\n  };\n  const handlePickDate = (event, isKeyboardMovement = false) => {\n    const target = event.target.closest(\"td\");\n    if (!target)\n      return;\n    const row = target.parentNode.rowIndex - 1;\n    const column = target.cellIndex;\n    const cell = unref(rows)[row][column];\n    if (cell.disabled || cell.type === \"week\")\n      return;\n    const newDate = getDateOfCell(row, column);\n    switch (props.selectionMode) {\n      case \"range\": {\n        handleRangePick(newDate);\n        break;\n      }\n      case \"date\": {\n        emit(\"pick\", newDate, isKeyboardMovement);\n        break;\n      }\n      case \"week\": {\n        handleWeekPick(newDate);\n        break;\n      }\n      case \"dates\": {\n        handleDatesPick(newDate, !!cell.selected);\n        break;\n      }\n      default: {\n        break;\n      }\n    }\n  };\n  const isWeekActive = (cell) => {\n    if (props.selectionMode !== \"week\")\n      return false;\n    let newDate = props.date.startOf(\"day\");\n    if (cell.type === \"prev-month\") {\n      newDate = newDate.subtract(1, \"month\");\n    }\n    if (cell.type === \"next-month\") {\n      newDate = newDate.add(1, \"month\");\n    }\n    newDate = newDate.date(Number.parseInt(cell.text, 10));\n    if (props.parsedValue && !Array.isArray(props.parsedValue)) {\n      const dayOffset = (props.parsedValue.day() - firstDayOfWeek + 7) % 7 - 1;\n      const weekDate = props.parsedValue.subtract(dayOffset, \"day\");\n      return weekDate.isSame(newDate, \"day\");\n    }\n    return false;\n  };\n  return {\n    WEEKS,\n    rows,\n    tbodyRef,\n    currentCellRef,\n    focus,\n    isCurrent,\n    isWeekActive,\n    isSelectedCell,\n    handlePickDate,\n    handleMouseUp,\n    handleMouseDown,\n    handleMouseMove,\n    handleFocus\n  };\n};\nconst useBasicDateTableDOM = (props, {\n  isCurrent,\n  isWeekActive\n}) => {\n  const ns = useNamespace(\"date-table\");\n  const { t } = useLocale();\n  const tableKls = computed(() => [\n    ns.b(),\n    { \"is-week-mode\": props.selectionMode === \"week\" }\n  ]);\n  const tableLabel = computed(() => t(\"el.datepicker.dateTablePrompt\"));\n  const weekLabel = computed(() => t(\"el.datepicker.week\"));\n  const getCellClasses = (cell) => {\n    const classes = [];\n    if (isNormalDay(cell.type) && !cell.disabled) {\n      classes.push(\"available\");\n      if (cell.type === \"today\") {\n        classes.push(\"today\");\n      }\n    } else {\n      classes.push(cell.type);\n    }\n    if (isCurrent(cell)) {\n      classes.push(\"current\");\n    }\n    if (cell.inRange && (isNormalDay(cell.type) || props.selectionMode === \"week\")) {\n      classes.push(\"in-range\");\n      if (cell.start) {\n        classes.push(\"start-date\");\n      }\n      if (cell.end) {\n        classes.push(\"end-date\");\n      }\n    }\n    if (cell.disabled) {\n      classes.push(\"disabled\");\n    }\n    if (cell.selected) {\n      classes.push(\"selected\");\n    }\n    if (cell.customClass) {\n      classes.push(cell.customClass);\n    }\n    return classes.join(\" \");\n  };\n  const getRowKls = (cell) => [\n    ns.e(\"row\"),\n    { current: isWeekActive(cell) }\n  ];\n  return {\n    tableKls,\n    tableLabel,\n    weekLabel,\n    getCellClasses,\n    getRowKls,\n    t\n  };\n};\n\nexport { useBasicDateTable, useBasicDateTableDOM };\n//# sourceMappingURL=use-basic-date-table.mjs.map\n","import '../../../../utils/index.mjs';\nimport { buildProps, definePropType } from '../../../../utils/vue/props/runtime.mjs';\n\nconst basicCellProps = buildProps({\n  cell: {\n    type: definePropType(Object)\n  }\n});\n\nexport { basicCellProps };\n//# sourceMappingURL=basic-cell.mjs.map\n","import { defineComponent, inject, createVNode } from 'vue';\nimport '../../../../hooks/index.mjs';\nimport { ROOT_PICKER_INJECTION_KEY } from '../constants.mjs';\nimport { basicCellProps } from '../props/basic-cell.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\n\nvar ElDatePickerCell = defineComponent({\n  name: \"ElDatePickerCell\",\n  props: basicCellProps,\n  setup(props) {\n    const ns = useNamespace(\"date-table-cell\");\n    const {\n      slots\n    } = inject(ROOT_PICKER_INJECTION_KEY);\n    return () => {\n      const {\n        cell\n      } = props;\n      if (slots.default) {\n        const list = slots.default(cell).filter((item) => {\n          return item.patchFlag !== -2 && item.type.toString() !== \"Symbol(Comment)\";\n        });\n        if (list.length) {\n          return list;\n        }\n      }\n      return createVNode(\"div\", {\n        \"class\": ns.b()\n      }, [createVNode(\"span\", {\n        \"class\": ns.e(\"text\")\n      }, [cell == null ? void 0 : cell.text])]);\n    };\n  }\n});\n\nexport { ElDatePickerCell as default };\n//# sourceMappingURL=basic-cell-render.mjs.map\n","import { defineComponent, openBlock, createElementBlock, unref, normalizeClass, withModifiers, createElementVNode, toDisplayString, createCommentVNode, Fragment, renderList, createVNode } from 'vue';\nimport { basicDateTableProps, basicDateTableEmits } from '../props/basic-date-table.mjs';\nimport { useBasicDateTable, useBasicDateTableDOM } from '../composables/use-basic-date-table.mjs';\nimport ElDatePickerCell from './basic-cell-render.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\n\nconst _hoisted_1 = [\"aria-label\"];\nconst _hoisted_2 = {\n  key: 0,\n  scope: \"col\"\n};\nconst _hoisted_3 = [\"aria-label\"];\nconst _hoisted_4 = [\"aria-current\", \"aria-selected\", \"tabindex\"];\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"basic-date-table\",\n  props: basicDateTableProps,\n  emits: basicDateTableEmits,\n  setup(__props, { expose, emit }) {\n    const props = __props;\n    const {\n      WEEKS,\n      rows,\n      tbodyRef,\n      currentCellRef,\n      focus,\n      isCurrent,\n      isWeekActive,\n      isSelectedCell,\n      handlePickDate,\n      handleMouseUp,\n      handleMouseDown,\n      handleMouseMove,\n      handleFocus\n    } = useBasicDateTable(props, emit);\n    const { tableLabel, tableKls, weekLabel, getCellClasses, getRowKls, t } = useBasicDateTableDOM(props, {\n      isCurrent,\n      isWeekActive\n    });\n    expose({\n      focus\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"table\", {\n        \"aria-label\": unref(tableLabel),\n        class: normalizeClass(unref(tableKls)),\n        cellspacing: \"0\",\n        cellpadding: \"0\",\n        role: \"grid\",\n        onClick: _cache[1] || (_cache[1] = (...args) => unref(handlePickDate) && unref(handlePickDate)(...args)),\n        onMousemove: _cache[2] || (_cache[2] = (...args) => unref(handleMouseMove) && unref(handleMouseMove)(...args)),\n        onMousedown: _cache[3] || (_cache[3] = withModifiers((...args) => unref(handleMouseDown) && unref(handleMouseDown)(...args), [\"prevent\"])),\n        onMouseup: _cache[4] || (_cache[4] = (...args) => unref(handleMouseUp) && unref(handleMouseUp)(...args))\n      }, [\n        createElementVNode(\"tbody\", {\n          ref_key: \"tbodyRef\",\n          ref: tbodyRef\n        }, [\n          createElementVNode(\"tr\", null, [\n            _ctx.showWeekNumber ? (openBlock(), createElementBlock(\"th\", _hoisted_2, toDisplayString(unref(weekLabel)), 1)) : createCommentVNode(\"v-if\", true),\n            (openBlock(true), createElementBlock(Fragment, null, renderList(unref(WEEKS), (week, key) => {\n              return openBlock(), createElementBlock(\"th\", {\n                key,\n                \"aria-label\": unref(t)(\"el.datepicker.weeksFull.\" + week),\n                scope: \"col\"\n              }, toDisplayString(unref(t)(\"el.datepicker.weeks.\" + week)), 9, _hoisted_3);\n            }), 128))\n          ]),\n          (openBlock(true), createElementBlock(Fragment, null, renderList(unref(rows), (row, rowKey) => {\n            return openBlock(), createElementBlock(\"tr\", {\n              key: rowKey,\n              class: normalizeClass(unref(getRowKls)(row[1]))\n            }, [\n              (openBlock(true), createElementBlock(Fragment, null, renderList(row, (cell, columnKey) => {\n                return openBlock(), createElementBlock(\"td\", {\n                  key: `${rowKey}.${columnKey}`,\n                  ref_for: true,\n                  ref: (el) => unref(isSelectedCell)(cell) && (currentCellRef.value = el),\n                  class: normalizeClass(unref(getCellClasses)(cell)),\n                  \"aria-current\": cell.isCurrent ? \"date\" : void 0,\n                  \"aria-selected\": cell.isCurrent,\n                  tabindex: unref(isSelectedCell)(cell) ? 0 : -1,\n                  onFocus: _cache[0] || (_cache[0] = (...args) => unref(handleFocus) && unref(handleFocus)(...args))\n                }, [\n                  createVNode(unref(ElDatePickerCell), { cell }, null, 8, [\"cell\"])\n                ], 42, _hoisted_4);\n              }), 128))\n            ], 2);\n          }), 128))\n        ], 512)\n      ], 42, _hoisted_1);\n    };\n  }\n});\nvar DateTable = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-date-table.vue\"]]);\n\nexport { DateTable as default };\n//# sourceMappingURL=basic-date-table.mjs.map\n","import '../../../../utils/index.mjs';\nimport { datePickerSharedProps, selectionModeWithDefault } from './shared.mjs';\nimport { buildProps } from '../../../../utils/vue/props/runtime.mjs';\n\nconst basicMonthTableProps = buildProps({\n  ...datePickerSharedProps,\n  selectionMode: selectionModeWithDefault(\"month\")\n});\n\nexport { basicMonthTableProps };\n//# sourceMappingURL=basic-month-table.mjs.map\n","import { defineComponent, ref, computed, watch, nextTick, openBlock, createElementBlock, unref, normalizeClass, createElementVNode, Fragment, renderList, withKeys, withModifiers, toDisplayString } from 'vue';\nimport dayjs from 'dayjs';\nimport '../../../../hooks/index.mjs';\nimport '../../../time-picker/index.mjs';\nimport '../../../../utils/index.mjs';\nimport { basicMonthTableProps } from '../props/basic-month-table.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { rangeArr } from '../../../time-picker/src/utils.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\nimport { castArray } from '../../../../utils/arrays.mjs';\nimport { hasClass } from '../../../../utils/dom/style.mjs';\n\nconst _hoisted_1 = [\"aria-label\"];\nconst _hoisted_2 = [\"aria-selected\", \"aria-label\", \"tabindex\", \"onKeydown\"];\nconst _hoisted_3 = { class: \"cell\" };\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"basic-month-table\",\n  props: basicMonthTableProps,\n  emits: [\"changerange\", \"pick\", \"select\"],\n  setup(__props, { expose, emit }) {\n    const props = __props;\n    const datesInMonth = (year, month, lang2) => {\n      const firstDay = dayjs().locale(lang2).startOf(\"month\").month(month).year(year);\n      const numOfDays = firstDay.daysInMonth();\n      return rangeArr(numOfDays).map((n) => firstDay.add(n, \"day\").toDate());\n    };\n    const ns = useNamespace(\"month-table\");\n    const { t, lang } = useLocale();\n    const tbodyRef = ref();\n    const currentCellRef = ref();\n    const months = ref(props.date.locale(\"en\").localeData().monthsShort().map((_) => _.toLowerCase()));\n    const tableRows = ref([\n      [],\n      [],\n      []\n    ]);\n    const lastRow = ref();\n    const lastColumn = ref();\n    const rows = computed(() => {\n      var _a, _b;\n      const rows2 = tableRows.value;\n      const now = dayjs().locale(lang.value).startOf(\"month\");\n      for (let i = 0; i < 3; i++) {\n        const row = rows2[i];\n        for (let j = 0; j < 4; j++) {\n          const cell = row[j] || (row[j] = {\n            row: i,\n            column: j,\n            type: \"normal\",\n            inRange: false,\n            start: false,\n            end: false,\n            text: -1,\n            disabled: false\n          });\n          cell.type = \"normal\";\n          const index = i * 4 + j;\n          const calTime = props.date.startOf(\"year\").month(index);\n          const calEndDate = props.rangeState.endDate || props.maxDate || props.rangeState.selecting && props.minDate || null;\n          cell.inRange = !!(props.minDate && calTime.isSameOrAfter(props.minDate, \"month\") && calEndDate && calTime.isSameOrBefore(calEndDate, \"month\")) || !!(props.minDate && calTime.isSameOrBefore(props.minDate, \"month\") && calEndDate && calTime.isSameOrAfter(calEndDate, \"month\"));\n          if ((_a = props.minDate) == null ? void 0 : _a.isSameOrAfter(calEndDate)) {\n            cell.start = !!(calEndDate && calTime.isSame(calEndDate, \"month\"));\n            cell.end = props.minDate && calTime.isSame(props.minDate, \"month\");\n          } else {\n            cell.start = !!(props.minDate && calTime.isSame(props.minDate, \"month\"));\n            cell.end = !!(calEndDate && calTime.isSame(calEndDate, \"month\"));\n          }\n          const isToday = now.isSame(calTime);\n          if (isToday) {\n            cell.type = \"today\";\n          }\n          cell.text = index;\n          cell.disabled = ((_b = props.disabledDate) == null ? void 0 : _b.call(props, calTime.toDate())) || false;\n        }\n      }\n      return rows2;\n    });\n    const focus = () => {\n      var _a;\n      (_a = currentCellRef.value) == null ? void 0 : _a.focus();\n    };\n    const getCellStyle = (cell) => {\n      const style = {};\n      const year = props.date.year();\n      const today = new Date();\n      const month = cell.text;\n      style.disabled = props.disabledDate ? datesInMonth(year, month, lang.value).every(props.disabledDate) : false;\n      style.current = castArray(props.parsedValue).findIndex((date) => dayjs.isDayjs(date) && date.year() === year && date.month() === month) >= 0;\n      style.today = today.getFullYear() === year && today.getMonth() === month;\n      if (cell.inRange) {\n        style[\"in-range\"] = true;\n        if (cell.start) {\n          style[\"start-date\"] = true;\n        }\n        if (cell.end) {\n          style[\"end-date\"] = true;\n        }\n      }\n      return style;\n    };\n    const isSelectedCell = (cell) => {\n      const year = props.date.year();\n      const month = cell.text;\n      return castArray(props.date).findIndex((date) => date.year() === year && date.month() === month) >= 0;\n    };\n    const handleMouseMove = (event) => {\n      var _a;\n      if (!props.rangeState.selecting)\n        return;\n      let target = event.target;\n      if (target.tagName === \"A\") {\n        target = (_a = target.parentNode) == null ? void 0 : _a.parentNode;\n      }\n      if (target.tagName === \"DIV\") {\n        target = target.parentNode;\n      }\n      if (target.tagName !== \"TD\")\n        return;\n      const row = target.parentNode.rowIndex;\n      const column = target.cellIndex;\n      if (rows.value[row][column].disabled)\n        return;\n      if (row !== lastRow.value || column !== lastColumn.value) {\n        lastRow.value = row;\n        lastColumn.value = column;\n        emit(\"changerange\", {\n          selecting: true,\n          endDate: props.date.startOf(\"year\").month(row * 4 + column)\n        });\n      }\n    };\n    const handleMonthTableClick = (event) => {\n      var _a;\n      const target = (_a = event.target) == null ? void 0 : _a.closest(\"td\");\n      if ((target == null ? void 0 : target.tagName) !== \"TD\")\n        return;\n      if (hasClass(target, \"disabled\"))\n        return;\n      const column = target.cellIndex;\n      const row = target.parentNode.rowIndex;\n      const month = row * 4 + column;\n      const newDate = props.date.startOf(\"year\").month(month);\n      if (props.selectionMode === \"range\") {\n        if (!props.rangeState.selecting) {\n          emit(\"pick\", { minDate: newDate, maxDate: null });\n          emit(\"select\", true);\n        } else {\n          if (props.minDate && newDate >= props.minDate) {\n            emit(\"pick\", { minDate: props.minDate, maxDate: newDate });\n          } else {\n            emit(\"pick\", { minDate: newDate, maxDate: props.minDate });\n          }\n          emit(\"select\", false);\n        }\n      } else {\n        emit(\"pick\", month);\n      }\n    };\n    watch(() => props.date, async () => {\n      var _a, _b;\n      if ((_a = tbodyRef.value) == null ? void 0 : _a.contains(document.activeElement)) {\n        await nextTick();\n        (_b = currentCellRef.value) == null ? void 0 : _b.focus();\n      }\n    });\n    expose({\n      focus\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"table\", {\n        role: \"grid\",\n        \"aria-label\": unref(t)(\"el.datepicker.monthTablePrompt\"),\n        class: normalizeClass(unref(ns).b()),\n        onClick: handleMonthTableClick,\n        onMousemove: handleMouseMove\n      }, [\n        createElementVNode(\"tbody\", {\n          ref_key: \"tbodyRef\",\n          ref: tbodyRef\n        }, [\n          (openBlock(true), createElementBlock(Fragment, null, renderList(unref(rows), (row, key) => {\n            return openBlock(), createElementBlock(\"tr\", { key }, [\n              (openBlock(true), createElementBlock(Fragment, null, renderList(row, (cell, key_) => {\n                return openBlock(), createElementBlock(\"td\", {\n                  key: key_,\n                  ref_for: true,\n                  ref: (el) => isSelectedCell(cell) && (currentCellRef.value = el),\n                  class: normalizeClass(getCellStyle(cell)),\n                  \"aria-selected\": `${isSelectedCell(cell)}`,\n                  \"aria-label\": unref(t)(`el.datepicker.month${+cell.text + 1}`),\n                  tabindex: isSelectedCell(cell) ? 0 : -1,\n                  onKeydown: [\n                    withKeys(withModifiers(handleMonthTableClick, [\"prevent\", \"stop\"]), [\"space\"]),\n                    withKeys(withModifiers(handleMonthTableClick, [\"prevent\", \"stop\"]), [\"enter\"])\n                  ]\n                }, [\n                  createElementVNode(\"div\", null, [\n                    createElementVNode(\"span\", _hoisted_3, toDisplayString(unref(t)(\"el.datepicker.months.\" + months.value[cell.text])), 1)\n                  ])\n                ], 42, _hoisted_2);\n              }), 128))\n            ]);\n          }), 128))\n        ], 512)\n      ], 42, _hoisted_1);\n    };\n  }\n});\nvar MonthTable = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-month-table.vue\"]]);\n\nexport { MonthTable as default };\n//# sourceMappingURL=basic-month-table.mjs.map\n","import '../../../../utils/index.mjs';\nimport { datePickerSharedProps } from './shared.mjs';\nimport { buildProps } from '../../../../utils/vue/props/runtime.mjs';\n\nconst { date, disabledDate, parsedValue } = datePickerSharedProps;\nconst basicYearTableProps = buildProps({\n  date,\n  disabledDate,\n  parsedValue\n});\n\nexport { basicYearTableProps };\n//# sourceMappingURL=basic-year-table.mjs.map\n","import { defineComponent, ref, computed, watch, nextTick, openBlock, createElementBlock, unref, normalizeClass, createElementVNode, Fragment, renderList, withKeys, withModifiers, toDisplayString } from 'vue';\nimport dayjs from 'dayjs';\nimport '../../../../hooks/index.mjs';\nimport '../../../time-picker/index.mjs';\nimport '../../../../utils/index.mjs';\nimport { basicYearTableProps } from '../props/basic-year-table.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { rangeArr } from '../../../time-picker/src/utils.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\nimport { castArray } from '../../../../utils/arrays.mjs';\nimport { hasClass } from '../../../../utils/dom/style.mjs';\n\nconst _hoisted_1 = [\"aria-label\"];\nconst _hoisted_2 = [\"aria-selected\", \"tabindex\", \"onKeydown\"];\nconst _hoisted_3 = { class: \"cell\" };\nconst _hoisted_4 = { key: 1 };\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"basic-year-table\",\n  props: basicYearTableProps,\n  emits: [\"pick\"],\n  setup(__props, { expose, emit }) {\n    const props = __props;\n    const datesInYear = (year, lang2) => {\n      const firstDay = dayjs(String(year)).locale(lang2).startOf(\"year\");\n      const lastDay = firstDay.endOf(\"year\");\n      const numOfDays = lastDay.dayOfYear();\n      return rangeArr(numOfDays).map((n) => firstDay.add(n, \"day\").toDate());\n    };\n    const ns = useNamespace(\"year-table\");\n    const { t, lang } = useLocale();\n    const tbodyRef = ref();\n    const currentCellRef = ref();\n    const startYear = computed(() => {\n      return Math.floor(props.date.year() / 10) * 10;\n    });\n    const focus = () => {\n      var _a;\n      (_a = currentCellRef.value) == null ? void 0 : _a.focus();\n    };\n    const getCellKls = (year) => {\n      const kls = {};\n      const today = dayjs().locale(lang.value);\n      kls.disabled = props.disabledDate ? datesInYear(year, lang.value).every(props.disabledDate) : false;\n      kls.current = castArray(props.parsedValue).findIndex((d) => d.year() === year) >= 0;\n      kls.today = today.year() === year;\n      return kls;\n    };\n    const isSelectedCell = (year) => {\n      return year === startYear.value && props.date.year() < startYear.value && props.date.year() > startYear.value + 9 || castArray(props.date).findIndex((date) => date.year() === year) >= 0;\n    };\n    const handleYearTableClick = (event) => {\n      const clickTarget = event.target;\n      const target = clickTarget.closest(\"td\");\n      if (target && target.textContent) {\n        if (hasClass(target, \"disabled\"))\n          return;\n        const year = target.textContent || target.innerText;\n        emit(\"pick\", Number(year));\n      }\n    };\n    watch(() => props.date, async () => {\n      var _a, _b;\n      if ((_a = tbodyRef.value) == null ? void 0 : _a.contains(document.activeElement)) {\n        await nextTick();\n        (_b = currentCellRef.value) == null ? void 0 : _b.focus();\n      }\n    });\n    expose({\n      focus\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"table\", {\n        role: \"grid\",\n        \"aria-label\": unref(t)(\"el.datepicker.yearTablePrompt\"),\n        class: normalizeClass(unref(ns).b()),\n        onClick: handleYearTableClick\n      }, [\n        createElementVNode(\"tbody\", {\n          ref_key: \"tbodyRef\",\n          ref: tbodyRef\n        }, [\n          (openBlock(), createElementBlock(Fragment, null, renderList(3, (_, i) => {\n            return createElementVNode(\"tr\", { key: i }, [\n              (openBlock(), createElementBlock(Fragment, null, renderList(4, (__, j) => {\n                return openBlock(), createElementBlock(Fragment, {\n                  key: i + \"_\" + j\n                }, [\n                  i * 4 + j < 10 ? (openBlock(), createElementBlock(\"td\", {\n                    key: 0,\n                    ref_for: true,\n                    ref: (el) => isSelectedCell(unref(startYear) + i * 4 + j) && (currentCellRef.value = el),\n                    class: normalizeClass([\"available\", getCellKls(unref(startYear) + i * 4 + j)]),\n                    \"aria-selected\": `${isSelectedCell(unref(startYear) + i * 4 + j)}`,\n                    tabindex: isSelectedCell(unref(startYear) + i * 4 + j) ? 0 : -1,\n                    onKeydown: [\n                      withKeys(withModifiers(handleYearTableClick, [\"prevent\", \"stop\"]), [\"space\"]),\n                      withKeys(withModifiers(handleYearTableClick, [\"prevent\", \"stop\"]), [\"enter\"])\n                    ]\n                  }, [\n                    createElementVNode(\"span\", _hoisted_3, toDisplayString(unref(startYear) + i * 4 + j), 1)\n                  ], 42, _hoisted_2)) : (openBlock(), createElementBlock(\"td\", _hoisted_4))\n                ], 64);\n              }), 64))\n            ]);\n          }), 64))\n        ], 512)\n      ], 10, _hoisted_1);\n    };\n  }\n});\nvar YearTable = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-year-table.vue\"]]);\n\nexport { YearTable as default };\n//# sourceMappingURL=basic-year-table.mjs.map\n","import { defineComponent, useAttrs, useSlots, inject, toRef, ref, computed, nextTick, watch, openBlock, createElementBlock, normalizeClass, unref, createElementVNode, renderSlot, Fragment, renderList, toDisplayString, createCommentVNode, createVNode, withDirectives, withCtx, vShow, withKeys, createBlock, createTextVNode } from 'vue';\nimport dayjs from 'dayjs';\nimport { ElButton } from '../../../button/index.mjs';\nimport '../../../../directives/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { ElInput } from '../../../input/index.mjs';\nimport '../../../time-picker/index.mjs';\nimport { ElIcon } from '../../../icon/index.mjs';\nimport '../../../../utils/index.mjs';\nimport '../../../../constants/index.mjs';\nimport { DArrowLeft, ArrowLeft, ArrowRight, DArrowRight } from '@element-plus/icons-vue';\nimport '../../../tooltip/index.mjs';\nimport { panelDatePickProps } from '../props/panel-date-pick.mjs';\nimport DateTable from './basic-date-table.mjs';\nimport MonthTable from './basic-month-table.mjs';\nimport YearTable from './basic-year-table.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\nimport { TOOLTIP_INJECTION_KEY } from '../../../tooltip/src/constants.mjs';\nimport { isArray, isFunction } from '@vue/shared';\nimport { extractTimeFormat, extractDateFormat } from '../../../time-picker/src/utils.mjs';\nimport { EVENT_CODE } from '../../../../constants/aria.mjs';\nimport TimePickPanel from '../../../time-picker/src/time-picker-com/panel-time-pick.mjs';\nimport ClickOutside from '../../../../directives/click-outside/index.mjs';\n\nconst _hoisted_1 = [\"onClick\"];\nconst _hoisted_2 = [\"aria-label\"];\nconst _hoisted_3 = [\"aria-label\"];\nconst _hoisted_4 = [\"aria-label\"];\nconst _hoisted_5 = [\"aria-label\"];\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"panel-date-pick\",\n  props: panelDatePickProps,\n  emits: [\"pick\", \"set-picker-option\", \"panel-change\"],\n  setup(__props, { emit: contextEmit }) {\n    const props = __props;\n    const timeWithinRange = (_, __, ___) => true;\n    const ppNs = useNamespace(\"picker-panel\");\n    const dpNs = useNamespace(\"date-picker\");\n    const attrs = useAttrs();\n    const slots = useSlots();\n    const { t, lang } = useLocale();\n    const pickerBase = inject(\"EP_PICKER_BASE\");\n    const popper = inject(TOOLTIP_INJECTION_KEY);\n    const { shortcuts, disabledDate, cellClassName, defaultTime } = pickerBase.props;\n    const defaultValue = toRef(pickerBase.props, \"defaultValue\");\n    const currentViewRef = ref();\n    const innerDate = ref(dayjs().locale(lang.value));\n    const isChangeToNow = ref(false);\n    let isShortcut = false;\n    const defaultTimeD = computed(() => {\n      return dayjs(defaultTime).locale(lang.value);\n    });\n    const month = computed(() => {\n      return innerDate.value.month();\n    });\n    const year = computed(() => {\n      return innerDate.value.year();\n    });\n    const selectableRange = ref([]);\n    const userInputDate = ref(null);\n    const userInputTime = ref(null);\n    const checkDateWithinRange = (date) => {\n      return selectableRange.value.length > 0 ? timeWithinRange(date, selectableRange.value, props.format || \"HH:mm:ss\") : true;\n    };\n    const formatEmit = (emitDayjs) => {\n      if (defaultTime && !visibleTime.value && !isChangeToNow.value && !isShortcut) {\n        return defaultTimeD.value.year(emitDayjs.year()).month(emitDayjs.month()).date(emitDayjs.date());\n      }\n      if (showTime.value)\n        return emitDayjs.millisecond(0);\n      return emitDayjs.startOf(\"day\");\n    };\n    const emit = (value, ...args) => {\n      if (!value) {\n        contextEmit(\"pick\", value, ...args);\n      } else if (isArray(value)) {\n        const dates = value.map(formatEmit);\n        contextEmit(\"pick\", dates, ...args);\n      } else {\n        contextEmit(\"pick\", formatEmit(value), ...args);\n      }\n      userInputDate.value = null;\n      userInputTime.value = null;\n      isChangeToNow.value = false;\n      isShortcut = false;\n    };\n    const handleDatePick = (value, keepOpen) => {\n      if (selectionMode.value === \"date\") {\n        value = value;\n        let newDate = props.parsedValue ? props.parsedValue.year(value.year()).month(value.month()).date(value.date()) : value;\n        if (!checkDateWithinRange(newDate)) {\n          newDate = selectableRange.value[0][0].year(value.year()).month(value.month()).date(value.date());\n        }\n        innerDate.value = newDate;\n        emit(newDate, showTime.value || keepOpen);\n      } else if (selectionMode.value === \"week\") {\n        emit(value.date);\n      } else if (selectionMode.value === \"dates\") {\n        emit(value, true);\n      }\n    };\n    const moveByMonth = (forward) => {\n      const action = forward ? \"add\" : \"subtract\";\n      innerDate.value = innerDate.value[action](1, \"month\");\n      handlePanelChange(\"month\");\n    };\n    const moveByYear = (forward) => {\n      const currentDate = innerDate.value;\n      const action = forward ? \"add\" : \"subtract\";\n      innerDate.value = currentView.value === \"year\" ? currentDate[action](10, \"year\") : currentDate[action](1, \"year\");\n      handlePanelChange(\"year\");\n    };\n    const currentView = ref(\"date\");\n    const yearLabel = computed(() => {\n      const yearTranslation = t(\"el.datepicker.year\");\n      if (currentView.value === \"year\") {\n        const startYear = Math.floor(year.value / 10) * 10;\n        if (yearTranslation) {\n          return `${startYear} ${yearTranslation} - ${startYear + 9} ${yearTranslation}`;\n        }\n        return `${startYear} - ${startYear + 9}`;\n      }\n      return `${year.value} ${yearTranslation}`;\n    });\n    const handleShortcutClick = (shortcut) => {\n      const shortcutValue = isFunction(shortcut.value) ? shortcut.value() : shortcut.value;\n      if (shortcutValue) {\n        isShortcut = true;\n        emit(dayjs(shortcutValue).locale(lang.value));\n        return;\n      }\n      if (shortcut.onClick) {\n        shortcut.onClick({\n          attrs,\n          slots,\n          emit: contextEmit\n        });\n      }\n    };\n    const selectionMode = computed(() => {\n      const { type } = props;\n      if ([\"week\", \"month\", \"year\", \"dates\"].includes(type))\n        return type;\n      return \"date\";\n    });\n    const keyboardMode = computed(() => {\n      return selectionMode.value === \"date\" ? currentView.value : selectionMode.value;\n    });\n    const hasShortcuts = computed(() => !!shortcuts.length);\n    const handleMonthPick = async (month2) => {\n      innerDate.value = innerDate.value.startOf(\"month\").month(month2);\n      if (selectionMode.value === \"month\") {\n        emit(innerDate.value, false);\n      } else {\n        currentView.value = \"date\";\n        if ([\"month\", \"year\", \"date\", \"week\"].includes(selectionMode.value)) {\n          emit(innerDate.value, true);\n          await nextTick();\n          handleFocusPicker();\n        }\n      }\n      handlePanelChange(\"month\");\n    };\n    const handleYearPick = async (year2) => {\n      if (selectionMode.value === \"year\") {\n        innerDate.value = innerDate.value.startOf(\"year\").year(year2);\n        emit(innerDate.value, false);\n      } else {\n        innerDate.value = innerDate.value.year(year2);\n        currentView.value = \"month\";\n        if ([\"month\", \"year\", \"date\", \"week\"].includes(selectionMode.value)) {\n          emit(innerDate.value, true);\n          await nextTick();\n          handleFocusPicker();\n        }\n      }\n      handlePanelChange(\"year\");\n    };\n    const showPicker = async (view) => {\n      currentView.value = view;\n      await nextTick();\n      handleFocusPicker();\n    };\n    const showTime = computed(() => props.type === \"datetime\" || props.type === \"datetimerange\");\n    const footerVisible = computed(() => {\n      return showTime.value || selectionMode.value === \"dates\";\n    });\n    const disabledConfirm = computed(() => {\n      if (!disabledDate)\n        return false;\n      if (!props.parsedValue)\n        return true;\n      if (isArray(props.parsedValue)) {\n        return disabledDate(props.parsedValue[0].toDate());\n      }\n      return disabledDate(props.parsedValue.toDate());\n    });\n    const onConfirm = () => {\n      if (selectionMode.value === \"dates\") {\n        emit(props.parsedValue);\n      } else {\n        let result = props.parsedValue;\n        if (!result) {\n          const defaultTimeD2 = dayjs(defaultTime).locale(lang.value);\n          const defaultValueD = getDefaultValue();\n          result = defaultTimeD2.year(defaultValueD.year()).month(defaultValueD.month()).date(defaultValueD.date());\n        }\n        innerDate.value = result;\n        emit(result);\n      }\n    };\n    const disabledNow = computed(() => {\n      if (!disabledDate)\n        return false;\n      return disabledDate(dayjs().locale(lang.value).toDate());\n    });\n    const changeToNow = () => {\n      const now = dayjs().locale(lang.value);\n      const nowDate = now.toDate();\n      isChangeToNow.value = true;\n      if ((!disabledDate || !disabledDate(nowDate)) && checkDateWithinRange(nowDate)) {\n        innerDate.value = dayjs().locale(lang.value);\n        emit(innerDate.value);\n      }\n    };\n    const timeFormat = computed(() => {\n      return extractTimeFormat(props.format);\n    });\n    const dateFormat = computed(() => {\n      return extractDateFormat(props.format);\n    });\n    const visibleTime = computed(() => {\n      if (userInputTime.value)\n        return userInputTime.value;\n      if (!props.parsedValue && !defaultValue.value)\n        return;\n      return (props.parsedValue || innerDate.value).format(timeFormat.value);\n    });\n    const visibleDate = computed(() => {\n      if (userInputDate.value)\n        return userInputDate.value;\n      if (!props.parsedValue && !defaultValue.value)\n        return;\n      return (props.parsedValue || innerDate.value).format(dateFormat.value);\n    });\n    const timePickerVisible = ref(false);\n    const onTimePickerInputFocus = () => {\n      timePickerVisible.value = true;\n    };\n    const handleTimePickClose = () => {\n      timePickerVisible.value = false;\n    };\n    const getUnits = (date) => {\n      return {\n        hour: date.hour(),\n        minute: date.minute(),\n        second: date.second(),\n        year: date.year(),\n        month: date.month(),\n        date: date.date()\n      };\n    };\n    const handleTimePick = (value, visible, first) => {\n      const { hour, minute, second } = getUnits(value);\n      const newDate = props.parsedValue ? props.parsedValue.hour(hour).minute(minute).second(second) : value;\n      innerDate.value = newDate;\n      emit(innerDate.value, true);\n      if (!first) {\n        timePickerVisible.value = visible;\n      }\n    };\n    const handleVisibleTimeChange = (value) => {\n      const newDate = dayjs(value, timeFormat.value).locale(lang.value);\n      if (newDate.isValid() && checkDateWithinRange(newDate)) {\n        const { year: year2, month: month2, date } = getUnits(innerDate.value);\n        innerDate.value = newDate.year(year2).month(month2).date(date);\n        userInputTime.value = null;\n        timePickerVisible.value = false;\n        emit(innerDate.value, true);\n      }\n    };\n    const handleVisibleDateChange = (value) => {\n      const newDate = dayjs(value, dateFormat.value).locale(lang.value);\n      if (newDate.isValid()) {\n        if (disabledDate && disabledDate(newDate.toDate())) {\n          return;\n        }\n        const { hour, minute, second } = getUnits(innerDate.value);\n        innerDate.value = newDate.hour(hour).minute(minute).second(second);\n        userInputDate.value = null;\n        emit(innerDate.value, true);\n      }\n    };\n    const isValidValue = (date) => {\n      return dayjs.isDayjs(date) && date.isValid() && (disabledDate ? !disabledDate(date.toDate()) : true);\n    };\n    const formatToString = (value) => {\n      if (selectionMode.value === \"dates\") {\n        return value.map((_) => _.format(props.format));\n      }\n      return value.format(props.format);\n    };\n    const parseUserInput = (value) => {\n      return dayjs(value, props.format).locale(lang.value);\n    };\n    const getDefaultValue = () => {\n      const parseDate = dayjs(defaultValue.value).locale(lang.value);\n      if (!defaultValue.value) {\n        const defaultTimeDValue = defaultTimeD.value;\n        return dayjs().hour(defaultTimeDValue.hour()).minute(defaultTimeDValue.minute()).second(defaultTimeDValue.second()).locale(lang.value);\n      }\n      return parseDate;\n    };\n    const handleFocusPicker = async () => {\n      var _a;\n      if ([\"week\", \"month\", \"year\", \"date\"].includes(selectionMode.value)) {\n        (_a = currentViewRef.value) == null ? void 0 : _a.focus();\n        if (selectionMode.value === \"week\") {\n          handleKeyControl(EVENT_CODE.down);\n        }\n      }\n    };\n    const handleKeydownTable = (event) => {\n      const { code } = event;\n      const validCode = [\n        EVENT_CODE.up,\n        EVENT_CODE.down,\n        EVENT_CODE.left,\n        EVENT_CODE.right,\n        EVENT_CODE.home,\n        EVENT_CODE.end,\n        EVENT_CODE.pageUp,\n        EVENT_CODE.pageDown\n      ];\n      if (validCode.includes(code)) {\n        handleKeyControl(code);\n        event.stopPropagation();\n        event.preventDefault();\n      }\n      if ([EVENT_CODE.enter, EVENT_CODE.space, EVENT_CODE.numpadEnter].includes(code) && userInputDate.value === null && userInputTime.value === null) {\n        event.preventDefault();\n        emit(innerDate.value, false);\n      }\n    };\n    const handleKeyControl = (code) => {\n      var _a;\n      const { up, down, left, right, home, end, pageUp, pageDown } = EVENT_CODE;\n      const mapping = {\n        year: {\n          [up]: -4,\n          [down]: 4,\n          [left]: -1,\n          [right]: 1,\n          offset: (date, step) => date.setFullYear(date.getFullYear() + step)\n        },\n        month: {\n          [up]: -4,\n          [down]: 4,\n          [left]: -1,\n          [right]: 1,\n          offset: (date, step) => date.setMonth(date.getMonth() + step)\n        },\n        week: {\n          [up]: -1,\n          [down]: 1,\n          [left]: -1,\n          [right]: 1,\n          offset: (date, step) => date.setDate(date.getDate() + step * 7)\n        },\n        date: {\n          [up]: -7,\n          [down]: 7,\n          [left]: -1,\n          [right]: 1,\n          [home]: (date) => -date.getDay(),\n          [end]: (date) => -date.getDay() + 6,\n          [pageUp]: (date) => -new Date(date.getFullYear(), date.getMonth(), 0).getDate(),\n          [pageDown]: (date) => new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate(),\n          offset: (date, step) => date.setDate(date.getDate() + step)\n        }\n      };\n      const newDate = innerDate.value.toDate();\n      while (Math.abs(innerDate.value.diff(newDate, \"year\", true)) < 1) {\n        const map = mapping[keyboardMode.value];\n        if (!map)\n          return;\n        map.offset(newDate, isFunction(map[code]) ? map[code](newDate) : (_a = map[code]) != null ? _a : 0);\n        if (disabledDate && disabledDate(newDate)) {\n          break;\n        }\n        const result = dayjs(newDate).locale(lang.value);\n        innerDate.value = result;\n        contextEmit(\"pick\", result, true);\n        break;\n      }\n    };\n    const handlePanelChange = (mode) => {\n      contextEmit(\"panel-change\", innerDate.value.toDate(), mode, currentView.value);\n    };\n    watch(() => selectionMode.value, (val) => {\n      if ([\"month\", \"year\"].includes(val)) {\n        currentView.value = val;\n        return;\n      }\n      currentView.value = \"date\";\n    }, { immediate: true });\n    watch(() => currentView.value, () => {\n      popper == null ? void 0 : popper.updatePopper();\n    });\n    watch(() => defaultValue.value, (val) => {\n      if (val) {\n        innerDate.value = getDefaultValue();\n      }\n    }, { immediate: true });\n    watch(() => props.parsedValue, (val) => {\n      if (val) {\n        if (selectionMode.value === \"dates\")\n          return;\n        if (Array.isArray(val))\n          return;\n        innerDate.value = val;\n      } else {\n        innerDate.value = getDefaultValue();\n      }\n    }, { immediate: true });\n    contextEmit(\"set-picker-option\", [\"isValidValue\", isValidValue]);\n    contextEmit(\"set-picker-option\", [\"formatToString\", formatToString]);\n    contextEmit(\"set-picker-option\", [\"parseUserInput\", parseUserInput]);\n    contextEmit(\"set-picker-option\", [\"handleFocusPicker\", handleFocusPicker]);\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        class: normalizeClass([\n          unref(ppNs).b(),\n          unref(dpNs).b(),\n          {\n            \"has-sidebar\": _ctx.$slots.sidebar || unref(hasShortcuts),\n            \"has-time\": unref(showTime)\n          }\n        ])\n      }, [\n        createElementVNode(\"div\", {\n          class: normalizeClass(unref(ppNs).e(\"body-wrapper\"))\n        }, [\n          renderSlot(_ctx.$slots, \"sidebar\", {\n            class: normalizeClass(unref(ppNs).e(\"sidebar\"))\n          }),\n          unref(hasShortcuts) ? (openBlock(), createElementBlock(\"div\", {\n            key: 0,\n            class: normalizeClass(unref(ppNs).e(\"sidebar\"))\n          }, [\n            (openBlock(true), createElementBlock(Fragment, null, renderList(unref(shortcuts), (shortcut, key) => {\n              return openBlock(), createElementBlock(\"button\", {\n                key,\n                type: \"button\",\n                class: normalizeClass(unref(ppNs).e(\"shortcut\")),\n                onClick: ($event) => handleShortcutClick(shortcut)\n              }, toDisplayString(shortcut.text), 11, _hoisted_1);\n            }), 128))\n          ], 2)) : createCommentVNode(\"v-if\", true),\n          createElementVNode(\"div\", {\n            class: normalizeClass(unref(ppNs).e(\"body\"))\n          }, [\n            unref(showTime) ? (openBlock(), createElementBlock(\"div\", {\n              key: 0,\n              class: normalizeClass(unref(dpNs).e(\"time-header\"))\n            }, [\n              createElementVNode(\"span\", {\n                class: normalizeClass(unref(dpNs).e(\"editor-wrap\"))\n              }, [\n                createVNode(unref(ElInput), {\n                  placeholder: unref(t)(\"el.datepicker.selectDate\"),\n                  \"model-value\": unref(visibleDate),\n                  size: \"small\",\n                  \"validate-event\": false,\n                  onInput: _cache[0] || (_cache[0] = (val) => userInputDate.value = val),\n                  onChange: handleVisibleDateChange\n                }, null, 8, [\"placeholder\", \"model-value\"])\n              ], 2),\n              withDirectives((openBlock(), createElementBlock(\"span\", {\n                class: normalizeClass(unref(dpNs).e(\"editor-wrap\"))\n              }, [\n                createVNode(unref(ElInput), {\n                  placeholder: unref(t)(\"el.datepicker.selectTime\"),\n                  \"model-value\": unref(visibleTime),\n                  size: \"small\",\n                  \"validate-event\": false,\n                  onFocus: onTimePickerInputFocus,\n                  onInput: _cache[1] || (_cache[1] = (val) => userInputTime.value = val),\n                  onChange: handleVisibleTimeChange\n                }, null, 8, [\"placeholder\", \"model-value\"]),\n                createVNode(unref(TimePickPanel), {\n                  visible: timePickerVisible.value,\n                  format: unref(timeFormat),\n                  \"parsed-value\": innerDate.value,\n                  onPick: handleTimePick\n                }, null, 8, [\"visible\", \"format\", \"parsed-value\"])\n              ], 2)), [\n                [unref(ClickOutside), handleTimePickClose]\n              ])\n            ], 2)) : createCommentVNode(\"v-if\", true),\n            withDirectives(createElementVNode(\"div\", {\n              class: normalizeClass([\n                unref(dpNs).e(\"header\"),\n                (currentView.value === \"year\" || currentView.value === \"month\") && unref(dpNs).e(\"header--bordered\")\n              ])\n            }, [\n              createElementVNode(\"span\", {\n                class: normalizeClass(unref(dpNs).e(\"prev-btn\"))\n              }, [\n                createElementVNode(\"button\", {\n                  type: \"button\",\n                  \"aria-label\": unref(t)(`el.datepicker.prevYear`),\n                  class: normalizeClass([\"d-arrow-left\", unref(ppNs).e(\"icon-btn\")]),\n                  onClick: _cache[2] || (_cache[2] = ($event) => moveByYear(false))\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowLeft))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_2),\n                withDirectives(createElementVNode(\"button\", {\n                  type: \"button\",\n                  \"aria-label\": unref(t)(`el.datepicker.prevMonth`),\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"arrow-left\"]),\n                  onClick: _cache[3] || (_cache[3] = ($event) => moveByMonth(false))\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(ArrowLeft))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_3), [\n                  [vShow, currentView.value === \"date\"]\n                ])\n              ], 2),\n              createElementVNode(\"span\", {\n                role: \"button\",\n                class: normalizeClass(unref(dpNs).e(\"header-label\")),\n                \"aria-live\": \"polite\",\n                tabindex: \"0\",\n                onKeydown: _cache[4] || (_cache[4] = withKeys(($event) => showPicker(\"year\"), [\"enter\"])),\n                onClick: _cache[5] || (_cache[5] = ($event) => showPicker(\"year\"))\n              }, toDisplayString(unref(yearLabel)), 35),\n              withDirectives(createElementVNode(\"span\", {\n                role: \"button\",\n                \"aria-live\": \"polite\",\n                tabindex: \"0\",\n                class: normalizeClass([\n                  unref(dpNs).e(\"header-label\"),\n                  { active: currentView.value === \"month\" }\n                ]),\n                onKeydown: _cache[6] || (_cache[6] = withKeys(($event) => showPicker(\"month\"), [\"enter\"])),\n                onClick: _cache[7] || (_cache[7] = ($event) => showPicker(\"month\"))\n              }, toDisplayString(unref(t)(`el.datepicker.month${unref(month) + 1}`)), 35), [\n                [vShow, currentView.value === \"date\"]\n              ]),\n              createElementVNode(\"span\", {\n                class: normalizeClass(unref(dpNs).e(\"next-btn\"))\n              }, [\n                withDirectives(createElementVNode(\"button\", {\n                  type: \"button\",\n                  \"aria-label\": unref(t)(`el.datepicker.nextMonth`),\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"arrow-right\"]),\n                  onClick: _cache[8] || (_cache[8] = ($event) => moveByMonth(true))\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(ArrowRight))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_4), [\n                  [vShow, currentView.value === \"date\"]\n                ]),\n                createElementVNode(\"button\", {\n                  type: \"button\",\n                  \"aria-label\": unref(t)(`el.datepicker.nextYear`),\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"d-arrow-right\"]),\n                  onClick: _cache[9] || (_cache[9] = ($event) => moveByYear(true))\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowRight))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_5)\n              ], 2)\n            ], 2), [\n              [vShow, currentView.value !== \"time\"]\n            ]),\n            createElementVNode(\"div\", {\n              class: normalizeClass(unref(ppNs).e(\"content\")),\n              onKeydown: handleKeydownTable\n            }, [\n              currentView.value === \"date\" ? (openBlock(), createBlock(DateTable, {\n                key: 0,\n                ref_key: \"currentViewRef\",\n                ref: currentViewRef,\n                \"selection-mode\": unref(selectionMode),\n                date: innerDate.value,\n                \"parsed-value\": _ctx.parsedValue,\n                \"disabled-date\": unref(disabledDate),\n                \"cell-class-name\": unref(cellClassName),\n                onPick: handleDatePick\n              }, null, 8, [\"selection-mode\", \"date\", \"parsed-value\", \"disabled-date\", \"cell-class-name\"])) : createCommentVNode(\"v-if\", true),\n              currentView.value === \"year\" ? (openBlock(), createBlock(YearTable, {\n                key: 1,\n                ref_key: \"currentViewRef\",\n                ref: currentViewRef,\n                date: innerDate.value,\n                \"disabled-date\": unref(disabledDate),\n                \"parsed-value\": _ctx.parsedValue,\n                onPick: handleYearPick\n              }, null, 8, [\"date\", \"disabled-date\", \"parsed-value\"])) : createCommentVNode(\"v-if\", true),\n              currentView.value === \"month\" ? (openBlock(), createBlock(MonthTable, {\n                key: 2,\n                ref_key: \"currentViewRef\",\n                ref: currentViewRef,\n                date: innerDate.value,\n                \"parsed-value\": _ctx.parsedValue,\n                \"disabled-date\": unref(disabledDate),\n                onPick: handleMonthPick\n              }, null, 8, [\"date\", \"parsed-value\", \"disabled-date\"])) : createCommentVNode(\"v-if\", true)\n            ], 34)\n          ], 2)\n        ], 2),\n        withDirectives(createElementVNode(\"div\", {\n          class: normalizeClass(unref(ppNs).e(\"footer\"))\n        }, [\n          withDirectives(createVNode(unref(ElButton), {\n            text: \"\",\n            size: \"small\",\n            class: normalizeClass(unref(ppNs).e(\"link-btn\")),\n            disabled: unref(disabledNow),\n            onClick: changeToNow\n          }, {\n            default: withCtx(() => [\n              createTextVNode(toDisplayString(unref(t)(\"el.datepicker.now\")), 1)\n            ]),\n            _: 1\n          }, 8, [\"class\", \"disabled\"]), [\n            [vShow, unref(selectionMode) !== \"dates\"]\n          ]),\n          createVNode(unref(ElButton), {\n            plain: \"\",\n            size: \"small\",\n            class: normalizeClass(unref(ppNs).e(\"link-btn\")),\n            disabled: unref(disabledConfirm),\n            onClick: onConfirm\n          }, {\n            default: withCtx(() => [\n              createTextVNode(toDisplayString(unref(t)(\"el.datepicker.confirm\")), 1)\n            ]),\n            _: 1\n          }, 8, [\"class\", \"disabled\"])\n        ], 2), [\n          [vShow, unref(footerVisible) && currentView.value === \"date\"]\n        ])\n      ], 2);\n    };\n  }\n});\nvar DatePickPanel = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-date-pick.vue\"]]);\n\nexport { DatePickPanel as default };\n//# sourceMappingURL=panel-date-pick.mjs.map\n","import '../../../../utils/index.mjs';\nimport { panelSharedProps, panelRangeSharedProps } from './shared.mjs';\nimport { buildProps } from '../../../../utils/vue/props/runtime.mjs';\n\nconst panelDateRangeProps = buildProps({\n  ...panelSharedProps,\n  ...panelRangeSharedProps\n});\n\nexport { panelDateRangeProps };\n//# sourceMappingURL=panel-date-range.mjs.map\n","import { getCurrentInstance, useAttrs, useSlots } from 'vue';\nimport dayjs from 'dayjs';\nimport '../../../../utils/index.mjs';\nimport { isFunction } from '@vue/shared';\n\nconst useShortcut = (lang) => {\n  const { emit } = getCurrentInstance();\n  const attrs = useAttrs();\n  const slots = useSlots();\n  const handleShortcutClick = (shortcut) => {\n    const shortcutValues = isFunction(shortcut.value) ? shortcut.value() : shortcut.value;\n    if (shortcutValues) {\n      emit(\"pick\", [\n        dayjs(shortcutValues[0]).locale(lang.value),\n        dayjs(shortcutValues[1]).locale(lang.value)\n      ]);\n      return;\n    }\n    if (shortcut.onClick) {\n      shortcut.onClick({\n        attrs,\n        slots,\n        emit\n      });\n    }\n  };\n  return handleShortcutClick;\n};\n\nexport { useShortcut };\n//# sourceMappingURL=use-shortcut.mjs.map\n","import { getCurrentInstance, inject, ref, unref, watch } from 'vue';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { isValidRange, getDefaultValue } from '../utils.mjs';\nimport { ROOT_PICKER_INJECTION_KEY } from '../constants.mjs';\nimport { useShortcut } from './use-shortcut.mjs';\nimport { useNamespace } from '../../../../hooks/use-namespace/index.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\nimport { isArray } from '@vue/shared';\n\nconst useRangePicker = (props, {\n  defaultValue,\n  leftDate,\n  rightDate,\n  unit,\n  onParsedValueChanged\n}) => {\n  const { emit } = getCurrentInstance();\n  const { pickerNs } = inject(ROOT_PICKER_INJECTION_KEY);\n  const drpNs = useNamespace(\"date-range-picker\");\n  const { t, lang } = useLocale();\n  const handleShortcutClick = useShortcut(lang);\n  const minDate = ref();\n  const maxDate = ref();\n  const rangeState = ref({\n    endDate: null,\n    selecting: false\n  });\n  const handleChangeRange = (val) => {\n    rangeState.value = val;\n  };\n  const handleRangeConfirm = (visible = false) => {\n    const _minDate = unref(minDate);\n    const _maxDate = unref(maxDate);\n    if (isValidRange([_minDate, _maxDate])) {\n      emit(\"pick\", [_minDate, _maxDate], visible);\n    }\n  };\n  const onSelect = (selecting) => {\n    rangeState.value.selecting = selecting;\n    if (!selecting) {\n      rangeState.value.endDate = null;\n    }\n  };\n  const restoreDefault = () => {\n    const [start, end] = getDefaultValue(unref(defaultValue), {\n      lang: unref(lang),\n      unit,\n      unlinkPanels: props.unlinkPanels\n    });\n    minDate.value = void 0;\n    maxDate.value = void 0;\n    leftDate.value = start;\n    rightDate.value = end;\n  };\n  watch(defaultValue, (val) => {\n    if (val) {\n      restoreDefault();\n    }\n  }, { immediate: true });\n  watch(() => props.parsedValue, (parsedValue) => {\n    if (isArray(parsedValue) && parsedValue.length === 2) {\n      const [start, end] = parsedValue;\n      minDate.value = start;\n      leftDate.value = start;\n      maxDate.value = end;\n      onParsedValueChanged(unref(minDate), unref(maxDate));\n    } else {\n      restoreDefault();\n    }\n  }, { immediate: true });\n  return {\n    minDate,\n    maxDate,\n    rangeState,\n    lang,\n    ppNs: pickerNs,\n    drpNs,\n    handleChangeRange,\n    handleRangeConfirm,\n    handleShortcutClick,\n    onSelect,\n    t\n  };\n};\n\nexport { useRangePicker };\n//# sourceMappingURL=use-range-picker.mjs.map\n","import { defineComponent, inject, toRef, ref, computed, unref, openBlock, createElementBlock, normalizeClass, createElementVNode, renderSlot, Fragment, renderList, toDisplayString, createCommentVNode, createVNode, withDirectives, withCtx, createBlock, createTextVNode } from 'vue';\nimport dayjs from 'dayjs';\nimport '../../../../directives/index.mjs';\nimport '../../../../utils/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { ElButton } from '../../../button/index.mjs';\nimport { ElInput } from '../../../input/index.mjs';\nimport '../../../time-picker/index.mjs';\nimport { ElIcon } from '../../../icon/index.mjs';\nimport { ArrowRight, DArrowLeft, ArrowLeft, DArrowRight } from '@element-plus/icons-vue';\nimport { panelDateRangeProps } from '../props/panel-date-range.mjs';\nimport { useRangePicker } from '../composables/use-range-picker.mjs';\nimport { isValidRange, getDefaultValue } from '../utils.mjs';\nimport DateTable from './basic-date-table.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\nimport { extractTimeFormat, extractDateFormat } from '../../../time-picker/src/utils.mjs';\nimport { isArray } from '@vue/shared';\nimport TimePickPanel from '../../../time-picker/src/time-picker-com/panel-time-pick.mjs';\nimport ClickOutside from '../../../../directives/click-outside/index.mjs';\n\nconst _hoisted_1 = [\"onClick\"];\nconst _hoisted_2 = [\"aria-label\"];\nconst _hoisted_3 = [\"aria-label\"];\nconst _hoisted_4 = [\"disabled\", \"aria-label\"];\nconst _hoisted_5 = [\"disabled\", \"aria-label\"];\nconst _hoisted_6 = [\"disabled\", \"aria-label\"];\nconst _hoisted_7 = [\"disabled\", \"aria-label\"];\nconst _hoisted_8 = [\"aria-label\"];\nconst _hoisted_9 = [\"aria-label\"];\nconst unit = \"month\";\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"panel-date-range\",\n  props: panelDateRangeProps,\n  emits: [\n    \"pick\",\n    \"set-picker-option\",\n    \"calendar-change\",\n    \"panel-change\"\n  ],\n  setup(__props, { emit }) {\n    const props = __props;\n    const pickerBase = inject(\"EP_PICKER_BASE\");\n    const { disabledDate, cellClassName, format, defaultTime, clearable } = pickerBase.props;\n    const shortcuts = toRef(pickerBase.props, \"shortcuts\");\n    const defaultValue = toRef(pickerBase.props, \"defaultValue\");\n    const { lang } = useLocale();\n    const leftDate = ref(dayjs().locale(lang.value));\n    const rightDate = ref(dayjs().locale(lang.value).add(1, unit));\n    const {\n      minDate,\n      maxDate,\n      rangeState,\n      ppNs,\n      drpNs,\n      handleChangeRange,\n      handleRangeConfirm,\n      handleShortcutClick,\n      onSelect,\n      t\n    } = useRangePicker(props, {\n      defaultValue,\n      leftDate,\n      rightDate,\n      unit,\n      onParsedValueChanged\n    });\n    const dateUserInput = ref({\n      min: null,\n      max: null\n    });\n    const timeUserInput = ref({\n      min: null,\n      max: null\n    });\n    const leftLabel = computed(() => {\n      return `${leftDate.value.year()} ${t(\"el.datepicker.year\")} ${t(`el.datepicker.month${leftDate.value.month() + 1}`)}`;\n    });\n    const rightLabel = computed(() => {\n      return `${rightDate.value.year()} ${t(\"el.datepicker.year\")} ${t(`el.datepicker.month${rightDate.value.month() + 1}`)}`;\n    });\n    const leftYear = computed(() => {\n      return leftDate.value.year();\n    });\n    const leftMonth = computed(() => {\n      return leftDate.value.month();\n    });\n    const rightYear = computed(() => {\n      return rightDate.value.year();\n    });\n    const rightMonth = computed(() => {\n      return rightDate.value.month();\n    });\n    const hasShortcuts = computed(() => !!shortcuts.value.length);\n    const minVisibleDate = computed(() => {\n      if (dateUserInput.value.min !== null)\n        return dateUserInput.value.min;\n      if (minDate.value)\n        return minDate.value.format(dateFormat.value);\n      return \"\";\n    });\n    const maxVisibleDate = computed(() => {\n      if (dateUserInput.value.max !== null)\n        return dateUserInput.value.max;\n      if (maxDate.value || minDate.value)\n        return (maxDate.value || minDate.value).format(dateFormat.value);\n      return \"\";\n    });\n    const minVisibleTime = computed(() => {\n      if (timeUserInput.value.min !== null)\n        return timeUserInput.value.min;\n      if (minDate.value)\n        return minDate.value.format(timeFormat.value);\n      return \"\";\n    });\n    const maxVisibleTime = computed(() => {\n      if (timeUserInput.value.max !== null)\n        return timeUserInput.value.max;\n      if (maxDate.value || minDate.value)\n        return (maxDate.value || minDate.value).format(timeFormat.value);\n      return \"\";\n    });\n    const timeFormat = computed(() => {\n      return extractTimeFormat(format);\n    });\n    const dateFormat = computed(() => {\n      return extractDateFormat(format);\n    });\n    const isValidValue = (date) => {\n      return isValidRange(date) && (disabledDate ? !disabledDate(date[0].toDate()) && !disabledDate(date[1].toDate()) : true);\n    };\n    const leftPrevYear = () => {\n      leftDate.value = leftDate.value.subtract(1, \"year\");\n      if (!props.unlinkPanels) {\n        rightDate.value = leftDate.value.add(1, \"month\");\n      }\n      handlePanelChange(\"year\");\n    };\n    const leftPrevMonth = () => {\n      leftDate.value = leftDate.value.subtract(1, \"month\");\n      if (!props.unlinkPanels) {\n        rightDate.value = leftDate.value.add(1, \"month\");\n      }\n      handlePanelChange(\"month\");\n    };\n    const rightNextYear = () => {\n      if (!props.unlinkPanels) {\n        leftDate.value = leftDate.value.add(1, \"year\");\n        rightDate.value = leftDate.value.add(1, \"month\");\n      } else {\n        rightDate.value = rightDate.value.add(1, \"year\");\n      }\n      handlePanelChange(\"year\");\n    };\n    const rightNextMonth = () => {\n      if (!props.unlinkPanels) {\n        leftDate.value = leftDate.value.add(1, \"month\");\n        rightDate.value = leftDate.value.add(1, \"month\");\n      } else {\n        rightDate.value = rightDate.value.add(1, \"month\");\n      }\n      handlePanelChange(\"month\");\n    };\n    const leftNextYear = () => {\n      leftDate.value = leftDate.value.add(1, \"year\");\n      handlePanelChange(\"year\");\n    };\n    const leftNextMonth = () => {\n      leftDate.value = leftDate.value.add(1, \"month\");\n      handlePanelChange(\"month\");\n    };\n    const rightPrevYear = () => {\n      rightDate.value = rightDate.value.subtract(1, \"year\");\n      handlePanelChange(\"year\");\n    };\n    const rightPrevMonth = () => {\n      rightDate.value = rightDate.value.subtract(1, \"month\");\n      handlePanelChange(\"month\");\n    };\n    const handlePanelChange = (mode) => {\n      emit(\"panel-change\", [leftDate.value.toDate(), rightDate.value.toDate()], mode);\n    };\n    const enableMonthArrow = computed(() => {\n      const nextMonth = (leftMonth.value + 1) % 12;\n      const yearOffset = leftMonth.value + 1 >= 12 ? 1 : 0;\n      return props.unlinkPanels && new Date(leftYear.value + yearOffset, nextMonth) < new Date(rightYear.value, rightMonth.value);\n    });\n    const enableYearArrow = computed(() => {\n      return props.unlinkPanels && rightYear.value * 12 + rightMonth.value - (leftYear.value * 12 + leftMonth.value + 1) >= 12;\n    });\n    const btnDisabled = computed(() => {\n      return !(minDate.value && maxDate.value && !rangeState.value.selecting && isValidRange([minDate.value, maxDate.value]));\n    });\n    const showTime = computed(() => props.type === \"datetime\" || props.type === \"datetimerange\");\n    const formatEmit = (emitDayjs, index) => {\n      if (!emitDayjs)\n        return;\n      if (defaultTime) {\n        const defaultTimeD = dayjs(defaultTime[index] || defaultTime).locale(lang.value);\n        return defaultTimeD.year(emitDayjs.year()).month(emitDayjs.month()).date(emitDayjs.date());\n      }\n      return emitDayjs;\n    };\n    const handleRangePick = (val, close = true) => {\n      const min_ = val.minDate;\n      const max_ = val.maxDate;\n      const minDate_ = formatEmit(min_, 0);\n      const maxDate_ = formatEmit(max_, 1);\n      if (maxDate.value === maxDate_ && minDate.value === minDate_) {\n        return;\n      }\n      emit(\"calendar-change\", [min_.toDate(), max_ && max_.toDate()]);\n      maxDate.value = maxDate_;\n      minDate.value = minDate_;\n      if (!close || showTime.value)\n        return;\n      handleRangeConfirm();\n    };\n    const minTimePickerVisible = ref(false);\n    const maxTimePickerVisible = ref(false);\n    const handleMinTimeClose = () => {\n      minTimePickerVisible.value = false;\n    };\n    const handleMaxTimeClose = () => {\n      maxTimePickerVisible.value = false;\n    };\n    const handleDateInput = (value, type) => {\n      dateUserInput.value[type] = value;\n      const parsedValueD = dayjs(value, dateFormat.value).locale(lang.value);\n      if (parsedValueD.isValid()) {\n        if (disabledDate && disabledDate(parsedValueD.toDate())) {\n          return;\n        }\n        if (type === \"min\") {\n          leftDate.value = parsedValueD;\n          minDate.value = (minDate.value || leftDate.value).year(parsedValueD.year()).month(parsedValueD.month()).date(parsedValueD.date());\n          if (!props.unlinkPanels && (!maxDate.value || maxDate.value.isBefore(minDate.value))) {\n            rightDate.value = parsedValueD.add(1, \"month\");\n            maxDate.value = minDate.value.add(1, \"month\");\n          }\n        } else {\n          rightDate.value = parsedValueD;\n          maxDate.value = (maxDate.value || rightDate.value).year(parsedValueD.year()).month(parsedValueD.month()).date(parsedValueD.date());\n          if (!props.unlinkPanels && (!minDate.value || minDate.value.isAfter(maxDate.value))) {\n            leftDate.value = parsedValueD.subtract(1, \"month\");\n            minDate.value = maxDate.value.subtract(1, \"month\");\n          }\n        }\n      }\n    };\n    const handleDateChange = (_, type) => {\n      dateUserInput.value[type] = null;\n    };\n    const handleTimeInput = (value, type) => {\n      timeUserInput.value[type] = value;\n      const parsedValueD = dayjs(value, timeFormat.value).locale(lang.value);\n      if (parsedValueD.isValid()) {\n        if (type === \"min\") {\n          minTimePickerVisible.value = true;\n          minDate.value = (minDate.value || leftDate.value).hour(parsedValueD.hour()).minute(parsedValueD.minute()).second(parsedValueD.second());\n          if (!maxDate.value || maxDate.value.isBefore(minDate.value)) {\n            maxDate.value = minDate.value;\n          }\n        } else {\n          maxTimePickerVisible.value = true;\n          maxDate.value = (maxDate.value || rightDate.value).hour(parsedValueD.hour()).minute(parsedValueD.minute()).second(parsedValueD.second());\n          rightDate.value = maxDate.value;\n          if (maxDate.value && maxDate.value.isBefore(minDate.value)) {\n            minDate.value = maxDate.value;\n          }\n        }\n      }\n    };\n    const handleTimeChange = (value, type) => {\n      timeUserInput.value[type] = null;\n      if (type === \"min\") {\n        leftDate.value = minDate.value;\n        minTimePickerVisible.value = false;\n      } else {\n        rightDate.value = maxDate.value;\n        maxTimePickerVisible.value = false;\n      }\n    };\n    const handleMinTimePick = (value, visible, first) => {\n      if (timeUserInput.value.min)\n        return;\n      if (value) {\n        leftDate.value = value;\n        minDate.value = (minDate.value || leftDate.value).hour(value.hour()).minute(value.minute()).second(value.second());\n      }\n      if (!first) {\n        minTimePickerVisible.value = visible;\n      }\n      if (!maxDate.value || maxDate.value.isBefore(minDate.value)) {\n        maxDate.value = minDate.value;\n        rightDate.value = value;\n      }\n    };\n    const handleMaxTimePick = (value, visible, first) => {\n      if (timeUserInput.value.max)\n        return;\n      if (value) {\n        rightDate.value = value;\n        maxDate.value = (maxDate.value || rightDate.value).hour(value.hour()).minute(value.minute()).second(value.second());\n      }\n      if (!first) {\n        maxTimePickerVisible.value = visible;\n      }\n      if (maxDate.value && maxDate.value.isBefore(minDate.value)) {\n        minDate.value = maxDate.value;\n      }\n    };\n    const handleClear = () => {\n      leftDate.value = getDefaultValue(unref(defaultValue), {\n        lang: unref(lang),\n        unit: \"month\",\n        unlinkPanels: props.unlinkPanels\n      })[0];\n      rightDate.value = leftDate.value.add(1, \"month\");\n      emit(\"pick\", null);\n    };\n    const formatToString = (value) => {\n      return isArray(value) ? value.map((_) => _.format(format)) : value.format(format);\n    };\n    const parseUserInput = (value) => {\n      return isArray(value) ? value.map((_) => dayjs(_, format).locale(lang.value)) : dayjs(value, format).locale(lang.value);\n    };\n    function onParsedValueChanged(minDate2, maxDate2) {\n      if (props.unlinkPanels && maxDate2) {\n        const minDateYear = (minDate2 == null ? void 0 : minDate2.year()) || 0;\n        const minDateMonth = (minDate2 == null ? void 0 : minDate2.month()) || 0;\n        const maxDateYear = maxDate2.year();\n        const maxDateMonth = maxDate2.month();\n        rightDate.value = minDateYear === maxDateYear && minDateMonth === maxDateMonth ? maxDate2.add(1, unit) : maxDate2;\n      } else {\n        rightDate.value = leftDate.value.add(1, unit);\n        if (maxDate2) {\n          rightDate.value = rightDate.value.hour(maxDate2.hour()).minute(maxDate2.minute()).second(maxDate2.second());\n        }\n      }\n    }\n    emit(\"set-picker-option\", [\"isValidValue\", isValidValue]);\n    emit(\"set-picker-option\", [\"parseUserInput\", parseUserInput]);\n    emit(\"set-picker-option\", [\"formatToString\", formatToString]);\n    emit(\"set-picker-option\", [\"handleClear\", handleClear]);\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        class: normalizeClass([\n          unref(ppNs).b(),\n          unref(drpNs).b(),\n          {\n            \"has-sidebar\": _ctx.$slots.sidebar || unref(hasShortcuts),\n            \"has-time\": unref(showTime)\n          }\n        ])\n      }, [\n        createElementVNode(\"div\", {\n          class: normalizeClass(unref(ppNs).e(\"body-wrapper\"))\n        }, [\n          renderSlot(_ctx.$slots, \"sidebar\", {\n            class: normalizeClass(unref(ppNs).e(\"sidebar\"))\n          }),\n          unref(hasShortcuts) ? (openBlock(), createElementBlock(\"div\", {\n            key: 0,\n            class: normalizeClass(unref(ppNs).e(\"sidebar\"))\n          }, [\n            (openBlock(true), createElementBlock(Fragment, null, renderList(unref(shortcuts), (shortcut, key) => {\n              return openBlock(), createElementBlock(\"button\", {\n                key,\n                type: \"button\",\n                class: normalizeClass(unref(ppNs).e(\"shortcut\")),\n                onClick: ($event) => unref(handleShortcutClick)(shortcut)\n              }, toDisplayString(shortcut.text), 11, _hoisted_1);\n            }), 128))\n          ], 2)) : createCommentVNode(\"v-if\", true),\n          createElementVNode(\"div\", {\n            class: normalizeClass(unref(ppNs).e(\"body\"))\n          }, [\n            unref(showTime) ? (openBlock(), createElementBlock(\"div\", {\n              key: 0,\n              class: normalizeClass(unref(drpNs).e(\"time-header\"))\n            }, [\n              createElementVNode(\"span\", {\n                class: normalizeClass(unref(drpNs).e(\"editors-wrap\"))\n              }, [\n                createElementVNode(\"span\", {\n                  class: normalizeClass(unref(drpNs).e(\"time-picker-wrap\"))\n                }, [\n                  createVNode(unref(ElInput), {\n                    size: \"small\",\n                    disabled: unref(rangeState).selecting,\n                    placeholder: unref(t)(\"el.datepicker.startDate\"),\n                    class: normalizeClass(unref(drpNs).e(\"editor\")),\n                    \"model-value\": unref(minVisibleDate),\n                    \"validate-event\": false,\n                    onInput: _cache[0] || (_cache[0] = (val) => handleDateInput(val, \"min\")),\n                    onChange: _cache[1] || (_cache[1] = (val) => handleDateChange(val, \"min\"))\n                  }, null, 8, [\"disabled\", \"placeholder\", \"class\", \"model-value\"])\n                ], 2),\n                withDirectives((openBlock(), createElementBlock(\"span\", {\n                  class: normalizeClass(unref(drpNs).e(\"time-picker-wrap\"))\n                }, [\n                  createVNode(unref(ElInput), {\n                    size: \"small\",\n                    class: normalizeClass(unref(drpNs).e(\"editor\")),\n                    disabled: unref(rangeState).selecting,\n                    placeholder: unref(t)(\"el.datepicker.startTime\"),\n                    \"model-value\": unref(minVisibleTime),\n                    \"validate-event\": false,\n                    onFocus: _cache[2] || (_cache[2] = ($event) => minTimePickerVisible.value = true),\n                    onInput: _cache[3] || (_cache[3] = (val) => handleTimeInput(val, \"min\")),\n                    onChange: _cache[4] || (_cache[4] = (val) => handleTimeChange(val, \"min\"))\n                  }, null, 8, [\"class\", \"disabled\", \"placeholder\", \"model-value\"]),\n                  createVNode(unref(TimePickPanel), {\n                    visible: minTimePickerVisible.value,\n                    format: unref(timeFormat),\n                    \"datetime-role\": \"start\",\n                    \"parsed-value\": leftDate.value,\n                    onPick: handleMinTimePick\n                  }, null, 8, [\"visible\", \"format\", \"parsed-value\"])\n                ], 2)), [\n                  [unref(ClickOutside), handleMinTimeClose]\n                ])\n              ], 2),\n              createElementVNode(\"span\", null, [\n                createVNode(unref(ElIcon), null, {\n                  default: withCtx(() => [\n                    createVNode(unref(ArrowRight))\n                  ]),\n                  _: 1\n                })\n              ]),\n              createElementVNode(\"span\", {\n                class: normalizeClass([unref(drpNs).e(\"editors-wrap\"), \"is-right\"])\n              }, [\n                createElementVNode(\"span\", {\n                  class: normalizeClass(unref(drpNs).e(\"time-picker-wrap\"))\n                }, [\n                  createVNode(unref(ElInput), {\n                    size: \"small\",\n                    class: normalizeClass(unref(drpNs).e(\"editor\")),\n                    disabled: unref(rangeState).selecting,\n                    placeholder: unref(t)(\"el.datepicker.endDate\"),\n                    \"model-value\": unref(maxVisibleDate),\n                    readonly: !unref(minDate),\n                    \"validate-event\": false,\n                    onInput: _cache[5] || (_cache[5] = (val) => handleDateInput(val, \"max\")),\n                    onChange: _cache[6] || (_cache[6] = (val) => handleDateChange(val, \"max\"))\n                  }, null, 8, [\"class\", \"disabled\", \"placeholder\", \"model-value\", \"readonly\"])\n                ], 2),\n                withDirectives((openBlock(), createElementBlock(\"span\", {\n                  class: normalizeClass(unref(drpNs).e(\"time-picker-wrap\"))\n                }, [\n                  createVNode(unref(ElInput), {\n                    size: \"small\",\n                    class: normalizeClass(unref(drpNs).e(\"editor\")),\n                    disabled: unref(rangeState).selecting,\n                    placeholder: unref(t)(\"el.datepicker.endTime\"),\n                    \"model-value\": unref(maxVisibleTime),\n                    readonly: !unref(minDate),\n                    \"validate-event\": false,\n                    onFocus: _cache[7] || (_cache[7] = ($event) => unref(minDate) && (maxTimePickerVisible.value = true)),\n                    onInput: _cache[8] || (_cache[8] = (val) => handleTimeInput(val, \"max\")),\n                    onChange: _cache[9] || (_cache[9] = (val) => handleTimeChange(val, \"max\"))\n                  }, null, 8, [\"class\", \"disabled\", \"placeholder\", \"model-value\", \"readonly\"]),\n                  createVNode(unref(TimePickPanel), {\n                    \"datetime-role\": \"end\",\n                    visible: maxTimePickerVisible.value,\n                    format: unref(timeFormat),\n                    \"parsed-value\": rightDate.value,\n                    onPick: handleMaxTimePick\n                  }, null, 8, [\"visible\", \"format\", \"parsed-value\"])\n                ], 2)), [\n                  [unref(ClickOutside), handleMaxTimeClose]\n                ])\n              ], 2)\n            ], 2)) : createCommentVNode(\"v-if\", true),\n            createElementVNode(\"div\", {\n              class: normalizeClass([[unref(ppNs).e(\"content\"), unref(drpNs).e(\"content\")], \"is-left\"])\n            }, [\n              createElementVNode(\"div\", {\n                class: normalizeClass(unref(drpNs).e(\"header\"))\n              }, [\n                createElementVNode(\"button\", {\n                  type: \"button\",\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"d-arrow-left\"]),\n                  \"aria-label\": unref(t)(`el.datepicker.prevYear`),\n                  onClick: leftPrevYear\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowLeft))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_2),\n                createElementVNode(\"button\", {\n                  type: \"button\",\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"arrow-left\"]),\n                  \"aria-label\": unref(t)(`el.datepicker.prevMonth`),\n                  onClick: leftPrevMonth\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(ArrowLeft))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_3),\n                _ctx.unlinkPanels ? (openBlock(), createElementBlock(\"button\", {\n                  key: 0,\n                  type: \"button\",\n                  disabled: !unref(enableYearArrow),\n                  class: normalizeClass([[unref(ppNs).e(\"icon-btn\"), { \"is-disabled\": !unref(enableYearArrow) }], \"d-arrow-right\"]),\n                  \"aria-label\": unref(t)(`el.datepicker.nextYear`),\n                  onClick: leftNextYear\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowRight))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_4)) : createCommentVNode(\"v-if\", true),\n                _ctx.unlinkPanels ? (openBlock(), createElementBlock(\"button\", {\n                  key: 1,\n                  type: \"button\",\n                  disabled: !unref(enableMonthArrow),\n                  class: normalizeClass([[\n                    unref(ppNs).e(\"icon-btn\"),\n                    { \"is-disabled\": !unref(enableMonthArrow) }\n                  ], \"arrow-right\"]),\n                  \"aria-label\": unref(t)(`el.datepicker.nextMonth`),\n                  onClick: leftNextMonth\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(ArrowRight))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_5)) : createCommentVNode(\"v-if\", true),\n                createElementVNode(\"div\", null, toDisplayString(unref(leftLabel)), 1)\n              ], 2),\n              createVNode(DateTable, {\n                \"selection-mode\": \"range\",\n                date: leftDate.value,\n                \"min-date\": unref(minDate),\n                \"max-date\": unref(maxDate),\n                \"range-state\": unref(rangeState),\n                \"disabled-date\": unref(disabledDate),\n                \"cell-class-name\": unref(cellClassName),\n                onChangerange: unref(handleChangeRange),\n                onPick: handleRangePick,\n                onSelect: unref(onSelect)\n              }, null, 8, [\"date\", \"min-date\", \"max-date\", \"range-state\", \"disabled-date\", \"cell-class-name\", \"onChangerange\", \"onSelect\"])\n            ], 2),\n            createElementVNode(\"div\", {\n              class: normalizeClass([[unref(ppNs).e(\"content\"), unref(drpNs).e(\"content\")], \"is-right\"])\n            }, [\n              createElementVNode(\"div\", {\n                class: normalizeClass(unref(drpNs).e(\"header\"))\n              }, [\n                _ctx.unlinkPanels ? (openBlock(), createElementBlock(\"button\", {\n                  key: 0,\n                  type: \"button\",\n                  disabled: !unref(enableYearArrow),\n                  class: normalizeClass([[unref(ppNs).e(\"icon-btn\"), { \"is-disabled\": !unref(enableYearArrow) }], \"d-arrow-left\"]),\n                  \"aria-label\": unref(t)(`el.datepicker.prevYear`),\n                  onClick: rightPrevYear\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowLeft))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_6)) : createCommentVNode(\"v-if\", true),\n                _ctx.unlinkPanels ? (openBlock(), createElementBlock(\"button\", {\n                  key: 1,\n                  type: \"button\",\n                  disabled: !unref(enableMonthArrow),\n                  class: normalizeClass([[\n                    unref(ppNs).e(\"icon-btn\"),\n                    { \"is-disabled\": !unref(enableMonthArrow) }\n                  ], \"arrow-left\"]),\n                  \"aria-label\": unref(t)(`el.datepicker.prevMonth`),\n                  onClick: rightPrevMonth\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(ArrowLeft))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_7)) : createCommentVNode(\"v-if\", true),\n                createElementVNode(\"button\", {\n                  type: \"button\",\n                  \"aria-label\": unref(t)(`el.datepicker.nextYear`),\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"d-arrow-right\"]),\n                  onClick: rightNextYear\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowRight))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_8),\n                createElementVNode(\"button\", {\n                  type: \"button\",\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"arrow-right\"]),\n                  \"aria-label\": unref(t)(`el.datepicker.nextMonth`),\n                  onClick: rightNextMonth\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(ArrowRight))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_9),\n                createElementVNode(\"div\", null, toDisplayString(unref(rightLabel)), 1)\n              ], 2),\n              createVNode(DateTable, {\n                \"selection-mode\": \"range\",\n                date: rightDate.value,\n                \"min-date\": unref(minDate),\n                \"max-date\": unref(maxDate),\n                \"range-state\": unref(rangeState),\n                \"disabled-date\": unref(disabledDate),\n                \"cell-class-name\": unref(cellClassName),\n                onChangerange: unref(handleChangeRange),\n                onPick: handleRangePick,\n                onSelect: unref(onSelect)\n              }, null, 8, [\"date\", \"min-date\", \"max-date\", \"range-state\", \"disabled-date\", \"cell-class-name\", \"onChangerange\", \"onSelect\"])\n            ], 2)\n          ], 2)\n        ], 2),\n        unref(showTime) ? (openBlock(), createElementBlock(\"div\", {\n          key: 0,\n          class: normalizeClass(unref(ppNs).e(\"footer\"))\n        }, [\n          unref(clearable) ? (openBlock(), createBlock(unref(ElButton), {\n            key: 0,\n            text: \"\",\n            size: \"small\",\n            class: normalizeClass(unref(ppNs).e(\"link-btn\")),\n            onClick: handleClear\n          }, {\n            default: withCtx(() => [\n              createTextVNode(toDisplayString(unref(t)(\"el.datepicker.clear\")), 1)\n            ]),\n            _: 1\n          }, 8, [\"class\"])) : createCommentVNode(\"v-if\", true),\n          createVNode(unref(ElButton), {\n            plain: \"\",\n            size: \"small\",\n            class: normalizeClass(unref(ppNs).e(\"link-btn\")),\n            disabled: unref(btnDisabled),\n            onClick: _cache[10] || (_cache[10] = ($event) => unref(handleRangeConfirm)(false))\n          }, {\n            default: withCtx(() => [\n              createTextVNode(toDisplayString(unref(t)(\"el.datepicker.confirm\")), 1)\n            ]),\n            _: 1\n          }, 8, [\"class\", \"disabled\"])\n        ], 2)) : createCommentVNode(\"v-if\", true)\n      ], 2);\n    };\n  }\n});\nvar DateRangePickPanel = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-date-range.vue\"]]);\n\nexport { DateRangePickPanel as default };\n//# sourceMappingURL=panel-date-range.mjs.map\n","import '../../../../utils/index.mjs';\nimport { panelRangeSharedProps } from './shared.mjs';\nimport { buildProps } from '../../../../utils/vue/props/runtime.mjs';\n\nconst panelMonthRangeProps = buildProps({\n  ...panelRangeSharedProps\n});\nconst panelMonthRangeEmits = [\n  \"pick\",\n  \"set-picker-option\",\n  \"calendar-change\"\n];\n\nexport { panelMonthRangeEmits, panelMonthRangeProps };\n//# sourceMappingURL=panel-month-range.mjs.map\n","import { computed } from 'vue';\nimport '../../../../hooks/index.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\n\nconst useMonthRangeHeader = ({\n  unlinkPanels,\n  leftDate,\n  rightDate\n}) => {\n  const { t } = useLocale();\n  const leftPrevYear = () => {\n    leftDate.value = leftDate.value.subtract(1, \"year\");\n    if (!unlinkPanels.value) {\n      rightDate.value = rightDate.value.subtract(1, \"year\");\n    }\n  };\n  const rightNextYear = () => {\n    if (!unlinkPanels.value) {\n      leftDate.value = leftDate.value.add(1, \"year\");\n    }\n    rightDate.value = rightDate.value.add(1, \"year\");\n  };\n  const leftNextYear = () => {\n    leftDate.value = leftDate.value.add(1, \"year\");\n  };\n  const rightPrevYear = () => {\n    rightDate.value = rightDate.value.subtract(1, \"year\");\n  };\n  const leftLabel = computed(() => {\n    return `${leftDate.value.year()} ${t(\"el.datepicker.year\")}`;\n  });\n  const rightLabel = computed(() => {\n    return `${rightDate.value.year()} ${t(\"el.datepicker.year\")}`;\n  });\n  const leftYear = computed(() => {\n    return leftDate.value.year();\n  });\n  const rightYear = computed(() => {\n    return rightDate.value.year() === leftDate.value.year() ? leftDate.value.year() + 1 : rightDate.value.year();\n  });\n  return {\n    leftPrevYear,\n    rightNextYear,\n    leftNextYear,\n    rightPrevYear,\n    leftLabel,\n    rightLabel,\n    leftYear,\n    rightYear\n  };\n};\n\nexport { useMonthRangeHeader };\n//# sourceMappingURL=use-month-range-header.mjs.map\n","import { defineComponent, inject, toRef, ref, computed, openBlock, createElementBlock, normalizeClass, unref, createElementVNode, renderSlot, Fragment, renderList, toDisplayString, createCommentVNode, createVNode, withCtx } from 'vue';\nimport dayjs from 'dayjs';\nimport { ElIcon } from '../../../icon/index.mjs';\nimport '../../../../hooks/index.mjs';\nimport { DArrowLeft, DArrowRight } from '@element-plus/icons-vue';\nimport { panelMonthRangeProps, panelMonthRangeEmits } from '../props/panel-month-range.mjs';\nimport { useMonthRangeHeader } from '../composables/use-month-range-header.mjs';\nimport { useRangePicker } from '../composables/use-range-picker.mjs';\nimport MonthTable from './basic-month-table.mjs';\nimport _export_sfc from '../../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useLocale } from '../../../../hooks/use-locale/index.mjs';\n\nconst _hoisted_1 = [\"onClick\"];\nconst _hoisted_2 = [\"disabled\"];\nconst _hoisted_3 = [\"disabled\"];\nconst unit = \"year\";\nconst __default__ = defineComponent({\n  name: \"DatePickerMonthRange\"\n});\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  ...__default__,\n  props: panelMonthRangeProps,\n  emits: panelMonthRangeEmits,\n  setup(__props, { emit }) {\n    const props = __props;\n    const { lang } = useLocale();\n    const pickerBase = inject(\"EP_PICKER_BASE\");\n    const { shortcuts, disabledDate, format } = pickerBase.props;\n    const defaultValue = toRef(pickerBase.props, \"defaultValue\");\n    const leftDate = ref(dayjs().locale(lang.value));\n    const rightDate = ref(dayjs().locale(lang.value).add(1, unit));\n    const {\n      minDate,\n      maxDate,\n      rangeState,\n      ppNs,\n      drpNs,\n      handleChangeRange,\n      handleRangeConfirm,\n      handleShortcutClick,\n      onSelect\n    } = useRangePicker(props, {\n      defaultValue,\n      leftDate,\n      rightDate,\n      unit,\n      onParsedValueChanged\n    });\n    const hasShortcuts = computed(() => !!shortcuts.length);\n    const {\n      leftPrevYear,\n      rightNextYear,\n      leftNextYear,\n      rightPrevYear,\n      leftLabel,\n      rightLabel,\n      leftYear,\n      rightYear\n    } = useMonthRangeHeader({\n      unlinkPanels: toRef(props, \"unlinkPanels\"),\n      leftDate,\n      rightDate\n    });\n    const enableYearArrow = computed(() => {\n      return props.unlinkPanels && rightYear.value > leftYear.value + 1;\n    });\n    const handleRangePick = (val, close = true) => {\n      const minDate_ = val.minDate;\n      const maxDate_ = val.maxDate;\n      if (maxDate.value === maxDate_ && minDate.value === minDate_) {\n        return;\n      }\n      emit(\"calendar-change\", [minDate_.toDate(), maxDate_ && maxDate_.toDate()]);\n      maxDate.value = maxDate_;\n      minDate.value = minDate_;\n      if (!close)\n        return;\n      handleRangeConfirm();\n    };\n    const formatToString = (days) => {\n      return days.map((day) => day.format(format));\n    };\n    function onParsedValueChanged(minDate2, maxDate2) {\n      if (props.unlinkPanels && maxDate2) {\n        const minDateYear = (minDate2 == null ? void 0 : minDate2.year()) || 0;\n        const maxDateYear = maxDate2.year();\n        rightDate.value = minDateYear === maxDateYear ? maxDate2.add(1, unit) : maxDate2;\n      } else {\n        rightDate.value = leftDate.value.add(1, unit);\n      }\n    }\n    emit(\"set-picker-option\", [\"formatToString\", formatToString]);\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        class: normalizeClass([\n          unref(ppNs).b(),\n          unref(drpNs).b(),\n          {\n            \"has-sidebar\": Boolean(_ctx.$slots.sidebar) || unref(hasShortcuts)\n          }\n        ])\n      }, [\n        createElementVNode(\"div\", {\n          class: normalizeClass(unref(ppNs).e(\"body-wrapper\"))\n        }, [\n          renderSlot(_ctx.$slots, \"sidebar\", {\n            class: normalizeClass(unref(ppNs).e(\"sidebar\"))\n          }),\n          unref(hasShortcuts) ? (openBlock(), createElementBlock(\"div\", {\n            key: 0,\n            class: normalizeClass(unref(ppNs).e(\"sidebar\"))\n          }, [\n            (openBlock(true), createElementBlock(Fragment, null, renderList(unref(shortcuts), (shortcut, key) => {\n              return openBlock(), createElementBlock(\"button\", {\n                key,\n                type: \"button\",\n                class: normalizeClass(unref(ppNs).e(\"shortcut\")),\n                onClick: ($event) => unref(handleShortcutClick)(shortcut)\n              }, toDisplayString(shortcut.text), 11, _hoisted_1);\n            }), 128))\n          ], 2)) : createCommentVNode(\"v-if\", true),\n          createElementVNode(\"div\", {\n            class: normalizeClass(unref(ppNs).e(\"body\"))\n          }, [\n            createElementVNode(\"div\", {\n              class: normalizeClass([[unref(ppNs).e(\"content\"), unref(drpNs).e(\"content\")], \"is-left\"])\n            }, [\n              createElementVNode(\"div\", {\n                class: normalizeClass(unref(drpNs).e(\"header\"))\n              }, [\n                createElementVNode(\"button\", {\n                  type: \"button\",\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"d-arrow-left\"]),\n                  onClick: _cache[0] || (_cache[0] = (...args) => unref(leftPrevYear) && unref(leftPrevYear)(...args))\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowLeft))\n                    ]),\n                    _: 1\n                  })\n                ], 2),\n                _ctx.unlinkPanels ? (openBlock(), createElementBlock(\"button\", {\n                  key: 0,\n                  type: \"button\",\n                  disabled: !unref(enableYearArrow),\n                  class: normalizeClass([[\n                    unref(ppNs).e(\"icon-btn\"),\n                    { [unref(ppNs).is(\"disabled\")]: !unref(enableYearArrow) }\n                  ], \"d-arrow-right\"]),\n                  onClick: _cache[1] || (_cache[1] = (...args) => unref(leftNextYear) && unref(leftNextYear)(...args))\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowRight))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_2)) : createCommentVNode(\"v-if\", true),\n                createElementVNode(\"div\", null, toDisplayString(unref(leftLabel)), 1)\n              ], 2),\n              createVNode(MonthTable, {\n                \"selection-mode\": \"range\",\n                date: leftDate.value,\n                \"min-date\": unref(minDate),\n                \"max-date\": unref(maxDate),\n                \"range-state\": unref(rangeState),\n                \"disabled-date\": unref(disabledDate),\n                onChangerange: unref(handleChangeRange),\n                onPick: handleRangePick,\n                onSelect: unref(onSelect)\n              }, null, 8, [\"date\", \"min-date\", \"max-date\", \"range-state\", \"disabled-date\", \"onChangerange\", \"onSelect\"])\n            ], 2),\n            createElementVNode(\"div\", {\n              class: normalizeClass([[unref(ppNs).e(\"content\"), unref(drpNs).e(\"content\")], \"is-right\"])\n            }, [\n              createElementVNode(\"div\", {\n                class: normalizeClass(unref(drpNs).e(\"header\"))\n              }, [\n                _ctx.unlinkPanels ? (openBlock(), createElementBlock(\"button\", {\n                  key: 0,\n                  type: \"button\",\n                  disabled: !unref(enableYearArrow),\n                  class: normalizeClass([[unref(ppNs).e(\"icon-btn\"), { \"is-disabled\": !unref(enableYearArrow) }], \"d-arrow-left\"]),\n                  onClick: _cache[2] || (_cache[2] = (...args) => unref(rightPrevYear) && unref(rightPrevYear)(...args))\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowLeft))\n                    ]),\n                    _: 1\n                  })\n                ], 10, _hoisted_3)) : createCommentVNode(\"v-if\", true),\n                createElementVNode(\"button\", {\n                  type: \"button\",\n                  class: normalizeClass([unref(ppNs).e(\"icon-btn\"), \"d-arrow-right\"]),\n                  onClick: _cache[3] || (_cache[3] = (...args) => unref(rightNextYear) && unref(rightNextYear)(...args))\n                }, [\n                  createVNode(unref(ElIcon), null, {\n                    default: withCtx(() => [\n                      createVNode(unref(DArrowRight))\n                    ]),\n                    _: 1\n                  })\n                ], 2),\n                createElementVNode(\"div\", null, toDisplayString(unref(rightLabel)), 1)\n              ], 2),\n              createVNode(MonthTable, {\n                \"selection-mode\": \"range\",\n                date: rightDate.value,\n                \"min-date\": unref(minDate),\n                \"max-date\": unref(maxDate),\n                \"range-state\": unref(rangeState),\n                \"disabled-date\": unref(disabledDate),\n                onChangerange: unref(handleChangeRange),\n                onPick: handleRangePick,\n                onSelect: unref(onSelect)\n              }, null, 8, [\"date\", \"min-date\", \"max-date\", \"range-state\", \"disabled-date\", \"onChangerange\", \"onSelect\"])\n            ], 2)\n          ], 2)\n        ], 2)\n      ], 2);\n    };\n  }\n});\nvar MonthRangePickPanel = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-month-range.vue\"]]);\n\nexport { MonthRangePickPanel as default };\n//# sourceMappingURL=panel-month-range.mjs.map\n","import DatePickPanel from './date-picker-com/panel-date-pick.mjs';\nimport DateRangePickPanel from './date-picker-com/panel-date-range.mjs';\nimport MonthRangePickPanel from './date-picker-com/panel-month-range.mjs';\n\nconst getPanel = function(type) {\n  switch (type) {\n    case \"daterange\":\n    case \"datetimerange\": {\n      return DateRangePickPanel;\n    }\n    case \"monthrange\": {\n      return MonthRangePickPanel;\n    }\n    default: {\n      return DatePickPanel;\n    }\n  }\n};\n\nexport { getPanel };\n//# sourceMappingURL=panel-utils.mjs.map\n","import { defineComponent, provide, reactive, toRef, ref, createVNode, mergeProps } from 'vue';\nimport dayjs from 'dayjs';\nimport customParseFormat from 'dayjs/plugin/customParseFormat.js';\nimport advancedFormat from 'dayjs/plugin/advancedFormat.js';\nimport localeData from 'dayjs/plugin/localeData.js';\nimport weekOfYear from 'dayjs/plugin/weekOfYear.js';\nimport weekYear from 'dayjs/plugin/weekYear.js';\nimport dayOfYear from 'dayjs/plugin/dayOfYear.js';\nimport isSameOrAfter from 'dayjs/plugin/isSameOrAfter.js';\nimport isSameOrBefore from 'dayjs/plugin/isSameOrBefore.js';\nimport '../../../hooks/index.mjs';\nimport '../../time-picker/index.mjs';\nimport { ROOT_PICKER_INJECTION_KEY } from './constants.mjs';\nimport { datePickerProps } from './props/date-picker.mjs';\nimport { getPanel } from './panel-utils.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { DEFAULT_FORMATS_DATEPICKER, DEFAULT_FORMATS_DATE } from '../../time-picker/src/constants.mjs';\nimport CommonPicker from '../../time-picker/src/common/picker.mjs';\n\ndayjs.extend(localeData);\ndayjs.extend(advancedFormat);\ndayjs.extend(customParseFormat);\ndayjs.extend(weekOfYear);\ndayjs.extend(weekYear);\ndayjs.extend(dayOfYear);\ndayjs.extend(isSameOrAfter);\ndayjs.extend(isSameOrBefore);\nvar DatePicker = defineComponent({\n  name: \"ElDatePicker\",\n  install: null,\n  props: datePickerProps,\n  emits: [\"update:modelValue\"],\n  setup(props, {\n    expose,\n    emit,\n    slots\n  }) {\n    const ns = useNamespace(\"picker-panel\");\n    provide(\"ElPopperOptions\", reactive(toRef(props, \"popperOptions\")));\n    provide(ROOT_PICKER_INJECTION_KEY, {\n      slots,\n      pickerNs: ns\n    });\n    const commonPicker = ref();\n    const refProps = {\n      focus: (focusStartInput = true) => {\n        var _a;\n        (_a = commonPicker.value) == null ? void 0 : _a.focus(focusStartInput);\n      },\n      handleOpen: () => {\n        var _a;\n        (_a = commonPicker.value) == null ? void 0 : _a.handleOpen();\n      },\n      handleClose: () => {\n        var _a;\n        (_a = commonPicker.value) == null ? void 0 : _a.handleClose();\n      }\n    };\n    expose(refProps);\n    const onModelValueUpdated = (val) => {\n      emit(\"update:modelValue\", val);\n    };\n    return () => {\n      var _a;\n      const format = (_a = props.format) != null ? _a : DEFAULT_FORMATS_DATEPICKER[props.type] || DEFAULT_FORMATS_DATE;\n      const Component = getPanel(props.type);\n      return createVNode(CommonPicker, mergeProps(props, {\n        \"format\": format,\n        \"type\": props.type,\n        \"ref\": commonPicker,\n        \"onUpdate:modelValue\": onModelValueUpdated\n      }), {\n        default: (scopedProps) => createVNode(Component, scopedProps, null),\n        \"range-separator\": slots[\"range-separator\"]\n      });\n    };\n  }\n});\n\nexport { DatePicker as default };\n//# sourceMappingURL=date-picker.mjs.map\n","import DatePicker from './src/date-picker.mjs';\nexport { ROOT_PICKER_INJECTION_KEY } from './src/constants.mjs';\nexport { datePickerProps } from './src/props/date-picker.mjs';\n\nconst _DatePicker = DatePicker;\n_DatePicker.install = (app) => {\n  app.component(_DatePicker.name, _DatePicker);\n};\nconst ElDatePicker = _DatePicker;\n\nexport { ElDatePicker, _DatePicker as default };\n//# sourceMappingURL=index.mjs.map\n","import { isNil } from 'lodash-unified';\nimport '../../../hooks/index.mjs';\nimport '../../../utils/index.mjs';\nimport '../../../constants/index.mjs';\nimport { buildProps } from '../../../utils/vue/props/runtime.mjs';\nimport { useSizeProp } from '../../../hooks/use-size/index.mjs';\nimport { isNumber } from '../../../utils/types.mjs';\nimport { CHANGE_EVENT, INPUT_EVENT, UPDATE_MODEL_EVENT } from '../../../constants/event.mjs';\n\nconst inputNumberProps = buildProps({\n  id: {\n    type: String,\n    default: void 0\n  },\n  step: {\n    type: Number,\n    default: 1\n  },\n  stepStrictly: Boolean,\n  max: {\n    type: Number,\n    default: Number.POSITIVE_INFINITY\n  },\n  min: {\n    type: Number,\n    default: Number.NEGATIVE_INFINITY\n  },\n  modelValue: Number,\n  readonly: Boolean,\n  disabled: Boolean,\n  size: useSizeProp,\n  controls: {\n    type: Boolean,\n    default: true\n  },\n  controlsPosition: {\n    type: String,\n    default: \"\",\n    values: [\"\", \"right\"]\n  },\n  valueOnClear: {\n    type: [String, Number, null],\n    validator: (val) => val === null || isNumber(val) || [\"min\", \"max\"].includes(val),\n    default: null\n  },\n  name: String,\n  label: String,\n  placeholder: String,\n  precision: {\n    type: Number,\n    validator: (val) => val >= 0 && val === Number.parseInt(`${val}`, 10)\n  },\n  validateEvent: {\n    type: Boolean,\n    default: true\n  }\n});\nconst inputNumberEmits = {\n  [CHANGE_EVENT]: (cur, prev) => prev !== cur,\n  blur: (e) => e instanceof FocusEvent,\n  focus: (e) => e instanceof FocusEvent,\n  [INPUT_EVENT]: (val) => isNumber(val) || isNil(val),\n  [UPDATE_MODEL_EVENT]: (val) => isNumber(val) || isNil(val)\n};\n\nexport { inputNumberEmits, inputNumberProps };\n//# sourceMappingURL=input-number.mjs.map\n","import { defineComponent, ref, reactive, computed, watch, onMounted, onUpdated, openBlock, createElementBlock, normalizeClass, unref, withModifiers, withDirectives, withKeys, createVNode, withCtx, createBlock, createCommentVNode } from 'vue';\nimport { isNil } from 'lodash-unified';\nimport { ElInput } from '../../input/index.mjs';\nimport { ElIcon } from '../../icon/index.mjs';\nimport '../../form/index.mjs';\nimport '../../../directives/index.mjs';\nimport '../../../hooks/index.mjs';\nimport '../../../utils/index.mjs';\nimport { ArrowDown, Minus, ArrowUp, Plus } from '@element-plus/icons-vue';\nimport '../../../constants/index.mjs';\nimport { inputNumberProps, inputNumberEmits } from './input-number.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useLocale } from '../../../hooks/use-locale/index.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\nimport { useFormItem } from '../../form/src/hooks/use-form-item.mjs';\nimport { isNumber, isUndefined } from '../../../utils/types.mjs';\nimport { debugWarn, throwError } from '../../../utils/error.mjs';\nimport { useFormSize, useFormDisabled } from '../../form/src/hooks/use-form-common-props.mjs';\nimport { INPUT_EVENT, UPDATE_MODEL_EVENT, CHANGE_EVENT } from '../../../constants/event.mjs';\nimport { isString } from '@vue/shared';\nimport { vRepeatClick } from '../../../directives/repeat-click/index.mjs';\n\nconst _hoisted_1 = [\"aria-label\", \"onKeydown\"];\nconst _hoisted_2 = [\"aria-label\", \"onKeydown\"];\nconst __default__ = defineComponent({\n  name: \"ElInputNumber\"\n});\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  ...__default__,\n  props: inputNumberProps,\n  emits: inputNumberEmits,\n  setup(__props, { expose, emit }) {\n    const props = __props;\n    const { t } = useLocale();\n    const ns = useNamespace(\"input-number\");\n    const input = ref();\n    const data = reactive({\n      currentValue: props.modelValue,\n      userInput: null\n    });\n    const { formItem } = useFormItem();\n    const minDisabled = computed(() => isNumber(props.modelValue) && props.modelValue <= props.min);\n    const maxDisabled = computed(() => isNumber(props.modelValue) && props.modelValue >= props.max);\n    const numPrecision = computed(() => {\n      const stepPrecision = getPrecision(props.step);\n      if (!isUndefined(props.precision)) {\n        if (stepPrecision > props.precision) {\n          debugWarn(\"InputNumber\", \"precision should not be less than the decimal places of step\");\n        }\n        return props.precision;\n      } else {\n        return Math.max(getPrecision(props.modelValue), stepPrecision);\n      }\n    });\n    const controlsAtRight = computed(() => {\n      return props.controls && props.controlsPosition === \"right\";\n    });\n    const inputNumberSize = useFormSize();\n    const inputNumberDisabled = useFormDisabled();\n    const displayValue = computed(() => {\n      if (data.userInput !== null) {\n        return data.userInput;\n      }\n      let currentValue = data.currentValue;\n      if (isNil(currentValue))\n        return \"\";\n      if (isNumber(currentValue)) {\n        if (Number.isNaN(currentValue))\n          return \"\";\n        if (!isUndefined(props.precision)) {\n          currentValue = currentValue.toFixed(props.precision);\n        }\n      }\n      return currentValue;\n    });\n    const toPrecision = (num, pre) => {\n      if (isUndefined(pre))\n        pre = numPrecision.value;\n      if (pre === 0)\n        return Math.round(num);\n      let snum = String(num);\n      const pointPos = snum.indexOf(\".\");\n      if (pointPos === -1)\n        return num;\n      const nums = snum.replace(\".\", \"\").split(\"\");\n      const datum = nums[pointPos + pre];\n      if (!datum)\n        return num;\n      const length = snum.length;\n      if (snum.charAt(length - 1) === \"5\") {\n        snum = `${snum.slice(0, Math.max(0, length - 1))}6`;\n      }\n      return Number.parseFloat(Number(snum).toFixed(pre));\n    };\n    const getPrecision = (value) => {\n      if (isNil(value))\n        return 0;\n      const valueString = value.toString();\n      const dotPosition = valueString.indexOf(\".\");\n      let precision = 0;\n      if (dotPosition !== -1) {\n        precision = valueString.length - dotPosition - 1;\n      }\n      return precision;\n    };\n    const ensurePrecision = (val, coefficient = 1) => {\n      if (!isNumber(val))\n        return data.currentValue;\n      return toPrecision(val + props.step * coefficient);\n    };\n    const increase = () => {\n      if (props.readonly || inputNumberDisabled.value || maxDisabled.value)\n        return;\n      const value = Number(displayValue.value) || 0;\n      const newVal = ensurePrecision(value);\n      setCurrentValue(newVal);\n      emit(INPUT_EVENT, data.currentValue);\n    };\n    const decrease = () => {\n      if (props.readonly || inputNumberDisabled.value || minDisabled.value)\n        return;\n      const value = Number(displayValue.value) || 0;\n      const newVal = ensurePrecision(value, -1);\n      setCurrentValue(newVal);\n      emit(INPUT_EVENT, data.currentValue);\n    };\n    const verifyValue = (value, update) => {\n      const { max, min, step, precision, stepStrictly, valueOnClear } = props;\n      if (max < min) {\n        throwError(\"InputNumber\", \"min should not be greater than max.\");\n      }\n      let newVal = Number(value);\n      if (isNil(value) || Number.isNaN(newVal)) {\n        return null;\n      }\n      if (value === \"\") {\n        if (valueOnClear === null) {\n          return null;\n        }\n        newVal = isString(valueOnClear) ? { min, max }[valueOnClear] : valueOnClear;\n      }\n      if (stepStrictly) {\n        newVal = toPrecision(Math.round(newVal / step) * step, precision);\n      }\n      if (!isUndefined(precision)) {\n        newVal = toPrecision(newVal, precision);\n      }\n      if (newVal > max || newVal < min) {\n        newVal = newVal > max ? max : min;\n        update && emit(UPDATE_MODEL_EVENT, newVal);\n      }\n      return newVal;\n    };\n    const setCurrentValue = (value, emitChange = true) => {\n      var _a;\n      const oldVal = data.currentValue;\n      const newVal = verifyValue(value);\n      if (!emitChange) {\n        emit(UPDATE_MODEL_EVENT, newVal);\n        return;\n      }\n      if (oldVal === newVal)\n        return;\n      data.userInput = null;\n      emit(UPDATE_MODEL_EVENT, newVal);\n      emit(CHANGE_EVENT, newVal, oldVal);\n      if (props.validateEvent) {\n        (_a = formItem == null ? void 0 : formItem.validate) == null ? void 0 : _a.call(formItem, \"change\").catch((err) => debugWarn(err));\n      }\n      data.currentValue = newVal;\n    };\n    const handleInput = (value) => {\n      data.userInput = value;\n      const newVal = value === \"\" ? null : Number(value);\n      emit(INPUT_EVENT, newVal);\n      setCurrentValue(newVal, false);\n    };\n    const handleInputChange = (value) => {\n      const newVal = value !== \"\" ? Number(value) : \"\";\n      if (isNumber(newVal) && !Number.isNaN(newVal) || value === \"\") {\n        setCurrentValue(newVal);\n      }\n      data.userInput = null;\n    };\n    const focus = () => {\n      var _a, _b;\n      (_b = (_a = input.value) == null ? void 0 : _a.focus) == null ? void 0 : _b.call(_a);\n    };\n    const blur = () => {\n      var _a, _b;\n      (_b = (_a = input.value) == null ? void 0 : _a.blur) == null ? void 0 : _b.call(_a);\n    };\n    const handleFocus = (event) => {\n      emit(\"focus\", event);\n    };\n    const handleBlur = (event) => {\n      var _a;\n      emit(\"blur\", event);\n      if (props.validateEvent) {\n        (_a = formItem == null ? void 0 : formItem.validate) == null ? void 0 : _a.call(formItem, \"blur\").catch((err) => debugWarn(err));\n      }\n    };\n    watch(() => props.modelValue, (value) => {\n      const userInput = verifyValue(data.userInput);\n      const newValue = verifyValue(value, true);\n      if (!isNumber(userInput) && (!userInput || userInput !== newValue)) {\n        data.currentValue = newValue;\n        data.userInput = null;\n      }\n    }, { immediate: true });\n    onMounted(() => {\n      var _a;\n      const { min, max, modelValue } = props;\n      const innerInput = (_a = input.value) == null ? void 0 : _a.input;\n      innerInput.setAttribute(\"role\", \"spinbutton\");\n      if (Number.isFinite(max)) {\n        innerInput.setAttribute(\"aria-valuemax\", String(max));\n      } else {\n        innerInput.removeAttribute(\"aria-valuemax\");\n      }\n      if (Number.isFinite(min)) {\n        innerInput.setAttribute(\"aria-valuemin\", String(min));\n      } else {\n        innerInput.removeAttribute(\"aria-valuemin\");\n      }\n      innerInput.setAttribute(\"aria-valuenow\", data.currentValue || data.currentValue === 0 ? String(data.currentValue) : \"\");\n      innerInput.setAttribute(\"aria-disabled\", String(inputNumberDisabled.value));\n      if (!isNumber(modelValue) && modelValue != null) {\n        let val = Number(modelValue);\n        if (Number.isNaN(val)) {\n          val = null;\n        }\n        emit(UPDATE_MODEL_EVENT, val);\n      }\n    });\n    onUpdated(() => {\n      var _a, _b;\n      const innerInput = (_a = input.value) == null ? void 0 : _a.input;\n      innerInput == null ? void 0 : innerInput.setAttribute(\"aria-valuenow\", `${(_b = data.currentValue) != null ? _b : \"\"}`);\n    });\n    expose({\n      focus,\n      blur\n    });\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"div\", {\n        class: normalizeClass([\n          unref(ns).b(),\n          unref(ns).m(unref(inputNumberSize)),\n          unref(ns).is(\"disabled\", unref(inputNumberDisabled)),\n          unref(ns).is(\"without-controls\", !_ctx.controls),\n          unref(ns).is(\"controls-right\", unref(controlsAtRight))\n        ]),\n        onDragstart: _cache[1] || (_cache[1] = withModifiers(() => {\n        }, [\"prevent\"]))\n      }, [\n        _ctx.controls ? withDirectives((openBlock(), createElementBlock(\"span\", {\n          key: 0,\n          role: \"button\",\n          \"aria-label\": unref(t)(\"el.inputNumber.decrease\"),\n          class: normalizeClass([unref(ns).e(\"decrease\"), unref(ns).is(\"disabled\", unref(minDisabled))]),\n          onKeydown: withKeys(decrease, [\"enter\"])\n        }, [\n          createVNode(unref(ElIcon), null, {\n            default: withCtx(() => [\n              unref(controlsAtRight) ? (openBlock(), createBlock(unref(ArrowDown), { key: 0 })) : (openBlock(), createBlock(unref(Minus), { key: 1 }))\n            ]),\n            _: 1\n          })\n        ], 42, _hoisted_1)), [\n          [unref(vRepeatClick), decrease]\n        ]) : createCommentVNode(\"v-if\", true),\n        _ctx.controls ? withDirectives((openBlock(), createElementBlock(\"span\", {\n          key: 1,\n          role: \"button\",\n          \"aria-label\": unref(t)(\"el.inputNumber.increase\"),\n          class: normalizeClass([unref(ns).e(\"increase\"), unref(ns).is(\"disabled\", unref(maxDisabled))]),\n          onKeydown: withKeys(increase, [\"enter\"])\n        }, [\n          createVNode(unref(ElIcon), null, {\n            default: withCtx(() => [\n              unref(controlsAtRight) ? (openBlock(), createBlock(unref(ArrowUp), { key: 0 })) : (openBlock(), createBlock(unref(Plus), { key: 1 }))\n            ]),\n            _: 1\n          })\n        ], 42, _hoisted_2)), [\n          [unref(vRepeatClick), increase]\n        ]) : createCommentVNode(\"v-if\", true),\n        createVNode(unref(ElInput), {\n          id: _ctx.id,\n          ref_key: \"input\",\n          ref: input,\n          type: \"number\",\n          step: _ctx.step,\n          \"model-value\": unref(displayValue),\n          placeholder: _ctx.placeholder,\n          readonly: _ctx.readonly,\n          disabled: unref(inputNumberDisabled),\n          size: unref(inputNumberSize),\n          max: _ctx.max,\n          min: _ctx.min,\n          name: _ctx.name,\n          label: _ctx.label,\n          \"validate-event\": false,\n          onWheel: _cache[0] || (_cache[0] = withModifiers(() => {\n          }, [\"prevent\"])),\n          onKeydown: [\n            withKeys(withModifiers(increase, [\"prevent\"]), [\"up\"]),\n            withKeys(withModifiers(decrease, [\"prevent\"]), [\"down\"])\n          ],\n          onBlur: handleBlur,\n          onFocus: handleFocus,\n          onInput: handleInput,\n          onChange: handleInputChange\n        }, null, 8, [\"id\", \"step\", \"model-value\", \"placeholder\", \"readonly\", \"disabled\", \"size\", \"max\", \"min\", \"name\", \"label\", \"onKeydown\"])\n      ], 34);\n    };\n  }\n});\nvar InputNumber = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue\"]]);\n\nexport { InputNumber as default };\n//# sourceMappingURL=input-number2.mjs.map\n","import '../../utils/index.mjs';\nimport InputNumber from './src/input-number2.mjs';\nexport { inputNumberEmits, inputNumberProps } from './src/input-number.mjs';\nimport { withInstall } from '../../utils/vue/install.mjs';\n\nconst ElInputNumber = withInstall(InputNumber);\n\nexport { ElInputNumber, ElInputNumber as default };\n//# sourceMappingURL=index.mjs.map\n","import '../../../utils/index.mjs';\nimport { buildProps } from '../../../utils/vue/props/runtime.mjs';\nimport { iconPropType } from '../../../utils/vue/icon.mjs';\n\nconst linkProps = buildProps({\n  type: {\n    type: String,\n    values: [\"primary\", \"success\", \"warning\", \"info\", \"danger\", \"default\"],\n    default: \"default\"\n  },\n  underline: {\n    type: Boolean,\n    default: true\n  },\n  disabled: { type: Boolean, default: false },\n  href: { type: String, default: \"\" },\n  icon: {\n    type: iconPropType\n  }\n});\nconst linkEmits = {\n  click: (evt) => evt instanceof MouseEvent\n};\n\nexport { linkEmits, linkProps };\n//# sourceMappingURL=link.mjs.map\n","import { defineComponent, computed, openBlock, createElementBlock, normalizeClass, unref, createBlock, withCtx, resolveDynamicComponent, createCommentVNode, renderSlot } from 'vue';\nimport { ElIcon } from '../../icon/index.mjs';\nimport '../../../hooks/index.mjs';\nimport { linkProps, linkEmits } from './link.mjs';\nimport _export_sfc from '../../../_virtual/plugin-vue_export-helper.mjs';\nimport { useNamespace } from '../../../hooks/use-namespace/index.mjs';\n\nconst _hoisted_1 = [\"href\"];\nconst __default__ = defineComponent({\n  name: \"ElLink\"\n});\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  ...__default__,\n  props: linkProps,\n  emits: linkEmits,\n  setup(__props, { emit }) {\n    const props = __props;\n    const ns = useNamespace(\"link\");\n    const linkKls = computed(() => [\n      ns.b(),\n      ns.m(props.type),\n      ns.is(\"disabled\", props.disabled),\n      ns.is(\"underline\", props.underline && !props.disabled)\n    ]);\n    function handleClick(event) {\n      if (!props.disabled)\n        emit(\"click\", event);\n    }\n    return (_ctx, _cache) => {\n      return openBlock(), createElementBlock(\"a\", {\n        class: normalizeClass(unref(linkKls)),\n        href: _ctx.disabled || !_ctx.href ? void 0 : _ctx.href,\n        onClick: handleClick\n      }, [\n        _ctx.icon ? (openBlock(), createBlock(unref(ElIcon), { key: 0 }, {\n          default: withCtx(() => [\n            (openBlock(), createBlock(resolveDynamicComponent(_ctx.icon)))\n          ]),\n          _: 1\n        })) : createCommentVNode(\"v-if\", true),\n        _ctx.$slots.default ? (openBlock(), createElementBlock(\"span\", {\n          key: 1,\n          class: normalizeClass(unref(ns).e(\"inner\"))\n        }, [\n          renderSlot(_ctx.$slots, \"default\")\n        ], 2)) : createCommentVNode(\"v-if\", true),\n        _ctx.$slots.icon ? renderSlot(_ctx.$slots, \"icon\", { key: 2 }) : createCommentVNode(\"v-if\", true)\n      ], 10, _hoisted_1);\n    };\n  }\n});\nvar Link = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"__file\", \"/home/runner/work/element-plus/element-plus/packages/components/link/src/link.vue\"]]);\n\nexport { Link as default };\n//# sourceMappingURL=link2.mjs.map\n","import '../../utils/index.mjs';\nimport Link from './src/link2.mjs';\nexport { linkEmits, linkProps } from './src/link.mjs';\nimport { withInstall } from '../../utils/vue/install.mjs';\n\nconst ElLink = withInstall(Link);\n\nexport { ElLink, ElLink as default };\n//# sourceMappingURL=index.mjs.map\n","const props = {\n    x: 'x',\n    y: 'y',\n    width: 'w',\n    height: 'h',\n    minimum: 's',\n    maximum: 'l',\n    diagonal: 'd'\n};\nconst propsList = Object.keys(props).map(key => props[key]).join('');\nconst numberPattern = '[-+]?[0-9]*\\\\.?[0-9]+(?:[eE][-+]?[0-9]+)?';\nconst findSpacesRegex = /\\s/g;\nconst parseExpressionRegExp = new RegExp(`^(${numberPattern}\\\\*)?([${propsList}])(/${numberPattern})?([-+]{1,2}${numberPattern})?$`, 'g');\n\nfunction throwInvalid(expression) {\n    throw new Error(`Invalid calc() expression: ${expression}`);\n}\n\nexport function evalCalcExpression(expression, bbox) {\n    const match = parseExpressionRegExp.exec(expression.replace(findSpacesRegex, ''));\n    if (!match) throwInvalid(expression);\n    parseExpressionRegExp.lastIndex = 0; // reset regex results for the next run\n    const [,multiply, property, divide, add] = match;\n    const { x, y, width, height } = bbox;\n    let value = 0;\n    switch (property) {\n        case props.width: {\n            value = width;\n            break;\n        }\n        case props.height: {\n            value = height;\n            break;\n        }\n        case props.x: {\n            value = x;\n            break;\n        }\n        case props.y: {\n            value = y;\n            break;\n        }\n        case props.minimum: {\n            value = Math.min(height, width);\n            break;\n        }\n        case props.maximum: {\n            value = Math.max(height, width);\n            break;\n        }\n        case props.diagonal: {\n            value = Math.sqrt((height * height) + (width * width));\n            break;\n        }\n    }\n    if (multiply) {\n        // e.g \"2*\"\n        value *= parseFloat(multiply);\n    }\n    if (divide) {\n        // e.g \"/2\"\n        value /= parseFloat(divide.slice(1));\n    }\n    if (add) {\n        value += evalAddExpression(add);\n    }\n    return value;\n}\n\nfunction evalAddExpression(addExpression) {\n    if (!addExpression) return 0;\n    const [sign] = addExpression;\n    switch (sign) {\n        case '+': {\n            return parseFloat(addExpression.substr(1));\n        }\n        case '-': {\n            return -parseFloat(addExpression.substr(1));\n        }\n    }\n    return parseFloat(addExpression);\n}\n\nexport function isCalcAttribute(value) {\n    return typeof value === 'string' && value.includes('calc');\n}\n\nconst calcStart = 'calc(';\nconst calcStartOffset = calcStart.length;\n\nexport function evalCalcAttribute(attributeValue, refBBox) {\n    let value = attributeValue;\n    let startSearchIndex = 0;\n    do {\n        let calcIndex = value.indexOf(calcStart, startSearchIndex);\n        if (calcIndex === -1) return value;\n        let calcEndIndex = calcIndex + calcStartOffset;\n        let brackets = 1;\n        findClosingBracket: do {\n            switch (value[calcEndIndex]) {\n                case '(': {\n                    brackets++;\n                    break;\n                }\n                case ')': {\n                    brackets--;\n                    if (brackets === 0) break findClosingBracket;\n                    break;\n                }\n                case undefined: {\n                    // Could not find the closing bracket.\n                    throwInvalid(value);\n                }\n            }\n            calcEndIndex++;\n        } while (true);\n        // Get the calc() expression without nested calcs (recursion)\n        let expression = value.slice(calcIndex + calcStartOffset, calcEndIndex);\n        if (isCalcAttribute(expression)) {\n            expression = evalCalcAttribute(expression, refBBox);\n        }\n        // Eval the calc() expression without nested calcs.\n        const calcValue = String(evalCalcExpression(expression, refBBox));\n        // Replace the calc() expression and continue search\n        value = value.slice(0, calcIndex) + calcValue + value.slice(calcEndIndex + 1);\n        startSearchIndex = calcIndex + calcValue.length;\n    } while (true);\n}\n","import { uniq, toArray, isEmpty } from './util.mjs';\n\n// Clone `cells` returning an object that maps the original cell ID to the clone. The number\n// of clones is exactly the same as the `cells.length`.\n// This function simply clones all the `cells`. However, it also reconstructs\n// all the `source/target` and `parent/embed` references within the `cells`.\n// This is the main difference from the `cell.clone()` method. The\n// `cell.clone()` method works on one single cell only.\n// For example, for a graph: `A --- L ---> B`, `cloneCells([A, L, B])`\n// returns `[A2, L2, B2]` resulting to a graph: `A2 --- L2 ---> B2`, i.e.\n// the source and target of the link `L2` is changed to point to `A2` and `B2`.\nexport function cloneCells(cells) {\n\n    cells = uniq(cells);\n\n    // A map of the form [original cell ID] -> [clone] helping\n    // us to reconstruct references for source/target and parent/embeds.\n    // This is also the returned value.\n    const cloneMap = toArray(cells).reduce(function(map, cell) {\n        map[cell.id] = cell.clone();\n        return map;\n    }, {});\n\n    toArray(cells).forEach(function(cell) {\n\n        const clone = cloneMap[cell.id];\n        // assert(clone exists)\n\n        if (clone.isLink()) {\n            const source = clone.source();\n            const target = clone.target();\n            if (source.id && cloneMap[source.id]) {\n                // Source points to an element and the element is among the clones.\n                // => Update the source of the cloned link.\n                clone.prop('source/id', cloneMap[source.id].id);\n            }\n            if (target.id && cloneMap[target.id]) {\n                // Target points to an element and the element is among the clones.\n                // => Update the target of the cloned link.\n                clone.prop('target/id', cloneMap[target.id].id);\n            }\n        }\n\n        // Find the parent of the original cell\n        const parent = cell.get('parent');\n        if (parent && cloneMap[parent]) {\n            clone.set('parent', cloneMap[parent].id);\n        }\n\n        // Find the embeds of the original cell\n        const embeds = toArray(cell.get('embeds')).reduce(function(newEmbeds, embed) {\n            // Embedded cells that are not being cloned can not be carried\n            // over with other embedded cells.\n            if (cloneMap[embed]) {\n                newEmbeds.push(cloneMap[embed].id);\n            }\n            return newEmbeds;\n        }, []);\n\n        if (!isEmpty(embeds)) {\n            clone.set('embeds', embeds);\n        }\n    });\n\n    return cloneMap;\n}\n\n","import { isPlainObject } from '../../util/util.mjs';\n\nconst validPropertiesList = ['checked', 'selected', 'disabled', 'readOnly', 'contentEditable', 'value', 'indeterminate'];\n\nconst validProperties = validPropertiesList.reduce((acc, key) => {\n    acc[key] = true;\n    return acc;\n}, {});\n\nconst props = {\n    qualify: function(properties) {\n        return isPlainObject(properties);\n    },\n    set: function(properties, _, node) {\n        Object.keys(properties).forEach(function(key) {\n            if (validProperties[key] && key in node) {\n                const value = properties[key];\n                if (node.tagName === 'SELECT' && Array.isArray(value)) {\n                    Array.from(node.options).forEach(function(option, index) {\n                        option.selected = value.includes(option.value);\n                    });\n                } else {\n                    node[key] = value;\n                }\n            }\n        });\n    }\n};\n\nexport default props;\n","import { Point, Path, Polyline } from '../../g/index.mjs';\nimport { assign, isPlainObject, pick, isObject, isPercentage, breakText } from '../../util/util.mjs';\nimport { isCalcAttribute, evalCalcAttribute } from './calc.mjs';\nimport props from './props.mjs';\nimport $ from 'jquery';\nimport V from '../../V/index.mjs';\n\nfunction setWrapper(attrName, dimension) {\n    return function(value, refBBox) {\n        var isValuePercentage = isPercentage(value);\n        value = parseFloat(value);\n        if (isValuePercentage) {\n            value /= 100;\n        }\n\n        var attrs = {};\n        if (isFinite(value)) {\n            var attrValue = (isValuePercentage || value >= 0 && value <= 1)\n                ? value * refBBox[dimension]\n                : Math.max(value + refBBox[dimension], 0);\n            attrs[attrName] = attrValue;\n        }\n\n        return attrs;\n    };\n}\n\nfunction positionWrapper(axis, dimension, origin) {\n    return function(value, refBBox) {\n        var valuePercentage = isPercentage(value);\n        value = parseFloat(value);\n        if (valuePercentage) {\n            value /= 100;\n        }\n\n        var delta;\n        if (isFinite(value)) {\n            var refOrigin = refBBox[origin]();\n            if (valuePercentage || value > 0 && value < 1) {\n                delta = refOrigin[axis] + refBBox[dimension] * value;\n            } else {\n                delta = refOrigin[axis] + value;\n            }\n        }\n\n        var point = Point();\n        point[axis] = delta || 0;\n        return point;\n    };\n}\n\nfunction offsetWrapper(axis, dimension, corner) {\n    return function(value, nodeBBox) {\n        var delta;\n        if (value === 'middle') {\n            delta = nodeBBox[dimension] / 2;\n        } else if (value === corner) {\n            delta = nodeBBox[dimension];\n        } else if (isFinite(value)) {\n            // TODO: or not to do a breaking change?\n            delta = (value > -1 && value < 1) ? (-nodeBBox[dimension] * value) : -value;\n        } else if (isPercentage(value)) {\n            delta = nodeBBox[dimension] * parseFloat(value) / 100;\n        } else {\n            delta = 0;\n        }\n\n        var point = Point();\n        point[axis] = -(nodeBBox[axis] + delta);\n        return point;\n    };\n}\n\nfunction shapeWrapper(shapeConstructor, opt) {\n    var cacheName = 'joint-shape';\n    var resetOffset = opt && opt.resetOffset;\n    return function(value, refBBox, node) {\n        var $node = $(node);\n        var cache = $node.data(cacheName);\n        if (!cache || cache.value !== value) {\n            // only recalculate if value has changed\n            var cachedShape = shapeConstructor(value);\n            cache = {\n                value: value,\n                shape: cachedShape,\n                shapeBBox: cachedShape.bbox()\n            };\n            $node.data(cacheName, cache);\n        }\n\n        var shape = cache.shape.clone();\n        var shapeBBox = cache.shapeBBox.clone();\n        var shapeOrigin = shapeBBox.origin();\n        var refOrigin = refBBox.origin();\n\n        shapeBBox.x = refOrigin.x;\n        shapeBBox.y = refOrigin.y;\n\n        var fitScale = refBBox.maxRectScaleToFit(shapeBBox, refOrigin);\n        // `maxRectScaleToFit` can give Infinity if width or height is 0\n        var sx = (shapeBBox.width === 0 || refBBox.width === 0) ? 1 : fitScale.sx;\n        var sy = (shapeBBox.height === 0 || refBBox.height === 0) ? 1 : fitScale.sy;\n\n        shape.scale(sx, sy, shapeOrigin);\n        if (resetOffset) {\n            shape.translate(-shapeOrigin.x, -shapeOrigin.y);\n        }\n\n        return shape;\n    };\n}\n\n// `d` attribute for SVGPaths\nfunction dWrapper(opt) {\n    function pathConstructor(value) {\n        return new Path(V.normalizePathData(value));\n    }\n\n    var shape = shapeWrapper(pathConstructor, opt);\n    return function(value, refBBox, node) {\n        var path = shape(value, refBBox, node);\n        return {\n            d: path.serialize()\n        };\n    };\n}\n\n// `points` attribute for SVGPolylines and SVGPolygons\nfunction pointsWrapper(opt) {\n    var shape = shapeWrapper(Polyline, opt);\n    return function(value, refBBox, node) {\n        var polyline = shape(value, refBBox, node);\n        return {\n            points: polyline.serialize()\n        };\n    };\n}\n\nfunction atConnectionWrapper(method, opt) {\n    var zeroVector = new Point(1, 0);\n    return function(value) {\n        var p, angle;\n        var tangent = this[method](value);\n        if (tangent) {\n            angle = (opt.rotate) ? tangent.vector().vectorAngle(zeroVector) : 0;\n            p = tangent.start;\n        } else {\n            p = this.path.start;\n            angle = 0;\n        }\n        if (angle === 0) return { transform: 'translate(' + p.x + ',' + p.y + ')' };\n        return { transform: 'translate(' + p.x + ',' + p.y + ') rotate(' + angle + ')' };\n    };\n}\n\nfunction setIfChangedWrapper(attribute) {\n    return function setIfChanged(value, _, node) {\n        const vel = V(node);\n        if (vel.attr(attribute) === value) return;\n        vel.attr(attribute, value);\n    };\n}\n\nfunction isTextInUse(_value, _node, attrs) {\n    return (attrs.text !== undefined);\n}\n\nfunction isLinkView() {\n    return this.model.isLink();\n}\n\nfunction contextMarker(context) {\n    var marker = {};\n    // Stroke\n    // The context 'fill' is disregared here. The usual case is to use the marker with a connection\n    // (for which 'fill' attribute is set to 'none').\n    var stroke = context.stroke;\n    if (typeof stroke === 'string') {\n        marker['stroke'] = stroke;\n        marker['fill'] = stroke;\n    }\n    // Opacity\n    // Again the context 'fill-opacity' is ignored.\n    var strokeOpacity = context.strokeOpacity;\n    if (strokeOpacity === undefined) strokeOpacity = context['stroke-opacity'];\n    if (strokeOpacity === undefined) strokeOpacity = context.opacity;\n    if (strokeOpacity !== undefined) {\n        marker['stroke-opacity'] = strokeOpacity;\n        marker['fill-opacity'] = strokeOpacity;\n    }\n    return marker;\n}\n\nfunction setPaintURL(def) {\n    const { paper } = this;\n    const url = (def.type === 'pattern')\n        ? paper.definePattern(def)\n        : paper.defineGradient(def);\n    return `url(#${url})`;\n}\n\nconst attributesNS = {\n\n    xlinkShow: {\n        set: 'xlink:show'\n    },\n\n    xlinkRole: {\n        set: 'xlink:role'\n    },\n\n    xlinkType: {\n        set: 'xlink:type'\n    },\n\n    xlinkArcrole: {\n        set: 'xlink:arcrole'\n    },\n\n    xlinkTitle: {\n        set: 'xlink:title'\n    },\n\n    xlinkActuate: {\n        set: 'xlink:actuate'\n    },\n\n    xmlSpace: {\n        set: 'xml:space'\n    },\n\n    xmlBase: {\n        set: 'xml:base'\n    },\n\n    xmlLang: {\n        set: 'xml:lang'\n    },\n\n    preserveAspectRatio: {\n        set: 'preserveAspectRatio'\n    },\n\n    requiredExtension: {\n        set: 'requiredExtension'\n    },\n\n    requiredFeatures: {\n        set: 'requiredFeatures'\n    },\n\n    systemLanguage: {\n        set: 'systemLanguage'\n    },\n\n    externalResourcesRequired: {\n        set: 'externalResourceRequired'\n    },\n\n    href: {\n        set: setIfChangedWrapper('href')\n    },\n\n    xlinkHref: {\n        set: setIfChangedWrapper('xlink:href')\n    },\n\n    filter: {\n        qualify: isPlainObject,\n        set: function(filter) {\n            return 'url(#' + this.paper.defineFilter(filter) + ')';\n        }\n    },\n\n    fill: {\n        qualify: isPlainObject,\n        set: setPaintURL\n    },\n\n    stroke: {\n        qualify: isPlainObject,\n        set: setPaintURL\n    },\n\n    sourceMarker: {\n        qualify: isPlainObject,\n        set: function(marker, refBBox, node, attrs) {\n            marker = assign(contextMarker(attrs), marker);\n            return { 'marker-start': 'url(#' + this.paper.defineMarker(marker) + ')' };\n        }\n    },\n\n    targetMarker: {\n        qualify: isPlainObject,\n        set: function(marker, refBBox, node, attrs) {\n            marker = assign(contextMarker(attrs), { 'transform': 'rotate(180)' }, marker);\n            return { 'marker-end': 'url(#' + this.paper.defineMarker(marker) + ')' };\n        }\n    },\n\n    vertexMarker: {\n        qualify: isPlainObject,\n        set: function(marker, refBBox, node, attrs) {\n            marker = assign(contextMarker(attrs), marker);\n            return { 'marker-mid': 'url(#' + this.paper.defineMarker(marker) + ')' };\n        }\n    },\n\n    text: {\n        qualify: function(_text, _node, attrs) {\n            return !attrs.textWrap || !isPlainObject(attrs.textWrap);\n        },\n        set: function(text, refBBox, node, attrs) {\n            var $node = $(node);\n            var cacheName = 'joint-text';\n            var cache = $node.data(cacheName);\n            var textAttrs = pick(attrs, 'lineHeight', 'annotations', 'textPath', 'x', 'textVerticalAnchor', 'eol', 'displayEmpty');\n            // eval `x` if using calc()\n            const { x } = textAttrs;\n            if (isCalcAttribute(x)) {\n                textAttrs.x = evalCalcAttribute(x, refBBox);\n            }\n\n            let fontSizeAttr = attrs['font-size'] || attrs['fontSize'];\n            if (isCalcAttribute(fontSizeAttr)) {\n                fontSizeAttr = evalCalcAttribute(fontSizeAttr, refBBox);\n            }\n            var fontSize = textAttrs.fontSize = fontSizeAttr;\n            var textHash = JSON.stringify([text, textAttrs]);\n            // Update the text only if there was a change in the string\n            // or any of its attributes.\n            if (cache === undefined || cache !== textHash) {\n                // Chrome bug:\n                // Tspans positions defined as `em` are not updated\n                // when container `font-size` change.\n                if (fontSize) node.setAttribute('font-size', fontSize);\n                // Text Along Path Selector\n                var textPath = textAttrs.textPath;\n                if (isObject(textPath)) {\n                    var pathSelector = textPath.selector;\n                    if (typeof pathSelector === 'string') {\n                        var pathNode = this.findBySelector(pathSelector)[0];\n                        if (pathNode instanceof SVGPathElement) {\n                            textAttrs.textPath = assign({ 'xlink:href': '#' + pathNode.id }, textPath);\n                        }\n                    }\n                }\n                V(node).text('' + text, textAttrs);\n                $node.data(cacheName, textHash);\n            }\n        }\n    },\n\n    textWrap: {\n        qualify: isPlainObject,\n        set: function(value, refBBox, node, attrs) {\n            var size = {};\n            // option `width`\n            var width = value.width || 0;\n            if (isPercentage(width)) {\n                size.width = refBBox.width * parseFloat(width) / 100;\n            } else if (isCalcAttribute(width)) {\n                size.width = Number(evalCalcAttribute(width, refBBox));\n            } else {\n                if (value.width === null) {\n                    // breakText() requires width to be specified.\n                    size.width = Infinity;\n                } else if (width <= 0) {\n                    size.width = refBBox.width + width;\n                } else {\n                    size.width = width;\n                }\n            }\n            // option `height`\n            var height = value.height || 0;\n            if (isPercentage(height)) {\n                size.height = refBBox.height * parseFloat(height) / 100;\n            } else if (isCalcAttribute(height)) {\n                size.height = Number(evalCalcAttribute(height, refBBox));\n            } else {\n                if (value.height === null) {\n                    // if height is not specified breakText() does not\n                    // restrict the height of the text.\n                } else if (height <= 0) {\n                    size.height = refBBox.height + height;\n                } else {\n                    size.height = height;\n                }\n            }\n            // option `text`\n            var wrappedText;\n            var text = value.text;\n            if (text === undefined) text = attrs.text;\n            if (text !== undefined) {\n                const breakTextFn = value.breakText || breakText;\n                const fontSizeAttr = attrs['font-size'] || attrs.fontSize;\n                wrappedText = breakTextFn('' + text, size, {\n                    'font-weight': attrs['font-weight'] || attrs.fontWeight,\n                    'font-size': isCalcAttribute(fontSizeAttr) ? evalCalcAttribute(fontSizeAttr, refBBox) : fontSizeAttr,\n                    'font-family': attrs['font-family'] || attrs.fontFamily,\n                    'lineHeight': attrs.lineHeight,\n                    'letter-spacing': 'letter-spacing' in attrs ? attrs['letter-spacing'] : attrs.letterSpacing\n                }, {\n                    // Provide an existing SVG Document here\n                    // instead of creating a temporary one over again.\n                    svgDocument: this.paper.svg,\n                    ellipsis: value.ellipsis,\n                    hyphen: value.hyphen,\n                    maxLineCount: value.maxLineCount,\n                    preserveSpaces: value.preserveSpaces\n                });\n            } else {\n                wrappedText = '';\n            }\n            attributesNS.text.set.call(this, wrappedText, refBBox, node, attrs);\n        }\n    },\n\n    title: {\n        qualify: function(title, node) {\n            // HTMLElement title is specified via an attribute (i.e. not an element)\n            return node instanceof SVGElement;\n        },\n        set: function(title, refBBox, node) {\n            var $node = $(node);\n            var cacheName = 'joint-title';\n            var cache = $node.data(cacheName);\n            if (cache === undefined || cache !== title) {\n                $node.data(cacheName, title);\n                if (node.tagName === 'title') {\n                    // The target node is a <title> element.\n                    node.textContent = title;\n                    return;\n                }\n                // Generally <title> element should be the first child element of its parent.\n                var firstChild = node.firstElementChild;\n                if (firstChild && firstChild.tagName === 'title') {\n                    // Update an existing title\n                    firstChild.textContent = title;\n                } else {\n                    // Create a new title\n                    var titleNode = document.createElementNS(node.namespaceURI, 'title');\n                    titleNode.textContent = title;\n                    node.insertBefore(titleNode, firstChild);\n                }\n            }\n        }\n    },\n\n    lineHeight: {\n        qualify: isTextInUse\n    },\n\n    textVerticalAnchor: {\n        qualify: isTextInUse\n    },\n\n    textPath: {\n        qualify: isTextInUse\n    },\n\n    annotations: {\n        qualify: isTextInUse\n    },\n\n    eol: {\n        qualify: isTextInUse\n    },\n\n    displayEmpty: {\n        qualify: isTextInUse\n    },\n\n    // `port` attribute contains the `id` of the port that the underlying magnet represents.\n    port: {\n        set: function(port) {\n            return (port === null || port.id === undefined) ? port : port.id;\n        }\n    },\n\n    // `style` attribute is special in the sense that it sets the CSS style of the subelement.\n    style: {\n        qualify: isPlainObject,\n        set: function(styles, refBBox, node) {\n            $(node).css(styles);\n        }\n    },\n\n    html: {\n        set: function(html, refBBox, node) {\n            $(node).html(html + '');\n        }\n    },\n\n    // Properties setter (set various properties on the node)\n    props,\n\n    ref: {\n        // We do not set `ref` attribute directly on an element.\n        // The attribute itself does not qualify for relative positioning.\n    },\n\n    // if `refX` is in [0, 1] then `refX` is a fraction of bounding box width\n    // if `refX` is < 0 then `refX`'s absolute values is the right coordinate of the bounding box\n    // otherwise, `refX` is the left coordinate of the bounding box\n\n    refX: {\n        position: positionWrapper('x', 'width', 'origin')\n    },\n\n    refY: {\n        position: positionWrapper('y', 'height', 'origin')\n    },\n\n    // `ref-dx` and `ref-dy` define the offset of the subelement relative to the right and/or bottom\n    // coordinate of the reference element.\n\n    refDx: {\n        position: positionWrapper('x', 'width', 'corner')\n    },\n\n    refDy: {\n        position: positionWrapper('y', 'height', 'corner')\n    },\n\n    // 'ref-width'/'ref-height' defines the width/height of the subelement relatively to\n    // the reference element size\n    // val in 0..1         ref-width = 0.75 sets the width to 75% of the ref. el. width\n    // val < 0 || val > 1  ref-height = -20 sets the height to the ref. el. height shorter by 20\n\n    refWidth: {\n        set: setWrapper('width', 'width')\n    },\n\n    refHeight: {\n        set: setWrapper('height', 'height')\n    },\n\n    refRx: {\n        set: setWrapper('rx', 'width')\n    },\n\n    refRy: {\n        set: setWrapper('ry', 'height')\n    },\n\n    refRInscribed: {\n        set: (function(attrName) {\n            var widthFn = setWrapper(attrName, 'width');\n            var heightFn = setWrapper(attrName, 'height');\n            return function(value, refBBox) {\n                var fn = (refBBox.height > refBBox.width) ? widthFn : heightFn;\n                return fn(value, refBBox);\n            };\n        })('r')\n    },\n\n    refRCircumscribed: {\n        set: function(value, refBBox) {\n            var isValuePercentage = isPercentage(value);\n            value = parseFloat(value);\n            if (isValuePercentage) {\n                value /= 100;\n            }\n\n            var diagonalLength = Math.sqrt((refBBox.height * refBBox.height) + (refBBox.width * refBBox.width));\n\n            var rValue;\n            if (isFinite(value)) {\n                if (isValuePercentage || value >= 0 && value <= 1) rValue = value * diagonalLength;\n                else rValue = Math.max(value + diagonalLength, 0);\n            }\n\n            return { r: rValue };\n        }\n    },\n\n    refCx: {\n        set: setWrapper('cx', 'width')\n    },\n\n    refCy: {\n        set: setWrapper('cy', 'height')\n    },\n\n    // `x-alignment` when set to `middle` causes centering of the subelement around its new x coordinate.\n    // `x-alignment` when set to `right` uses the x coordinate as referenced to the right of the bbox.\n\n    xAlignment: {\n        offset: offsetWrapper('x', 'width', 'right')\n    },\n\n    // `y-alignment` when set to `middle` causes centering of the subelement around its new y coordinate.\n    // `y-alignment` when set to `bottom` uses the y coordinate as referenced to the bottom of the bbox.\n\n    yAlignment: {\n        offset: offsetWrapper('y', 'height', 'bottom')\n    },\n\n    resetOffset: {\n        offset: function(val, nodeBBox) {\n            return (val)\n                ? { x: -nodeBBox.x, y: -nodeBBox.y }\n                : { x: 0, y: 0 };\n        }\n\n    },\n\n    refDResetOffset: {\n        set: dWrapper({ resetOffset: true })\n    },\n\n    refDKeepOffset: {\n        set: dWrapper({ resetOffset: false })\n    },\n\n    refPointsResetOffset: {\n        set: pointsWrapper({ resetOffset: true })\n    },\n\n    refPointsKeepOffset: {\n        set: pointsWrapper({ resetOffset: false })\n    },\n\n    // LinkView Attributes\n\n    connection: {\n        qualify: isLinkView,\n        set: function({ stubs = 0 }) {\n            let d;\n            if (isFinite(stubs) && stubs !== 0) {\n                let offset;\n                if (stubs < 0) {\n                    offset = (this.getConnectionLength() + stubs) / 2;\n                } else {\n                    offset = stubs;\n                }\n                const path = this.getConnection();\n                const segmentSubdivisions = this.getConnectionSubdivisions();\n                const sourceParts = path.divideAtLength(offset, { segmentSubdivisions });\n                const targetParts = path.divideAtLength(-offset, { segmentSubdivisions });\n                if (sourceParts && targetParts) {\n                    d = `${sourceParts[0].serialize()} ${targetParts[1].serialize()}`;\n                }\n            }\n\n            return { d: d || this.getSerializedConnection() };\n        }\n    },\n\n    atConnectionLengthKeepGradient: {\n        qualify: isLinkView,\n        set: atConnectionWrapper('getTangentAtLength', { rotate: true })\n    },\n\n    atConnectionLengthIgnoreGradient: {\n        qualify: isLinkView,\n        set: atConnectionWrapper('getTangentAtLength', { rotate: false })\n    },\n\n    atConnectionRatioKeepGradient: {\n        qualify: isLinkView,\n        set: atConnectionWrapper('getTangentAtRatio', { rotate: true })\n    },\n\n    atConnectionRatioIgnoreGradient: {\n        qualify: isLinkView,\n        set: atConnectionWrapper('getTangentAtRatio', { rotate: false })\n    }\n};\n\nattributesNS['xlink:href'] = attributesNS.xlinkHref;\n\n// Support `calc()` with the following SVG attributes\n[\n    'transform', // g\n    'd', // path\n    'points', // polyline / polygon\n    'cx', 'cy', // circle / ellipse\n    'x1', 'x2', 'y1', 'y2', // line\n    'x', 'y', // rect / text / image\n    'dx', 'dy' // text\n].forEach(attribute => {\n    attributesNS[attribute] = {\n        qualify: isCalcAttribute,\n        set: function setCalcAttribute(value, refBBox) {\n            return { [attribute]: evalCalcAttribute(value, refBBox) };\n        }\n    };\n});\n\n// Prevent \"A negative value is not valid\" error.\n[\n    'width', 'height', // rect / image\n    'r', // circle\n    'rx', 'ry', // rect / ellipse\n    'font-size', // text\n    'stroke-width' // elements\n].forEach(attribute => {\n    attributesNS[attribute] = {\n        qualify: isCalcAttribute,\n        set: function setCalcAttribute(value, refBBox) {\n            return { [attribute]: Math.max(0, evalCalcAttribute(value, refBBox)) };\n        }\n    };\n});\n\n// Aliases\nattributesNS.refR = attributesNS.refRInscribed;\nattributesNS.refD = attributesNS.refDResetOffset;\nattributesNS.refPoints = attributesNS.refPointsResetOffset;\nattributesNS.atConnectionLength = attributesNS.atConnectionLengthKeepGradient;\nattributesNS.atConnectionRatio = attributesNS.atConnectionRatioKeepGradient;\nattributesNS.fontSize = attributesNS['font-size'];\nattributesNS.strokeWidth = attributesNS['stroke-width'];\n\n// This allows to combine both absolute and relative positioning\n// refX: 50%, refX2: 20\nattributesNS.refX2 = attributesNS.refX;\nattributesNS.refY2 = attributesNS.refY;\nattributesNS.refWidth2 = attributesNS.refWidth;\nattributesNS.refHeight2 = attributesNS.refHeight;\n\n// Aliases for backwards compatibility\nattributesNS['ref-x'] = attributesNS.refX;\nattributesNS['ref-y'] = attributesNS.refY;\nattributesNS['ref-dy'] = attributesNS.refDy;\nattributesNS['ref-dx'] = attributesNS.refDx;\nattributesNS['ref-width'] = attributesNS.refWidth;\nattributesNS['ref-height'] = attributesNS.refHeight;\nattributesNS['x-alignment'] = attributesNS.xAlignment;\nattributesNS['y-alignment'] = attributesNS.yAlignment;\n\nexport const attributes = attributesNS;\n\n","import Backbone from 'backbone';\nimport {\n    uniqueId,\n    union,\n    result,\n    merge,\n    forIn,\n    isObject,\n    isEqual,\n    isString,\n    cloneDeep,\n    omit,\n    uuid,\n    isEmpty,\n    assign,\n    uniq,\n    toArray,\n    setByPath,\n    unsetByPath,\n    getByPath,\n    timing,\n    interpolate,\n    nextFrame,\n    without,\n    cancelFrame,\n    defaultsDeep,\n    has,\n    sortBy,\n    defaults\n} from '../util/util.mjs';\nimport { cloneCells } from '../util/cloneCells.mjs';\nimport { attributes } from './attributes/index.mjs';\nimport * as g from '../g/index.mjs';\n\n\n// Cell base model.\n// --------------------------\n\nexport const Cell = Backbone.Model.extend({\n\n    // This is the same as Backbone.Model with the only difference that is uses util.merge\n    // instead of just _.extend. The reason is that we want to mixin attributes set in upper classes.\n    constructor: function(attributes, options) {\n\n        var defaults;\n        var attrs = attributes || {};\n        if (typeof this.preinitialize === 'function') {\n            // Check to support an older version of Backbone (prior v1.4)\n            this.preinitialize.apply(this, arguments);\n        }\n        this.cid = uniqueId('c');\n        this.attributes = {};\n        if (options && options.collection) this.collection = options.collection;\n        if (options && options.parse) attrs = this.parse(attrs, options) || {};\n        if ((defaults = result(this, 'defaults'))) {\n            //<custom code>\n            // Replaced the call to _.defaults with util.merge.\n            attrs = merge({}, defaults, attrs);\n            //</custom code>\n        }\n        this.set(attrs, options);\n        this.changed = {};\n        this.initialize.apply(this, arguments);\n    },\n\n    translate: function(dx, dy, opt) {\n\n        throw new Error('Must define a translate() method.');\n    },\n\n    toJSON: function() {\n\n        const defaults = result(this.constructor.prototype, 'defaults');\n        const defaultAttrs = defaults.attrs || {};\n        const attrs = this.attributes.attrs;\n        const finalAttrs = {};\n\n        // Loop through all the attributes and\n        // omit the default attributes as they are implicitly reconstructible by the cell 'type'.\n        forIn(attrs, function(attr, selector) {\n\n            const defaultAttr = defaultAttrs[selector];\n\n            forIn(attr, function(value, name) {\n\n                // attr is mainly flat though it might have one more level (consider the `style` attribute).\n                // Check if the `value` is object and if yes, go one level deep.\n                if (isObject(value) && !Array.isArray(value)) {\n\n                    forIn(value, function(value2, name2) {\n\n                        if (!defaultAttr || !defaultAttr[name] || !isEqual(defaultAttr[name][name2], value2)) {\n\n                            finalAttrs[selector] = finalAttrs[selector] || {};\n                            (finalAttrs[selector][name] || (finalAttrs[selector][name] = {}))[name2] = value2;\n                        }\n                    });\n\n                } else if (!defaultAttr || !isEqual(defaultAttr[name], value)) {\n                    // `value` is not an object, default attribute for such a selector does not exist\n                    // or it is different than the attribute value set on the model.\n\n                    finalAttrs[selector] = finalAttrs[selector] || {};\n                    finalAttrs[selector][name] = value;\n                }\n            });\n        });\n\n        const attributes = cloneDeep(omit(this.attributes, 'attrs'));\n        attributes.attrs = finalAttrs;\n\n        return attributes;\n    },\n\n    initialize: function(options) {\n\n        const idAttribute = this.getIdAttribute();\n        if (!options || options[idAttribute] === undefined) {\n            this.set(idAttribute, this.generateId(), { silent: true });\n        }\n\n        this._transitionIds = {};\n        this._scheduledTransitionIds = {};\n\n        // Collect ports defined in `attrs` and keep collecting whenever `attrs` object changes.\n        this.processPorts();\n        this.on('change:attrs', this.processPorts, this);\n    },\n\n    getIdAttribute: function() {\n        return this.idAttribute || 'id';\n    },\n\n    generateId: function() {\n        return uuid();\n    },\n\n    /**\n     * @deprecated\n     */\n    processPorts: function() {\n\n        // Whenever `attrs` changes, we extract ports from the `attrs` object and store it\n        // in a more accessible way. Also, if any port got removed and there were links that had `target`/`source`\n        // set to that port, we remove those links as well (to follow the same behaviour as\n        // with a removed element).\n\n        var previousPorts = this.ports;\n\n        // Collect ports from the `attrs` object.\n        var ports = {};\n        forIn(this.get('attrs'), function(attrs, selector) {\n\n            if (attrs && attrs.port) {\n\n                // `port` can either be directly an `id` or an object containing an `id` (and potentially other data).\n                if (attrs.port.id !== undefined) {\n                    ports[attrs.port.id] = attrs.port;\n                } else {\n                    ports[attrs.port] = { id: attrs.port };\n                }\n            }\n        });\n\n        // Collect ports that have been removed (compared to the previous ports) - if any.\n        // Use hash table for quick lookup.\n        var removedPorts = {};\n        forIn(previousPorts, function(port, id) {\n\n            if (!ports[id]) removedPorts[id] = true;\n        });\n\n        // Remove all the incoming/outgoing links that have source/target port set to any of the removed ports.\n        if (this.graph && !isEmpty(removedPorts)) {\n\n            var inboundLinks = this.graph.getConnectedLinks(this, { inbound: true });\n            inboundLinks.forEach(function(link) {\n\n                if (removedPorts[link.get('target').port]) link.remove();\n            });\n\n            var outboundLinks = this.graph.getConnectedLinks(this, { outbound: true });\n            outboundLinks.forEach(function(link) {\n\n                if (removedPorts[link.get('source').port]) link.remove();\n            });\n        }\n\n        // Update the `ports` object.\n        this.ports = ports;\n    },\n\n    remove: function(opt = {}) {\n\n        // Store the graph in a variable because `this.graph` won't be accessible\n        // after `this.trigger('remove', ...)` down below.\n        const { graph, collection } = this;\n        if (!graph) {\n            // The collection is a common Backbone collection (not the graph collection).\n            if (collection) collection.remove(this, opt);\n            return this;\n        }\n\n        graph.startBatch('remove');\n\n        // First, unembed this cell from its parent cell if there is one.\n        const parentCell = this.getParentCell();\n        if (parentCell) {\n            parentCell.unembed(this, opt);\n        }\n\n        // Remove also all the cells, which were embedded into this cell\n        const embeddedCells = this.getEmbeddedCells();\n        for (let i = 0, n = embeddedCells.length; i < n; i++) {\n            const embed = embeddedCells[i];\n            if (embed) {\n                embed.remove(opt);\n            }\n        }\n\n        this.trigger('remove', this, graph.attributes.cells, opt);\n\n        graph.stopBatch('remove');\n\n        return this;\n    },\n\n    toFront: function(opt) {\n        var graph = this.graph;\n        if (graph) {\n            opt = defaults(opt || {}, { foregroundEmbeds: true });\n\n            let cells;\n            if (opt.deep) {\n                cells = this.getEmbeddedCells({ deep: true, breadthFirst: opt.breadthFirst !== false, sortSiblings: opt.foregroundEmbeds });\n                cells.unshift(this);\n            } else {\n                cells = [this];\n            }\n\n            const sortedCells = opt.foregroundEmbeds ? cells : sortBy(cells, cell => cell.z());\n\n            const maxZ = graph.maxZIndex();\n            let z = maxZ - cells.length + 1;\n\n            const collection = graph.get('cells');\n\n            let shouldUpdate = (collection.indexOf(sortedCells[0]) !== (collection.length - cells.length));\n            if (!shouldUpdate) {\n                shouldUpdate = sortedCells.some(function(cell, index) {\n                    return cell.z() !== z + index;\n                });\n            }\n\n            if (shouldUpdate) {\n                this.startBatch('to-front');\n\n                z = z + cells.length;\n\n                sortedCells.forEach(function(cell, index) {\n                    cell.set('z', z + index, opt);\n                });\n\n                this.stopBatch('to-front');\n            }\n        }\n\n        return this;\n    },\n\n    toBack: function(opt) {\n        var graph = this.graph;\n        if (graph) {\n            opt = defaults(opt || {}, { foregroundEmbeds: true });\n\n            let cells;\n            if (opt.deep) {\n                cells = this.getEmbeddedCells({ deep: true, breadthFirst: opt.breadthFirst !== false, sortSiblings: opt.foregroundEmbeds });\n                cells.unshift(this);\n            } else {\n                cells = [this];\n            }\n\n            const sortedCells = opt.foregroundEmbeds ? cells : sortBy(cells, cell => cell.z());\n\n            let z = graph.minZIndex();\n\n            var collection = graph.get('cells');\n\n            let shouldUpdate = (collection.indexOf(sortedCells[0]) !== 0);\n            if (!shouldUpdate) {\n                shouldUpdate = sortedCells.some(function(cell, index) {\n                    return cell.z() !== z + index;\n                });\n            }\n\n            if (shouldUpdate) {\n                this.startBatch('to-back');\n\n                z -= cells.length;\n\n                sortedCells.forEach(function(cell, index) {\n                    cell.set('z', z + index, opt);\n                });\n\n                this.stopBatch('to-back');\n            }\n        }\n\n        return this;\n    },\n\n    parent: function(parent, opt) {\n\n        // getter\n        if (parent === undefined) return this.get('parent');\n        // setter\n        return this.set('parent', parent, opt);\n    },\n\n    embed: function(cell, opt) {\n        const cells = Array.isArray(cell) ? cell : [cell];\n        if (!this.canEmbed(cells)) {\n            throw new Error('Recursive embedding not allowed.');\n        }\n        if (cells.some(c => c.isEmbedded() && this.id !== c.parent())) {\n            throw new Error('Embedding of already embedded cells is not allowed.');\n        }\n        this._embedCells(cells, opt);\n        return this;\n    },\n\n    unembed: function(cell, opt) {\n        const cells = Array.isArray(cell) ? cell : [cell];\n        this._unembedCells(cells, opt);\n        return this;\n    },\n\n    canEmbed: function(cell) {\n        const cells = Array.isArray(cell) ? cell : [cell];\n        return cells.every(c => this !== c && !this.isEmbeddedIn(c));\n    },\n\n    _embedCells: function(cells, opt) {\n        const batchName = 'embed';\n        this.startBatch(batchName);\n        const embeds = assign([], this.get('embeds'));\n        cells.forEach(cell => {\n            // We keep all element ids after link ids.\n            embeds[cell.isLink() ? 'unshift' : 'push'](cell.id);\n            cell.parent(this.id, opt);\n        });\n        this.set('embeds', uniq(embeds), opt);\n        this.stopBatch(batchName);\n    },\n\n    _unembedCells: function(cells, opt) {\n        const batchName = 'unembed';\n        this.startBatch(batchName);\n        cells.forEach(cell => cell.unset('parent', opt));\n        this.set('embeds', without(this.get('embeds'), ...cells.map(cell => cell.id)), opt);\n        this.stopBatch(batchName);\n    },\n\n    getParentCell: function() {\n\n        // unlike link.source/target, cell.parent stores id directly as a string\n        var parentId = this.parent();\n        var graph = this.graph;\n\n        return (parentId && graph && graph.getCell(parentId)) || null;\n    },\n\n    // Return an array of ancestor cells.\n    // The array is ordered from the parent of the cell\n    // to the most distant ancestor.\n    getAncestors: function() {\n\n        var ancestors = [];\n\n        if (!this.graph) {\n            return ancestors;\n        }\n\n        var parentCell = this.getParentCell();\n        while (parentCell) {\n            ancestors.push(parentCell);\n            parentCell = parentCell.getParentCell();\n        }\n\n        return ancestors;\n    },\n\n    getEmbeddedCells: function(opt) {\n\n        opt = opt || {};\n\n        // Cell models can only be retrieved when this element is part of a collection.\n        // There is no way this element knows about other cells otherwise.\n        // This also means that calling e.g. `translate()` on an element with embeds before\n        // adding it to a graph does not translate its embeds.\n        if (!this.graph) {\n            return [];\n        }\n\n        if (opt.deep) {\n            if (opt.breadthFirst) {\n                return this._getEmbeddedCellsBfs(opt.sortSiblings);\n            } else {\n                return this._getEmbeddedCellsDfs(opt.sortSiblings);\n            }\n        }\n\n        const embeddedIds = this.get('embeds');\n        if (isEmpty(embeddedIds)) {\n            return [];\n        }\n\n        let cells = embeddedIds.map(this.graph.getCell, this.graph);\n        if (opt.sortSiblings) {\n            cells = sortBy(cells, cell => cell.z());\n        }\n\n        return cells;\n    },\n\n    _getEmbeddedCellsBfs: function(sortSiblings) {\n        const cells = [];\n\n        const queue = [];\n        queue.push(this);\n\n        while (queue.length > 0) {\n            const current = queue.shift();\n            cells.push(current);\n\n            const embeddedCells = current.getEmbeddedCells({ sortSiblings: sortSiblings });\n\n            queue.push(...embeddedCells);\n        }\n        cells.shift();\n\n        return cells;\n    },\n\n    _getEmbeddedCellsDfs: function(sortSiblings) {\n        const cells = [];\n\n        const stack = [];\n        stack.push(this);\n\n        while (stack.length > 0) {\n            const current = stack.pop();\n            cells.push(current);\n\n            const embeddedCells = current.getEmbeddedCells({ sortSiblings: sortSiblings });\n\n            // When using the stack, cells that are embedded last are processed first.\n            // To maintain the original order, we need to push the cells in reverse order\n            for (let i = embeddedCells.length - 1; i >= 0; --i) {\n                stack.push(embeddedCells[i]);\n            }\n        }\n        cells.shift();\n\n        return cells;\n    },\n\n    isEmbeddedIn: function(cell, opt) {\n\n        var cellId = isString(cell) ? cell : cell.id;\n        var parentId = this.parent();\n\n        opt = assign({ deep: true }, opt);\n\n        // See getEmbeddedCells().\n        if (this.graph && opt.deep) {\n\n            while (parentId) {\n                if (parentId === cellId) {\n                    return true;\n                }\n                parentId = this.graph.getCell(parentId).parent();\n            }\n\n            return false;\n\n        } else {\n\n            // When this cell is not part of a collection check\n            // at least whether it's a direct child of given cell.\n            return parentId === cellId;\n        }\n    },\n\n    // Whether or not the cell is embedded in any other cell.\n    isEmbedded: function() {\n\n        return !!this.parent();\n    },\n\n    // Isolated cloning. Isolated cloning has two versions: shallow and deep (pass `{ deep: true }` in `opt`).\n    // Shallow cloning simply clones the cell and returns a new cell with different ID.\n    // Deep cloning clones the cell and all its embedded cells recursively.\n    clone: function(opt) {\n\n        opt = opt || {};\n\n        if (!opt.deep) {\n            // Shallow cloning.\n\n            var clone = Backbone.Model.prototype.clone.apply(this, arguments);\n            // We don't want the clone to have the same ID as the original.\n            clone.set(this.getIdAttribute(), this.generateId());\n            // A shallow cloned element does not carry over the original embeds.\n            clone.unset('embeds');\n            // And can not be embedded in any cell\n            // as the clone is not part of the graph.\n            clone.unset('parent');\n\n            return clone;\n\n        } else {\n            // Deep cloning.\n\n            // For a deep clone, simply call `graph.cloneCells()` with the cell and all its embedded cells.\n            return toArray(cloneCells([this].concat(this.getEmbeddedCells({ deep: true }))));\n        }\n    },\n\n    // A convenient way to set nested properties.\n    // This method merges the properties you'd like to set with the ones\n    // stored in the cell and makes sure change events are properly triggered.\n    // You can either set a nested property with one object\n    // or use a property path.\n    // The most simple use case is:\n    // `cell.prop('name/first', 'John')` or\n    // `cell.prop({ name: { first: 'John' } })`.\n    // Nested arrays are supported too:\n    // `cell.prop('series/0/data/0/degree', 50)` or\n    // `cell.prop({ series: [ { data: [ { degree: 50 } ] } ] })`.\n    prop: function(props, value, opt) {\n\n        var delim = '/';\n        var _isString = isString(props);\n\n        if (_isString || Array.isArray(props)) {\n            // Get/set an attribute by a special path syntax that delimits\n            // nested objects by the colon character.\n\n            if (arguments.length > 1) {\n\n                var path;\n                var pathArray;\n\n                if (_isString) {\n                    path = props;\n                    pathArray = path.split('/');\n                } else {\n                    path = props.join(delim);\n                    pathArray = props.slice();\n                }\n\n                var property = pathArray[0];\n                var pathArrayLength = pathArray.length;\n\n                const options = opt || {};\n                options.propertyPath = path;\n                options.propertyValue = value;\n                options.propertyPathArray = pathArray;\n                if (!('rewrite' in options)) {\n                    options.rewrite = false;\n                }\n\n                var update = {};\n                // Initialize the nested object. Sub-objects are either arrays or objects.\n                // An empty array is created if the sub-key is an integer. Otherwise, an empty object is created.\n                // Note that this imposes a limitation on object keys one can use with Inspector.\n                // Pure integer keys will cause issues and are therefore not allowed.\n                var initializer = update;\n                var prevProperty = property;\n\n                for (var i = 1; i < pathArrayLength; i++) {\n                    var pathItem = pathArray[i];\n                    var isArrayIndex = Number.isFinite(_isString ? Number(pathItem) : pathItem);\n                    initializer = initializer[prevProperty] = isArrayIndex ? [] : {};\n                    prevProperty = pathItem;\n                }\n\n                // Fill update with the `value` on `path`.\n                update = setByPath(update, pathArray, value, '/');\n\n                var baseAttributes = merge({}, this.attributes);\n                // if rewrite mode enabled, we replace value referenced by path with\n                // the new one (we don't merge).\n                options.rewrite && unsetByPath(baseAttributes, path, '/');\n\n                // Merge update with the model attributes.\n                var attributes = merge(baseAttributes, update);\n                // Finally, set the property to the updated attributes.\n                return this.set(property, attributes[property], options);\n\n            } else {\n\n                return getByPath(this.attributes, props, delim);\n            }\n        }\n\n        const options = value || {};\n        // Note: '' is not the path to the root. It's a path with an empty string i.e. { '': {}}.\n        options.propertyPath = null;\n        options.propertyValue = props;\n        options.propertyPathArray = [];\n        if (!('rewrite' in options)) {\n            options.rewrite = false;\n        }\n\n        return this.set(merge({}, this.attributes, props), options);\n    },\n\n    // A convenient way to unset nested properties\n    removeProp: function(path, opt) {\n\n        opt = opt || {};\n\n        var pathArray = Array.isArray(path) ? path : path.split('/');\n\n        // Once a property is removed from the `attrs` attribute\n        // the cellView will recognize a `dirty` flag and re-render itself\n        // in order to remove the attribute from SVG element.\n        var property = pathArray[0];\n        if (property === 'attrs') opt.dirty = true;\n\n        if (pathArray.length === 1) {\n            // A top level property\n            return this.unset(path, opt);\n        }\n\n        // A nested property\n        var nestedPath = pathArray.slice(1);\n        var propertyValue = this.get(property);\n        if (propertyValue === undefined || propertyValue === null) return this;\n        propertyValue = cloneDeep(propertyValue);\n\n        unsetByPath(propertyValue, nestedPath, '/');\n\n        return this.set(property, propertyValue, opt);\n    },\n\n    // A convenient way to set nested attributes.\n    attr: function(attrs, value, opt) {\n\n        var args = Array.from(arguments);\n        if (args.length === 0) {\n            return this.get('attrs');\n        }\n\n        if (Array.isArray(attrs)) {\n            args[0] = ['attrs'].concat(attrs);\n        } else if (isString(attrs)) {\n            // Get/set an attribute by a special path syntax that delimits\n            // nested objects by the colon character.\n            args[0] = 'attrs/' + attrs;\n\n        } else {\n\n            args[0] = { 'attrs' : attrs };\n        }\n\n        return this.prop.apply(this, args);\n    },\n\n    // A convenient way to unset nested attributes\n    removeAttr: function(path, opt) {\n\n        if (Array.isArray(path)) {\n\n            return this.removeProp(['attrs'].concat(path));\n        }\n\n        return this.removeProp('attrs/' + path, opt);\n    },\n\n    transition: function(path, value, opt, delim) {\n\n        delim = delim || '/';\n\n        var defaults = {\n            duration: 100,\n            delay: 10,\n            timingFunction: timing.linear,\n            valueFunction: interpolate.number\n        };\n\n        opt = assign(defaults, opt);\n\n        var firstFrameTime = 0;\n        var interpolatingFunction;\n\n        var setter = function(runtime) {\n\n            var id, progress, propertyValue;\n\n            firstFrameTime = firstFrameTime || runtime;\n            runtime -= firstFrameTime;\n            progress = runtime / opt.duration;\n\n            if (progress < 1) {\n                this._transitionIds[path] = id = nextFrame(setter);\n            } else {\n                progress = 1;\n                delete this._transitionIds[path];\n            }\n\n            propertyValue = interpolatingFunction(opt.timingFunction(progress));\n\n            opt.transitionId = id;\n\n            this.prop(path, propertyValue, opt);\n\n            if (!id) this.trigger('transition:end', this, path);\n\n        }.bind(this);\n\n        const { _scheduledTransitionIds } = this;\n        let initialId;\n\n        var initiator = (callback) => {\n\n            if (_scheduledTransitionIds[path]) {\n                _scheduledTransitionIds[path] = without(_scheduledTransitionIds[path], initialId);\n                if (_scheduledTransitionIds[path].length === 0) {\n                    delete _scheduledTransitionIds[path];\n                }\n            }\n\n            this.stopPendingTransitions(path, delim);\n\n            interpolatingFunction = opt.valueFunction(getByPath(this.attributes, path, delim), value);\n\n            this._transitionIds[path] = nextFrame(callback);\n\n            this.trigger('transition:start', this, path);\n\n        };\n\n        initialId = setTimeout(initiator, opt.delay, setter);\n\n        _scheduledTransitionIds[path] || (_scheduledTransitionIds[path] = []);\n        _scheduledTransitionIds[path].push(initialId);\n\n        return initialId;\n    },\n\n    getTransitions: function() {\n        return union(\n            Object.keys(this._transitionIds),\n            Object.keys(this._scheduledTransitionIds)\n        );\n    },\n\n    stopScheduledTransitions: function(path, delim = '/') {\n        const { _scheduledTransitionIds = {}} = this;\n        let transitions = Object.keys(_scheduledTransitionIds);\n        if (path) {\n            const pathArray = path.split(delim);\n            transitions = transitions.filter((key) => {\n                return isEqual(pathArray, key.split(delim).slice(0, pathArray.length));\n            });\n        }\n        transitions.forEach((key) => {\n            const transitionIds = _scheduledTransitionIds[key];\n            // stop the initiator\n            transitionIds.forEach(transitionId => clearTimeout(transitionId));\n            delete _scheduledTransitionIds[key];\n            // Note: we could trigger transition:cancel` event here\n        });\n        return this;\n    },\n\n    stopPendingTransitions(path, delim = '/') {\n        const { _transitionIds = {}} = this;\n        let transitions = Object.keys(_transitionIds);\n        if (path) {\n            const pathArray = path.split(delim);\n            transitions = transitions.filter((key) => {\n                return isEqual(pathArray, key.split(delim).slice(0, pathArray.length));\n            });\n        }\n        transitions.forEach((key) => {\n            const transitionId = _transitionIds[key];\n            // stop the setter\n            cancelFrame(transitionId);\n            delete _transitionIds[key];\n            this.trigger('transition:end', this, key);\n        });\n    },\n\n    stopTransitions: function(path, delim = '/') {\n        this.stopScheduledTransitions(path, delim);\n        this.stopPendingTransitions(path, delim);\n        return this;\n    },\n\n    // A shorcut making it easy to create constructs like the following:\n    // `var el = (new joint.shapes.basic.Rect).addTo(graph)`.\n    addTo: function(graph, opt) {\n\n        graph.addCell(this, opt);\n        return this;\n    },\n\n    // A shortcut for an equivalent call: `paper.findViewByModel(cell)`\n    // making it easy to create constructs like the following:\n    // `cell.findView(paper).highlight()`\n    findView: function(paper) {\n\n        return paper.findViewByModel(this);\n    },\n\n    isElement: function() {\n\n        return false;\n    },\n\n    isLink: function() {\n\n        return false;\n    },\n\n    startBatch: function(name, opt) {\n\n        if (this.graph) { this.graph.startBatch(name, assign({}, opt, { cell: this })); }\n        return this;\n    },\n\n    stopBatch: function(name, opt) {\n\n        if (this.graph) { this.graph.stopBatch(name, assign({}, opt, { cell: this })); }\n        return this;\n    },\n\n    getChangeFlag: function(attributes) {\n\n        var flag = 0;\n        if (!attributes) return flag;\n        for (var key in attributes) {\n            if (!attributes.hasOwnProperty(key) || !this.hasChanged(key)) continue;\n            flag |= attributes[key];\n        }\n        return flag;\n    },\n\n    angle: function() {\n\n        // To be overridden.\n        return 0;\n    },\n\n    position: function() {\n\n        // To be overridden.\n        return new g.Point(0, 0);\n    },\n\n    z: function() {\n        return this.get('z') || 0;\n    },\n\n    getPointFromConnectedLink: function() {\n\n        // To be overridden\n        return new g.Point();\n    },\n\n    getBBox: function() {\n\n        // To be overridden\n        return new g.Rect(0, 0, 0, 0);\n    },\n\n    getPointRotatedAroundCenter(angle, x, y) {\n        const point = new g.Point(x, y);\n        if (angle) point.rotate(this.getBBox().center(), angle);\n        return point;\n    },\n\n    getAbsolutePointFromRelative(x, y) {\n        // Rotate the position to take the model angle into account\n        return this.getPointRotatedAroundCenter(\n            -this.angle(),\n            // Transform the relative position to absolute\n            this.position().offset(x, y)\n        );\n    },\n\n    getRelativePointFromAbsolute(x, y) {\n        return this\n            // Rotate the coordinates to mitigate the element's rotation.\n            .getPointRotatedAroundCenter(this.angle(), x, y)\n            // Transform the absolute position into relative\n            .difference(this.position());\n    }\n\n}, {\n\n    getAttributeDefinition: function(attrName) {\n\n        var defNS = this.attributes;\n        var globalDefNS = attributes;\n        return (defNS && defNS[attrName]) || globalDefNS[attrName];\n    },\n\n    define: function(type, defaults, protoProps, staticProps) {\n\n        protoProps = assign({\n            defaults: defaultsDeep({ type: type }, defaults, this.prototype.defaults)\n        }, protoProps);\n\n        var Cell = this.extend(protoProps, staticProps);\n        // es5 backward compatibility\n        /* eslint-disable no-undef */\n        if (typeof joint !== 'undefined' && has(joint, 'shapes')) {\n            setByPath(joint.shapes, type, Cell, '.');\n        }\n        /* eslint-enable no-undef */\n        return Cell;\n    }\n});\n\n","import { Cell } from '../dia/Cell.mjs';\nimport { isFunction, isString, toArray } from './util.mjs';\n\nexport const wrapWith = function(object, methods, wrapper) {\n\n    if (isString(wrapper)) {\n\n        if (!wrappers[wrapper]) {\n            throw new Error('Unknown wrapper: \"' + wrapper + '\"');\n        }\n\n        wrapper = wrappers[wrapper];\n    }\n\n    if (!isFunction(wrapper)) {\n        throw new Error('Wrapper must be a function.');\n    }\n\n    toArray(methods).forEach(function(method) {\n        object[method] = wrapper(object[method]);\n    });\n};\n\nexport const wrappers = {\n\n    cells: function(fn) {\n\n        return function() {\n\n            var args = Array.from(arguments);\n            var n = args.length;\n            var cells = n > 0 && args[0] || [];\n            var opt = n > 1 && args[n - 1] || {};\n\n            if (!Array.isArray(cells)) {\n\n                if (opt instanceof Cell) {\n                    cells = args;\n                } else if (cells instanceof Cell) {\n                    if (args.length > 1) {\n                        args.pop();\n                    }\n                    cells = args;\n                }\n            }\n\n            if (opt instanceof Cell) {\n                opt = {};\n            }\n\n            return fn.call(this, cells, opt);\n        };\n    }\n\n};\n\n","import * as g from '../g/index.mjs';\n\nexport const Positions = {\n    TOP: 'top',\n    RIGHT: 'right',\n    BOTTOM: 'bottom',\n    LEFT: 'left',\n    TOP_LEFT: 'top-left',\n    TOP_RIGHT: 'top-right',\n    BOTTOM_LEFT: 'bottom-left',\n    BOTTOM_RIGHT: 'bottom-right',\n    CENTER: 'center',\n};\n\nexport function getRectPoint(rect, position) {\n    const r = new g.Rect(rect);\n    switch (position) {\n        case undefined:\n            throw new Error('Position required');\n\n        // Middle Points\n        case Positions.LEFT:\n        case 'leftMiddle':\n            return r.leftMiddle();\n\n        case Positions.RIGHT:\n        case 'rightMiddle':\n            return r.rightMiddle();\n\n        case Positions.TOP:\n        case 'topMiddle':\n            return r.topMiddle();\n\n        case Positions.BOTTOM:\n        case 'bottomMiddle':\n            return r.bottomMiddle();\n\n        // Corners\n        case Positions.TOP_LEFT:\n        case 'topLeft':\n        case 'origin':\n            return r.topLeft();\n\n        case Positions.TOP_RIGHT:\n        case 'topRight':\n            return r.topRight();\n\n        case Positions.BOTTOM_LEFT:\n        case 'bottomLeft':\n            return r.bottomLeft();\n\n        case Positions.BOTTOM_RIGHT:\n        case 'bottomRight':\n        case 'corner':\n            return r.bottomRight();\n\n        // Center\n        case Positions.CENTER:\n            return r.center();\n\n        // TODO: calc(), percentage etc.\n        default:\n            throw new Error(`Unknown position: ${position}`);\n    }\n}\n","import { evalCalcAttribute, isCalcAttribute } from '../../dia/attributes/calc.mjs';\nimport * as g from '../../g/index.mjs';\nimport * as util from '../../util/index.mjs';\n\nfunction portTransformAttrs(point, angle, opt) {\n\n    var trans = point.toJSON();\n\n    trans.angle = angle || 0;\n\n    return util.defaults({}, opt, trans);\n}\n\nfunction lineLayout(ports, p1, p2, elBBox) {\n    return ports.map(function(port, index, ports) {\n        var p = this.pointAt(((index + 0.5) / ports.length));\n        // `dx`,`dy` per port offset option\n        if (port.dx || port.dy) {\n            p.offset(port.dx || 0, port.dy || 0);\n        }\n        return portTransformAttrs(p.round(), 0, argTransform(elBBox, port));\n    }, g.line(p1, p2));\n}\n\nfunction ellipseLayout(ports, elBBox, startAngle, stepFn) {\n\n    var center = elBBox.center();\n    var ratio = elBBox.width / elBBox.height;\n    var p1 = elBBox.topMiddle();\n\n    var ellipse = g.Ellipse.fromRect(elBBox);\n\n    return ports.map(function(port, index, ports) {\n\n        var angle = startAngle + stepFn(index, ports.length);\n        var p2 = p1.clone()\n            .rotate(center, -angle)\n            .scale(ratio, 1, center);\n\n        var theta = port.compensateRotation ? -ellipse.tangentTheta(p2) : 0;\n\n        // `dx`,`dy` per port offset option\n        if (port.dx || port.dy) {\n            p2.offset(port.dx || 0, port.dy || 0);\n        }\n\n        // `dr` delta radius option\n        if (port.dr) {\n            p2.move(center, port.dr);\n        }\n\n        return portTransformAttrs(p2.round(), theta, argTransform(elBBox, port));\n    });\n}\n\n\nfunction argTransform(bbox, args) {\n    let { x, y, angle } = args;\n    if (util.isPercentage(x)) {\n        x = parseFloat(x) / 100 * bbox.width;\n    } else if (isCalcAttribute(x)) {\n        x = Number(evalCalcAttribute(x, bbox));\n    }\n    if (util.isPercentage(y)) {\n        y = parseFloat(y) / 100 * bbox.height;\n    } else if (isCalcAttribute(y)) {\n        y = Number(evalCalcAttribute(y, bbox));\n    }\n    return { x, y, angle };\n}\n\n// Creates a point stored in arguments\nfunction argPoint(bbox, args) {\n    const { x, y } = argTransform(bbox, args);\n    return new g.Point(x || 0, y || 0);\n}\n\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt opt Group options\n * @returns {Array<g.Point>}\n */\nexport const absolute = function(ports, elBBox) {\n    return ports.map(port => {\n        const transformation = argPoint(elBBox, port).round().toJSON();\n        transformation.angle = port.angle || 0;\n        return transformation;\n    });\n};\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt opt Group options\n * @returns {Array<g.Point>}\n */\nexport const fn = function(ports, elBBox, opt) {\n    return opt.fn(ports, elBBox, opt);\n};\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt opt Group options\n * @returns {Array<g.Point>}\n */\nexport const line = function(ports, elBBox, opt) {\n\n    var start = argPoint(elBBox, opt.start || elBBox.origin());\n    var end = argPoint(elBBox, opt.end || elBBox.corner());\n\n    return lineLayout(ports, start, end, elBBox);\n};\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt opt Group options\n * @returns {Array<g.Point>}\n */\nexport const left = function(ports, elBBox, opt) {\n    return lineLayout(ports, elBBox.origin(), elBBox.bottomLeft(), elBBox);\n};\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt opt Group options\n * @returns {Array<g.Point>}\n */\nexport const right = function(ports, elBBox, opt) {\n    return lineLayout(ports, elBBox.topRight(), elBBox.corner(), elBBox);\n};\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt opt Group options\n * @returns {Array<g.Point>}\n */\nexport const top = function(ports, elBBox, opt) {\n    return lineLayout(ports, elBBox.origin(), elBBox.topRight(), elBBox);\n};\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt opt Group options\n * @returns {Array<g.Point>}\n */\nexport const bottom = function(ports, elBBox, opt) {\n    return lineLayout(ports, elBBox.bottomLeft(), elBBox.corner(), elBBox);\n};\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt Group options\n * @returns {Array<g.Point>}\n */\nexport const ellipseSpread = function(ports, elBBox, opt) {\n\n    var startAngle = opt.startAngle || 0;\n    var stepAngle = opt.step || 360 / ports.length;\n\n    return ellipseLayout(ports, elBBox, startAngle, function(index) {\n        return index * stepAngle;\n    });\n};\n\n/**\n * @param {Array<Object>} ports\n * @param {g.Rect} elBBox\n * @param {Object=} opt Group options\n * @returns {Array<g.Point>}\n */\nexport const ellipse = function(ports, elBBox, opt) {\n\n    var startAngle = opt.startAngle || 0;\n    var stepAngle = opt.step || 20;\n\n    return ellipseLayout(ports, elBBox, startAngle, function(index, count) {\n        return (index + 0.5 - count / 2) * stepAngle;\n    });\n};\n\n","import * as g from '../../g/index.mjs';\nimport * as util from '../../util/index.mjs';\n\nfunction labelAttributes(opt1, opt2) {\n\n    // use value from `opt2` if it is missing in `opt1`\n    // use value from this object if it is missing in `opt2` as well\n    return util.defaultsDeep({}, opt1, opt2, {\n        x: 0,\n        y: 0,\n        angle: 0,\n        attrs: {}\n    });\n}\n\nfunction getBBoxAngles(elBBox) {\n\n    var center = elBBox.center();\n\n    var tl = center.theta(elBBox.origin());\n    var bl = center.theta(elBBox.bottomLeft());\n    var br = center.theta(elBBox.corner());\n    var tr = center.theta(elBBox.topRight());\n\n    return [tl, tr, br, bl];\n}\n\nfunction outsideLayout(portPosition, elBBox, autoOrient, opt) {\n\n    opt = util.defaults({}, opt, { offset: 15 });\n    var angle = elBBox.center().theta(portPosition);\n\n    var tx, ty, y, textAnchor;\n    var offset = opt.offset;\n    var orientAngle = 0;\n\n    const [topLeftAngle, bottomLeftAngle, bottomRightAngle, topRightAngle] = getBBoxAngles(elBBox);\n    if ((angle < bottomLeftAngle) || (angle > bottomRightAngle)) {\n        y = '.3em';\n        tx = offset;\n        ty = 0;\n        textAnchor = 'start';\n    } else if (angle < topLeftAngle) {\n        tx = 0;\n        ty = -offset;\n        if (autoOrient) {\n            orientAngle = -90;\n            textAnchor = 'start';\n            y = '.3em';\n        } else {\n            textAnchor = 'middle';\n            y = '0';\n        }\n    } else if (angle < topRightAngle) {\n        y = '.3em';\n        tx = -offset;\n        ty = 0;\n        textAnchor = 'end';\n    } else {\n        tx = 0;\n        ty = offset;\n        if (autoOrient) {\n            orientAngle = 90;\n            textAnchor = 'start';\n            y = '.3em';\n        } else {\n            textAnchor = 'middle';\n            y = '.6em';\n        }\n    }\n\n    var round = Math.round;\n    return labelAttributes(opt, {\n        x: round(tx),\n        y: round(ty),\n        angle: orientAngle,\n        attrs: { labelText: { y, textAnchor }}\n    });\n}\n\nfunction insideLayout(portPosition, elBBox, autoOrient, opt) {\n\n    opt = util.defaults({}, opt, { offset: 15 });\n    var angle = elBBox.center().theta(portPosition);\n\n    var tx, ty, y, textAnchor;\n    var offset = opt.offset;\n    var orientAngle = 0;\n\n    const [topLeftAngle, bottomLeftAngle, bottomRightAngle, topRightAngle] = getBBoxAngles(elBBox);\n    if ((angle < bottomLeftAngle) || (angle > bottomRightAngle)) {\n        y = '.3em';\n        tx = -offset;\n        ty = 0;\n        textAnchor = 'end';\n    } else if (angle < topLeftAngle) {\n        tx = 0;\n        ty = offset;\n        if (autoOrient) {\n            orientAngle = 90;\n            textAnchor = 'start';\n            y = '.3em';\n        } else {\n            textAnchor = 'middle';\n            y = '.6em';\n        }\n    } else if (angle < topRightAngle) {\n        y = '.3em';\n        tx = offset;\n        ty = 0;\n        textAnchor = 'start';\n    } else {\n        tx = 0;\n        ty = -offset;\n        if (autoOrient) {\n            orientAngle = -90;\n            textAnchor = 'start';\n            y = '.3em';\n        } else {\n            textAnchor = 'middle';\n            y = '0';\n        }\n    }\n\n    var round = Math.round;\n    return labelAttributes(opt, {\n        x: round(tx),\n        y: round(ty),\n        angle: orientAngle,\n        attrs: { labelText: { y, textAnchor }}\n    });\n}\n\nfunction radialLayout(portCenterOffset, autoOrient, opt) {\n\n    opt = util.defaults({}, opt, { offset: 20 });\n\n    var origin = g.point(0, 0);\n    var angle = -portCenterOffset.theta(origin);\n    var orientAngle = angle;\n    var offset = portCenterOffset.clone()\n        .move(origin, opt.offset)\n        .difference(portCenterOffset)\n        .round();\n\n    var y = '.3em';\n    var textAnchor;\n\n    if ((angle + 90) % 180 === 0) {\n        textAnchor = autoOrient ? 'end' : 'middle';\n        if (!autoOrient && angle === -270) {\n            y = '0em';\n        }\n    } else if (angle > -270 && angle < -90) {\n        textAnchor = 'start';\n        orientAngle = angle - 180;\n    } else {\n        textAnchor = 'end';\n    }\n\n    var round = Math.round;\n    return labelAttributes(opt, {\n        x: round(offset.x),\n        y: round(offset.y),\n        angle: ((autoOrient) ? orientAngle : 0),\n        attrs: { labelText: { y, textAnchor }}\n    });\n}\n\nexport const manual = function(_portPosition, _elBBox, opt) {\n    return labelAttributes(opt);\n};\n\nexport const left = function(portPosition, elBBox, opt) {\n    return labelAttributes(opt, {\n        x: -15,\n        attrs: { labelText: { y: '.3em', textAnchor: 'end' }},\n    });\n};\n\nexport const right = function(portPosition, elBBox, opt) {\n    return labelAttributes(opt, {\n        x: 15,\n        attrs: { labelText: { y: '.3em', textAnchor: 'start' }},\n    });\n};\n\nexport const top = function(portPosition, elBBox, opt) {\n    return labelAttributes(opt, {\n        y: -15,\n        attrs: { labelText: { y: '0', textAnchor: 'middle' }},\n    });\n};\n\nexport const bottom = function(portPosition, elBBox, opt) {\n    return labelAttributes(opt, {\n        y: 15,\n        attrs: { labelText: { y: '.6em', textAnchor: 'middle' }},\n    });\n};\n\nexport const outsideOriented = function(portPosition, elBBox, opt) {\n    return outsideLayout(portPosition, elBBox, true, opt);\n};\n\nexport const outside = function(portPosition, elBBox, opt) {\n    return outsideLayout(portPosition, elBBox, false, opt);\n};\n\nexport const insideOriented = function(portPosition, elBBox, opt) {\n    return insideLayout(portPosition, elBBox, true, opt);\n};\n\nexport const inside = function(portPosition, elBBox, opt) {\n    return insideLayout(portPosition, elBBox, false, opt);\n};\n\nexport const radial = function(portPosition, elBBox, opt) {\n    return radialLayout(portPosition.difference(elBBox.center()), false, opt);\n};\n\nexport const radialOriented = function(portPosition, elBBox, opt) {\n    return radialLayout(portPosition.difference(elBBox.center()), true, opt);\n};\n","import { Cell } from './Cell.mjs';\nimport { clone, isPlainObject, isFunction, isString, isNumber } from '../util/index.mjs';\nimport { Point, Polyline } from '../g/index.mjs';\n\n// Link base model.\n// --------------------------\n\nexport const Link = Cell.extend({\n\n    // The default markup for links.\n    markup: [\n        '<path class=\"connection\" stroke=\"black\" d=\"M 0 0 0 0\"/>',\n        '<path class=\"marker-source\" fill=\"black\" stroke=\"black\" d=\"M 0 0 0 0\"/>',\n        '<path class=\"marker-target\" fill=\"black\" stroke=\"black\" d=\"M 0 0 0 0\"/>',\n        '<path class=\"connection-wrap\" d=\"M 0 0 0 0\"/>',\n        '<g class=\"labels\"/>',\n        '<g class=\"marker-vertices\"/>',\n        '<g class=\"marker-arrowheads\"/>',\n        '<g class=\"link-tools\"/>'\n    ].join(''),\n\n    toolMarkup: [\n        '<g class=\"link-tool\">',\n        '<g class=\"tool-remove\" event=\"remove\">',\n        '<circle r=\"11\" />',\n        '<path transform=\"scale(.8) translate(-16, -16)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\" />',\n        '<title>Remove link.</title>',\n        '</g>',\n        '<g class=\"tool-options\" event=\"link:options\">',\n        '<circle r=\"11\" transform=\"translate(25)\"/>',\n        '<path fill=\"white\" transform=\"scale(.55) translate(29, -16)\" d=\"M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z\"/>',\n        '<title>Link options.</title>',\n        '</g>',\n        '</g>'\n    ].join(''),\n\n    doubleToolMarkup: undefined,\n\n    // The default markup for showing/removing vertices. These elements are the children of the .marker-vertices element (see `this.markup`).\n    // Only .marker-vertex and .marker-vertex-remove element have special meaning. The former is used for\n    // dragging vertices (changing their position). The latter is used for removing vertices.\n    vertexMarkup: [\n        '<g class=\"marker-vertex-group\" transform=\"translate(<%= x %>, <%= y %>)\">',\n        '<circle class=\"marker-vertex\" idx=\"<%= idx %>\" r=\"10\" />',\n        '<path class=\"marker-vertex-remove-area\" idx=\"<%= idx %>\" d=\"M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z\" transform=\"translate(5, -33)\"/>',\n        '<path class=\"marker-vertex-remove\" idx=\"<%= idx %>\" transform=\"scale(.8) translate(9.5, -37)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\">',\n        '<title>Remove vertex.</title>',\n        '</path>',\n        '</g>'\n    ].join(''),\n\n    arrowheadMarkup: [\n        '<g class=\"marker-arrowhead-group marker-arrowhead-group-<%= end %>\">',\n        '<path class=\"marker-arrowhead\" end=\"<%= end %>\" d=\"M 26 0 L 0 13 L 26 26 z\" />',\n        '</g>'\n    ].join(''),\n\n    // may be overwritten by user to change default label (its markup, size, attrs, position)\n    defaultLabel: undefined,\n\n    // deprecated\n    // may be overwritten by user to change default label markup\n    // lower priority than defaultLabel.markup\n    labelMarkup: undefined,\n\n    // private\n    _builtins: {\n        defaultLabel: {\n            // builtin default markup:\n            // used if neither defaultLabel.markup\n            // nor label.markup is set\n            markup: [\n                {\n                    tagName: 'rect',\n                    selector: 'rect' // faster than tagName CSS selector\n                }, {\n                    tagName: 'text',\n                    selector: 'text' // faster than tagName CSS selector\n                }\n            ],\n            // builtin default attributes:\n            // applied only if builtin default markup is used\n            attrs: {\n                text: {\n                    fill: '#000000',\n                    fontSize: 14,\n                    textAnchor: 'middle',\n                    yAlignment: 'middle',\n                    pointerEvents: 'none'\n                },\n                rect: {\n                    ref: 'text',\n                    fill: '#ffffff',\n                    rx: 3,\n                    ry: 3,\n                    refWidth: 1,\n                    refHeight: 1,\n                    refX: 0,\n                    refY: 0\n                }\n            },\n            // builtin default position:\n            // used if neither defaultLabel.position\n            // nor label.position is set\n            position: {\n                distance: 0.5\n            }\n        }\n    },\n\n    defaults: {\n        type: 'link',\n        source: {},\n        target: {}\n    },\n\n    isLink: function() {\n\n        return true;\n    },\n\n    disconnect: function(opt) {\n\n        return this.set({\n            source: { x: 0, y: 0 },\n            target: { x: 0, y: 0 }\n        }, opt);\n    },\n\n    source: function(source, args, opt) {\n\n        // getter\n        if (source === undefined) {\n            return clone(this.get('source'));\n        }\n\n        // setter\n        var setSource;\n        var setOpt;\n\n        // `source` is a cell\n        // take only its `id` and combine with `args`\n        var isCellProvided = source instanceof Cell;\n        if (isCellProvided) { // three arguments\n            setSource = clone(args) || {};\n            setSource.id = source.id;\n            setOpt = opt;\n            return this.set('source', setSource, setOpt);\n        }\n\n        // `source` is a point-like object\n        // for example, a g.Point\n        // take only its `x` and `y` and combine with `args`\n        var isPointProvided = !isPlainObject(source);\n        if (isPointProvided) { // three arguments\n            setSource = clone(args) || {};\n            setSource.x = source.x;\n            setSource.y = source.y;\n            setOpt = opt;\n            return this.set('source', setSource, setOpt);\n        }\n\n        // `source` is an object\n        // no checking\n        // two arguments\n        setSource = source;\n        setOpt = args;\n        return this.set('source', setSource, setOpt);\n    },\n\n    target: function(target, args, opt) {\n\n        // getter\n        if (target === undefined) {\n            return clone(this.get('target'));\n        }\n\n        // setter\n        var setTarget;\n        var setOpt;\n\n        // `target` is a cell\n        // take only its `id` argument and combine with `args`\n        var isCellProvided = target instanceof Cell;\n        if (isCellProvided) { // three arguments\n            setTarget = clone(args) || {};\n            setTarget.id = target.id;\n            setOpt = opt;\n            return this.set('target', setTarget, setOpt);\n        }\n\n        // `target` is a point-like object\n        // for example, a g.Point\n        // take only its `x` and `y` and combine with `args`\n        var isPointProvided = !isPlainObject(target);\n        if (isPointProvided) { // three arguments\n            setTarget = clone(args) || {};\n            setTarget.x = target.x;\n            setTarget.y = target.y;\n            setOpt = opt;\n            return this.set('target', setTarget, setOpt);\n        }\n\n        // `target` is an object\n        // no checking\n        // two arguments\n        setTarget = target;\n        setOpt = args;\n        return this.set('target', setTarget, setOpt);\n    },\n\n    router: function(name, args, opt) {\n\n        // getter\n        if (name === undefined) {\n            var router = this.get('router');\n            if (!router) {\n                if (this.get('manhattan')) return { name: 'orthogonal' }; // backwards compatibility\n                return null;\n            }\n            if (typeof router === 'object') return clone(router);\n            return router; // e.g. a function\n        }\n\n        // setter\n        var isRouterProvided = ((typeof name === 'object') || (typeof name === 'function'));\n        var localRouter = isRouterProvided ? name : { name: name, args: args };\n        var localOpt = isRouterProvided ? args : opt;\n\n        return this.set('router', localRouter, localOpt);\n    },\n\n    connector: function(name, args, opt) {\n\n        // getter\n        if (name === undefined) {\n            var connector = this.get('connector');\n            if (!connector) {\n                if (this.get('smooth')) return { name: 'smooth' }; // backwards compatibility\n                return null;\n            }\n            if (typeof connector === 'object') return clone(connector);\n            return connector; // e.g. a function\n        }\n\n        // setter\n        var isConnectorProvided = ((typeof name === 'object' || typeof name === 'function'));\n        var localConnector = isConnectorProvided ? name : { name: name, args: args };\n        var localOpt = isConnectorProvided ? args : opt;\n\n        return this.set('connector', localConnector, localOpt);\n    },\n\n    // Labels API\n\n    // A convenient way to set labels. Currently set values will be mixined with `value` if used as a setter.\n    label: function(idx, label, opt) {\n\n        var labels = this.labels();\n\n        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : 0;\n        if (idx < 0) idx = labels.length + idx;\n\n        // getter\n        if (arguments.length <= 1) return this.prop(['labels', idx]);\n        // setter\n        return this.prop(['labels', idx], label, opt);\n    },\n\n    labels: function(labels, opt) {\n\n        // getter\n        if (arguments.length === 0) {\n            labels = this.get('labels');\n            if (!Array.isArray(labels)) return [];\n            return labels.slice();\n        }\n        // setter\n        if (!Array.isArray(labels)) labels = [];\n        return this.set('labels', labels, opt);\n    },\n\n    hasLabels: function() {\n        const { labels } = this.attributes;\n        return Array.isArray(labels) && labels.length > 0;\n    },\n\n    insertLabel: function(idx, label, opt) {\n\n        if (!label) throw new Error('dia.Link: no label provided');\n\n        var labels = this.labels();\n        var n = labels.length;\n        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : n;\n        if (idx < 0) idx = n + idx + 1;\n\n        labels.splice(idx, 0, label);\n        return this.labels(labels, opt);\n    },\n\n    // convenience function\n    // add label to end of labels array\n    appendLabel: function(label, opt) {\n\n        return this.insertLabel(-1, label, opt);\n    },\n\n    removeLabel: function(idx, opt) {\n\n        var labels = this.labels();\n        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : -1;\n\n        labels.splice(idx, 1);\n        return this.labels(labels, opt);\n    },\n\n    // Vertices API\n\n    vertex: function(idx, vertex, opt) {\n\n        var vertices = this.vertices();\n\n        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : 0;\n        if (idx < 0) idx = vertices.length + idx;\n\n        // getter\n        if (arguments.length <= 1) return this.prop(['vertices', idx]);\n\n        // setter\n        var setVertex = this._normalizeVertex(vertex);\n        return this.prop(['vertices', idx], setVertex, opt);\n    },\n\n    vertices: function(vertices, opt) {\n\n        // getter\n        if (arguments.length === 0) {\n            vertices = this.get('vertices');\n            if (!Array.isArray(vertices)) return [];\n            return vertices.slice();\n        }\n\n        // setter\n        if (!Array.isArray(vertices)) vertices = [];\n        var setVertices = [];\n        for (var i = 0; i < vertices.length; i++) {\n            var vertex = vertices[i];\n            var setVertex = this._normalizeVertex(vertex);\n            setVertices.push(setVertex);\n        }\n        return this.set('vertices', setVertices, opt);\n    },\n\n    insertVertex: function(idx, vertex, opt) {\n\n        if (!vertex) throw new Error('dia.Link: no vertex provided');\n\n        var vertices = this.vertices();\n        var n = vertices.length;\n        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : n;\n        if (idx < 0) idx = n + idx + 1;\n\n        var setVertex = this._normalizeVertex(vertex);\n        vertices.splice(idx, 0, setVertex);\n        return this.vertices(vertices, opt);\n    },\n\n    removeVertex: function(idx, opt) {\n\n        var vertices = this.vertices();\n        idx = (isFinite(idx) && idx !== null) ? (idx | 0) : -1;\n\n        vertices.splice(idx, 1);\n        return this.vertices(vertices, opt);\n    },\n\n    _normalizeVertex: function(vertex) {\n\n        // is vertex a point-like object?\n        // for example, a g.Point\n        var isPointProvided = !isPlainObject(vertex);\n        if (isPointProvided) return { x: vertex.x, y: vertex.y };\n\n        // else: return vertex unchanged\n        return vertex;\n    },\n\n    // Transformations\n\n    translate: function(tx, ty, opt) {\n\n        // enrich the option object\n        opt = opt || {};\n        opt.translateBy = opt.translateBy || this.id;\n        opt.tx = tx;\n        opt.ty = ty;\n\n        return this.applyToPoints(function(p) {\n            return { x: (p.x || 0) + tx, y: (p.y || 0) + ty };\n        }, opt);\n    },\n\n    scale: function(sx, sy, origin, opt) {\n\n        return this.applyToPoints(function(p) {\n            return Point(p).scale(sx, sy, origin).toJSON();\n        }, opt);\n    },\n\n    applyToPoints: function(fn, opt) {\n\n        if (!isFunction(fn)) {\n            throw new TypeError('dia.Link: applyToPoints expects its first parameter to be a function.');\n        }\n\n        var attrs = {};\n\n        var { source, target } = this.attributes;\n        if (!source.id) {\n            attrs.source = fn(source);\n        }\n        if (!target.id) {\n            attrs.target = fn(target);\n        }\n\n        var vertices = this.vertices();\n        if (vertices.length > 0) {\n            attrs.vertices = vertices.map(fn);\n        }\n\n        return this.set(attrs, opt);\n    },\n\n    getSourcePoint: function() {\n        var sourceCell = this.getSourceCell();\n        if (!sourceCell) return new Point(this.source());\n        return sourceCell.getPointFromConnectedLink(this, 'source');\n    },\n\n    getTargetPoint: function() {\n        var targetCell = this.getTargetCell();\n        if (!targetCell) return new Point(this.target());\n        return targetCell.getPointFromConnectedLink(this, 'target');\n    },\n\n    getPointFromConnectedLink: function(/* link, endType */) {\n        return this.getPolyline().pointAt(0.5);\n    },\n\n    getPolyline: function() {\n        const points = [\n            this.getSourcePoint(),\n            ...this.vertices().map(Point),\n            this.getTargetPoint()\n        ];\n        return new Polyline(points);\n    },\n\n    getBBox: function() {\n        return this.getPolyline().bbox();\n    },\n\n    reparent: function(opt) {\n\n        var newParent;\n\n        if (this.graph) {\n\n            var source = this.getSourceElement();\n            var target = this.getTargetElement();\n            var prevParent = this.getParentCell();\n\n            if (source && target) {\n                if (source === target || source.isEmbeddedIn(target)) {\n                    newParent = target;\n                } else if (target.isEmbeddedIn(source)) {\n                    newParent = source;\n                } else {\n                    newParent = this.graph.getCommonAncestor(source, target);\n                }\n            }\n\n            if (prevParent && (!newParent || newParent.id !== prevParent.id)) {\n                // Unembed the link if source and target has no common ancestor\n                // or common ancestor changed\n                prevParent.unembed(this, opt);\n            }\n\n            if (newParent) {\n                newParent.embed(this, opt);\n            }\n        }\n\n        return newParent;\n    },\n\n    hasLoop: function(opt) {\n\n        opt = opt || {};\n\n        var { source, target } = this.attributes;\n        var sourceId = source.id;\n        var targetId = target.id;\n\n        if (!sourceId || !targetId) {\n            // Link \"pinned\" to the paper does not have a loop.\n            return false;\n        }\n\n        var loop = sourceId === targetId;\n\n        // Note that there in the deep mode a link can have a loop,\n        // even if it connects only a parent and its embed.\n        // A loop \"target equals source\" is valid in both shallow and deep mode.\n        if (!loop && opt.deep && this.graph) {\n\n            var sourceElement = this.getSourceCell();\n            var targetElement = this.getTargetCell();\n\n            loop = sourceElement.isEmbeddedIn(targetElement) || targetElement.isEmbeddedIn(sourceElement);\n        }\n\n        return loop;\n    },\n\n    // unlike source(), this method returns null if source is a point\n    getSourceCell: function() {\n\n        const { graph, attributes } = this;\n        var source = attributes.source;\n        return (source && source.id && graph && graph.getCell(source.id)) || null;\n    },\n\n    getSourceElement: function() {\n        var cell = this;\n        var visited = {};\n        do {\n            if (visited[cell.id]) return null;\n            visited[cell.id] = true;\n            cell = cell.getSourceCell();\n        } while (cell && cell.isLink());\n        return cell;\n    },\n\n    // unlike target(), this method returns null if target is a point\n    getTargetCell: function() {\n\n        const { graph, attributes } = this;\n        var target = attributes.target;\n        return (target && target.id && graph && graph.getCell(target.id)) || null;\n    },\n\n    getTargetElement: function() {\n        var cell = this;\n        var visited = {};\n        do {\n            if (visited[cell.id]) return null;\n            visited[cell.id] = true;\n            cell = cell.getTargetCell();\n        } while (cell && cell.isLink());\n        return cell;\n    },\n\n    // Returns the common ancestor for the source element,\n    // target element and the link itself.\n    getRelationshipAncestor: function() {\n\n        var connectionAncestor;\n\n        if (this.graph) {\n\n            var cells = [\n                this,\n                this.getSourceElement(), // null if source is a point\n                this.getTargetElement() // null if target is a point\n            ].filter(function(item) {\n                return !!item;\n            });\n\n            connectionAncestor = this.graph.getCommonAncestor.apply(this.graph, cells);\n        }\n\n        return connectionAncestor || null;\n    },\n\n    // Is source, target and the link itself embedded in a given cell?\n    isRelationshipEmbeddedIn: function(cell) {\n\n        var cellId = (isString(cell) || isNumber(cell)) ? cell : cell.id;\n        var ancestor = this.getRelationshipAncestor();\n\n        return !!ancestor && (ancestor.id === cellId || ancestor.isEmbeddedIn(cellId));\n    },\n\n    // Get resolved default label.\n    _getDefaultLabel: function() {\n\n        var defaultLabel = this.get('defaultLabel') || this.defaultLabel || {};\n\n        var label = {};\n        label.markup = defaultLabel.markup || this.get('labelMarkup') || this.labelMarkup;\n        label.position = defaultLabel.position;\n        label.attrs = defaultLabel.attrs;\n        label.size = defaultLabel.size;\n\n        return label;\n    }\n}, {\n\n    endsEqual: function(a, b) {\n\n        var portsEqual = a.port === b.port || !a.port && !b.port;\n        return a.id === b.id && portsEqual;\n    }\n});\n\n","import * as util from '../util/index.mjs';\nimport V from '../V/index.mjs';\nimport { Rect, Point } from '../g/index.mjs';\nimport * as Port from '../layout/ports/port.mjs';\nimport * as PortLabel from '../layout/ports/portLabel.mjs';\n\nvar PortData = function(data) {\n\n    var clonedData = util.cloneDeep(data) || {};\n    this.ports = [];\n    this.groups = {};\n    this.portLayoutNamespace = Port;\n    this.portLabelLayoutNamespace = PortLabel;\n\n    this._init(clonedData);\n};\n\nPortData.prototype = {\n\n    getPorts: function() {\n        return this.ports;\n    },\n\n    getGroup: function(name) {\n        return this.groups[name] || {};\n    },\n\n    getPortsByGroup: function(groupName) {\n\n        return this.ports.filter(function(port) {\n            return port.group === groupName;\n        });\n    },\n\n    getGroupPortsMetrics: function(groupName, elBBox) {\n\n        var group = this.getGroup(groupName);\n        var ports = this.getPortsByGroup(groupName);\n\n        var groupPosition = group.position || {};\n        var groupPositionName = groupPosition.name;\n        var namespace = this.portLayoutNamespace;\n        if (!namespace[groupPositionName]) {\n            groupPositionName = 'left';\n        }\n\n        var groupArgs = groupPosition.args || {};\n        var portsArgs = ports.map(function(port) {\n            return port && port.position && port.position.args;\n        });\n        var groupPortTransformations = namespace[groupPositionName](portsArgs, elBBox, groupArgs);\n\n        var accumulator = {\n            ports: ports,\n            result: []\n        };\n\n        util.toArray(groupPortTransformations).reduce(function(res, portTransformation, index) {\n            var port = res.ports[index];\n            res.result.push({\n                portId: port.id,\n                portTransformation: portTransformation,\n                labelTransformation: this._getPortLabelLayout(port, Point(portTransformation), elBBox),\n                portAttrs: port.attrs,\n                portSize: port.size,\n                labelSize: port.label.size\n            });\n            return res;\n        }.bind(this), accumulator);\n\n        return accumulator.result;\n    },\n\n    _getPortLabelLayout: function(port, portPosition, elBBox) {\n\n        var namespace = this.portLabelLayoutNamespace;\n        var labelPosition = port.label.position.name || 'left';\n\n        if (namespace[labelPosition]) {\n            return namespace[labelPosition](portPosition, elBBox, port.label.position.args);\n        }\n\n        return null;\n    },\n\n    _init: function(data) {\n\n        // prepare groups\n        if (util.isObject(data.groups)) {\n            var groups = Object.keys(data.groups);\n            for (var i = 0, n = groups.length; i < n; i++) {\n                var key = groups[i];\n                this.groups[key] = this._evaluateGroup(data.groups[key]);\n            }\n        }\n\n        // prepare ports\n        var ports = util.toArray(data.items);\n        for (var j = 0, m = ports.length; j < m; j++) {\n            this.ports.push(this._evaluatePort(ports[j]));\n        }\n    },\n\n    _evaluateGroup: function(group) {\n\n        return util.merge(group, {\n            position: this._getPosition(group.position, true),\n            label: this._getLabel(group, true)\n        });\n    },\n\n    _evaluatePort: function(port) {\n\n        var evaluated = util.assign({}, port);\n\n        var group = this.getGroup(port.group);\n\n        evaluated.markup = evaluated.markup || group.markup;\n        evaluated.attrs = util.merge({}, group.attrs, evaluated.attrs);\n        evaluated.position = this._createPositionNode(group, evaluated);\n        evaluated.label = util.merge({}, group.label, this._getLabel(evaluated));\n        evaluated.z = this._getZIndex(group, evaluated);\n        evaluated.size = util.assign({}, group.size, evaluated.size);\n\n        return evaluated;\n    },\n\n    _getZIndex: function(group, port) {\n\n        if (util.isNumber(port.z)) {\n            return port.z;\n        }\n        if (util.isNumber(group.z) || group.z === 'auto') {\n            return group.z;\n        }\n        return 'auto';\n    },\n\n    _createPositionNode: function(group, port) {\n\n        return util.merge({\n            name: 'left',\n            args: {}\n        }, group.position, { args: port.args });\n    },\n\n    _getPosition: function(position, setDefault) {\n\n        var args = {};\n        var positionName;\n\n        if (util.isFunction(position)) {\n            positionName = 'fn';\n            args.fn = position;\n        } else if (util.isString(position)) {\n            positionName = position;\n        } else if (position === undefined) {\n            positionName = setDefault ? 'left' : null;\n        } else if (Array.isArray(position)) {\n            positionName = 'absolute';\n            args.x = position[0];\n            args.y = position[1];\n        } else if (util.isObject(position)) {\n            positionName = position.name;\n            util.assign(args, position.args);\n        }\n\n        var result = { args: args };\n\n        if (positionName) {\n            result.name = positionName;\n        }\n        return result;\n    },\n\n    _getLabel: function(item, setDefaults) {\n\n        var label = item.label || {};\n\n        var ret = label;\n        ret.position = this._getPosition(label.position, setDefaults);\n\n        return ret;\n    }\n};\n\nexport const elementPortPrototype = {\n\n    _initializePorts: function() {\n\n        this._createPortData();\n        this.on('change:ports', function() {\n\n            this._processRemovedPort();\n            this._createPortData();\n        }, this);\n    },\n\n    /**\n     * remove links tied wiht just removed element\n     * @private\n     */\n    _processRemovedPort: function() {\n\n        var current = this.get('ports') || {};\n        var currentItemsMap = {};\n\n        util.toArray(current.items).forEach(function(item) {\n            currentItemsMap[item.id] = true;\n        });\n\n        var previous = this.previous('ports') || {};\n        var removed = {};\n\n        util.toArray(previous.items).forEach(function(item) {\n            if (!currentItemsMap[item.id]) {\n                removed[item.id] = true;\n            }\n        });\n\n        var graph = this.graph;\n        if (graph && !util.isEmpty(removed)) {\n\n            var inboundLinks = graph.getConnectedLinks(this, { inbound: true });\n            inboundLinks.forEach(function(link) {\n\n                if (removed[link.get('target').port]) link.remove();\n            });\n\n            var outboundLinks = graph.getConnectedLinks(this, { outbound: true });\n            outboundLinks.forEach(function(link) {\n\n                if (removed[link.get('source').port]) link.remove();\n            });\n        }\n    },\n\n    /**\n     * @returns {boolean}\n     */\n    hasPorts: function() {\n\n        var ports = this.prop('ports/items');\n        return Array.isArray(ports) && ports.length > 0;\n    },\n\n    /**\n     * @param {string} id\n     * @returns {boolean}\n     */\n    hasPort: function(id) {\n\n        return this.getPortIndex(id) !== -1;\n    },\n\n    /**\n     * @returns {Array<object>}\n     */\n    getPorts: function() {\n\n        return util.cloneDeep(this.prop('ports/items')) || [];\n    },\n\n    /**\n     * @returns {Array<object>}\n     */\n    getGroupPorts: function(groupName) {\n        const groupPorts = util.toArray(this.prop(['ports','items'])).filter(port => port.group === groupName);\n        return util.cloneDeep(groupPorts);\n    },\n\n    /**\n     * @param {string} id\n     * @returns {object}\n     */\n    getPort: function(id) {\n\n        return util.cloneDeep(util.toArray(this.prop('ports/items')).find(function(port) {\n            return port.id && port.id === id;\n        }));\n    },\n\n    /**\n     * @param {string} groupName\n     * @returns {Object<portId, {x: number, y: number, angle: number}>}\n     */\n    getPortsPositions: function(groupName) {\n\n        var portsMetrics = this._portSettingsData.getGroupPortsMetrics(groupName, Rect(this.size()));\n\n        return portsMetrics.reduce(function(positions, metrics) {\n            var transformation = metrics.portTransformation;\n            positions[metrics.portId] = {\n                x: transformation.x,\n                y: transformation.y,\n                angle: transformation.angle\n            };\n            return positions;\n        }, {});\n    },\n\n    /**\n     * @param {string|Port} port port id or port\n     * @returns {number} port index\n     */\n    getPortIndex: function(port) {\n\n        var id = util.isObject(port) ? port.id : port;\n\n        if (!this._isValidPortId(id)) {\n            return -1;\n        }\n\n        return util.toArray(this.prop('ports/items')).findIndex(function(item) {\n            return item.id === id;\n        });\n    },\n\n    /**\n     * @param {object} port\n     * @param {object} [opt]\n     * @returns {joint.dia.Element}\n     */\n    addPort: function(port, opt) {\n\n        if (!util.isObject(port) || Array.isArray(port)) {\n            throw new Error('Element: addPort requires an object.');\n        }\n\n        var ports = util.assign([], this.prop('ports/items'));\n        ports.push(port);\n        this.prop('ports/items', ports, opt);\n\n        return this;\n    },\n\n    /**\n     * @param {string|Port|number} before\n     * @param {object} port\n     * @param {object} [opt]\n     * @returns {joint.dia.Element}\n     */\n    insertPort: function(before, port, opt) {\n        const index = (typeof before === 'number') ? before : this.getPortIndex(before);\n\n        if (!util.isObject(port) || Array.isArray(port)) {\n            throw new Error('dia.Element: insertPort requires an object.');\n        }\n\n        const ports = util.assign([], this.prop('ports/items'));\n        ports.splice(index, 0, port);\n        this.prop('ports/items', ports, opt);\n\n        return this;\n    },\n\n    /**\n     * @param {string} portId\n     * @param {string|object=} path\n     * @param {*=} value\n     * @param {object=} opt\n     * @returns {joint.dia.Element}\n     */\n    portProp: function(portId, path, value, opt) {\n\n        var index = this.getPortIndex(portId);\n\n        if (index === -1) {\n            throw new Error('Element: unable to find port with id ' + portId);\n        }\n\n        var args = Array.prototype.slice.call(arguments, 1);\n        if (Array.isArray(path)) {\n            args[0] = ['ports', 'items', index].concat(path);\n        } else if (util.isString(path)) {\n\n            // Get/set an attribute by a special path syntax that delimits\n            // nested objects by the colon character.\n            args[0] = ['ports/items/', index, '/', path].join('');\n\n        } else {\n\n            args = ['ports/items/' + index];\n            if (util.isPlainObject(path)) {\n                args.push(path);\n                args.push(value);\n            }\n        }\n\n        return this.prop.apply(this, args);\n    },\n\n    _validatePorts: function() {\n\n        var portsAttr = this.get('ports') || {};\n\n        var errorMessages = [];\n        portsAttr = portsAttr || {};\n        var ports = util.toArray(portsAttr.items);\n\n        ports.forEach(function(p) {\n\n            if (typeof p !== 'object') {\n                errorMessages.push('Element: invalid port ', p);\n            }\n\n            if (!this._isValidPortId(p.id)) {\n                p.id = this.generatePortId();\n            }\n        }, this);\n\n        if (util.uniq(ports, 'id').length !== ports.length) {\n            errorMessages.push('Element: found id duplicities in ports.');\n        }\n\n        return errorMessages;\n    },\n\n    generatePortId: function() {\n        return this.generateId();\n    },\n\n    /**\n     * @param {string} id port id\n     * @returns {boolean}\n     * @private\n     */\n    _isValidPortId: function(id) {\n\n        return id !== null && id !== undefined && !util.isObject(id);\n    },\n\n    addPorts: function(ports, opt) {\n\n        if (ports.length) {\n            this.prop('ports/items', util.assign([], this.prop('ports/items')).concat(ports), opt);\n        }\n\n        return this;\n    },\n\n    removePort: function(port, opt) {\n        const options = opt || {};\n        const index = this.getPortIndex(port);\n        if (index !== -1) {\n            const ports = util.assign([], this.prop(['ports', 'items']));\n            ports.splice(index, 1);\n            options.rewrite = true;\n            this.startBatch('port-remove');\n            this.prop(['ports', 'items'], ports, options);\n            this.stopBatch('port-remove');\n        }\n        return this;\n    },\n\n    removePorts: function(portsForRemoval, opt) {\n        let options, newPorts;\n        if (Array.isArray(portsForRemoval)) {\n            options = opt || {};\n            if (portsForRemoval.length === 0) return this.this;\n            const currentPorts = util.assign([], this.prop(['ports', 'items']));\n            newPorts = currentPorts.filter(function(cp) {\n                return !portsForRemoval.some(function(rp) {\n                    const rpId = util.isObject(rp) ? rp.id : rp;\n                    return cp.id === rpId;\n                });\n            });\n        } else {\n            options = portsForRemoval || {};\n            newPorts = [];\n        }\n        this.startBatch('port-remove');\n        options.rewrite = true;\n        this.prop(['ports', 'items'], newPorts, options);\n        this.stopBatch('port-remove');\n        return this;\n    },\n\n    /**\n     * @private\n     */\n    _createPortData: function() {\n\n        var err = this._validatePorts();\n\n        if (err.length > 0) {\n            this.set('ports', this.previous('ports'));\n            throw new Error(err.join(' '));\n        }\n\n        var prevPortData;\n\n        if (this._portSettingsData) {\n\n            prevPortData = this._portSettingsData.getPorts();\n        }\n\n        this._portSettingsData = new PortData(this.get('ports'));\n\n        var curPortData = this._portSettingsData.getPorts();\n\n        if (prevPortData) {\n\n            var added = curPortData.filter(function(item) {\n                if (!prevPortData.find(function(prevPort) {\n                    return prevPort.id === item.id;\n                })) {\n                    return item;\n                }\n            });\n\n            var removed = prevPortData.filter(function(item) {\n                if (!curPortData.find(function(curPort) {\n                    return curPort.id === item.id;\n                })) {\n                    return item;\n                }\n            });\n\n            if (removed.length > 0) {\n                this.trigger('ports:remove', this, removed);\n            }\n\n            if (added.length > 0) {\n                this.trigger('ports:add', this, added);\n            }\n        }\n    }\n};\n\nexport const elementViewPortPrototype = {\n\n    portContainerMarkup: 'g',\n    portMarkup: [{\n        tagName: 'circle',\n        selector: 'circle',\n        attributes: {\n            'r': 10,\n            'fill': '#FFFFFF',\n            'stroke': '#000000'\n        }\n    }],\n    portLabelMarkup: [{\n        tagName: 'text',\n        selector: 'text',\n        attributes: {\n            'fill': '#000000'\n        }\n    }],\n    /** @type {Object<string, {portElement: Vectorizer, portLabelElement: Vectorizer}>} */\n    _portElementsCache: null,\n\n    /**\n     * @private\n     */\n    _initializePorts: function() {\n        this._cleanPortsCache();\n    },\n\n    /**\n     * @typedef {Object} Port\n     *\n     * @property {string} id\n     * @property {Object} position\n     * @property {Object} label\n     * @property {Object} attrs\n     * @property {string} markup\n     * @property {string} group\n     */\n\n    /**\n     * @private\n     */\n    _refreshPorts: function() {\n\n        this._removePorts();\n        this._cleanPortsCache();\n        this._renderPorts();\n    },\n\n    _cleanPortsCache: function() {\n        this._portElementsCache = {};\n    },\n\n    /**\n     * @private\n     */\n    _renderPorts: function() {\n\n        // references to rendered elements without z-index\n        var elementReferences = [];\n        var elem = this._getContainerElement();\n\n        for (var i = 0, count = elem.node.childNodes.length; i < count; i++) {\n            elementReferences.push(elem.node.childNodes[i]);\n        }\n\n        var portsGropsByZ = util.groupBy(this.model._portSettingsData.getPorts(), 'z');\n        var withoutZKey = 'auto';\n\n        // render non-z first\n        util.toArray(portsGropsByZ[withoutZKey]).forEach(function(port) {\n            var portElement = this._getPortElement(port);\n            elem.append(portElement);\n            elementReferences.push(portElement);\n        }, this);\n\n        var groupNames = Object.keys(portsGropsByZ);\n        for (var k = 0; k < groupNames.length; k++) {\n            var groupName = groupNames[k];\n            if (groupName !== withoutZKey) {\n                var z = parseInt(groupName, 10);\n                this._appendPorts(portsGropsByZ[groupName], z, elementReferences);\n            }\n        }\n\n        this._updatePorts();\n    },\n\n    /**\n     * @returns {V}\n     * @private\n     */\n    _getContainerElement: function() {\n\n        return this.rotatableNode || this.vel;\n    },\n\n    /**\n     * @param {Array<Port>}ports\n     * @param {number} z\n     * @param refs\n     * @private\n     */\n    _appendPorts: function(ports, z, refs) {\n\n        var containerElement = this._getContainerElement();\n        var portElements = util.toArray(ports).map(this._getPortElement, this);\n\n        if (refs[z] || z < 0) {\n            V(refs[Math.max(z, 0)]).before(portElements);\n        } else {\n            containerElement.append(portElements);\n        }\n    },\n\n    /**\n     * Try to get element from cache,\n     * @param port\n     * @returns {*}\n     * @private\n     */\n    _getPortElement: function(port) {\n\n        if (this._portElementsCache[port.id]) {\n            return this._portElementsCache[port.id].portElement;\n        }\n        return this._createPortElement(port);\n    },\n\n    findPortNode: function(portId, selector) {\n        const portCache = this._portElementsCache[portId];\n        if (!portCache) return null;\n        if (!selector) return portCache.portContentElement.node;\n        const portRoot = portCache.portElement.node;\n        const portSelectors = portCache.portSelectors;\n        const [node = null] = this.findBySelector(selector, portRoot, portSelectors);\n        return node;\n    },\n\n    /**\n     * @private\n     */\n    _updatePorts: function() {\n\n        // layout ports without group\n        this._updatePortGroup(undefined);\n        // layout ports with explicit group\n        var groupsNames = Object.keys(this.model._portSettingsData.groups);\n        groupsNames.forEach(this._updatePortGroup, this);\n    },\n\n    /**\n     * @private\n     */\n    _removePorts: function() {\n        util.invoke(this._portElementsCache, 'portElement.remove');\n    },\n\n    /**\n     * @param {Port} port\n     * @returns {V}\n     * @private\n     */\n    _createPortElement: function(port) {\n\n        let portElement;\n        let labelElement;\n        let labelSelectors;\n        let portSelectors;\n\n        var portContainerElement = V(this.portContainerMarkup).addClass('joint-port');\n\n        var portMarkup = this._getPortMarkup(port);\n        if (Array.isArray(portMarkup)) {\n            var portDoc = this.parseDOMJSON(portMarkup, portContainerElement.node);\n            var portFragment = portDoc.fragment;\n            if (portFragment.childNodes.length > 1) {\n                portElement = V('g').append(portFragment);\n            } else {\n                portElement = V(portFragment.firstChild);\n            }\n            portSelectors = portDoc.selectors;\n        } else {\n            portElement = V(portMarkup);\n            if (Array.isArray(portElement)) {\n                portElement = V('g').append(portElement);\n            }\n        }\n\n        if (!portElement) {\n            throw new Error('ElementView: Invalid port markup.');\n        }\n\n        portElement.attr({\n            'port': port.id,\n            'port-group': port.group\n        });\n\n        const labelMarkupDef = this._getPortLabelMarkup(port.label);\n        if (Array.isArray(labelMarkupDef)) {\n            // JSON Markup\n            const { fragment, selectors } = this.parseDOMJSON(labelMarkupDef, portContainerElement.node);\n            const childCount = fragment.childNodes.length;\n            if (childCount > 0) {\n                labelSelectors = selectors;\n                labelElement = (childCount === 1) ? V(fragment.firstChild) : V('g').append(fragment);\n            }\n        } else {\n            // String Markup\n            labelElement = V(labelMarkupDef);\n            if (Array.isArray(labelElement)) {\n                labelElement = V('g').append(labelElement);\n            }\n        }\n\n        var portContainerSelectors;\n        if (portSelectors && labelSelectors) {\n            for (var key in labelSelectors) {\n                if (portSelectors[key] && key !== this.selector) throw new Error('ElementView: selectors within port must be unique.');\n            }\n            portContainerSelectors = util.assign({}, portSelectors, labelSelectors);\n        } else {\n            portContainerSelectors = portSelectors || labelSelectors || {};\n        }\n\n        // The `portRootSelector` points to the root SVGNode of the port.\n        // Either the implicit wrapping group <g/> in case the port consist of multiple SVGNodes.\n        // Or the single SVGNode of the port.\n        const portRootSelector = 'portRoot';\n        // The `labelRootSelector` points to the root SVGNode of the label.\n        const labelRootSelector = 'labelRoot';\n        // The `labelTextSelector` points to all text SVGNodes of the label.\n        const labelTextSelector = 'labelText';\n\n        if (!(portRootSelector in portContainerSelectors)) {\n            portContainerSelectors[portRootSelector] = portElement.node;\n        }\n\n        if (labelElement) {\n            const labelNode = labelElement.node;\n            if (!(labelRootSelector in portContainerSelectors)) {\n                portContainerSelectors[labelRootSelector] = labelNode;\n            }\n            if (!(labelTextSelector in portContainerSelectors)) {\n                // If the label is a <text> element, we can use it directly.\n                // Otherwise, we need to find the <text> element within the label.\n                const labelTextNode = (labelElement.tagName() === 'TEXT')\n                    ? labelNode\n                    : Array.from(labelNode.querySelectorAll('text'));\n                portContainerSelectors[labelTextSelector] = labelTextNode;\n                if (!labelSelectors) labelSelectors = {};\n                labelSelectors[labelTextSelector] = labelTextNode;\n            }\n        }\n\n        portContainerElement.append(portElement.addClass('joint-port-body'));\n        if (labelElement) {\n            portContainerElement.append(labelElement.addClass('joint-port-label'));\n        }\n\n        this._portElementsCache[port.id] = {\n            portElement: portContainerElement,\n            portLabelElement: labelElement,\n            portSelectors: portContainerSelectors,\n            portLabelSelectors: labelSelectors,\n            portContentElement: portElement,\n            portContentSelectors: portSelectors\n        };\n\n        return portContainerElement;\n    },\n\n    /**\n     * @param {string=} groupName\n     * @private\n     */\n    _updatePortGroup: function(groupName) {\n\n        var elementBBox = Rect(this.model.size());\n        var portsMetrics = this.model._portSettingsData.getGroupPortsMetrics(groupName, elementBBox);\n\n        for (var i = 0, n = portsMetrics.length; i < n; i++) {\n            var metrics = portsMetrics[i];\n            var portId = metrics.portId;\n            var cached = this._portElementsCache[portId] || {};\n            var portTransformation = metrics.portTransformation;\n            var labelTransformation = metrics.labelTransformation;\n            if (labelTransformation && cached.portLabelElement) {\n                this.updateDOMSubtreeAttributes(cached.portLabelElement.node, labelTransformation.attrs, {\n                    rootBBox: new Rect(metrics.labelSize),\n                    selectors: cached.portLabelSelectors\n                });\n                this.applyPortTransform(cached.portLabelElement, labelTransformation, (-portTransformation.angle || 0));\n            }\n            this.updateDOMSubtreeAttributes(cached.portElement.node, metrics.portAttrs, {\n                rootBBox: new Rect(metrics.portSize),\n                selectors: cached.portSelectors\n            });\n            this.applyPortTransform(cached.portElement, portTransformation);\n        }\n    },\n\n    /**\n     * @param {Vectorizer} element\n     * @param {{dx:number, dy:number, angle: number, attrs: Object, x:number: y:number}} transformData\n     * @param {number=} initialAngle\n     * @constructor\n     */\n    applyPortTransform: function(element, transformData, initialAngle) {\n\n        var matrix = V.createSVGMatrix()\n            .rotate(initialAngle || 0)\n            .translate(transformData.x || 0, transformData.y || 0)\n            .rotate(transformData.angle || 0);\n\n        element.transform(matrix, { absolute: true });\n    },\n\n    /**\n     * @param {Port} port\n     * @returns {string}\n     * @private\n     */\n    _getPortMarkup: function(port) {\n\n        return port.markup || this.model.get('portMarkup') || this.model.portMarkup || this.portMarkup;\n    },\n\n    /**\n     * @param {Object} label\n     * @returns {string}\n     * @private\n     */\n    _getPortLabelMarkup: function(label) {\n\n        return label.markup || this.model.get('portLabelMarkup') || this.model.portLabelMarkup || this.portLabelMarkup;\n    }\n};\n\n","import { Cell } from './Cell.mjs';\nimport { Point, toRad, normalizeAngle, Rect } from '../g/index.mjs';\nimport { isNumber, isObject, interpolate, assign, invoke, normalizeSides } from '../util/index.mjs';\nimport { elementPortPrototype } from './ports.mjs';\n\n// Element base model.\n// -----------------------------\n\nexport const Element = Cell.extend({\n\n    defaults: {\n        position: { x: 0, y: 0 },\n        size: { width: 1, height: 1 },\n        angle: 0\n    },\n\n    initialize: function() {\n\n        this._initializePorts();\n        Cell.prototype.initialize.apply(this, arguments);\n    },\n\n    /**\n     * @abstract\n     */\n    _initializePorts: function() {\n        // implemented in ports.js\n    },\n\n    _refreshPorts: function() {\n        // implemented in ports.js\n    },\n\n    isElement: function() {\n\n        return true;\n    },\n\n    position: function(x, y, opt) {\n\n        const isSetter = isNumber(y);\n        opt = (isSetter ? opt : x) || {};\n        const { parentRelative, deep, restrictedArea } = opt;\n\n\n        // option `parentRelative` for setting the position relative to the element's parent.\n        let parentPosition;\n        if (parentRelative) {\n\n            // Getting the parent's position requires the collection.\n            // Cell.parent() holds cell id only.\n            if (!this.graph) throw new Error('Element must be part of a graph.');\n\n            const parent = this.getParentCell();\n            if (parent && !parent.isLink()) {\n                parentPosition = parent.get('position');\n            }\n        }\n\n        if (isSetter) {\n\n            if (parentPosition) {\n                x += parentPosition.x;\n                y += parentPosition.y;\n            }\n\n            if (deep || restrictedArea) {\n                const { x: x0, y: y0 } = this.get('position');\n                this.translate(x - x0, y - y0, opt);\n            } else {\n                this.set('position', { x, y }, opt);\n            }\n\n            return this;\n\n        } else { // Getter returns a geometry point.\n\n            const elementPosition = Point(this.get('position'));\n            return parentRelative\n                ? elementPosition.difference(parentPosition)\n                : elementPosition;\n        }\n    },\n\n    translate: function(tx, ty, opt) {\n\n        tx = tx || 0;\n        ty = ty || 0;\n\n        if (tx === 0 && ty === 0) {\n            // Like nothing has happened.\n            return this;\n        }\n\n        opt = opt || {};\n        // Pass the initiator of the translation.\n        opt.translateBy = opt.translateBy || this.id;\n\n        var position = this.get('position') || { x: 0, y: 0 };\n        var ra = opt.restrictedArea;\n        if (ra && opt.translateBy === this.id) {\n\n            if (typeof ra === 'function') {\n\n                var newPosition = ra.call(this, position.x + tx, position.y + ty, opt);\n\n                tx = newPosition.x - position.x;\n                ty = newPosition.y - position.y;\n\n            } else  {\n                // We are restricting the translation for the element itself only. We get\n                // the bounding box of the element including all its embeds.\n                // All embeds have to be translated the exact same way as the element.\n                var bbox = this.getBBox({ deep: true });\n                //- - - - - - - - - - - - -> ra.x + ra.width\n                // - - - -> position.x      |\n                // -> bbox.x\n                //                ▓▓▓▓▓▓▓   |\n                //         ░░░░░░░▓▓▓▓▓▓▓\n                //         ░░░░░░░░░        |\n                //   ▓▓▓▓▓▓▓▓░░░░░░░\n                //   ▓▓▓▓▓▓▓▓               |\n                //   <-dx->                     | restricted area right border\n                //         <-width->        |   ░ translated element\n                //   <- - bbox.width - ->       ▓ embedded element\n                var dx = position.x - bbox.x;\n                var dy = position.y - bbox.y;\n                // Find the maximal/minimal coordinates that the element can be translated\n                // while complies the restrictions.\n                var x = Math.max(ra.x + dx, Math.min(ra.x + ra.width + dx - bbox.width, position.x + tx));\n                var y = Math.max(ra.y + dy, Math.min(ra.y + ra.height + dy - bbox.height, position.y + ty));\n                // recalculate the translation taking the restrictions into account.\n                tx = x - position.x;\n                ty = y - position.y;\n            }\n        }\n\n        var translatedPosition = {\n            x: position.x + tx,\n            y: position.y + ty\n        };\n\n        // To find out by how much an element was translated in event 'change:position' handlers.\n        opt.tx = tx;\n        opt.ty = ty;\n\n        if (opt.transition) {\n\n            if (!isObject(opt.transition)) opt.transition = {};\n\n            this.transition('position', translatedPosition, assign({}, opt.transition, {\n                valueFunction: interpolate.object\n            }));\n\n            // Recursively call `translate()` on all the embeds cells.\n            invoke(this.getEmbeddedCells(), 'translate', tx, ty, opt);\n\n        } else {\n\n            this.startBatch('translate', opt);\n            this.set('position', translatedPosition, opt);\n            invoke(this.getEmbeddedCells(), 'translate', tx, ty, opt);\n            this.stopBatch('translate', opt);\n        }\n\n        return this;\n    },\n\n    size: function(width, height, opt) {\n\n        var currentSize = this.get('size');\n        // Getter\n        // () signature\n        if (width === undefined) {\n            return {\n                width: currentSize.width,\n                height: currentSize.height\n            };\n        }\n        // Setter\n        // (size, opt) signature\n        if (isObject(width)) {\n            opt = height;\n            height = isNumber(width.height) ? width.height : currentSize.height;\n            width = isNumber(width.width) ? width.width : currentSize.width;\n        }\n\n        return this.resize(width, height, opt);\n    },\n\n    resize: function(width, height, opt) {\n\n        opt = opt || {};\n\n        this.startBatch('resize', opt);\n\n        if (opt.direction) {\n\n            var currentSize = this.get('size');\n\n            switch (opt.direction) {\n\n                case 'left':\n                case 'right':\n                    // Don't change height when resizing horizontally.\n                    height = currentSize.height;\n                    break;\n\n                case 'top':\n                case 'bottom':\n                    // Don't change width when resizing vertically.\n                    width = currentSize.width;\n                    break;\n            }\n\n            // Get the angle and clamp its value between 0 and 360 degrees.\n            var angle = normalizeAngle(this.get('angle') || 0);\n\n            // This is a rectangle in size of the un-rotated element.\n            var bbox = this.getBBox();\n\n            var origin;\n\n            if (angle) {\n\n                var quadrant = {\n                    'top-right': 0,\n                    'right': 0,\n                    'top-left': 1,\n                    'top': 1,\n                    'bottom-left': 2,\n                    'left': 2,\n                    'bottom-right': 3,\n                    'bottom': 3\n                }[opt.direction];\n\n                if (opt.absolute) {\n\n                    // We are taking the element's rotation into account\n                    quadrant += Math.floor((angle + 45) / 90);\n                    quadrant %= 4;\n                }\n\n                // Pick the corner point on the element, which meant to stay on its place before and\n                // after the rotation.\n                var fixedPoint = bbox[['bottomLeft', 'corner', 'topRight', 'origin'][quadrant]]();\n\n                // Find  an image of the previous indent point. This is the position, where is the\n                // point actually located on the screen.\n                var imageFixedPoint = Point(fixedPoint).rotate(bbox.center(), -angle);\n\n                // Every point on the element rotates around a circle with the centre of rotation\n                // in the middle of the element while the whole element is being rotated. That means\n                // that the distance from a point in the corner of the element (supposed its always rect) to\n                // the center of the element doesn't change during the rotation and therefore it equals\n                // to a distance on un-rotated element.\n                // We can find the distance as DISTANCE = (ELEMENTWIDTH/2)^2 + (ELEMENTHEIGHT/2)^2)^0.5.\n                var radius = Math.sqrt((width * width) + (height * height)) / 2;\n\n                // Now we are looking for an angle between x-axis and the line starting at image of fixed point\n                // and ending at the center of the element. We call this angle `alpha`.\n\n                // The image of a fixed point is located in n-th quadrant. For each quadrant passed\n                // going anti-clockwise we have to add 90 degrees. Note that the first quadrant has index 0.\n                //\n                // 3 | 2\n                // --c-- Quadrant positions around the element's center `c`\n                // 0 | 1\n                //\n                var alpha = quadrant * Math.PI / 2;\n\n                // Add an angle between the beginning of the current quadrant (line parallel with x-axis or y-axis\n                // going through the center of the element) and line crossing the indent of the fixed point and the center\n                // of the element. This is the angle we need but on the un-rotated element.\n                alpha += Math.atan(quadrant % 2 == 0 ? height / width : width / height);\n\n                // Lastly we have to deduct the original angle the element was rotated by and that's it.\n                alpha -= toRad(angle);\n\n                // With this angle and distance we can easily calculate the centre of the un-rotated element.\n                // Note that fromPolar constructor accepts an angle in radians.\n                var center = Point.fromPolar(radius, alpha, imageFixedPoint);\n\n                // The top left corner on the un-rotated element has to be half a width on the left\n                // and half a height to the top from the center. This will be the origin of rectangle\n                // we were looking for.\n                origin = Point(center).offset(width / -2, height / -2);\n\n            } else {\n                // calculation for the origin Point when there is no rotation of the element\n                origin = bbox.topLeft();\n\n                switch (opt.direction) {\n                    case 'top':\n                    case 'top-right':\n                        origin.offset(0, bbox.height - height);\n                        break;\n                    case 'left':\n                    case 'bottom-left':\n                        origin.offset(bbox.width -width, 0);\n                        break;\n                    case 'top-left':\n                        origin.offset(bbox.width - width, bbox.height - height);\n                        break;\n                }\n            }\n\n            // Resize the element (before re-positioning it).\n            this.set('size', { width: width, height: height }, opt);\n\n            // Finally, re-position the element.\n            this.position(origin.x, origin.y, opt);\n\n        } else {\n\n            // Resize the element.\n            this.set('size', { width: width, height: height }, opt);\n        }\n\n        this.stopBatch('resize', opt);\n\n        return this;\n    },\n\n    scale: function(sx, sy, origin, opt) {\n\n        var scaledBBox = this.getBBox().scale(sx, sy, origin);\n        this.startBatch('scale', opt);\n        this.position(scaledBBox.x, scaledBBox.y, opt);\n        this.resize(scaledBBox.width, scaledBBox.height, opt);\n        this.stopBatch('scale');\n        return this;\n    },\n\n    fitEmbeds: function(opt) {\n\n        return this.fitToChildren(opt);\n    },\n\n    fitToChildren: function(opt = {}) {\n\n        // Getting the children's size and position requires the collection.\n        // Cell.get('embeds') holds an array of cell ids only.\n        const { graph } = this;\n        if (!graph) throw new Error('Element must be part of a graph.');\n\n        const childElements = this.getEmbeddedCells().filter(cell => cell.isElement());\n        if (childElements.length === 0) return this;\n\n        this.startBatch('fit-embeds', opt);\n\n        if (opt.deep) {\n            // `opt.deep = true` means \"fit to all descendants\".\n            // As the first action of the fitting algorithm, recursively apply `fitToChildren()` on all descendants.\n            // - i.e. the algorithm is applied in reverse-depth order - start from deepest descendant, then go up (= this element).\n            invoke(childElements, 'fitToChildren', opt);\n        }\n\n        // Set new size and position of this element, based on:\n        // - union of bboxes of all children\n        // - inflated by given `opt.padding`\n        this._fitToElements(Object.assign({ elements: childElements }, opt));\n\n        this.stopBatch('fit-embeds');\n\n        return this;\n    },\n\n    fitParent: function(opt = {}) {\n\n        const { graph } = this;\n        if (!graph) throw new Error('Element must be part of a graph.');\n\n        // When `opt.deep = true`, we want `opt.terminator` to be the last ancestor processed.\n        // If the current element is `opt.terminator`, it means that this element has already been processed as parent so we can exit now.\n        if (opt.deep && opt.terminator && ((opt.terminator === this) || (opt.terminator === this.id))) return this;\n\n        const parentElement = this.getParentCell();\n        if (!parentElement || !parentElement.isElement()) return this;\n\n        // Get all children of parent element (i.e. this element + any sibling elements).\n        const siblingElements = parentElement.getEmbeddedCells().filter(cell => cell.isElement());\n        if (siblingElements.length === 0) return this;\n\n        this.startBatch('fit-parent', opt);\n\n        // Set new size and position of parent element, based on:\n        // - union of bboxes of all children of parent element (i.e. this element + any sibling elements)\n        // - inflated by given `opt.padding`\n        parentElement._fitToElements(Object.assign({ elements: siblingElements }, opt));\n\n        if (opt.deep) {\n            // `opt.deep = true` means \"fit all ancestors to their respective children\".\n            // As the last action of the fitting algorithm, recursively apply `fitParent()` on all ancestors.\n            // - i.e. the algorithm is applied in reverse-depth order - start from deepest descendant (= this element), then go up.\n            parentElement.fitParent(opt);\n        }\n\n        this.stopBatch('fit-parent');\n\n        return this;\n    },\n\n    // Assumption: This element is part of a graph.\n    _fitToElements: function(opt = {}) {\n\n        const elementsBBox = this.graph.getCellsBBox(opt.elements);\n        // If no `opt.elements` were provided, do nothing.\n        if (!elementsBBox) return;\n\n        const { expandOnly, shrinkOnly } = opt;\n        // This combination is meaningless, do nothing.\n        if (expandOnly && shrinkOnly) return;\n\n        // Calculate new size and position of this element based on:\n        // - union of bboxes of `opt.elements`\n        // - inflated by `opt.padding` (if not provided, all four properties = 0)\n        let { x, y, width, height } = elementsBBox;\n        const { left, right, top, bottom } = normalizeSides(opt.padding);\n        x -= left;\n        y -= top;\n        width += left + right;\n        height += bottom + top;\n        let resultBBox = new Rect(x, y, width, height);\n\n        if (expandOnly) {\n            // Non-shrinking is enforced by taking union of this element's current bbox with bbox calculated from `opt.elements`.\n            resultBBox = this.getBBox().union(resultBBox);\n\n        } else if (shrinkOnly) {\n            // Non-expansion is enforced by taking intersection of this element's current bbox with bbox calculated from `opt.elements`.\n            const intersectionBBox = this.getBBox().intersect(resultBBox);\n            // If all children are outside this element's current bbox, then `intersectionBBox` is `null` - does not make sense, do nothing.\n            if (!intersectionBBox) return;\n\n            resultBBox =  intersectionBBox;\n        }\n\n        // Set the new size and position of this element.\n        this.set({\n            position: { x: resultBBox.x, y: resultBBox.y },\n            size: { width: resultBBox.width, height: resultBBox.height }\n        }, opt);\n    },\n\n    // Rotate element by `angle` degrees, optionally around `origin` point.\n    // If `origin` is not provided, it is considered to be the center of the element.\n    // If `absolute` is `true`, the `angle` is considered is absolute, i.e. it is not\n    // the difference from the previous angle.\n    rotate: function(angle, absolute, origin, opt) {\n\n        if (origin) {\n\n            var center = this.getBBox().center();\n            var size = this.get('size');\n            var position = this.get('position');\n            center.rotate(origin, this.get('angle') - angle);\n            var dx = center.x - size.width / 2 - position.x;\n            var dy = center.y - size.height / 2 - position.y;\n            this.startBatch('rotate', { angle: angle, absolute: absolute, origin: origin });\n            this.position(position.x + dx, position.y + dy, opt);\n            this.rotate(angle, absolute, null, opt);\n            this.stopBatch('rotate');\n\n        } else {\n\n            this.set('angle', absolute ? angle : (this.get('angle') + angle) % 360, opt);\n        }\n\n        return this;\n    },\n\n    angle: function() {\n        return normalizeAngle(this.get('angle') || 0);\n    },\n\n    getBBox: function(opt = {}) {\n\n        const { graph, attributes } = this;\n        const { deep, rotate } = opt;\n\n        if (deep && graph) {\n            // Get all the embedded elements using breadth first algorithm.\n            const elements = this.getEmbeddedCells({ deep: true, breadthFirst: true });\n            // Add the model itself.\n            elements.push(this);\n            // Note: the default of getCellsBBox() is rotate=true and can't be\n            // changed without a breaking change\n            return graph.getCellsBBox(elements, opt);\n        }\n\n        const { angle = 0, position: { x, y }, size: { width, height }} = attributes;\n        const bbox = new Rect(x, y, width, height);\n        if (rotate) {\n            bbox.rotateAroundCenter(angle);\n        }\n        return bbox;\n    },\n\n    getPointFromConnectedLink: function(link, endType) {\n        // Center of the model\n        var bbox = this.getBBox();\n        var center = bbox.center();\n        // Center of a port\n        var endDef = link.get(endType);\n        if (!endDef) return center;\n        var portId = endDef.port;\n        if (!portId || !this.hasPort(portId)) return center;\n        var portGroup = this.portProp(portId, ['group']);\n        var portsPositions = this.getPortsPositions(portGroup);\n        var portCenter = new Point(portsPositions[portId]).offset(bbox.origin());\n        var angle = this.angle();\n        if (angle) portCenter.rotate(center, -angle);\n        return portCenter;\n    }\n});\n\nassign(Element.prototype, elementPortPrototype);\n\n","import Backbone from 'backbone';\nimport * as util from '../util/index.mjs';\nimport * as g from '../g/index.mjs';\n\nimport { Link } from './Link.mjs';\nimport { Element } from './Element.mjs';\nimport { wrappers, wrapWith } from '../util/wrappers.mjs';\nimport { cloneCells } from '../util/index.mjs';\n\nconst GraphCells = Backbone.Collection.extend({\n\n    initialize: function(models, opt) {\n\n        // Set the optional namespace where all model classes are defined.\n        if (opt.cellNamespace) {\n            this.cellNamespace = opt.cellNamespace;\n        } else {\n            /* eslint-disable no-undef */\n            this.cellNamespace = typeof joint !== 'undefined' && util.has(joint, 'shapes') ? joint.shapes : null;\n            /* eslint-enable no-undef */\n        }\n\n\n        this.graph = opt.graph;\n    },\n\n    model: function(attrs, opt) {\n\n        var collection = opt.collection;\n        var namespace = collection.cellNamespace;\n\n        // Find the model class in the namespace or use the default one.\n        var ModelClass = (attrs.type === 'link')\n            ? Link\n            : util.getByPath(namespace, attrs.type, '.') || Element;\n\n        var cell = new ModelClass(attrs, opt);\n        // Add a reference to the graph. It is necessary to do this here because this is the earliest place\n        // where a new model is created from a plain JS object. For other objects, see `joint.dia.Graph>>_prepareCell()`.\n        if (!opt.dry) {\n            cell.graph = collection.graph;\n        }\n\n        return cell;\n    },\n\n    // `comparator` makes it easy to sort cells based on their `z` index.\n    comparator: function(model) {\n\n        return model.get('z') || 0;\n    }\n});\n\n\nexport const Graph = Backbone.Model.extend({\n\n    initialize: function(attrs, opt) {\n\n        opt = opt || {};\n\n        // Passing `cellModel` function in the options object to graph allows for\n        // setting models based on attribute objects. This is especially handy\n        // when processing JSON graphs that are in a different than JointJS format.\n        var cells = new GraphCells([], {\n            model: opt.cellModel,\n            cellNamespace: opt.cellNamespace,\n            graph: this\n        });\n        Backbone.Model.prototype.set.call(this, 'cells', cells);\n\n        // Make all the events fired in the `cells` collection available.\n        // to the outside world.\n        cells.on('all', this.trigger, this);\n\n        // Backbone automatically doesn't trigger re-sort if models attributes are changed later when\n        // they're already in the collection. Therefore, we're triggering sort manually here.\n        this.on('change:z', this._sortOnChangeZ, this);\n\n        // `joint.dia.Graph` keeps an internal data structure (an adjacency list)\n        // for fast graph queries. All changes that affect the structure of the graph\n        // must be reflected in the `al` object. This object provides fast answers to\n        // questions such as \"what are the neighbours of this node\" or \"what\n        // are the sibling links of this link\".\n\n        // Outgoing edges per node. Note that we use a hash-table for the list\n        // of outgoing edges for a faster lookup.\n        // [nodeId] -> Object [edgeId] -> true\n        this._out = {};\n        // Ingoing edges per node.\n        // [nodeId] -> Object [edgeId] -> true\n        this._in = {};\n        // `_nodes` is useful for quick lookup of all the elements in the graph, without\n        // having to go through the whole cells array.\n        // [node ID] -> true\n        this._nodes = {};\n        // `_edges` is useful for quick lookup of all the links in the graph, without\n        // having to go through the whole cells array.\n        // [edgeId] -> true\n        this._edges = {};\n\n        this._batches = {};\n\n        cells.on('add', this._restructureOnAdd, this);\n        cells.on('remove', this._restructureOnRemove, this);\n        cells.on('reset', this._restructureOnReset, this);\n        cells.on('change:source', this._restructureOnChangeSource, this);\n        cells.on('change:target', this._restructureOnChangeTarget, this);\n        cells.on('remove', this._removeCell, this);\n    },\n\n    _sortOnChangeZ: function() {\n\n        this.get('cells').sort();\n    },\n\n    _restructureOnAdd: function(cell) {\n\n        if (cell.isLink()) {\n            this._edges[cell.id] = true;\n            var { source, target } = cell.attributes;\n            if (source.id) {\n                (this._out[source.id] || (this._out[source.id] = {}))[cell.id] = true;\n            }\n            if (target.id) {\n                (this._in[target.id] || (this._in[target.id] = {}))[cell.id] = true;\n            }\n        } else {\n            this._nodes[cell.id] = true;\n        }\n    },\n\n    _restructureOnRemove: function(cell) {\n\n        if (cell.isLink()) {\n            delete this._edges[cell.id];\n            var { source, target } = cell.attributes;\n            if (source.id && this._out[source.id] && this._out[source.id][cell.id]) {\n                delete this._out[source.id][cell.id];\n            }\n            if (target.id && this._in[target.id] && this._in[target.id][cell.id]) {\n                delete this._in[target.id][cell.id];\n            }\n        } else {\n            delete this._nodes[cell.id];\n        }\n    },\n\n    _restructureOnReset: function(cells) {\n\n        // Normalize into an array of cells. The original `cells` is GraphCells Backbone collection.\n        cells = cells.models;\n\n        this._out = {};\n        this._in = {};\n        this._nodes = {};\n        this._edges = {};\n\n        cells.forEach(this._restructureOnAdd, this);\n    },\n\n    _restructureOnChangeSource: function(link) {\n\n        var prevSource = link.previous('source');\n        if (prevSource.id && this._out[prevSource.id]) {\n            delete this._out[prevSource.id][link.id];\n        }\n        var source = link.attributes.source;\n        if (source.id) {\n            (this._out[source.id] || (this._out[source.id] = {}))[link.id] = true;\n        }\n    },\n\n    _restructureOnChangeTarget: function(link) {\n\n        var prevTarget = link.previous('target');\n        if (prevTarget.id && this._in[prevTarget.id]) {\n            delete this._in[prevTarget.id][link.id];\n        }\n        var target = link.get('target');\n        if (target.id) {\n            (this._in[target.id] || (this._in[target.id] = {}))[link.id] = true;\n        }\n    },\n\n    // Return all outbound edges for the node. Return value is an object\n    // of the form: [edgeId] -> true\n    getOutboundEdges: function(node) {\n\n        return (this._out && this._out[node]) || {};\n    },\n\n    // Return all inbound edges for the node. Return value is an object\n    // of the form: [edgeId] -> true\n    getInboundEdges: function(node) {\n\n        return (this._in && this._in[node]) || {};\n    },\n\n    toJSON: function() {\n\n        // Backbone does not recursively call `toJSON()` on attributes that are themselves models/collections.\n        // It just clones the attributes. Therefore, we must call `toJSON()` on the cells collection explicitly.\n        var json = Backbone.Model.prototype.toJSON.apply(this, arguments);\n        json.cells = this.get('cells').toJSON();\n        return json;\n    },\n\n    fromJSON: function(json, opt) {\n\n        if (!json.cells) {\n\n            throw new Error('Graph JSON must contain cells array.');\n        }\n\n        return this.set(json, opt);\n    },\n\n    set: function(key, val, opt) {\n\n        var attrs;\n\n        // Handle both `key`, value and {key: value} style arguments.\n        if (typeof key === 'object') {\n            attrs = key;\n            opt = val;\n        } else {\n            (attrs = {})[key] = val;\n        }\n\n        // Make sure that `cells` attribute is handled separately via resetCells().\n        if (attrs.hasOwnProperty('cells')) {\n            this.resetCells(attrs.cells, opt);\n            attrs = util.omit(attrs, 'cells');\n        }\n\n        // The rest of the attributes are applied via original set method.\n        return Backbone.Model.prototype.set.call(this, attrs, opt);\n    },\n\n    clear: function(opt) {\n\n        opt = util.assign({}, opt, { clear: true });\n\n        var collection = this.get('cells');\n\n        if (collection.length === 0) return this;\n\n        this.startBatch('clear', opt);\n\n        // The elements come after the links.\n        var cells = collection.sortBy(function(cell) {\n            return cell.isLink() ? 1 : 2;\n        });\n\n        do {\n\n            // Remove all the cells one by one.\n            // Note that all the links are removed first, so it's\n            // safe to remove the elements without removing the connected\n            // links first.\n            cells.shift().remove(opt);\n\n        } while (cells.length > 0);\n\n        this.stopBatch('clear');\n\n        return this;\n    },\n\n    _prepareCell: function(cell, opt) {\n\n        var attrs;\n        if (cell instanceof Backbone.Model) {\n            attrs = cell.attributes;\n            if (!cell.graph && (!opt || !opt.dry)) {\n                // An element can not be member of more than one graph.\n                // A cell stops being the member of the graph after it's explicitly removed.\n                cell.graph = this;\n            }\n        } else {\n            // In case we're dealing with a plain JS object, we have to set the reference\n            // to the `graph` right after the actual model is created. This happens in the `model()` function\n            // of `joint.dia.GraphCells`.\n            attrs = cell;\n        }\n\n        if (!util.isString(attrs.type)) {\n            throw new TypeError('dia.Graph: cell type must be a string.');\n        }\n\n        return cell;\n    },\n\n    minZIndex: function() {\n\n        var firstCell = this.get('cells').first();\n        return firstCell ? (firstCell.get('z') || 0) : 0;\n    },\n\n    maxZIndex: function() {\n\n        var lastCell = this.get('cells').last();\n        return lastCell ? (lastCell.get('z') || 0) : 0;\n    },\n\n    addCell: function(cell, opt) {\n\n        if (Array.isArray(cell)) {\n\n            return this.addCells(cell, opt);\n        }\n\n        if (cell instanceof Backbone.Model) {\n\n            if (!cell.has('z')) {\n                cell.set('z', this.maxZIndex() + 1);\n            }\n\n        } else if (cell.z === undefined) {\n\n            cell.z = this.maxZIndex() + 1;\n        }\n\n        this.get('cells').add(this._prepareCell(cell, opt), opt || {});\n\n        return this;\n    },\n\n    addCells: function(cells, opt) {\n\n        if (cells.length === 0) return this;\n\n        cells = util.flattenDeep(cells);\n        opt.maxPosition = opt.position = cells.length - 1;\n\n        this.startBatch('add', opt);\n        cells.forEach(function(cell) {\n            this.addCell(cell, opt);\n            opt.position--;\n        }, this);\n        this.stopBatch('add', opt);\n\n        return this;\n    },\n\n    // When adding a lot of cells, it is much more efficient to\n    // reset the entire cells collection in one go.\n    // Useful for bulk operations and optimizations.\n    resetCells: function(cells, opt) {\n\n        var preparedCells = util.toArray(cells).map(function(cell) {\n            return this._prepareCell(cell, opt);\n        }, this);\n        this.get('cells').reset(preparedCells, opt);\n\n        return this;\n    },\n\n    removeCells: function(cells, opt) {\n\n        if (cells.length) {\n\n            this.startBatch('remove');\n            util.invoke(cells, 'remove', opt);\n            this.stopBatch('remove');\n        }\n\n        return this;\n    },\n\n    _removeCell: function(cell, collection, options) {\n\n        options = options || {};\n\n        if (!options.clear) {\n            // Applications might provide a `disconnectLinks` option set to `true` in order to\n            // disconnect links when a cell is removed rather then removing them. The default\n            // is to remove all the associated links.\n            if (options.disconnectLinks) {\n\n                this.disconnectLinks(cell, options);\n\n            } else {\n\n                this.removeLinks(cell, options);\n            }\n        }\n        // Silently remove the cell from the cells collection. Silently, because\n        // `joint.dia.Cell.prototype.remove` already triggers the `remove` event which is\n        // then propagated to the graph model. If we didn't remove the cell silently, two `remove` events\n        // would be triggered on the graph model.\n        this.get('cells').remove(cell, { silent: true });\n\n        if (cell.graph === this) {\n            // Remove the element graph reference only if the cell is the member of this graph.\n            cell.graph = null;\n        }\n    },\n\n    // Get a cell by `id`.\n    getCell: function(id) {\n\n        return this.get('cells').get(id);\n    },\n\n    getCells: function() {\n\n        return this.get('cells').toArray();\n    },\n\n    getElements: function() {\n\n        return this.get('cells').filter(cell => cell.isElement());\n    },\n\n    getLinks: function() {\n\n        return this.get('cells').filter(cell => cell.isLink());\n    },\n\n    getFirstCell: function() {\n\n        return this.get('cells').first();\n    },\n\n    getLastCell: function() {\n\n        return this.get('cells').last();\n    },\n\n    // Get all inbound and outbound links connected to the cell `model`.\n    getConnectedLinks: function(model, opt) {\n\n        opt = opt || {};\n\n        var indirect = opt.indirect;\n        var inbound = opt.inbound;\n        var outbound = opt.outbound;\n        if ((inbound === undefined) && (outbound === undefined)) {\n            inbound = outbound = true;\n        }\n\n        // the final array of connected link models\n        var links = [];\n        // a hash table of connected edges of the form: [edgeId] -> true\n        // used for quick lookups to check if we already added a link\n        var edges = {};\n\n        if (outbound) {\n            addOutbounds(this, model);\n        }\n        if (inbound) {\n            addInbounds(this, model);\n        }\n\n        function addOutbounds(graph, model) {\n            util.forIn(graph.getOutboundEdges(model.id), function(_, edge) {\n                // skip links that were already added\n                // (those must be self-loop links)\n                // (because they are inbound and outbound edges of the same two elements)\n                if (edges[edge]) return;\n                var link = graph.getCell(edge);\n                links.push(link);\n                edges[edge] = true;\n                if (indirect) {\n                    if (inbound) addInbounds(graph, link);\n                    if (outbound) addOutbounds(graph, link);\n                }\n            }.bind(graph));\n            if (indirect && model.isLink()) {\n                var outCell = model.getTargetCell();\n                if (outCell && outCell.isLink()) {\n                    if (!edges[outCell.id]) {\n                        links.push(outCell);\n                        addOutbounds(graph, outCell);\n                    }\n                }\n            }\n        }\n\n        function addInbounds(graph, model) {\n            util.forIn(graph.getInboundEdges(model.id), function(_, edge) {\n                // skip links that were already added\n                // (those must be self-loop links)\n                // (because they are inbound and outbound edges of the same two elements)\n                if (edges[edge]) return;\n                var link = graph.getCell(edge);\n                links.push(link);\n                edges[edge] = true;\n                if (indirect) {\n                    if (inbound) addInbounds(graph, link);\n                    if (outbound) addOutbounds(graph, link);\n                }\n            }.bind(graph));\n            if (indirect && model.isLink()) {\n                var inCell = model.getSourceCell();\n                if (inCell && inCell.isLink()) {\n                    if (!edges[inCell.id]) {\n                        links.push(inCell);\n                        addInbounds(graph, inCell);\n                    }\n                }\n            }\n        }\n\n        // if `deep` option is `true`, check also all the links that are connected to any of the descendant cells\n        if (opt.deep) {\n\n            var embeddedCells = model.getEmbeddedCells({ deep: true });\n\n            // in the first round, we collect all the embedded elements\n            var embeddedElements = {};\n            embeddedCells.forEach(function(cell) {\n                if (cell.isElement()) {\n                    embeddedElements[cell.id] = true;\n                }\n            });\n\n            embeddedCells.forEach(function(cell) {\n                if (cell.isLink()) return;\n                if (outbound) {\n                    util.forIn(this.getOutboundEdges(cell.id), function(exists, edge) {\n                        if (!edges[edge]) {\n                            var edgeCell = this.getCell(edge);\n                            var { source, target } = edgeCell.attributes;\n                            var sourceId = source.id;\n                            var targetId = target.id;\n\n                            // if `includeEnclosed` option is falsy, skip enclosed links\n                            if (!opt.includeEnclosed\n                                && (sourceId && embeddedElements[sourceId])\n                                && (targetId && embeddedElements[targetId])) {\n                                return;\n                            }\n\n                            links.push(this.getCell(edge));\n                            edges[edge] = true;\n                        }\n                    }.bind(this));\n                }\n                if (inbound) {\n                    util.forIn(this.getInboundEdges(cell.id), function(exists, edge) {\n                        if (!edges[edge]) {\n                            var edgeCell = this.getCell(edge);\n                            var { source, target } = edgeCell.attributes;\n                            var sourceId = source.id;\n                            var targetId = target.id;\n\n                            // if `includeEnclosed` option is falsy, skip enclosed links\n                            if (!opt.includeEnclosed\n                                && (sourceId && embeddedElements[sourceId])\n                                && (targetId && embeddedElements[targetId])) {\n                                return;\n                            }\n\n                            links.push(this.getCell(edge));\n                            edges[edge] = true;\n                        }\n                    }.bind(this));\n                }\n            }, this);\n        }\n\n        return links;\n    },\n\n    getNeighbors: function(model, opt) {\n\n        opt || (opt = {});\n\n        var inbound = opt.inbound;\n        var outbound = opt.outbound;\n        if (inbound === undefined && outbound === undefined) {\n            inbound = outbound = true;\n        }\n\n        var neighbors = this.getConnectedLinks(model, opt).reduce(function(res, link) {\n\n            var { source, target } = link.attributes;\n            var loop = link.hasLoop(opt);\n\n            // Discard if it is a point, or if the neighbor was already added.\n            if (inbound && util.has(source, 'id') && !res[source.id]) {\n\n                var sourceElement = this.getCell(source.id);\n                if (sourceElement.isElement()) {\n                    if (loop || (sourceElement && sourceElement !== model && (!opt.deep || !sourceElement.isEmbeddedIn(model)))) {\n                        res[source.id] = sourceElement;\n                    }\n                }\n            }\n\n            // Discard if it is a point, or if the neighbor was already added.\n            if (outbound && util.has(target, 'id') && !res[target.id]) {\n\n                var targetElement = this.getCell(target.id);\n                if (targetElement.isElement()) {\n                    if (loop || (targetElement && targetElement !== model && (!opt.deep || !targetElement.isEmbeddedIn(model)))) {\n                        res[target.id] = targetElement;\n                    }\n                }\n            }\n\n            return res;\n        }.bind(this), {});\n\n        if (model.isLink()) {\n            if (inbound) {\n                var sourceCell = model.getSourceCell();\n                if (sourceCell && sourceCell.isElement() && !neighbors[sourceCell.id]) {\n                    neighbors[sourceCell.id] = sourceCell;\n                }\n            }\n            if (outbound) {\n                var targetCell = model.getTargetCell();\n                if (targetCell && targetCell.isElement() && !neighbors[targetCell.id]) {\n                    neighbors[targetCell.id] = targetCell;\n                }\n            }\n        }\n\n        return util.toArray(neighbors);\n    },\n\n    getCommonAncestor: function(/* cells */) {\n\n        var cellsAncestors = Array.from(arguments).map(function(cell) {\n\n            var ancestors = [];\n            var parentId = cell.get('parent');\n\n            while (parentId) {\n\n                ancestors.push(parentId);\n                parentId = this.getCell(parentId).get('parent');\n            }\n\n            return ancestors;\n\n        }, this);\n\n        cellsAncestors = cellsAncestors.sort(function(a, b) {\n            return a.length - b.length;\n        });\n\n        var commonAncestor = util.toArray(cellsAncestors.shift()).find(function(ancestor) {\n            return cellsAncestors.every(function(cellAncestors) {\n                return cellAncestors.includes(ancestor);\n            });\n        });\n\n        return this.getCell(commonAncestor);\n    },\n\n    // Find the whole branch starting at `element`.\n    // If `opt.deep` is `true`, take into account embedded elements too.\n    // If `opt.breadthFirst` is `true`, use the Breadth-first search algorithm, otherwise use Depth-first search.\n    getSuccessors: function(element, opt) {\n\n        opt = opt || {};\n        var res = [];\n        // Modify the options so that it includes the `outbound` neighbors only. In other words, search forwards.\n        this.search(element, function(el) {\n            if (el !== element) {\n                res.push(el);\n            }\n        }, util.assign({}, opt, { outbound: true }));\n        return res;\n    },\n\n    cloneCells: cloneCells,\n    // Clone the whole subgraph (including all the connected links whose source/target is in the subgraph).\n    // If `opt.deep` is `true`, also take into account all the embedded cells of all the subgraph cells.\n    // Return a map of the form: [original cell ID] -> [clone].\n    cloneSubgraph: function(cells, opt) {\n\n        var subgraph = this.getSubgraph(cells, opt);\n        return this.cloneCells(subgraph);\n    },\n\n    // Return `cells` and all the connected links that connect cells in the `cells` array.\n    // If `opt.deep` is `true`, return all the cells including all their embedded cells\n    // and all the links that connect any of the returned cells.\n    // For example, for a single shallow element, the result is that very same element.\n    // For two elements connected with a link: `A --- L ---> B`, the result for\n    // `getSubgraph([A, B])` is `[A, L, B]`. The same goes for `getSubgraph([L])`, the result is again `[A, L, B]`.\n    getSubgraph: function(cells, opt) {\n\n        opt = opt || {};\n\n        var subgraph = [];\n        // `cellMap` is used for a quick lookup of existence of a cell in the `cells` array.\n        var cellMap = {};\n        var elements = [];\n        var links = [];\n\n        util.toArray(cells).forEach(function(cell) {\n            if (!cellMap[cell.id]) {\n                subgraph.push(cell);\n                cellMap[cell.id] = cell;\n                if (cell.isLink()) {\n                    links.push(cell);\n                } else {\n                    elements.push(cell);\n                }\n            }\n\n            if (opt.deep) {\n                var embeds = cell.getEmbeddedCells({ deep: true });\n                embeds.forEach(function(embed) {\n                    if (!cellMap[embed.id]) {\n                        subgraph.push(embed);\n                        cellMap[embed.id] = embed;\n                        if (embed.isLink()) {\n                            links.push(embed);\n                        } else {\n                            elements.push(embed);\n                        }\n                    }\n                });\n            }\n        });\n\n        links.forEach(function(link) {\n            // For links, return their source & target (if they are elements - not points).\n            var { source, target } = link.attributes;\n            if (source.id && !cellMap[source.id]) {\n                var sourceElement = this.getCell(source.id);\n                subgraph.push(sourceElement);\n                cellMap[sourceElement.id] = sourceElement;\n                elements.push(sourceElement);\n            }\n            if (target.id && !cellMap[target.id]) {\n                var targetElement = this.getCell(target.id);\n                subgraph.push(this.getCell(target.id));\n                cellMap[targetElement.id] = targetElement;\n                elements.push(targetElement);\n            }\n        }, this);\n\n        elements.forEach(function(element) {\n            // For elements, include their connected links if their source/target is in the subgraph;\n            var links = this.getConnectedLinks(element, opt);\n            links.forEach(function(link) {\n                var { source, target } = link.attributes;\n                if (!cellMap[link.id] && source.id && cellMap[source.id] && target.id && cellMap[target.id]) {\n                    subgraph.push(link);\n                    cellMap[link.id] = link;\n                }\n            });\n        }, this);\n\n        return subgraph;\n    },\n\n    // Find all the predecessors of `element`. This is a reverse operation of `getSuccessors()`.\n    // If `opt.deep` is `true`, take into account embedded elements too.\n    // If `opt.breadthFirst` is `true`, use the Breadth-first search algorithm, otherwise use Depth-first search.\n    getPredecessors: function(element, opt) {\n\n        opt = opt || {};\n        var res = [];\n        // Modify the options so that it includes the `inbound` neighbors only. In other words, search backwards.\n        this.search(element, function(el) {\n            if (el !== element) {\n                res.push(el);\n            }\n        }, util.assign({}, opt, { inbound: true }));\n        return res;\n    },\n\n    // Perform search on the graph.\n    // If `opt.breadthFirst` is `true`, use the Breadth-first Search algorithm, otherwise use Depth-first search.\n    // By setting `opt.inbound` to `true`, you can reverse the direction of the search.\n    // If `opt.deep` is `true`, take into account embedded elements too.\n    // `iteratee` is a function of the form `function(element) {}`.\n    // If `iteratee` explicitly returns `false`, the searching stops.\n    search: function(element, iteratee, opt) {\n\n        opt = opt || {};\n        if (opt.breadthFirst) {\n            this.bfs(element, iteratee, opt);\n        } else {\n            this.dfs(element, iteratee, opt);\n        }\n    },\n\n    // Breadth-first search.\n    // If `opt.deep` is `true`, take into account embedded elements too.\n    // If `opt.inbound` is `true`, reverse the search direction (it's like reversing all the link directions).\n    // `iteratee` is a function of the form `function(element, distance) {}`.\n    // where `element` is the currently visited element and `distance` is the distance of that element\n    // from the root `element` passed the `bfs()`, i.e. the element we started the search from.\n    // Note that the `distance` is not the shortest or longest distance, it is simply the number of levels\n    // crossed till we visited the `element` for the first time. It is especially useful for tree graphs.\n    // If `iteratee` explicitly returns `false`, the searching stops.\n    bfs: function(element, iteratee, opt = {}) {\n\n        const visited = {};\n        const distance = {};\n        const queue = [];\n\n        queue.push(element);\n        distance[element.id] = 0;\n\n        while (queue.length > 0) {\n            var next = queue.shift();\n            if (visited[next.id]) continue;\n            visited[next.id] = true;\n            if (iteratee.call(this, next, distance[next.id]) === false) continue;\n            const neighbors = this.getNeighbors(next, opt);\n            for (let i = 0, n = neighbors.length; i < n; i++) {\n                const neighbor = neighbors[i];\n                distance[neighbor.id] = distance[next.id] + 1;\n                queue.push(neighbor);\n            }\n        }\n    },\n\n    // Depth-first search.\n    // If `opt.deep` is `true`, take into account embedded elements too.\n    // If `opt.inbound` is `true`, reverse the search direction (it's like reversing all the link directions).\n    // `iteratee` is a function of the form `function(element, distance) {}`.\n    // If `iteratee` explicitly returns `false`, the search stops.\n    dfs: function(element, iteratee, opt = {}) {\n\n        const visited = {};\n        const distance = {};\n        const queue = [];\n\n        queue.push(element);\n        distance[element.id] = 0;\n\n        while (queue.length > 0) {\n            const next = queue.pop();\n            if (visited[next.id]) continue;\n            visited[next.id] = true;\n            if (iteratee.call(this, next, distance[next.id]) === false) continue;\n            const neighbors = this.getNeighbors(next, opt);\n            const lastIndex = queue.length;\n            for (let i = 0, n = neighbors.length; i < n; i++) {\n                const neighbor = neighbors[i];\n                distance[neighbor.id] = distance[next.id] + 1;\n                queue.splice(lastIndex, 0, neighbor);\n            }\n        }\n    },\n\n    // Get all the roots of the graph. Time complexity: O(|V|).\n    getSources: function() {\n\n        var sources = [];\n        util.forIn(this._nodes, function(exists, node) {\n            if (!this._in[node] || util.isEmpty(this._in[node])) {\n                sources.push(this.getCell(node));\n            }\n        }.bind(this));\n        return sources;\n    },\n\n    // Get all the leafs of the graph. Time complexity: O(|V|).\n    getSinks: function() {\n\n        var sinks = [];\n        util.forIn(this._nodes, function(exists, node) {\n            if (!this._out[node] || util.isEmpty(this._out[node])) {\n                sinks.push(this.getCell(node));\n            }\n        }.bind(this));\n        return sinks;\n    },\n\n    // Return `true` if `element` is a root. Time complexity: O(1).\n    isSource: function(element) {\n\n        return !this._in[element.id] || util.isEmpty(this._in[element.id]);\n    },\n\n    // Return `true` if `element` is a leaf. Time complexity: O(1).\n    isSink: function(element) {\n\n        return !this._out[element.id] || util.isEmpty(this._out[element.id]);\n    },\n\n    // Return `true` is `elementB` is a successor of `elementA`. Return `false` otherwise.\n    isSuccessor: function(elementA, elementB) {\n\n        var isSuccessor = false;\n        this.search(elementA, function(element) {\n            if (element === elementB && element !== elementA) {\n                isSuccessor = true;\n                return false;\n            }\n        }, { outbound: true });\n        return isSuccessor;\n    },\n\n    // Return `true` is `elementB` is a predecessor of `elementA`. Return `false` otherwise.\n    isPredecessor: function(elementA, elementB) {\n\n        var isPredecessor = false;\n        this.search(elementA, function(element) {\n            if (element === elementB && element !== elementA) {\n                isPredecessor = true;\n                return false;\n            }\n        }, { inbound: true });\n        return isPredecessor;\n    },\n\n    // Return `true` is `elementB` is a neighbor of `elementA`. Return `false` otherwise.\n    // `opt.deep` controls whether to take into account embedded elements as well. See `getNeighbors()`\n    // for more details.\n    // If `opt.outbound` is set to `true`, return `true` only if `elementB` is a successor neighbor.\n    // Similarly, if `opt.inbound` is set to `true`, return `true` only if `elementB` is a predecessor neighbor.\n    isNeighbor: function(elementA, elementB, opt) {\n\n        opt = opt || {};\n\n        var inbound = opt.inbound;\n        var outbound = opt.outbound;\n        if ((inbound === undefined) && (outbound === undefined)) {\n            inbound = outbound = true;\n        }\n\n        var isNeighbor = false;\n\n        this.getConnectedLinks(elementA, opt).forEach(function(link) {\n\n            var { source, target } = link.attributes;\n\n            // Discard if it is a point.\n            if (inbound && util.has(source, 'id') && (source.id === elementB.id)) {\n                isNeighbor = true;\n                return false;\n            }\n\n            // Discard if it is a point, or if the neighbor was already added.\n            if (outbound && util.has(target, 'id') && (target.id === elementB.id)) {\n                isNeighbor = true;\n                return false;\n            }\n        });\n\n        return isNeighbor;\n    },\n\n    // Disconnect links connected to the cell `model`.\n    disconnectLinks: function(model, opt) {\n\n        this.getConnectedLinks(model).forEach(function(link) {\n\n            link.set((link.attributes.source.id === model.id ? 'source' : 'target'), { x: 0, y: 0 }, opt);\n        });\n    },\n\n    // Remove links connected to the cell `model` completely.\n    removeLinks: function(model, opt) {\n\n        util.invoke(this.getConnectedLinks(model), 'remove', opt);\n    },\n\n    // Find all elements at given point\n    findModelsFromPoint: function(p) {\n        return this.getElements().filter(el => el.getBBox({ rotate: true }).containsPoint(p));\n    },\n\n    // Find all elements in given area\n    findModelsInArea: function(rect, opt = {}) {\n        const r = new g.Rect(rect);\n        const { strict = false } = opt;\n        const method = strict ? 'containsRect' : 'intersect';\n        return this.getElements().filter(el => r[method](el.getBBox({ rotate: true })));\n    },\n\n    // Find all elements under the given element.\n    findModelsUnderElement: function(element, opt = {}) {\n        const { searchBy = 'bbox' } = opt;\n        const bbox = element.getBBox().rotateAroundCenter(element.angle());\n        const elements = (searchBy === 'bbox')\n            ? this.findModelsInArea(bbox)\n            : this.findModelsFromPoint(util.getRectPoint(bbox, searchBy));\n        // don't account element itself or any of its descendants\n        return elements.filter(el => element.id !== el.id && !el.isEmbeddedIn(element));\n    },\n\n    // Return bounding box of all elements.\n    getBBox: function() {\n\n        return this.getCellsBBox(this.getCells());\n    },\n\n    // Return the bounding box of all cells in array provided.\n    getCellsBBox: function(cells, opt = {}) {\n        const { rotate = true } = opt;\n        return util.toArray(cells).reduce(function(memo, cell) {\n            const rect = cell.getBBox({ rotate });\n            if (!rect) return memo;\n            if (memo) {\n                return memo.union(rect);\n            }\n            return rect;\n        }, null);\n    },\n\n    translate: function(dx, dy, opt) {\n\n        // Don't translate cells that are embedded in any other cell.\n        var cells = this.getCells().filter(function(cell) {\n            return !cell.isEmbedded();\n        });\n\n        util.invoke(cells, 'translate', dx, dy, opt);\n\n        return this;\n    },\n\n    resize: function(width, height, opt) {\n\n        return this.resizeCells(width, height, this.getCells(), opt);\n    },\n\n    resizeCells: function(width, height, cells, opt) {\n\n        // `getBBox` method returns `null` if no elements provided.\n        // i.e. cells can be an array of links\n        var bbox = this.getCellsBBox(cells);\n        if (bbox) {\n            var sx = Math.max(width / bbox.width, 0);\n            var sy = Math.max(height / bbox.height, 0);\n            util.invoke(cells, 'scale', sx, sy, bbox.origin(), opt);\n        }\n\n        return this;\n    },\n\n    startBatch: function(name, data) {\n\n        data = data || {};\n        this._batches[name] = (this._batches[name] || 0) + 1;\n\n        return this.trigger('batch:start', util.assign({}, data, { batchName: name }));\n    },\n\n    stopBatch: function(name, data) {\n\n        data = data || {};\n        this._batches[name] = (this._batches[name] || 0) - 1;\n\n        return this.trigger('batch:stop', util.assign({}, data, { batchName: name }));\n    },\n\n    hasActiveBatch: function(name) {\n\n        const batches = this._batches;\n        let names;\n\n        if (arguments.length === 0) {\n            names = Object.keys(batches);\n        } else if (Array.isArray(name)) {\n            names = name;\n        } else {\n            names = [name];\n        }\n\n        return names.some((batch) => batches[batch] > 0);\n    }\n\n}, {\n\n    validations: {\n\n        multiLinks: function(graph, link) {\n\n            // Do not allow multiple links to have the same source and target.\n            var { source, target } = link.attributes;\n\n            if (source.id && target.id) {\n\n                var sourceModel = link.getSourceCell();\n                if (sourceModel) {\n\n                    var connectedLinks = graph.getConnectedLinks(sourceModel, { outbound: true });\n                    var sameLinks = connectedLinks.filter(function(_link) {\n\n                        var { source: _source, target: _target } = _link.attributes;\n                        return _source && _source.id === source.id &&\n                            (!_source.port || (_source.port === source.port)) &&\n                            _target && _target.id === target.id &&\n                            (!_target.port || (_target.port === target.port));\n\n                    });\n\n                    if (sameLinks.length > 1) {\n                        return false;\n                    }\n                }\n            }\n\n            return true;\n        },\n\n        linkPinning: function(_graph, link) {\n            var { source, target } = link.attributes;\n            return source.id && target.id;\n        }\n    }\n\n});\n\nwrapWith(Graph.prototype, ['resetCells', 'addCells', 'removeCells'], wrappers.cells);\n","import { View } from '../mvc/index.mjs';\nimport { addClassNamePrefix } from '../util/util.mjs';\n\nexport const LayersNames = {\n    CELLS: 'cells',\n    BACK: 'back',\n    FRONT: 'front',\n    TOOLS: 'tools',\n    LABELS: 'labels'\n};\n\nexport const PaperLayer = View.extend({\n\n    tagName: 'g',\n    svgElement: true,\n    pivotNodes: null,\n    defaultTheme: null,\n\n    options: {\n        name: ''\n    },\n\n    className: function() {\n        return addClassNamePrefix(`${this.options.name}-layer`);\n    },\n\n    init: function() {\n        this.pivotNodes = {};\n    },\n\n    insertSortedNode: function(node, z) {\n        this.el.insertBefore(node, this.insertPivot(z));\n    },\n\n    insertNode: function(node) {\n        const { el } = this;\n        if (node.parentNode !== el) {\n            el.appendChild(node);\n        }\n    },\n\n    insertPivot: function(z) {\n        const { el, pivotNodes } = this;\n        z = +z;\n        z || (z = 0);\n        let pivotNode = pivotNodes[z];\n        if (pivotNode) return pivotNode;\n        pivotNode = pivotNodes[z] = document.createComment('z-index:' + (z + 1));\n        let neighborZ = -Infinity;\n        for (let currentZ in pivotNodes) {\n            currentZ = +currentZ;\n            if (currentZ < z && currentZ > neighborZ) {\n                neighborZ = currentZ;\n                if (neighborZ === z - 1) continue;\n            }\n        }\n        if (neighborZ !== -Infinity) {\n            const neighborPivot = pivotNodes[neighborZ];\n            // Insert After\n            el.insertBefore(pivotNode, neighborPivot.nextSibling);\n        } else {\n            // First Child\n            el.insertBefore(pivotNode, el.firstChild);\n        }\n        return pivotNode;\n    },\n\n    removePivots: function() {\n        const { el, pivotNodes } = this;\n        for (let z in pivotNodes) el.removeChild(pivotNodes[z]);\n        this.pivotNodes = {};\n    }\n\n});\n","import * as mvc from '../mvc/index.mjs';\nimport V from '../V/index.mjs';\nimport { isPlainObject, result } from '../util/util.mjs';\n\nfunction toArray(obj) {\n    if (!obj) return [];\n    if (Array.isArray(obj)) return obj;\n    return [obj];\n}\n\nexport const HighlighterView = mvc.View.extend({\n\n    tagName: 'g',\n    svgElement: true,\n    className: 'highlight',\n\n    HIGHLIGHT_FLAG: 1,\n    UPDATE_PRIORITY: 3,\n    DETACHABLE: false,\n    UPDATABLE: true,\n    MOUNTABLE: true,\n\n    cellView: null,\n    nodeSelector: null,\n    node: null,\n    updateRequested: false,\n    postponedUpdate: false,\n    transformGroup: null,\n    detachedTransformGroup: null,\n\n    requestUpdate(cellView, nodeSelector) {\n        const { paper } = cellView;\n        this.cellView = cellView;\n        this.nodeSelector = nodeSelector;\n        if (paper) {\n            this.updateRequested = true;\n            paper.requestViewUpdate(this, this.HIGHLIGHT_FLAG, this.UPDATE_PRIORITY);\n        }\n    },\n\n    confirmUpdate() {\n        // The cellView is now rendered/updated since it has a higher update priority.\n        this.updateRequested = false;\n        const { cellView, nodeSelector } = this;\n        if (!cellView.isMounted()) {\n            this.postponedUpdate = true;\n            return 0;\n        }\n        this.update(cellView, nodeSelector);\n        this.mount();\n        this.transform();\n        return 0;\n    },\n\n    findNode(cellView, nodeSelector = null) {\n        let el;\n        if (typeof nodeSelector === 'string') {\n            [el] = cellView.findBySelector(nodeSelector);\n        } else if (isPlainObject(nodeSelector)) {\n            const isLink = cellView.model.isLink();\n            const { label = null, port, selector } = nodeSelector;\n            if (isLink && label !== null) {\n                // Link Label Selector\n                el = cellView.findLabelNode(label, selector);\n            } else if (!isLink && port) {\n                // Element Port Selector\n                el = cellView.findPortNode(port, selector);\n            } else {\n                // Cell Selector\n                [el] = cellView.findBySelector(selector);\n            }\n        } else if (nodeSelector) {\n            el = V.toNode(nodeSelector);\n            if (!(el instanceof SVGElement)) el = null;\n        }\n        return el ? el : null;\n    },\n\n    getNodeMatrix(cellView, node) {\n        const { options } = this;\n        const { layer } = options;\n        const { rotatableNode } = cellView;\n        const nodeMatrix = cellView.getNodeMatrix(node);\n        if (rotatableNode) {\n            if (layer) {\n                if (rotatableNode.contains(node)) {\n                    return nodeMatrix;\n                }\n                // The node is outside of the rotatable group.\n                // Compensate the rotation set by transformGroup.\n                return cellView.getRootRotateMatrix().inverse().multiply(nodeMatrix);\n            } else {\n                return cellView.getNodeRotateMatrix(node).multiply(nodeMatrix);\n            }\n        }\n        return nodeMatrix;\n    },\n\n    mount() {\n        const { MOUNTABLE, cellView, el, options, transformGroup, detachedTransformGroup, postponedUpdate, nodeSelector } = this;\n        if (!MOUNTABLE || transformGroup) return;\n        if (postponedUpdate) {\n            // The cellView was not mounted when the update was requested.\n            // The update was postponed until the cellView is mounted.\n            this.update(cellView, nodeSelector);\n            this.transform();\n            return;\n        }\n        const { vel: cellViewRoot, paper } = cellView;\n        const { layer: layerName } = options;\n        if (layerName) {\n            let vGroup;\n            if (detachedTransformGroup) {\n                vGroup = detachedTransformGroup;\n                this.detachedTransformGroup = null;\n            } else {\n                vGroup = V('g').addClass('highlight-transform').append(el);\n            }\n            this.transformGroup = vGroup;\n            paper.getLayerView(layerName).insertSortedNode(vGroup.node, options.z);\n        } else {\n            // TODO: prepend vs append\n            if (!el.parentNode || el.nextSibling) {\n                // Not appended yet or not the last child\n                cellViewRoot.append(el);\n            }\n        }\n    },\n\n    unmount() {\n        const { MOUNTABLE, transformGroup, vel } = this;\n        if (!MOUNTABLE) return;\n        if (transformGroup) {\n            this.transformGroup = null;\n            this.detachedTransformGroup = transformGroup;\n            transformGroup.remove();\n        } else {\n            vel.remove();\n        }\n    },\n\n    transform() {\n        const { transformGroup, cellView, updateRequested } = this;\n        if (!transformGroup || cellView.model.isLink() || updateRequested) return;\n        const translateMatrix = cellView.getRootTranslateMatrix();\n        const rotateMatrix = cellView.getRootRotateMatrix();\n        const transformMatrix = translateMatrix.multiply(rotateMatrix);\n        transformGroup.attr('transform', V.matrixToTransformString(transformMatrix));\n    },\n\n    update() {\n        const { node: prevNode, cellView, nodeSelector, updateRequested, id } = this;\n        if (updateRequested) return;\n        this.postponedUpdate = false;\n        const node = this.node = this.findNode(cellView, nodeSelector);\n        if (prevNode) {\n            this.unhighlight(cellView, prevNode);\n        }\n        if (node) {\n            this.highlight(cellView, node);\n            this.mount();\n        } else {\n            this.unmount();\n            cellView.notify('cell:highlight:invalid', id, this);\n        }\n    },\n\n    onRemove() {\n        const { node, cellView, id, constructor } = this;\n        if (node) {\n            this.unhighlight(cellView, node);\n        }\n        this.unmount();\n        constructor._removeRef(cellView, id);\n    },\n\n    highlight(_cellView, _node) {\n        // to be overridden\n    },\n\n    unhighlight(_cellView, _node) {\n        // to be overridden\n    },\n\n    // Update Attributes\n\n    listenToUpdateAttributes(cellView) {\n        const attributes = result(this, 'UPDATE_ATTRIBUTES');\n        if (!Array.isArray(attributes) || attributes.length === 0) return;\n        this.listenTo(cellView.model, 'change', this.onCellAttributeChange);\n    },\n\n    onCellAttributeChange() {\n        const { cellView } = this;\n        if (!cellView) return;\n        const { model, paper } = cellView;\n        const attributes = result(this, 'UPDATE_ATTRIBUTES');\n        if (!attributes.some(attribute => model.hasChanged(attribute))) return;\n        paper.requestViewUpdate(this, this.HIGHLIGHT_FLAG, this.UPDATE_PRIORITY);\n    }\n\n}, {\n\n    _views: {},\n\n    // Used internally by CellView highlight()\n    highlight: function(cellView, node, opt) {\n        const id = this.uniqueId(node, opt);\n        this.add(cellView, node, id, opt);\n    },\n\n    // Used internally by CellView unhighlight()\n    unhighlight: function(cellView, node, opt) {\n        const id = this.uniqueId(node, opt);\n        this.remove(cellView, id);\n    },\n\n    get(cellView, id = null) {\n        const { cid } = cellView;\n        const { _views } = this;\n        const refs = _views[cid];\n        if (id === null) {\n            // all highlighters\n            const views = [];\n            if (!refs) return views;\n            for (let hid in refs) {\n                const ref = refs[hid];\n                if (ref instanceof this) {\n                    views.push(ref);\n                }\n            }\n            return views;\n        } else {\n            // single highlighter\n            if (!refs) return null;\n            if (id in refs) {\n                const ref = refs[id];\n                if (ref instanceof this) return ref;\n            }\n            return null;\n        }\n    },\n\n    add(cellView, nodeSelector, id, opt = {}) {\n        if (!id) throw new Error('dia.HighlighterView: An ID required.');\n        // Search the existing view amongst all the highlighters\n        const previousView = HighlighterView.get(cellView, id);\n        if (previousView) previousView.remove();\n        const view = new this(opt);\n        view.id = id;\n        this._addRef(cellView, id, view);\n        view.requestUpdate(cellView, nodeSelector);\n        view.listenToUpdateAttributes(cellView);\n        return view;\n    },\n\n    _addRef(cellView, id, view) {\n        const { cid } = cellView;\n        const { _views } = this;\n        let refs = _views[cid];\n        if (!refs) refs = _views[cid] = {};\n        refs[id] = view;\n    },\n\n    _removeRef(cellView, id) {\n        const { cid } = cellView;\n        const { _views } = this;\n        const refs = _views[cid];\n        if (!refs) return;\n        if (id) delete refs[id];\n        for (let _ in refs) return;\n        delete _views[cid];\n    },\n\n    remove(cellView, id = null) {\n        toArray(this.get(cellView, id)).forEach(view => {\n            view.remove();\n        });\n    },\n\n    removeAll(paper, id = null) {\n        const { _views } = this;\n\n        for (let cid in _views) {\n            for (let hid in _views[cid]) {\n                const view = _views[cid][hid];\n\n                if (view.cellView.paper === paper && view instanceof this && (id === null || hid === id)) {\n                    view.remove();\n                }\n            }\n        }\n    },\n\n    update(cellView, id = null, dirty = false) {\n        toArray(this.get(cellView, id)).forEach(view => {\n            if (dirty || view.UPDATABLE) view.update();\n        });\n    },\n\n    transform(cellView, id = null) {\n        toArray(this.get(cellView, id)).forEach(view => {\n            if (view.UPDATABLE) view.transform();\n        });\n    },\n\n    unmount(cellView, id = null) {\n        toArray(this.get(cellView, id)).forEach(view => view.unmount());\n    },\n\n    mount(cellView, id = null) {\n        toArray(this.get(cellView, id)).forEach(view => view.mount());\n    },\n\n    uniqueId(node, opt = '') {\n        return V.ensureId(node) + JSON.stringify(opt);\n    }\n\n});\n","import { config } from '../config/index.mjs';\nimport { View } from '../mvc/index.mjs';\nimport {\n    assign,\n    guid,\n    omit,\n    parseDOMJSON,\n    isFunction,\n    isObject,\n    isPlainObject,\n    isBoolean,\n    isEmpty,\n    isString,\n    toKebabCase,\n    result,\n    sortedIndex,\n    merge,\n    uniq\n} from '../util/index.mjs';\nimport { Point, Rect } from '../g/index.mjs';\nimport V from '../V/index.mjs';\nimport $ from 'jquery';\nimport { HighlighterView } from './HighlighterView.mjs';\n\nconst HighlightingTypes = {\n    DEFAULT: 'default',\n    EMBEDDING: 'embedding',\n    CONNECTING: 'connecting',\n    MAGNET_AVAILABILITY: 'magnetAvailability',\n    ELEMENT_AVAILABILITY: 'elementAvailability'\n};\n\nconst Flags = {\n    TOOLS: 'TOOLS',\n};\n\n// CellView base view and controller.\n// --------------------------------------------\n\n// This is the base view and controller for `ElementView` and `LinkView`.\nexport const CellView = View.extend({\n\n    tagName: 'g',\n\n    svgElement: true,\n\n    selector: 'root',\n\n    metrics: null,\n\n    className: function() {\n\n        var classNames = ['cell'];\n        var type = this.model.get('type');\n\n        if (type) {\n\n            type.toLowerCase().split('.').forEach(function(value, index, list) {\n                classNames.push('type-' + list.slice(0, index + 1).join('-'));\n            });\n        }\n\n        return classNames.join(' ');\n    },\n\n    _presentationAttributes: null,\n    _flags: null,\n\n    setFlags: function() {\n        var flags = {};\n        var attributes = {};\n        var shift = 0;\n        var i, n, label;\n        var presentationAttributes = result(this, 'presentationAttributes');\n        for (var attribute in presentationAttributes) {\n            if (!presentationAttributes.hasOwnProperty(attribute)) continue;\n            var labels = presentationAttributes[attribute];\n            if (!Array.isArray(labels)) labels = [labels];\n            for (i = 0, n = labels.length; i < n; i++) {\n                label = labels[i];\n                var flag = flags[label];\n                if (!flag) {\n                    flag = flags[label] = 1<<(shift++);\n                }\n                attributes[attribute] |= flag;\n            }\n        }\n        var initFlag = result(this, 'initFlag');\n        if (!Array.isArray(initFlag)) initFlag = [initFlag];\n        for (i = 0, n = initFlag.length; i < n; i++) {\n            label = initFlag[i];\n            if (!flags[label]) flags[label] = 1<<(shift++);\n        }\n\n        // 26 - 30 are reserved for paper flags\n        // 31+ overflows maximal number\n        if (shift > 25) throw new Error('dia.CellView: Maximum number of flags exceeded.');\n\n        this._flags = flags;\n        this._presentationAttributes = attributes;\n    },\n\n    hasFlag: function(flag, label) {\n        return flag & this.getFlag(label);\n    },\n\n    removeFlag: function(flag, label) {\n        return flag ^ (flag & this.getFlag(label));\n    },\n\n    getFlag: function(label) {\n        var flags = this._flags;\n        if (!flags) return 0;\n        var flag = 0;\n        if (Array.isArray(label)) {\n            for (var i = 0, n = label.length; i < n; i++) flag |= flags[label[i]];\n        } else {\n            flag |= flags[label];\n        }\n        return flag;\n    },\n\n    attributes: function() {\n        var cell = this.model;\n        return {\n            'model-id': cell.id,\n            'data-type': cell.attributes.type\n        };\n    },\n\n    constructor: function(options) {\n\n        // Make sure a global unique id is assigned to this view. Store this id also to the properties object.\n        // The global unique id makes sure that the same view can be rendered on e.g. different machines and\n        // still be associated to the same object among all those clients. This is necessary for real-time\n        // collaboration mechanism.\n        options.id = options.id || guid(this);\n\n        View.call(this, options);\n    },\n\n    initialize: function() {\n\n        this.setFlags();\n\n        View.prototype.initialize.apply(this, arguments);\n\n        this.cleanNodesCache();\n\n        // Store reference to this to the <g> DOM element so that the view is accessible through the DOM tree.\n        this.$el.data('view', this);\n\n        this.startListening();\n    },\n\n    startListening: function() {\n        this.listenTo(this.model, 'change', this.onAttributesChange);\n    },\n\n    onAttributesChange: function(model, opt) {\n        var flag = model.getChangeFlag(this._presentationAttributes);\n        if (opt.updateHandled || !flag) return;\n        if (opt.dirty && this.hasFlag(flag, 'UPDATE')) flag |= this.getFlag('RENDER');\n        // TODO: tool changes does not need to be sync\n        // Fix Segments tools\n        if (opt.tool) opt.async = false;\n        this.requestUpdate(flag, opt);\n    },\n\n    requestUpdate: function(flags, opt) {\n        const { paper } = this;\n        if (paper && flags > 0) {\n            paper.requestViewUpdate(this, flags, this.UPDATE_PRIORITY, opt);\n        }\n    },\n\n    parseDOMJSON: function(markup, root) {\n\n        var doc = parseDOMJSON(markup);\n        var selectors = doc.selectors;\n        var groups = doc.groupSelectors;\n        for (var group in groups) {\n            if (selectors[group]) throw new Error('dia.CellView: ambiguous group selector');\n            selectors[group] = groups[group];\n        }\n        if (root) {\n            var rootSelector = this.selector;\n            if (selectors[rootSelector]) throw new Error('dia.CellView: ambiguous root selector.');\n            selectors[rootSelector] = root;\n        }\n        return { fragment: doc.fragment, selectors: selectors };\n    },\n\n    // Return `true` if cell link is allowed to perform a certain UI `feature`.\n    // Example: `can('vertexMove')`, `can('labelMove')`.\n    can: function(feature) {\n\n        var interactive = isFunction(this.options.interactive)\n            ? this.options.interactive(this)\n            : this.options.interactive;\n\n        return (isObject(interactive) && interactive[feature] !== false) ||\n            (isBoolean(interactive) && interactive !== false);\n    },\n\n    findBySelector: function(selector, root, selectors) {\n\n        root || (root = this.el);\n        selectors || (selectors = this.selectors);\n\n        // These are either descendants of `this.$el` of `this.$el` itself.\n        // `.` is a special selector used to select the wrapping `<g>` element.\n        if (!selector || selector === '.') return [root];\n        if (selectors) {\n            var nodes = selectors[selector];\n            if (nodes) {\n                if (Array.isArray(nodes)) return nodes;\n                return [nodes];\n            }\n        }\n\n        // Maintaining backwards compatibility\n        // e.g. `circle:first` would fail with querySelector() call\n        if (config.useCSSSelectors) return $(root).find(selector).toArray();\n\n        return [];\n    },\n\n    notify: function(eventName) {\n\n        if (this.paper) {\n\n            var args = Array.prototype.slice.call(arguments, 1);\n\n            // Trigger the event on both the element itself and also on the paper.\n            this.trigger.apply(this, [eventName].concat(args));\n\n            // Paper event handlers receive the view object as the first argument.\n            this.paper.trigger.apply(this.paper, [eventName, this].concat(args));\n        }\n    },\n\n    getBBox: function(opt) {\n\n        var bbox;\n        if (opt && opt.useModelGeometry) {\n            var model = this.model;\n            bbox = model.getBBox().bbox(model.angle());\n        } else {\n            bbox = this.getNodeBBox(this.el);\n        }\n\n        return this.paper.localToPaperRect(bbox);\n    },\n\n    getNodeBBox: function(magnet) {\n\n        const rect = this.getNodeBoundingRect(magnet);\n        const transformMatrix = this.getRootTranslateMatrix().multiply(this.getNodeRotateMatrix(magnet));\n        const magnetMatrix = this.getNodeMatrix(magnet);\n        return V.transformRect(rect, transformMatrix.multiply(magnetMatrix));\n    },\n\n    getNodeRotateMatrix(node) {\n        if (!this.rotatableNode || this.rotatableNode.contains(node)) {\n            // Rotate transformation is applied to all nodes when no rotatableGroup\n            // is present or to nodes inside the rotatableGroup only.\n            return this.getRootRotateMatrix();\n        }\n        // Nodes outside the rotatable group\n        return V.createSVGMatrix();\n    },\n\n    getNodeUnrotatedBBox: function(magnet) {\n\n        var rect = this.getNodeBoundingRect(magnet);\n        var magnetMatrix = this.getNodeMatrix(magnet);\n        var translateMatrix = this.getRootTranslateMatrix();\n        return V.transformRect(rect, translateMatrix.multiply(magnetMatrix));\n    },\n\n    getRootTranslateMatrix: function() {\n\n        var model = this.model;\n        var position = model.position();\n        var mt = V.createSVGMatrix().translate(position.x, position.y);\n        return mt;\n    },\n\n    getRootRotateMatrix: function() {\n\n        var mr = V.createSVGMatrix();\n        var model = this.model;\n        var angle = model.angle();\n        if (angle) {\n            var bbox = model.getBBox();\n            var cx = bbox.width / 2;\n            var cy = bbox.height / 2;\n            mr = mr.translate(cx, cy).rotate(angle).translate(-cx, -cy);\n        }\n        return mr;\n    },\n\n    _notifyHighlight: function(eventName, el, opt = {}) {\n        const { el: rootNode } = this;\n        let node;\n        if (typeof el === 'string') {\n            [node = rootNode] = this.findBySelector(el);\n        } else {\n            [node = rootNode] = this.$(el);\n        }\n        // set partial flag if the highlighted element is not the entire view.\n        opt.partial = (node !== rootNode);\n        // translate type flag into a type string\n        if (opt.type === undefined) {\n            let type;\n            switch (true) {\n                case opt.embedding:\n                    type = HighlightingTypes.EMBEDDING;\n                    break;\n                case opt.connecting:\n                    type = HighlightingTypes.CONNECTING;\n                    break;\n                case opt.magnetAvailability:\n                    type = HighlightingTypes.MAGNET_AVAILABILITY;\n                    break;\n                case opt.elementAvailability:\n                    type = HighlightingTypes.ELEMENT_AVAILABILITY;\n                    break;\n                default:\n                    type = HighlightingTypes.DEFAULT;\n                    break;\n            }\n            opt.type = type;\n        }\n        this.notify(eventName, node, opt);\n        return this;\n    },\n\n    highlight: function(el, opt) {\n        return this._notifyHighlight('cell:highlight', el, opt);\n    },\n\n    unhighlight: function(el, opt = {}) {\n        return this._notifyHighlight('cell:unhighlight', el, opt);\n    },\n\n    // Find the closest element that has the `magnet` attribute set to `true`. If there was not such\n    // an element found, return the root element of the cell view.\n    findMagnet: function(el) {\n\n        const root = this.el;\n        let magnet = this.$(el)[0];\n        if (!magnet) {\n            magnet = root;\n        }\n\n        do {\n            const magnetAttribute = magnet.getAttribute('magnet');\n            const isMagnetRoot = (magnet === root);\n            if ((magnetAttribute || isMagnetRoot) && magnetAttribute !== 'false') {\n                return magnet;\n            }\n            if (isMagnetRoot) {\n                // If the overall cell has set `magnet === false`, then return `undefined` to\n                // announce there is no magnet found for this cell.\n                // This is especially useful to set on cells that have 'ports'. In this case,\n                // only the ports have set `magnet === true` and the overall element has `magnet === false`.\n                return undefined;\n            }\n            magnet = magnet.parentNode;\n        } while (magnet);\n\n        return undefined;\n    },\n\n    findProxyNode: function(el, type) {\n        el || (el = this.el);\n        const nodeSelector = el.getAttribute(`${type}-selector`);\n        if (nodeSelector) {\n            const [proxyNode] = this.findBySelector(nodeSelector);\n            if (proxyNode) return proxyNode;\n        }\n        return el;\n    },\n\n    // Construct a unique selector for the `el` element within this view.\n    // `prevSelector` is being collected through the recursive call.\n    // No value for `prevSelector` is expected when using this method.\n    getSelector: function(el, prevSelector) {\n\n        var selector;\n\n        if (el === this.el) {\n            if (typeof prevSelector === 'string') selector = '> ' + prevSelector;\n            return selector;\n        }\n\n        if (el) {\n\n            var nthChild = V(el).index() + 1;\n            selector = el.tagName + ':nth-child(' + nthChild + ')';\n\n            if (prevSelector) {\n                selector += ' > ' + prevSelector;\n            }\n\n            selector = this.getSelector(el.parentNode, selector);\n        }\n\n        return selector;\n    },\n\n    addLinkFromMagnet: function(magnet, x, y) {\n\n        var paper = this.paper;\n        var graph = paper.model;\n\n        var link = paper.getDefaultLink(this, magnet);\n        link.set({\n            source: this.getLinkEnd(magnet, x, y, link, 'source'),\n            target: { x: x, y: y }\n        }).addTo(graph, {\n            async: false,\n            ui: true\n        });\n\n        return link.findView(paper);\n    },\n\n    getLinkEnd: function(magnet, ...args) {\n\n        var model = this.model;\n        var id = model.id;\n        var port = this.findAttribute('port', magnet);\n        // Find a unique `selector` of the element under pointer that is a magnet.\n        var selector = magnet.getAttribute('joint-selector');\n\n        var end = { id: id };\n        if (selector != null) end.magnet = selector;\n        if (port != null) {\n            end.port = port;\n            if (!model.hasPort(port) && !selector) {\n                // port created via the `port` attribute (not API)\n                end.selector = this.getSelector(magnet);\n            }\n        } else if (selector == null && this.el !== magnet) {\n            end.selector = this.getSelector(magnet);\n        }\n\n        return this.customizeLinkEnd(end, magnet, ...args);\n    },\n\n    customizeLinkEnd: function(end, magnet, x, y, link, endType) {\n        const { paper } = this;\n        const { connectionStrategy } = paper.options;\n        if (typeof connectionStrategy === 'function') {\n            var strategy = connectionStrategy.call(paper, end, this, magnet, new Point(x, y), link, endType, paper);\n            if (strategy) return strategy;\n        }\n        return end;\n    },\n\n    getMagnetFromLinkEnd: function(end) {\n\n        var root = this.el;\n        var port = end.port;\n        var selector = end.magnet;\n        var model = this.model;\n        var magnet;\n        if (port != null && model.isElement() && model.hasPort(port)) {\n            magnet = this.findPortNode(port, selector) || root;\n        } else {\n            if (!selector) selector = end.selector;\n            if (!selector && port != null) {\n                // link end has only `id` and `port` property referencing\n                // a port created via the `port` attribute (not API).\n                selector = '[port=\"' + port + '\"]';\n            }\n            magnet = this.findBySelector(selector, root, this.selectors)[0];\n        }\n\n        return this.findProxyNode(magnet, 'magnet');\n    },\n\n    dragLinkStart: function(evt, magnet, x, y) {\n        this.model.startBatch('add-link');\n        const linkView = this.addLinkFromMagnet(magnet, x, y);\n        // backwards compatibility events\n        linkView.notifyPointerdown(evt, x, y);\n        linkView.eventData(evt, linkView.startArrowheadMove('target', { whenNotAllowed: 'remove' }));\n        this.eventData(evt, { linkView });\n    },\n\n    dragLink: function(evt, x, y) {\n        var data = this.eventData(evt);\n        var linkView = data.linkView;\n        if (linkView) {\n            linkView.pointermove(evt, x, y);\n        } else {\n            var paper = this.paper;\n            var magnetThreshold = paper.options.magnetThreshold;\n            var currentTarget = this.getEventTarget(evt);\n            var targetMagnet = data.targetMagnet;\n            if (magnetThreshold === 'onleave') {\n                // magnetThreshold when the pointer leaves the magnet\n                if (targetMagnet === currentTarget || V(targetMagnet).contains(currentTarget)) return;\n            } else {\n                // magnetThreshold defined as a number of movements\n                if (paper.eventData(evt).mousemoved <= magnetThreshold) return;\n            }\n            this.dragLinkStart(evt, targetMagnet, x, y);\n        }\n    },\n\n    dragLinkEnd: function(evt, x, y) {\n        var data = this.eventData(evt);\n        var linkView = data.linkView;\n        if (!linkView) return;\n        linkView.pointerup(evt, x, y);\n        this.model.stopBatch('add-link');\n    },\n\n    getAttributeDefinition: function(attrName) {\n\n        return this.model.constructor.getAttributeDefinition(attrName);\n    },\n\n    setNodeAttributes: function(node, attrs) {\n\n        if (!isEmpty(attrs)) {\n            if (node instanceof SVGElement) {\n                V(node).attr(attrs);\n            } else {\n                $(node).attr(attrs);\n            }\n        }\n    },\n\n    processNodeAttributes: function(node, attrs) {\n\n        var attrName, attrVal, def, i, n;\n        var normalAttrs, setAttrs, positionAttrs, offsetAttrs;\n        var relatives = [];\n        // divide the attributes between normal and special\n        for (attrName in attrs) {\n            if (!attrs.hasOwnProperty(attrName)) continue;\n            attrVal = attrs[attrName];\n            def = this.getAttributeDefinition(attrName);\n            if (def && (!isFunction(def.qualify) || def.qualify.call(this, attrVal, node, attrs, this))) {\n                if (isString(def.set)) {\n                    normalAttrs || (normalAttrs = {});\n                    normalAttrs[def.set] = attrVal;\n                }\n                if (attrVal !== null) {\n                    relatives.push(attrName, def);\n                }\n            } else {\n                normalAttrs || (normalAttrs = {});\n                normalAttrs[toKebabCase(attrName)] = attrVal;\n            }\n        }\n\n        // handle the rest of attributes via related method\n        // from the special attributes namespace.\n        for (i = 0, n = relatives.length; i < n; i+=2) {\n            attrName = relatives[i];\n            def = relatives[i+1];\n            attrVal = attrs[attrName];\n            if (isFunction(def.set)) {\n                setAttrs || (setAttrs = {});\n                setAttrs[attrName] = attrVal;\n            }\n            if (isFunction(def.position)) {\n                positionAttrs || (positionAttrs = {});\n                positionAttrs[attrName] = attrVal;\n            }\n            if (isFunction(def.offset)) {\n                offsetAttrs || (offsetAttrs = {});\n                offsetAttrs[attrName] = attrVal;\n            }\n        }\n\n        return {\n            raw: attrs,\n            normal: normalAttrs,\n            set: setAttrs,\n            position: positionAttrs,\n            offset: offsetAttrs\n        };\n    },\n\n    updateRelativeAttributes: function(node, attrs, refBBox, opt) {\n\n        opt || (opt = {});\n\n        var attrName, attrVal, def;\n        var rawAttrs = attrs.raw || {};\n        var nodeAttrs = attrs.normal || {};\n        var setAttrs = attrs.set;\n        var positionAttrs = attrs.position;\n        var offsetAttrs = attrs.offset;\n\n        for (attrName in setAttrs) {\n            attrVal = setAttrs[attrName];\n            def = this.getAttributeDefinition(attrName);\n            // SET - set function should return attributes to be set on the node,\n            // which will affect the node dimensions based on the reference bounding\n            // box. e.g. `width`, `height`, `d`, `rx`, `ry`, `points\n            var setResult = def.set.call(this, attrVal, refBBox.clone(), node, rawAttrs, this);\n            if (isObject(setResult)) {\n                assign(nodeAttrs, setResult);\n            } else if (setResult !== undefined) {\n                nodeAttrs[attrName] = setResult;\n            }\n        }\n\n        if (node instanceof HTMLElement) {\n            // TODO: setting the `transform` attribute on HTMLElements\n            // via `node.style.transform = 'matrix(...)';` would introduce\n            // a breaking change (e.g. basic.TextBlock).\n            this.setNodeAttributes(node, nodeAttrs);\n            return;\n        }\n\n        // The final translation of the subelement.\n        var nodeTransform = nodeAttrs.transform;\n        var nodeMatrix = V.transformStringToMatrix(nodeTransform);\n        var nodePosition = Point(nodeMatrix.e, nodeMatrix.f);\n        if (nodeTransform) {\n            nodeAttrs = omit(nodeAttrs, 'transform');\n            nodeMatrix.e = nodeMatrix.f = 0;\n        }\n\n        // Calculate node scale determined by the scalable group\n        // only if later needed.\n        var sx, sy, translation;\n        if (positionAttrs || offsetAttrs) {\n            var nodeScale = this.getNodeScale(node, opt.scalableNode);\n            sx = nodeScale.sx;\n            sy = nodeScale.sy;\n        }\n\n        var positioned = false;\n        for (attrName in positionAttrs) {\n            attrVal = positionAttrs[attrName];\n            def = this.getAttributeDefinition(attrName);\n            // POSITION - position function should return a point from the\n            // reference bounding box. The default position of the node is x:0, y:0 of\n            // the reference bounding box or could be further specify by some\n            // SVG attributes e.g. `x`, `y`\n            translation = def.position.call(this, attrVal, refBBox.clone(), node, rawAttrs, this);\n            if (translation) {\n                nodePosition.offset(Point(translation).scale(sx, sy));\n                positioned || (positioned = true);\n            }\n        }\n\n        // The node bounding box could depend on the `size` set from the previous loop.\n        // Here we know, that all the size attributes have been already set.\n        this.setNodeAttributes(node, nodeAttrs);\n\n        var offseted = false;\n        if (offsetAttrs) {\n            // Check if the node is visible\n            var nodeBoundingRect = this.getNodeBoundingRect(node);\n            if (nodeBoundingRect.width > 0 && nodeBoundingRect.height > 0) {\n                var nodeBBox = V.transformRect(nodeBoundingRect, nodeMatrix).scale(1 / sx, 1 / sy);\n                for (attrName in offsetAttrs) {\n                    attrVal = offsetAttrs[attrName];\n                    def = this.getAttributeDefinition(attrName);\n                    // OFFSET - offset function should return a point from the element\n                    // bounding box. The default offset point is x:0, y:0 (origin) or could be further\n                    // specify with some SVG attributes e.g. `text-anchor`, `cx`, `cy`\n                    translation = def.offset.call(this, attrVal, nodeBBox, node, rawAttrs, this);\n                    if (translation) {\n                        nodePosition.offset(Point(translation).scale(sx, sy));\n                        offseted || (offseted = true);\n                    }\n                }\n            }\n        }\n\n        // Do not touch node's transform attribute if there is no transformation applied.\n        if (nodeTransform !== undefined || positioned || offseted) {\n            // Round the coordinates to 1 decimal point.\n            nodePosition.round(1);\n            nodeMatrix.e = nodePosition.x;\n            nodeMatrix.f = nodePosition.y;\n            node.setAttribute('transform', V.matrixToTransformString(nodeMatrix));\n            // TODO: store nodeMatrix metrics?\n        }\n    },\n\n    getNodeScale: function(node, scalableNode) {\n\n        // Check if the node is a descendant of the scalable group.\n        var sx, sy;\n        if (scalableNode && scalableNode.contains(node)) {\n            var scale = scalableNode.scale();\n            sx = 1 / scale.sx;\n            sy = 1 / scale.sy;\n        } else {\n            sx = 1;\n            sy = 1;\n        }\n\n        return { sx: sx, sy: sy };\n    },\n\n    cleanNodesCache: function() {\n        this.metrics = {};\n    },\n\n    nodeCache: function(magnet) {\n\n        var metrics = this.metrics;\n        // Don't use cache? It most likely a custom view with overridden update.\n        if (!metrics) return {};\n        var id = V.ensureId(magnet);\n        var value = metrics[id];\n        if (!value) value = metrics[id] = {};\n        return value;\n    },\n\n    getNodeData: function(magnet) {\n\n        var metrics = this.nodeCache(magnet);\n        if (!metrics.data) metrics.data = {};\n        return metrics.data;\n    },\n\n    getNodeBoundingRect: function(magnet) {\n\n        var metrics = this.nodeCache(magnet);\n        if (metrics.boundingRect === undefined) metrics.boundingRect = V(magnet).getBBox();\n        return new Rect(metrics.boundingRect);\n    },\n\n    getNodeMatrix: function(magnet) {\n\n        const metrics = this.nodeCache(magnet);\n        if (metrics.magnetMatrix === undefined) {\n            const { rotatableNode, el } = this;\n            let target;\n            if (rotatableNode && rotatableNode.contains(magnet)) {\n                target = rotatableNode;\n            } else {\n                target = el;\n            }\n            metrics.magnetMatrix = V(magnet).getTransformToElement(target);\n        }\n        return V.createSVGMatrix(metrics.magnetMatrix);\n    },\n\n    getNodeShape: function(magnet) {\n\n        var metrics = this.nodeCache(magnet);\n        if (metrics.geometryShape === undefined) metrics.geometryShape = V(magnet).toGeometryShape();\n        return metrics.geometryShape.clone();\n    },\n\n    isNodeConnection: function(node) {\n        return this.model.isLink() && (!node || node === this.el);\n    },\n\n    findNodesAttributes: function(attrs, root, selectorCache, selectors) {\n\n        var i, n, nodeAttrs, nodeId;\n        var nodesAttrs = {};\n        var mergeIds = [];\n        for (var selector in attrs) {\n            if (!attrs.hasOwnProperty(selector)) continue;\n            nodeAttrs = attrs[selector];\n            if (!isPlainObject(nodeAttrs)) continue; // Not a valid selector-attributes pair\n            var selected = selectorCache[selector] = this.findBySelector(selector, root, selectors);\n            for (i = 0, n = selected.length; i < n; i++) {\n                var node = selected[i];\n                nodeId = V.ensureId(node);\n                // \"unique\" selectors are selectors that referencing a single node (defined by `selector`)\n                // groupSelector referencing a single node is not \"unique\"\n                var unique = (selectors && selectors[selector] === node);\n                var prevNodeAttrs = nodesAttrs[nodeId];\n                if (prevNodeAttrs) {\n                    // Note, that nodes referenced by deprecated `CSS selectors` are not taken into account.\n                    // e.g. css:`.circle` and selector:`circle` can be applied in a random order\n                    if (!prevNodeAttrs.array) {\n                        mergeIds.push(nodeId);\n                        prevNodeAttrs.array = true;\n                        prevNodeAttrs.attributes = [prevNodeAttrs.attributes];\n                        prevNodeAttrs.selectedLength = [prevNodeAttrs.selectedLength];\n                    }\n                    var attributes = prevNodeAttrs.attributes;\n                    var selectedLength = prevNodeAttrs.selectedLength;\n                    if (unique) {\n                        // node referenced by `selector`\n                        attributes.unshift(nodeAttrs);\n                        selectedLength.unshift(-1);\n                    } else {\n                        // node referenced by `groupSelector`\n                        var sortIndex = sortedIndex(selectedLength, n);\n                        attributes.splice(sortIndex, 0, nodeAttrs);\n                        selectedLength.splice(sortIndex, 0, n);\n                    }\n                } else {\n                    nodesAttrs[nodeId] = {\n                        attributes: nodeAttrs,\n                        selectedLength: unique ? -1 : n,\n                        node: node,\n                        array: false\n                    };\n                }\n            }\n        }\n\n        for (i = 0, n = mergeIds.length; i < n; i++) {\n            nodeId = mergeIds[i];\n            nodeAttrs = nodesAttrs[nodeId];\n            nodeAttrs.attributes = merge({}, ...nodeAttrs.attributes.reverse());\n        }\n\n        return nodesAttrs;\n    },\n\n    getEventTarget: function(evt, opt = {}) {\n        const { target, type, clientX = 0, clientY = 0 } = evt;\n        if (\n            // Explicitly defined `fromPoint` option\n            opt.fromPoint ||\n            // Touchmove/Touchend event's target is not reflecting the element under the coordinates as mousemove does.\n            // It holds the element when a touchstart triggered.\n            type === 'touchmove' || type === 'touchend' ||\n            // Pointermove/Pointerup event with the pointer captured\n            ('pointerId' in evt && target.hasPointerCapture(evt.pointerId))\n        ) {\n            return document.elementFromPoint(clientX, clientY);\n        }\n\n        return target;\n    },\n\n    // Default is to process the `model.attributes.attrs` object and set attributes on subelements based on the selectors,\n    // unless `attrs` parameter was passed.\n    updateDOMSubtreeAttributes: function(rootNode, attrs, opt) {\n\n        opt || (opt = {});\n        opt.rootBBox || (opt.rootBBox = Rect());\n        opt.selectors || (opt.selectors = this.selectors); // selector collection to use\n\n        // Cache table for query results and bounding box calculation.\n        // Note that `selectorCache` needs to be invalidated for all\n        // `updateAttributes` calls, as the selectors might pointing\n        // to nodes designated by an attribute or elements dynamically\n        // created.\n        var selectorCache = {};\n        var bboxCache = {};\n        var relativeItems = [];\n        var relativeRefItems = [];\n        var item, node, nodeAttrs, nodeData, processedAttrs;\n\n        var roAttrs = opt.roAttributes;\n        var nodesAttrs = this.findNodesAttributes(roAttrs || attrs, rootNode, selectorCache, opt.selectors);\n        // `nodesAttrs` are different from all attributes, when\n        // rendering only  attributes sent to this method.\n        var nodesAllAttrs = (roAttrs)\n            ? this.findNodesAttributes(attrs, rootNode, selectorCache, opt.selectors)\n            : nodesAttrs;\n\n        for (var nodeId in nodesAttrs) {\n            nodeData = nodesAttrs[nodeId];\n            nodeAttrs = nodeData.attributes;\n            node = nodeData.node;\n            processedAttrs = this.processNodeAttributes(node, nodeAttrs);\n\n            if (!processedAttrs.set && !processedAttrs.position && !processedAttrs.offset) {\n                // Set all the normal attributes right on the SVG/HTML element.\n                this.setNodeAttributes(node, processedAttrs.normal);\n\n            } else {\n\n                var nodeAllAttrs = nodesAllAttrs[nodeId] && nodesAllAttrs[nodeId].attributes;\n                var refSelector = (nodeAllAttrs && (nodeAttrs.ref === undefined))\n                    ? nodeAllAttrs.ref\n                    : nodeAttrs.ref;\n\n                var refNode;\n                if (refSelector) {\n                    refNode = (selectorCache[refSelector] || this.findBySelector(refSelector, rootNode, opt.selectors))[0];\n                    if (!refNode) {\n                        throw new Error('dia.CellView: \"' + refSelector + '\" reference does not exist.');\n                    }\n                } else {\n                    refNode = null;\n                }\n\n                item = {\n                    node: node,\n                    refNode: refNode,\n                    processedAttributes: processedAttrs,\n                    allAttributes: nodeAllAttrs\n                };\n\n                if (refNode) {\n                    // If an element in the list is positioned relative to this one, then\n                    // we want to insert this one before it in the list.\n                    var itemIndex = relativeRefItems.findIndex(function(item) {\n                        return item.refNode === node;\n                    });\n\n                    if (itemIndex > -1) {\n                        relativeRefItems.splice(itemIndex, 0, item);\n                    } else {\n                        relativeRefItems.push(item);\n                    }\n                } else {\n                    // A node with no ref attribute. To be updated before the nodes referencing other nodes.\n                    // The order of no-ref-items is not specified/important.\n                    relativeItems.push(item);\n                }\n            }\n        }\n\n        relativeItems.push(...relativeRefItems);\n\n        for (let i = 0, n = relativeItems.length; i < n; i++) {\n            item = relativeItems[i];\n            node = item.node;\n            refNode = item.refNode;\n\n            // Find the reference element bounding box. If no reference was provided, we\n            // use the optional bounding box.\n            const refNodeId = refNode ? V.ensureId(refNode) : '';\n            let refBBox = bboxCache[refNodeId];\n            if (!refBBox) {\n                // Get the bounding box of the reference element using to the common ancestor\n                // transformation space.\n                //\n                // @example 1\n                // <g transform=\"translate(11, 13)\">\n                //     <rect @selector=\"b\" x=\"1\" y=\"2\" width=\"3\" height=\"4\"/>\n                //     <rect @selector=\"a\"/>\n                // </g>\n                //\n                // In this case, the reference bounding box can not be affected\n                // by the `transform` attribute of the `<g>` element,\n                // because the exact transformation will be applied to the `a` element\n                // as well as to the `b` element.\n                //\n                // @example 2\n                // <g transform=\"translate(11, 13)\">\n                //     <rect @selector=\"b\" x=\"1\" y=\"2\" width=\"3\" height=\"4\"/>\n                // </g>\n                // <rect @selector=\"a\"/>\n                //\n                // In this case, the reference bounding box have to be affected by the\n                // `transform` attribute of the `<g>` element, because the `a` element\n                // is not descendant of the `<g>` element and will not be affected\n                // by the transformation.\n                refBBox = bboxCache[refNodeId] = (refNode)\n                    ? V(refNode).getBBox({ target: getCommonAncestorNode(node, refNode) })\n                    : opt.rootBBox;\n            }\n\n            if (roAttrs) {\n                // if there was a special attribute affecting the position amongst passed-in attributes\n                // we have to merge it with the rest of the element's attributes as they are necessary\n                // to update the position relatively (i.e `ref-x` && 'ref-dx')\n                processedAttrs = this.processNodeAttributes(node, item.allAttributes);\n                this.mergeProcessedAttributes(processedAttrs, item.processedAttributes);\n\n            } else {\n                processedAttrs = item.processedAttributes;\n            }\n\n            this.updateRelativeAttributes(node, processedAttrs, refBBox, opt);\n        }\n    },\n\n    mergeProcessedAttributes: function(processedAttrs, roProcessedAttrs) {\n\n        processedAttrs.set || (processedAttrs.set = {});\n        processedAttrs.position || (processedAttrs.position = {});\n        processedAttrs.offset || (processedAttrs.offset = {});\n\n        assign(processedAttrs.set, roProcessedAttrs.set);\n        assign(processedAttrs.position, roProcessedAttrs.position);\n        assign(processedAttrs.offset, roProcessedAttrs.offset);\n\n        // Handle also the special transform property.\n        var transform = processedAttrs.normal && processedAttrs.normal.transform;\n        if (transform !== undefined && roProcessedAttrs.normal) {\n            roProcessedAttrs.normal.transform = transform;\n        }\n        processedAttrs.normal = roProcessedAttrs.normal;\n    },\n\n    // Lifecycle methods\n\n    // Called when the view is attached to the DOM,\n    // as result of `cell.addTo(graph)` being called (isInitialMount === true)\n    // or `paper.options.viewport` returning `true` (isInitialMount === false).\n    onMount(isInitialMount) {\n        if (isInitialMount) return;\n        this.mountTools();\n        HighlighterView.mount(this);\n    },\n\n    // Called when the view is detached from the DOM,\n    // as result of `paper.options.viewport` returning `false`.\n    onDetach() {\n        this.unmountTools();\n        HighlighterView.unmount(this);\n    },\n\n    // Called when the view is removed from the DOM\n    // as result of `cell.remove()`.\n    onRemove: function() {\n        this.removeTools();\n        this.removeHighlighters();\n    },\n\n    _toolsView: null,\n\n    hasTools: function(name) {\n        var toolsView = this._toolsView;\n        if (!toolsView) return false;\n        if (!name) return true;\n        return (toolsView.getName() === name);\n    },\n\n    addTools: function(toolsView) {\n\n        this.removeTools();\n\n        if (toolsView) {\n            this._toolsView = toolsView;\n            toolsView.configure({ relatedView: this });\n            toolsView.listenTo(this.paper, 'tools:event', this.onToolEvent.bind(this));\n        }\n        return this;\n    },\n\n    unmountTools() {\n        const toolsView = this._toolsView;\n        if (toolsView) toolsView.unmount();\n        return this;\n    },\n\n    mountTools() {\n        const toolsView = this._toolsView;\n        // Prevent unnecessary re-appending of the tools.\n        if (toolsView && !toolsView.isMounted()) toolsView.mount();\n        return this;\n    },\n\n    updateTools: function(opt) {\n\n        var toolsView = this._toolsView;\n        if (toolsView) toolsView.update(opt);\n        return this;\n    },\n\n    removeTools: function() {\n\n        var toolsView = this._toolsView;\n        if (toolsView) {\n            toolsView.remove();\n            this._toolsView = null;\n        }\n        return this;\n    },\n\n    hideTools: function() {\n\n        var toolsView = this._toolsView;\n        if (toolsView) toolsView.hide();\n        return this;\n    },\n\n    showTools: function() {\n\n        var toolsView = this._toolsView;\n        if (toolsView) toolsView.show();\n        return this;\n    },\n\n    onToolEvent: function(event) {\n        switch (event) {\n            case 'remove':\n                this.removeTools();\n                break;\n            case 'hide':\n                this.hideTools();\n                break;\n            case 'show':\n                this.showTools();\n                break;\n        }\n    },\n\n    removeHighlighters: function() {\n        HighlighterView.remove(this);\n    },\n\n    updateHighlighters: function(dirty = false) {\n        HighlighterView.update(this, null, dirty);\n    },\n\n    transformHighlighters: function() {\n        HighlighterView.transform(this);\n    },\n\n    // Interaction. The controller part.\n    // ---------------------------------\n\n    preventDefaultInteraction(evt) {\n        this.eventData(evt, { defaultInteractionPrevented: true  });\n    },\n\n    isDefaultInteractionPrevented(evt) {\n        const { defaultInteractionPrevented = false } = this.eventData(evt);\n        return defaultInteractionPrevented;\n    },\n\n    // Interaction is handled by the paper and delegated to the view in interest.\n    // `x` & `y` parameters passed to these functions represent the coordinates already snapped to the paper grid.\n    // If necessary, real coordinates can be obtained from the `evt` event object.\n\n    // These functions are supposed to be overridden by the views that inherit from `joint.dia.Cell`,\n    // i.e. `joint.dia.Element` and `joint.dia.Link`.\n\n    pointerdblclick: function(evt, x, y) {\n\n        this.notify('cell:pointerdblclick', evt, x, y);\n    },\n\n    pointerclick: function(evt, x, y) {\n\n        this.notify('cell:pointerclick', evt, x, y);\n    },\n\n    contextmenu: function(evt, x, y) {\n\n        this.notify('cell:contextmenu', evt, x, y);\n    },\n\n    pointerdown: function(evt, x, y) {\n\n        const { model } = this;\n        const { graph } = model;\n        if (graph) {\n            model.startBatch('pointer');\n            this.eventData(evt, { graph });\n        }\n\n        this.notify('cell:pointerdown', evt, x, y);\n    },\n\n    pointermove: function(evt, x, y) {\n\n        this.notify('cell:pointermove', evt, x, y);\n    },\n\n    pointerup: function(evt, x, y) {\n\n        const { graph } = this.eventData(evt);\n\n        this.notify('cell:pointerup', evt, x, y);\n\n        if (graph) {\n            // we don't want to trigger event on model as model doesn't\n            // need to be member of collection anymore (remove)\n            graph.stopBatch('pointer', { cell: this.model });\n        }\n    },\n\n    mouseover: function(evt) {\n\n        this.notify('cell:mouseover', evt);\n    },\n\n    mouseout: function(evt) {\n\n        this.notify('cell:mouseout', evt);\n    },\n\n    mouseenter: function(evt) {\n\n        this.notify('cell:mouseenter', evt);\n    },\n\n    mouseleave: function(evt) {\n\n        this.notify('cell:mouseleave', evt);\n    },\n\n    mousewheel: function(evt, x, y, delta) {\n\n        this.notify('cell:mousewheel', evt, x, y, delta);\n    },\n\n    onevent: function(evt, eventName, x, y) {\n\n        this.notify(eventName, evt, x, y);\n    },\n\n    onmagnet: function() {\n\n        // noop\n    },\n\n    magnetpointerdblclick: function() {\n\n        // noop\n    },\n\n    magnetcontextmenu: function() {\n\n        // noop\n    },\n\n    checkMouseleave(evt) {\n        const { paper, model } = this;\n        if (paper.isAsync()) {\n            // Make sure the source/target views are updated before this view.\n            // It's not 100% bulletproof (see below) but it's a good enough solution for now.\n            // The connected cells could be links as well. In that case, we would\n            // need to recursively go through all the connected links and update\n            // their source/target views as well.\n            if (model.isLink()) {\n                // The `this.sourceView` and `this.targetView` might not be updated yet.\n                // We need to find the view by the model.\n                const sourceElement = model.getSourceElement();\n                if (sourceElement) {\n                    const sourceView = paper.findViewByModel(sourceElement);\n                    if (sourceView) {\n                        paper.dumpView(sourceView);\n                        paper.checkViewVisibility(sourceView);\n                    }\n                }\n                const targetElement = model.getTargetElement();\n                if (targetElement) {\n                    const targetView = paper.findViewByModel(targetElement);\n                    if (targetView) {\n                        paper.dumpView(targetView);\n                        paper.checkViewVisibility(targetView);\n                    }\n                }\n            }\n            // Do the updates of the current view synchronously now\n            paper.dumpView(this);\n            paper.checkViewVisibility(this);\n        }\n        const target = this.getEventTarget(evt, { fromPoint: true });\n        const view = paper.findView(target);\n        if (view === this) return;\n        // Leaving the current view\n        this.mouseleave(evt);\n        if (!view) return;\n        // Entering another view\n        view.mouseenter(evt);\n    },\n\n    setInteractivity: function(value) {\n\n        this.options.interactive = value;\n    }\n}, {\n\n    Flags,\n\n    Highlighting: HighlightingTypes,\n\n    addPresentationAttributes: function(presentationAttributes) {\n        return merge({}, result(this.prototype, 'presentationAttributes'), presentationAttributes, function(a, b) {\n            if (!a || !b) return;\n            if (typeof a === 'string') a = [a];\n            if (typeof b === 'string') b = [b];\n            if (Array.isArray(a) && Array.isArray(b)) return uniq(a.concat(b));\n        });\n    }\n});\n\n// TODO: Move to Vectorizer library.\nfunction getCommonAncestorNode(node1, node2) {\n    let parent = node1;\n    do {\n        if (parent.contains(node2)) return parent;\n        parent = parent.parentNode;\n    } while (parent);\n    return null;\n}\n\n","import { config } from '../config/index.mjs';\nimport { assign, isFunction, toArray } from '../util/index.mjs';\nimport { CellView } from './CellView.mjs';\nimport { Cell } from './Cell.mjs';\nimport V from '../V/index.mjs';\nimport { elementViewPortPrototype } from './ports.mjs';\nimport { Rect, snapToGrid } from '../g/index.mjs';\n\nconst Flags = {\n    TOOLS: CellView.Flags.TOOLS,\n    UPDATE: 'UPDATE',\n    TRANSLATE: 'TRANSLATE',\n    RESIZE: 'RESIZE',\n    PORTS: 'PORTS',\n    ROTATE: 'ROTATE',\n    RENDER: 'RENDER'\n};\n\nconst DragActions = {\n    MOVE: 'move',\n    MAGNET: 'magnet',\n};\n// Element base view and controller.\n// -------------------------------------------\n\nexport const ElementView = CellView.extend({\n\n    /**\n     * @abstract\n     */\n    _removePorts: function() {\n        // implemented in ports.js\n    },\n\n    /**\n     *\n     * @abstract\n     */\n    _renderPorts: function() {\n        // implemented in ports.js\n    },\n\n    className: function() {\n\n        var classNames = CellView.prototype.className.apply(this).split(' ');\n\n        classNames.push('element');\n\n        return classNames.join(' ');\n    },\n\n    initialize: function() {\n\n        CellView.prototype.initialize.apply(this, arguments);\n\n        this._initializePorts();\n    },\n\n    presentationAttributes: {\n        'attrs': [Flags.UPDATE],\n        'position': [Flags.TRANSLATE, Flags.TOOLS],\n        'size': [Flags.RESIZE, Flags.PORTS, Flags.TOOLS],\n        'angle': [Flags.ROTATE, Flags.TOOLS],\n        'markup': [Flags.RENDER],\n        'ports': [Flags.PORTS],\n    },\n\n    initFlag: [Flags.RENDER],\n\n    UPDATE_PRIORITY: 0,\n\n    confirmUpdate: function(flag, opt) {\n\n        const { useCSSSelectors } = config;\n        if (this.hasFlag(flag, Flags.PORTS)) {\n            this._removePorts();\n            this._cleanPortsCache();\n        }\n        let transformHighlighters = false;\n        if (this.hasFlag(flag, Flags.RENDER)) {\n            this.render();\n            this.updateTools(opt);\n            this.updateHighlighters(true);\n            transformHighlighters = true;\n            flag = this.removeFlag(flag, [Flags.RENDER, Flags.UPDATE, Flags.RESIZE, Flags.TRANSLATE, Flags.ROTATE, Flags.PORTS, Flags.TOOLS]);\n        } else {\n            let updateHighlighters = false;\n\n            // Skip this branch if render is required\n            if (this.hasFlag(flag, Flags.RESIZE)) {\n                this.resize(opt);\n                updateHighlighters = true;\n                // Resize method is calling `update()` internally\n                flag = this.removeFlag(flag, [Flags.RESIZE, Flags.UPDATE]);\n                if (useCSSSelectors) {\n                    // `resize()` rendered the ports when useCSSSelectors are enabled\n                    flag = this.removeFlag(flag, Flags.PORTS);\n                }\n            }\n            if (this.hasFlag(flag, Flags.UPDATE)) {\n                this.update(this.model, null, opt);\n                flag = this.removeFlag(flag, Flags.UPDATE);\n                updateHighlighters = true;\n                if (useCSSSelectors) {\n                    // `update()` will render ports when useCSSSelectors are enabled\n                    flag = this.removeFlag(flag, Flags.PORTS);\n                }\n            }\n            if (this.hasFlag(flag, Flags.TRANSLATE)) {\n                this.translate();\n                flag = this.removeFlag(flag, Flags.TRANSLATE);\n                transformHighlighters = true;\n            }\n            if (this.hasFlag(flag, Flags.ROTATE)) {\n                this.rotate();\n                flag = this.removeFlag(flag, Flags.ROTATE);\n                transformHighlighters = true;\n            }\n            if (this.hasFlag(flag, Flags.PORTS)) {\n                this._renderPorts();\n                updateHighlighters = true;\n                flag = this.removeFlag(flag, Flags.PORTS);\n            }\n\n            if (updateHighlighters) {\n                this.updateHighlighters(false);\n            }\n        }\n\n        if (transformHighlighters) {\n            this.transformHighlighters();\n        }\n\n        if (this.hasFlag(flag, Flags.TOOLS)) {\n            this.updateTools(opt);\n            flag = this.removeFlag(flag, Flags.TOOLS);\n        }\n\n        return flag;\n    },\n\n    /**\n     * @abstract\n     */\n    _initializePorts: function() {\n\n    },\n\n    update: function(_, renderingOnlyAttrs) {\n\n        this.cleanNodesCache();\n\n        // When CSS selector strings are used, make sure no rule matches port nodes.\n        const { useCSSSelectors } = config;\n        if (useCSSSelectors) this._removePorts();\n\n        var model = this.model;\n        var modelAttrs = model.attr();\n        this.updateDOMSubtreeAttributes(this.el, modelAttrs, {\n            rootBBox: new Rect(model.size()),\n            selectors: this.selectors,\n            scalableNode: this.scalableNode,\n            rotatableNode: this.rotatableNode,\n            // Use rendering only attributes if they differs from the model attributes\n            roAttributes: (renderingOnlyAttrs === modelAttrs) ? null : renderingOnlyAttrs\n        });\n\n        if (useCSSSelectors) {\n            this._renderPorts();\n        }\n    },\n\n    rotatableSelector: 'rotatable',\n    scalableSelector: 'scalable',\n    scalableNode: null,\n    rotatableNode: null,\n\n    // `prototype.markup` is rendered by default. Set the `markup` attribute on the model if the\n    // default markup is not desirable.\n    renderMarkup: function() {\n\n        var element = this.model;\n        var markup = element.get('markup') || element.markup;\n        if (!markup) throw new Error('dia.ElementView: markup required');\n        if (Array.isArray(markup)) return this.renderJSONMarkup(markup);\n        if (typeof markup === 'string') return this.renderStringMarkup(markup);\n        throw new Error('dia.ElementView: invalid markup');\n    },\n\n    renderJSONMarkup: function(markup) {\n\n        var doc = this.parseDOMJSON(markup, this.el);\n        var selectors = this.selectors = doc.selectors;\n        this.rotatableNode = V(selectors[this.rotatableSelector]) || null;\n        this.scalableNode = V(selectors[this.scalableSelector]) || null;\n        // Fragment\n        this.vel.append(doc.fragment);\n    },\n\n    renderStringMarkup: function(markup) {\n\n        var vel = this.vel;\n        vel.append(V(markup));\n        // Cache transformation groups\n        this.rotatableNode = vel.findOne('.rotatable');\n        this.scalableNode = vel.findOne('.scalable');\n\n        var selectors = this.selectors = {};\n        selectors[this.selector] = this.el;\n    },\n\n    render: function() {\n\n        this.vel.empty();\n        this.renderMarkup();\n        if (this.scalableNode) {\n            // Double update is necessary for elements with the scalable group only\n            // Note the resize() triggers the other `update`.\n            this.update();\n        }\n        this.resize();\n        if (this.rotatableNode) {\n            // Translate transformation is applied on `this.el` while the rotation transformation\n            // on `this.rotatableNode`\n            this.rotate();\n            this.translate();\n        } else {\n            this.updateTransformation();\n        }\n        if (!config.useCSSSelectors) this._renderPorts();\n        return this;\n    },\n\n    resize: function(opt) {\n\n        if (this.scalableNode) return this.sgResize(opt);\n        if (this.model.attributes.angle) this.rotate();\n        this.update();\n    },\n\n    translate: function() {\n\n        if (this.rotatableNode) return this.rgTranslate();\n        this.updateTransformation();\n    },\n\n    rotate: function() {\n\n        if (this.rotatableNode) {\n            this.rgRotate();\n            // It's necessary to call the update for the nodes outside\n            // the rotatable group referencing nodes inside the group\n            this.update();\n            return;\n        }\n        this.updateTransformation();\n    },\n\n    updateTransformation: function() {\n\n        var transformation = this.getTranslateString();\n        var rotateString = this.getRotateString();\n        if (rotateString) transformation += ' ' + rotateString;\n        this.vel.attr('transform', transformation);\n    },\n\n    getTranslateString: function() {\n\n        var position = this.model.attributes.position;\n        return 'translate(' + position.x + ',' + position.y + ')';\n    },\n\n    getRotateString: function() {\n        var attributes = this.model.attributes;\n        var angle = attributes.angle;\n        if (!angle) return null;\n        var size = attributes.size;\n        return 'rotate(' + angle + ',' + (size.width / 2) + ',' + (size.height / 2) + ')';\n    },\n\n    // Rotatable & Scalable Group\n    // always slower, kept mainly for backwards compatibility\n\n    rgRotate: function() {\n\n        this.rotatableNode.attr('transform', this.getRotateString());\n    },\n\n    rgTranslate: function() {\n\n        this.vel.attr('transform', this.getTranslateString());\n    },\n\n    sgResize: function(opt) {\n\n        var model = this.model;\n        var angle = model.angle();\n        var size = model.size();\n        var scalable = this.scalableNode;\n\n        // Getting scalable group's bbox.\n        // Due to a bug in webkit's native SVG .getBBox implementation, the bbox of groups with path children includes the paths' control points.\n        // To work around the issue, we need to check whether there are any path elements inside the scalable group.\n        var recursive = false;\n        if (scalable.node.getElementsByTagName('path').length > 0) {\n            // If scalable has at least one descendant that is a path, we need to switch to recursive bbox calculation.\n            // If there are no path descendants, group bbox calculation works and so we can use the (faster) native function directly.\n            recursive = true;\n        }\n        var scalableBBox = scalable.getBBox({ recursive: recursive });\n\n        // Make sure `scalableBbox.width` and `scalableBbox.height` are not zero which can happen if the element does not have any content. By making\n        // the width/height 1, we prevent HTML errors of the type `scale(Infinity, Infinity)`.\n        var sx = (size.width / (scalableBBox.width || 1));\n        var sy = (size.height / (scalableBBox.height || 1));\n        scalable.attr('transform', 'scale(' + sx + ',' + sy + ')');\n\n        // Now the interesting part. The goal is to be able to store the object geometry via just `x`, `y`, `angle`, `width` and `height`\n        // Order of transformations is significant but we want to reconstruct the object always in the order:\n        // resize(), rotate(), translate() no matter of how the object was transformed. For that to work,\n        // we must adjust the `x` and `y` coordinates of the object whenever we resize it (because the origin of the\n        // rotation changes). The new `x` and `y` coordinates are computed by canceling the previous rotation\n        // around the center of the resized object (which is a different origin then the origin of the previous rotation)\n        // and getting the top-left corner of the resulting object. Then we clean up the rotation back to what it originally was.\n\n        // Cancel the rotation but now around a different origin, which is the center of the scaled object.\n        var rotatable = this.rotatableNode;\n        var rotation = rotatable && rotatable.attr('transform');\n        if (rotation) {\n\n            rotatable.attr('transform', rotation + ' rotate(' + (-angle) + ',' + (size.width / 2) + ',' + (size.height / 2) + ')');\n            var rotatableBBox = scalable.getBBox({ target: this.paper.cells });\n\n            // Store new x, y and perform rotate() again against the new rotation origin.\n            model.set('position', { x: rotatableBBox.x, y: rotatableBBox.y }, assign({ updateHandled: true }, opt));\n            this.translate();\n            this.rotate();\n        }\n\n        // Update must always be called on non-rotated element. Otherwise, relative positioning\n        // would work with wrong (rotated) bounding boxes.\n        this.update();\n    },\n\n    // Embedding mode methods.\n    // -----------------------\n\n    prepareEmbedding: function(data = {}) {\n\n        const element = data.model || this.model;\n        const paper = data.paper || this.paper;\n        const graph = paper.model;\n\n        const initialZIndices = data.initialZIndices = {};\n        const embeddedCells = element.getEmbeddedCells({ deep: true });\n        const connectedLinks = graph.getConnectedLinks(element, { deep: true, includeEnclosed: true });\n\n        // Note: an embedded cell can be a connect link, but it's fine\n        // to iterate over the cell twice.\n        [\n            element,\n            ...embeddedCells,\n            ...connectedLinks\n        ].forEach(cell => initialZIndices[cell.id] = cell.attributes.z);\n\n        element.startBatch('to-front');\n\n        // Bring the model to the front with all his embeds.\n        element.toFront({ deep: true, ui: true });\n\n        // Note that at this point cells in the collection are not sorted by z index (it's running in the batch, see\n        // the dia.Graph._sortOnChangeZ), so we can't assume that the last cell in the collection has the highest z.\n        const maxZ = graph.getElements().reduce((max, cell) => Math.max(max, cell.attributes.z || 0), 0);\n\n        // Move to front also all the inbound and outbound links that are connected\n        // to any of the element descendant. If we bring to front only embedded elements,\n        // links connected to them would stay in the background.\n        connectedLinks.forEach((link) => {\n            if (link.attributes.z <= maxZ) {\n                link.set('z', maxZ + 1, { ui: true });\n            }\n        });\n\n        element.stopBatch('to-front');\n\n        // Before we start looking for suitable parent we remove the current one.\n        const parentId = element.parent();\n        if (parentId) {\n            const parent = graph.getCell(parentId);\n            parent.unembed(element, { ui: true });\n            data.initialParentId = parentId;\n        } else {\n            data.initialParentId = null;\n        }\n    },\n\n    processEmbedding: function(data = {}, evt, x, y) {\n\n        const model = data.model || this.model;\n        const paper = data.paper || this.paper;\n        const graph = paper.model;\n        const { findParentBy, frontParentOnly, validateEmbedding } = paper.options;\n\n        let candidates;\n        if (isFunction(findParentBy)) {\n            candidates = toArray(findParentBy.call(graph, this, evt, x, y));\n        } else if (findParentBy === 'pointer') {\n            candidates = toArray(graph.findModelsFromPoint({ x, y }));\n        } else {\n            candidates = graph.findModelsUnderElement(model, { searchBy: findParentBy });\n        }\n\n        candidates = candidates.filter((el) => {\n            return (el instanceof Cell) && (model.id !== el.id) && !el.isEmbeddedIn(model);\n        });\n\n        if (frontParentOnly) {\n            // pick the element with the highest `z` index\n            candidates = candidates.slice(-1);\n        }\n\n        let newCandidateView = null;\n        const prevCandidateView = data.candidateEmbedView;\n\n        // iterate over all candidates starting from the last one (has the highest z-index).\n        for (let i = candidates.length - 1; i >= 0; i--) {\n            const candidate = candidates[i];\n            if (prevCandidateView && prevCandidateView.model.id == candidate.id) {\n                // candidate remains the same\n                newCandidateView = prevCandidateView;\n                break;\n            } else {\n                const view = candidate.findView(paper);\n                if (!isFunction(validateEmbedding) || validateEmbedding.call(paper, this, view)) {\n                    // flip to the new candidate\n                    newCandidateView = view;\n                    break;\n                }\n            }\n        }\n\n        if (newCandidateView && newCandidateView != prevCandidateView) {\n            // A new candidate view found. Highlight the new one.\n            this.clearEmbedding(data);\n            data.candidateEmbedView = newCandidateView.highlight(\n                newCandidateView.findProxyNode(null, 'container'),\n                { embedding: true }\n            );\n        }\n\n        if (!newCandidateView && prevCandidateView) {\n            // No candidate view found. Unhighlight the previous candidate.\n            this.clearEmbedding(data);\n        }\n    },\n\n    clearEmbedding: function(data) {\n\n        data || (data = {});\n\n        var candidateView = data.candidateEmbedView;\n        if (candidateView) {\n            // No candidate view found. Unhighlight the previous candidate.\n            candidateView.unhighlight(\n                candidateView.findProxyNode(null, 'container'),\n                { embedding: true }\n            );\n            data.candidateEmbedView = null;\n        }\n    },\n\n    finalizeEmbedding: function(data = {}) {\n\n        const candidateView = data.candidateEmbedView;\n        const element = data.model || this.model;\n        const paper = data.paper || this.paper;\n\n        if (candidateView) {\n\n            // We finished embedding. Candidate view is chosen to become the parent of the model.\n            candidateView.model.embed(element, { ui: true });\n            candidateView.unhighlight(candidateView.findProxyNode(null, 'container'), { embedding: true });\n\n            data.candidateEmbedView = null;\n\n        } else {\n\n            const { validateUnembedding } = paper.options;\n            const { initialParentId } = data;\n            // The element was originally embedded into another element.\n            // The interaction would unembed the element. Let's validate\n            // if the element can be unembedded.\n            if (\n                initialParentId &&\n                typeof validateUnembedding === 'function' &&\n                !validateUnembedding.call(paper, this)\n            ) {\n                this._disallowUnembed(data);\n                return;\n            }\n        }\n\n        paper.model.getConnectedLinks(element, { deep: true }).forEach(link => {\n            link.reparent({ ui: true });\n        });\n    },\n\n    _disallowUnembed: function(data) {\n        const { model, whenNotAllowed = 'revert' } = data;\n        const element = model || this.model;\n        const paper = data.paper || this.paper;\n        const graph = paper.model;\n        switch (whenNotAllowed) {\n            case 'remove': {\n                element.remove({ ui: true });\n                break;\n            }\n            case 'revert': {\n                const { initialParentId, initialPosition, initialZIndices } = data;\n                // Revert the element's position (and the position of its embedded cells if any)\n                if (initialPosition) {\n                    const { x, y } = initialPosition;\n                    element.position(x, y, { deep: true, ui: true });\n                }\n                // Revert all the z-indices changed during the embedding\n                if (initialZIndices) {\n                    Object.keys(initialZIndices).forEach(id => {\n                        const cell = graph.getCell(id);\n                        if (cell) {\n                            cell.set('z', initialZIndices[id], { ui: true });\n                        }\n                    });\n                }\n                // Revert the original parent\n                const parent = graph.getCell(initialParentId);\n                if (parent) {\n                    parent.embed(element, { ui: true });\n                }\n                break;\n            }\n        }\n    },\n\n    getDelegatedView: function() {\n\n        var view = this;\n        var model = view.model;\n        var paper = view.paper;\n\n        while (view) {\n            if (model.isLink()) break;\n            if (!model.isEmbedded() || view.can('stopDelegation')) return view;\n            model = model.getParentCell();\n            view = paper.findViewByModel(model);\n        }\n\n        return null;\n    },\n\n    findProxyNode: function(el, type) {\n        el || (el = this.el);\n        const nodeSelector = el.getAttribute(`${type}-selector`);\n        if (nodeSelector) {\n            const port = this.findAttribute('port', el);\n            if (port) {\n                const proxyPortNode = this.findPortNode(port, nodeSelector);\n                if (proxyPortNode) return proxyPortNode;\n            } else {\n                const [proxyNode] = this.findBySelector(nodeSelector);\n                if (proxyNode) return proxyNode;\n            }\n        }\n        return el;\n    },\n\n    // Interaction. The controller part.\n    // ---------------------------------\n\n    notifyPointerdown(evt, x, y) {\n        CellView.prototype.pointerdown.call(this, evt, x, y);\n        this.notify('element:pointerdown', evt, x, y);\n    },\n\n    notifyPointermove(evt, x, y) {\n        CellView.prototype.pointermove.call(this, evt, x, y);\n        this.notify('element:pointermove', evt, x, y);\n    },\n\n    notifyPointerup(evt, x, y) {\n        this.notify('element:pointerup', evt, x, y);\n        CellView.prototype.pointerup.call(this, evt, x, y);\n    },\n\n    pointerdblclick: function(evt, x, y) {\n\n        CellView.prototype.pointerdblclick.apply(this, arguments);\n        this.notify('element:pointerdblclick', evt, x, y);\n    },\n\n    pointerclick: function(evt, x, y) {\n\n        CellView.prototype.pointerclick.apply(this, arguments);\n        this.notify('element:pointerclick', evt, x, y);\n    },\n\n    contextmenu: function(evt, x, y) {\n\n        CellView.prototype.contextmenu.apply(this, arguments);\n        this.notify('element:contextmenu', evt, x, y);\n    },\n\n    pointerdown: function(evt, x, y) {\n\n        this.notifyPointerdown(evt, x, y);\n        this.dragStart(evt, x, y);\n    },\n\n    pointermove: function(evt, x, y) {\n\n        const data = this.eventData(evt);\n        const { targetMagnet, action, delegatedView } = data;\n\n        if (targetMagnet) {\n            this.magnetpointermove(evt, targetMagnet, x, y);\n        }\n\n        switch (action) {\n            case DragActions.MAGNET:\n                this.dragMagnet(evt, x, y);\n                break;\n            case DragActions.MOVE:\n                (delegatedView || this).drag(evt, x, y);\n            // eslint: no-fallthrough=false\n            default:\n                if (data.preventPointerEvents) break;\n                this.notifyPointermove(evt, x, y);\n                break;\n        }\n\n        // Make sure the element view data is passed along.\n        // It could have been wiped out in the handlers above.\n        this.eventData(evt, data);\n    },\n\n    pointerup: function(evt, x, y) {\n\n        const data = this.eventData(evt);\n        const { targetMagnet, action, delegatedView } = data;\n\n        if (targetMagnet) {\n            this.magnetpointerup(evt, targetMagnet, x, y);\n        }\n\n        switch (action) {\n            case DragActions.MAGNET:\n                this.dragMagnetEnd(evt, x, y);\n                break;\n            case DragActions.MOVE:\n                (delegatedView || this).dragEnd(evt, x, y);\n            // eslint: no-fallthrough=false\n            default:\n                if (data.preventPointerEvents) break;\n                this.notifyPointerup(evt, x, y);\n        }\n\n        if (targetMagnet) {\n            this.magnetpointerclick(evt, targetMagnet, x, y);\n        }\n\n        this.checkMouseleave(evt);\n    },\n\n    mouseover: function(evt) {\n\n        CellView.prototype.mouseover.apply(this, arguments);\n        this.notify('element:mouseover', evt);\n    },\n\n    mouseout: function(evt) {\n\n        CellView.prototype.mouseout.apply(this, arguments);\n        this.notify('element:mouseout', evt);\n    },\n\n    mouseenter: function(evt) {\n\n        CellView.prototype.mouseenter.apply(this, arguments);\n        this.notify('element:mouseenter', evt);\n    },\n\n    mouseleave: function(evt) {\n\n        CellView.prototype.mouseleave.apply(this, arguments);\n        this.notify('element:mouseleave', evt);\n    },\n\n    mousewheel: function(evt, x, y, delta) {\n\n        CellView.prototype.mousewheel.apply(this, arguments);\n        this.notify('element:mousewheel', evt, x, y, delta);\n    },\n\n    onmagnet: function(evt, x, y) {\n\n        const { currentTarget: targetMagnet } = evt;\n        this.magnetpointerdown(evt, targetMagnet, x, y);\n        this.eventData(evt, { targetMagnet });\n        this.dragMagnetStart(evt, x, y);\n    },\n\n    magnetpointerdown: function(evt, magnet, x, y) {\n\n        this.notify('element:magnet:pointerdown', evt, magnet, x, y);\n    },\n\n    magnetpointermove: function(evt, magnet, x, y) {\n\n        this.notify('element:magnet:pointermove', evt, magnet, x, y);\n    },\n\n    magnetpointerup: function(evt, magnet, x, y) {\n\n        this.notify('element:magnet:pointerup', evt, magnet, x, y);\n    },\n\n    magnetpointerdblclick: function(evt, magnet, x, y) {\n\n        this.notify('element:magnet:pointerdblclick', evt, magnet, x, y);\n    },\n\n    magnetcontextmenu: function(evt, magnet, x, y) {\n\n        this.notify('element:magnet:contextmenu', evt, magnet, x, y);\n    },\n\n    // Drag Start Handlers\n\n    dragStart: function(evt, x, y) {\n\n        if (this.isDefaultInteractionPrevented(evt)) return;\n\n        var view = this.getDelegatedView();\n        if (!view || !view.can('elementMove')) return;\n\n        this.eventData(evt, {\n            action: DragActions.MOVE,\n            delegatedView: view\n        });\n\n        const position = view.model.position();\n        view.eventData(evt, {\n            initialPosition: position,\n            pointerOffset: position.difference(x, y),\n            restrictedArea: this.paper.getRestrictedArea(view, x, y)\n        });\n    },\n\n    dragMagnetStart: function(evt, x, y) {\n\n        const { paper } = this;\n        const isPropagationAlreadyStopped = evt.isPropagationStopped();\n        if (isPropagationAlreadyStopped) {\n            // Special case when the propagation was already stopped\n            // on the `element:magnet:pointerdown` event.\n            // Do not trigger any `element:pointer*` events\n            // but still start the magnet dragging.\n            this.eventData(evt, { preventPointerEvents: true });\n        }\n\n        if (this.isDefaultInteractionPrevented(evt) || !this.can('addLinkFromMagnet')) {\n            // Stop the default action, which is to start dragging a link.\n            return;\n        }\n\n        const { targetMagnet = evt.currentTarget } = this.eventData(evt);\n        evt.stopPropagation();\n\n        // Invalid (Passive) magnet. Start dragging the element.\n        if (!paper.options.validateMagnet.call(paper, this, targetMagnet, evt)) {\n            if (isPropagationAlreadyStopped) {\n                // Do not trigger `element:pointerdown` and start element dragging\n                // if the propagation was stopped.\n                this.dragStart(evt, x, y);\n                // The `element:pointerdown` event is not triggered because\n                // of `preventPointerEvents` flag.\n            } else {\n                // We need to reset the action\n                // to `MOVE` so that the element is dragged.\n                this.pointerdown(evt, x, y);\n            }\n            return;\n        }\n\n        // Valid magnet. Start dragging a link.\n        if (paper.options.magnetThreshold <= 0) {\n            this.dragLinkStart(evt, targetMagnet, x, y);\n        }\n        this.eventData(evt, { action: DragActions.MAGNET });\n    },\n\n    // Drag Handlers\n\n    drag: function(evt, x, y) {\n\n        var paper = this.paper;\n        var grid = paper.options.gridSize;\n        var element = this.model;\n        var data = this.eventData(evt);\n        var { pointerOffset, restrictedArea, embedding } = data;\n\n        // Make sure the new element's position always snaps to the current grid\n        var elX = snapToGrid(x + pointerOffset.x, grid);\n        var elY = snapToGrid(y + pointerOffset.y, grid);\n\n        element.position(elX, elY, { restrictedArea, deep: true, ui: true });\n\n        if (paper.options.embeddingMode) {\n            if (!embedding) {\n                // Prepare the element for embedding only if the pointer moves.\n                // We don't want to do unnecessary action with the element\n                // if an user only clicks/dblclicks on it.\n                this.prepareEmbedding(data);\n                embedding = true;\n            }\n            this.processEmbedding(data, evt, x, y);\n        }\n\n        this.eventData(evt, {\n            embedding\n        });\n    },\n\n    dragMagnet: function(evt, x, y) {\n        this.dragLink(evt, x, y);\n    },\n\n    // Drag End Handlers\n\n    dragEnd: function(evt, x, y) {\n\n        var data = this.eventData(evt);\n        if (data.embedding) this.finalizeEmbedding(data);\n    },\n\n    dragMagnetEnd: function(evt, x, y) {\n        this.dragLinkEnd(evt, x, y);\n    },\n\n    magnetpointerclick: function(evt, magnet, x, y) {\n        var paper = this.paper;\n        if (paper.eventData(evt).mousemoved > paper.options.clickThreshold) return;\n        this.notify('element:magnet:pointerclick', evt, magnet, x, y);\n    }\n\n}, {\n\n    Flags: Flags,\n});\n\nassign(ElementView.prototype, elementViewPortPrototype);\n","// Does not make any changes to vertices.\n// Returns the arguments that are passed to it, unchanged.\nexport const normal = function(vertices, opt, linkView) {\n\n    return vertices;\n};\n","import * as util from '../util/index.mjs';\n\n// Routes the link always to/from a certain side\n//\n// Arguments:\n//   padding ... gap between the element and the first vertex. :: Default 40.\n//   side ... 'left' | 'right' | 'top' | 'bottom' :: Default 'bottom'.\n//\nexport const oneSide = function(vertices, opt, linkView) {\n\n    var side = opt.side || 'bottom';\n    var padding = util.normalizeSides(opt.padding || 40);\n\n    // LinkView contains cached source an target bboxes.\n    // Note that those are Geometry rectangle objects.\n    var sourceBBox = linkView.sourceBBox;\n    var targetBBox = linkView.targetBBox;\n    var sourcePoint = sourceBBox.center();\n    var targetPoint = targetBBox.center();\n\n    var coordinate, dimension, direction;\n\n    switch (side) {\n        case 'bottom':\n            direction = 1;\n            coordinate = 'y';\n            dimension = 'height';\n            break;\n        case 'top':\n            direction = -1;\n            coordinate = 'y';\n            dimension = 'height';\n            break;\n        case 'left':\n            direction = -1;\n            coordinate = 'x';\n            dimension = 'width';\n            break;\n        case 'right':\n            direction = 1;\n            coordinate = 'x';\n            dimension = 'width';\n            break;\n        default:\n            throw new Error('Router: invalid side');\n    }\n\n    // move the points from the center of the element to outside of it.\n    sourcePoint[coordinate] += direction * (sourceBBox[dimension] / 2 + padding[side]);\n    targetPoint[coordinate] += direction * (targetBBox[dimension] / 2 + padding[side]);\n\n    // make link orthogonal (at least the first and last vertex).\n    if ((direction * (sourcePoint[coordinate] - targetPoint[coordinate])) > 0) {\n        targetPoint[coordinate] = sourcePoint[coordinate];\n    } else {\n        sourcePoint[coordinate] = targetPoint[coordinate];\n    }\n\n    return [sourcePoint].concat(vertices, targetPoint);\n};\n","import * as g from '../g/index.mjs';\nimport * as util from '../util/index.mjs';\n\n// bearing -> opposite bearing\nvar opposites = {\n    N: 'S',\n    S: 'N',\n    E: 'W',\n    W: 'E'\n};\n\n// bearing -> radians\nvar radians = {\n    N: -Math.PI / 2 * 3,\n    S: -Math.PI / 2,\n    E: 0,\n    W: Math.PI\n};\n\n// HELPERS //\n\n// returns a point `p` where lines p,p1 and p,p2 are perpendicular and p is not contained\n// in the given box\nfunction freeJoin(p1, p2, bbox) {\n\n    var p = new g.Point(p1.x, p2.y);\n    if (bbox.containsPoint(p)) p = new g.Point(p2.x, p1.y);\n    // kept for reference\n    // if (bbox.containsPoint(p)) p = null;\n\n    return p;\n}\n\n// returns either width or height of a bbox based on the given bearing\nfunction getBBoxSize(bbox, bearing) {\n\n    return bbox[(bearing === 'W' || bearing === 'E') ? 'width' : 'height'];\n}\n\n// simple bearing method (calculates only orthogonal cardinals)\nfunction getBearing(from, to) {\n\n    if (from.x === to.x) return (from.y > to.y) ? 'N' : 'S';\n    if (from.y === to.y) return (from.x > to.x) ? 'W' : 'E';\n    return null;\n}\n\n// transform point to a rect\nfunction getPointBox(p) {\n\n    return new g.Rect(p.x, p.y, 0, 0);\n}\n\nfunction getPaddingBox(opt) {\n\n    // if both provided, opt.padding wins over opt.elementPadding\n    var sides = util.normalizeSides(opt.padding || opt.elementPadding || 20);\n\n    return {\n        x: -sides.left,\n        y: -sides.top,\n        width: sides.left + sides.right,\n        height: sides.top + sides.bottom\n    };\n}\n\n// return source bbox\nfunction getSourceBBox(linkView, opt) {\n\n    return linkView.sourceBBox.clone().moveAndExpand(getPaddingBox(opt));\n}\n\n// return target bbox\nfunction getTargetBBox(linkView, opt) {\n\n    return linkView.targetBBox.clone().moveAndExpand(getPaddingBox(opt));\n}\n\n// return source anchor\nfunction getSourceAnchor(linkView, opt) {\n\n    if (linkView.sourceAnchor) return linkView.sourceAnchor;\n\n    // fallback: center of bbox\n    var sourceBBox = getSourceBBox(linkView, opt);\n    return sourceBBox.center();\n}\n\n// return target anchor\nfunction getTargetAnchor(linkView, opt) {\n\n    if (linkView.targetAnchor) return linkView.targetAnchor;\n\n    // fallback: center of bbox\n    var targetBBox = getTargetBBox(linkView, opt);\n    return targetBBox.center(); // default\n}\n\n// PARTIAL ROUTERS //\n\nfunction vertexVertex(from, to, bearing) {\n\n    var p1 = new g.Point(from.x, to.y);\n    var p2 = new g.Point(to.x, from.y);\n    var d1 = getBearing(from, p1);\n    var d2 = getBearing(from, p2);\n    var opposite = opposites[bearing];\n\n    var p = (d1 === bearing || (d1 !== opposite && (d2 === opposite || d2 !== bearing))) ? p1 : p2;\n\n    return { points: [p], direction: getBearing(p, to) };\n}\n\nfunction elementVertex(from, to, fromBBox) {\n\n    var p = freeJoin(from, to, fromBBox);\n\n    return { points: [p], direction: getBearing(p, to) };\n}\n\nfunction vertexElement(from, to, toBBox, bearing) {\n\n    var route = {};\n\n    var points = [new g.Point(from.x, to.y), new g.Point(to.x, from.y)];\n    var freePoints = points.filter(function(pt) {\n        return !toBBox.containsPoint(pt);\n    });\n    var freeBearingPoints = freePoints.filter(function(pt) {\n        return getBearing(pt, from) !== bearing;\n    });\n\n    var p;\n\n    if (freeBearingPoints.length > 0) {\n        // Try to pick a point which bears the same direction as the previous segment.\n\n        p = freeBearingPoints.filter(function(pt) {\n            return getBearing(from, pt) === bearing;\n        }).pop();\n        p = p || freeBearingPoints[0];\n\n        route.points = [p];\n        route.direction = getBearing(p, to);\n\n    } else {\n        // Here we found only points which are either contained in the element or they would create\n        // a link segment going in opposite direction from the previous one.\n        // We take the point inside element and move it outside the element in the direction the\n        // route is going. Now we can join this point with the current end (using freeJoin).\n\n        p = util.difference(points, freePoints)[0];\n\n        var p2 = (new g.Point(to)).move(p, -getBBoxSize(toBBox, bearing) / 2);\n        var p1 = freeJoin(p2, from, toBBox);\n\n        route.points = [p1, p2];\n        route.direction = getBearing(p2, to);\n    }\n\n    return route;\n}\n\nfunction elementElement(from, to, fromBBox, toBBox) {\n\n    var route = elementVertex(to, from, toBBox);\n    var p1 = route.points[0];\n\n    if (fromBBox.containsPoint(p1)) {\n\n        route = elementVertex(from, to, fromBBox);\n        var p2 = route.points[0];\n\n        if (toBBox.containsPoint(p2)) {\n\n            var fromBorder = (new g.Point(from)).move(p2, -getBBoxSize(fromBBox, getBearing(from, p2)) / 2);\n            var toBorder = (new g.Point(to)).move(p1, -getBBoxSize(toBBox, getBearing(to, p1)) / 2);\n            var mid = (new g.Line(fromBorder, toBorder)).midpoint();\n\n            var startRoute = elementVertex(from, mid, fromBBox);\n            var endRoute = vertexVertex(mid, to, startRoute.direction);\n\n            route.points = [startRoute.points[0], endRoute.points[0]];\n            route.direction = endRoute.direction;\n        }\n    }\n\n    return route;\n}\n\n// Finds route for situations where one element is inside the other.\n// Typically the route is directed outside the outer element first and\n// then back towards the inner element.\nfunction insideElement(from, to, fromBBox, toBBox, bearing) {\n\n    var route = {};\n    var boundary = fromBBox.union(toBBox).inflate(1);\n\n    // start from the point which is closer to the boundary\n    var reversed = boundary.center().distance(to) > boundary.center().distance(from);\n    var start = reversed ? to : from;\n    var end = reversed ? from : to;\n\n    var p1, p2, p3;\n\n    if (bearing) {\n        // Points on circle with radius equals 'W + H` are always outside the rectangle\n        // with width W and height H if the center of that circle is the center of that rectangle.\n        p1 = g.Point.fromPolar(boundary.width + boundary.height, radians[bearing], start);\n        p1 = boundary.pointNearestToPoint(p1).move(p1, -1);\n\n    } else {\n        p1 = boundary.pointNearestToPoint(start).move(start, 1);\n    }\n\n    p2 = freeJoin(p1, end, boundary);\n\n    if (p1.round().equals(p2.round())) {\n        p2 = g.Point.fromPolar(boundary.width + boundary.height, g.toRad(p1.theta(start)) + Math.PI / 2, end);\n        p2 = boundary.pointNearestToPoint(p2).move(end, 1).round();\n        p3 = freeJoin(p1, p2, boundary);\n        route.points = reversed ? [p2, p3, p1] : [p1, p3, p2];\n\n    } else {\n        route.points = reversed ? [p2, p1] : [p1, p2];\n    }\n\n    route.direction = reversed ? getBearing(p1, to) : getBearing(p2, to);\n\n    return route;\n}\n\n// MAIN ROUTER //\n\n// Return points through which a connection needs to be drawn in order to obtain an orthogonal link\n// routing from source to target going through `vertices`.\nexport function orthogonal(vertices, opt, linkView) {\n\n    var sourceBBox = getSourceBBox(linkView, opt);\n    var targetBBox = getTargetBBox(linkView, opt);\n\n    var sourceAnchor = getSourceAnchor(linkView, opt);\n    var targetAnchor = getTargetAnchor(linkView, opt);\n\n    // if anchor lies outside of bbox, the bbox expands to include it\n    sourceBBox = sourceBBox.union(getPointBox(sourceAnchor));\n    targetBBox = targetBBox.union(getPointBox(targetAnchor));\n\n    vertices = util.toArray(vertices).map(g.Point);\n    vertices.unshift(sourceAnchor);\n    vertices.push(targetAnchor);\n\n    var bearing; // bearing of previous route segment\n\n    var orthogonalVertices = []; // the array of found orthogonal vertices to be returned\n    for (var i = 0, max = vertices.length - 1; i < max; i++) {\n\n        var route = null;\n\n        var from = vertices[i];\n        var to = vertices[i + 1];\n\n        var isOrthogonal = !!getBearing(from, to);\n\n        if (i === 0) { // source\n\n            if (i + 1 === max) { // route source -> target\n\n                // Expand one of the elements by 1px to detect situations when the two\n                // elements are positioned next to each other with no gap in between.\n                if (sourceBBox.intersect(targetBBox.clone().inflate(1))) {\n                    route = insideElement(from, to, sourceBBox, targetBBox);\n\n                } else if (!isOrthogonal) {\n                    route = elementElement(from, to, sourceBBox, targetBBox);\n                }\n\n            } else { // route source -> vertex\n\n                if (sourceBBox.containsPoint(to)) {\n                    route = insideElement(from, to, sourceBBox, getPointBox(to).moveAndExpand(getPaddingBox(opt)));\n\n                } else if (!isOrthogonal) {\n                    route = elementVertex(from, to, sourceBBox);\n                }\n            }\n\n        } else if (i + 1 === max) { // route vertex -> target\n\n            // prevent overlaps with previous line segment\n            var isOrthogonalLoop = isOrthogonal && getBearing(to, from) === bearing;\n\n            if (targetBBox.containsPoint(from) || isOrthogonalLoop) {\n                route = insideElement(from, to, getPointBox(from).moveAndExpand(getPaddingBox(opt)), targetBBox, bearing);\n\n            } else if (!isOrthogonal) {\n                route = vertexElement(from, to, targetBBox, bearing);\n            }\n\n        } else if (!isOrthogonal) { // route vertex -> vertex\n            route = vertexVertex(from, to, bearing);\n        }\n\n        // applicable to all routes:\n\n        // set bearing for next iteration\n        if (route) {\n            Array.prototype.push.apply(orthogonalVertices, route.points);\n            bearing = route.direction;\n\n        } else {\n            // orthogonal route and not looped\n            bearing = getBearing(from, to);\n        }\n\n        // push `to` point to identified orthogonal vertices array\n        if (i + 1 < max) {\n            orthogonalVertices.push(to);\n        }\n    }\n\n    return orthogonalVertices;\n}\n","import * as g from '../g/index.mjs';\nimport * as util from '../util/index.mjs';\nimport { orthogonal } from './orthogonal.mjs';\n\nvar config = {\n\n    // size of the step to find a route (the grid of the manhattan pathfinder)\n    step: 10,\n\n    // the number of route finding loops that cause the router to abort\n    // returns fallback route instead\n    maximumLoops: 2000,\n\n    // the number of decimal places to round floating point coordinates\n    precision: 1,\n\n    // maximum change of direction\n    maxAllowedDirectionChange: 90,\n\n    // should the router use perpendicular linkView option?\n    // does not connect anchor of element but rather a point close-by that is orthogonal\n    // this looks much better\n    perpendicular: true,\n\n    // should the source and/or target not be considered as obstacles?\n    excludeEnds: [], // 'source', 'target'\n\n    // should certain types of elements not be considered as obstacles?\n    excludeTypes: ['basic.Text'],\n\n    // possible starting directions from an element\n    startDirections: ['top', 'right', 'bottom', 'left'],\n\n    // possible ending directions to an element\n    endDirections: ['top', 'right', 'bottom', 'left'],\n\n    // specify the directions used above and what they mean\n    directionMap: {\n        top: { x: 0, y: -1 },\n        right: { x: 1, y: 0 },\n        bottom: { x: 0, y: 1 },\n        left: { x: -1, y: 0 }\n    },\n\n    // cost of an orthogonal step\n    cost: function() {\n\n        return this.step;\n    },\n\n    // an array of directions to find next points on the route\n    // different from start/end directions\n    directions: function() {\n\n        var step = this.step;\n        var cost = this.cost();\n\n        return [\n            { offsetX: step, offsetY: 0, cost: cost },\n            { offsetX: -step, offsetY: 0, cost: cost },\n            { offsetX: 0, offsetY: step, cost: cost },\n            { offsetX: 0, offsetY: -step, cost: cost }\n        ];\n    },\n\n    // a penalty received for direction change\n    penalties: function() {\n\n        return {\n            0: 0,\n            45: this.step / 2,\n            90: this.step / 2\n        };\n    },\n\n    // padding applied on the element bounding boxes\n    paddingBox: function() {\n\n        var step = this.step;\n\n        return {\n            x: -step,\n            y: -step,\n            width: 2 * step,\n            height: 2 * step\n        };\n    },\n\n    // A function that determines whether a given point is an obstacle or not.\n    // If used, the `padding`, `excludeEnds`and `excludeTypes` options are ignored.\n    // (point: dia.Point) => boolean;\n    isPointObstacle: null,\n\n    // a router to use when the manhattan router fails\n    // (one of the partial routes returns null)\n    fallbackRouter: function(vertices, opt, linkView) {\n\n        if (!util.isFunction(orthogonal)) {\n            throw new Error('Manhattan requires the orthogonal router as default fallback.');\n        }\n\n        return orthogonal(vertices, util.assign({}, config, opt), linkView);\n    },\n\n    /* Deprecated */\n    // a simple route used in situations when main routing method fails\n    // (exceed max number of loop iterations, inaccessible)\n    fallbackRoute: function(from, to, opt) {\n\n        return null; // null result will trigger the fallbackRouter\n\n        // left for reference:\n        /*// Find an orthogonal route ignoring obstacles.\n\n        var point = ((opt.previousDirAngle || 0) % 180 === 0)\n                ? new g.Point(from.x, to.y)\n                : new g.Point(to.x, from.y);\n\n        return [point];*/\n    },\n\n    // if a function is provided, it's used to route the link while dragging an end\n    // i.e. function(from, to, opt) { return []; }\n    draggingRoute: null\n};\n\n// HELPER CLASSES //\n\n// Map of obstacles\n// Helper structure to identify whether a point lies inside an obstacle.\nfunction ObstacleMap(opt) {\n\n    this.map = {};\n    this.options = opt;\n    // tells how to divide the paper when creating the elements map\n    this.mapGridSize = 100;\n}\n\nObstacleMap.prototype.build = function(graph, link) {\n\n    var opt = this.options;\n\n    // source or target element could be excluded from set of obstacles\n    var excludedEnds = util.toArray(opt.excludeEnds).reduce(function(res, item) {\n\n        var end = link.get(item);\n        if (end) {\n            var cell = graph.getCell(end.id);\n            if (cell) {\n                res.push(cell);\n            }\n        }\n\n        return res;\n    }, []);\n\n    // Exclude any embedded elements from the source and the target element.\n    var excludedAncestors = [];\n\n    var source = graph.getCell(link.get('source').id);\n    if (source) {\n        excludedAncestors = util.union(excludedAncestors, source.getAncestors().map(function(cell) {\n            return cell.id;\n        }));\n    }\n\n    var target = graph.getCell(link.get('target').id);\n    if (target) {\n        excludedAncestors = util.union(excludedAncestors, target.getAncestors().map(function(cell) {\n            return cell.id;\n        }));\n    }\n\n    // Builds a map of all elements for quicker obstacle queries (i.e. is a point contained\n    // in any obstacle?) (a simplified grid search).\n    // The paper is divided into smaller cells, where each holds information about which\n    // elements belong to it. When we query whether a point lies inside an obstacle we\n    // don't need to go through all obstacles, we check only those in a particular cell.\n    var mapGridSize = this.mapGridSize;\n\n    graph.getElements().reduce(function(map, element) {\n\n        var isExcludedType = util.toArray(opt.excludeTypes).includes(element.get('type'));\n        var isExcludedEnd = excludedEnds.find(function(excluded) {\n            return excluded.id === element.id;\n        });\n        var isExcludedAncestor = excludedAncestors.includes(element.id);\n\n        var isExcluded = isExcludedType || isExcludedEnd || isExcludedAncestor;\n        if (!isExcluded) {\n            var bbox = element.getBBox().moveAndExpand(opt.paddingBox);\n\n            var origin = bbox.origin().snapToGrid(mapGridSize);\n            var corner = bbox.corner().snapToGrid(mapGridSize);\n\n            for (var x = origin.x; x <= corner.x; x += mapGridSize) {\n                for (var y = origin.y; y <= corner.y; y += mapGridSize) {\n                    var gridKey = x + '@' + y;\n                    map[gridKey] = map[gridKey] || [];\n                    map[gridKey].push(bbox);\n                }\n            }\n        }\n\n        return map;\n    }, this.map);\n\n    return this;\n};\n\nObstacleMap.prototype.isPointAccessible = function(point) {\n\n    var mapKey = point.clone().snapToGrid(this.mapGridSize).toString();\n\n    return util.toArray(this.map[mapKey]).every(function(obstacle) {\n        return !obstacle.containsPoint(point);\n    });\n};\n\n// Sorted Set\n// Set of items sorted by given value.\nfunction SortedSet() {\n    this.items = [];\n    this.hash = {};\n    this.values = {};\n    this.OPEN = 1;\n    this.CLOSE = 2;\n}\n\nSortedSet.prototype.add = function(item, value) {\n\n    if (this.hash[item]) {\n        // item removal\n        this.items.splice(this.items.indexOf(item), 1);\n    } else {\n        this.hash[item] = this.OPEN;\n    }\n\n    this.values[item] = value;\n\n    var index = util.sortedIndex(this.items, item, function(i) {\n        return this.values[i];\n    }.bind(this));\n\n    this.items.splice(index, 0, item);\n};\n\nSortedSet.prototype.remove = function(item) {\n\n    this.hash[item] = this.CLOSE;\n};\n\nSortedSet.prototype.isOpen = function(item) {\n\n    return this.hash[item] === this.OPEN;\n};\n\nSortedSet.prototype.isClose = function(item) {\n\n    return this.hash[item] === this.CLOSE;\n};\n\nSortedSet.prototype.isEmpty = function() {\n\n    return this.items.length === 0;\n};\n\nSortedSet.prototype.pop = function() {\n\n    var item = this.items.shift();\n    this.remove(item);\n    return item;\n};\n\n// HELPERS //\n\n// return source bbox\nfunction getSourceBBox(linkView, opt) {\n\n    // expand by padding box\n    if (opt && opt.paddingBox) return linkView.sourceBBox.clone().moveAndExpand(opt.paddingBox);\n\n    return linkView.sourceBBox.clone();\n}\n\n// return target bbox\nfunction getTargetBBox(linkView, opt) {\n\n    // expand by padding box\n    if (opt && opt.paddingBox) return linkView.targetBBox.clone().moveAndExpand(opt.paddingBox);\n\n    return linkView.targetBBox.clone();\n}\n\n// return source anchor\nfunction getSourceAnchor(linkView, opt) {\n\n    if (linkView.sourceAnchor) return linkView.sourceAnchor;\n\n    // fallback: center of bbox\n    var sourceBBox = getSourceBBox(linkView, opt);\n    return sourceBBox.center();\n}\n\n// return target anchor\nfunction getTargetAnchor(linkView, opt) {\n\n    if (linkView.targetAnchor) return linkView.targetAnchor;\n\n    // fallback: center of bbox\n    var targetBBox = getTargetBBox(linkView, opt);\n    return targetBBox.center(); // default\n}\n\n// returns a direction index from start point to end point\n// corrects for grid deformation between start and end\nfunction getDirectionAngle(start, end, numDirections, grid, opt) {\n\n    var quadrant = 360 / numDirections;\n    var angleTheta = start.theta(fixAngleEnd(start, end, grid, opt));\n    var normalizedAngle = g.normalizeAngle(angleTheta + (quadrant / 2));\n    return quadrant * Math.floor(normalizedAngle / quadrant);\n}\n\n// helper function for getDirectionAngle()\n// corrects for grid deformation\n// (if a point is one grid steps away from another in both dimensions,\n// it is considered to be 45 degrees away, even if the real angle is different)\n// this causes visible angle discrepancies if `opt.step` is much larger than `paper.gridSize`\nfunction fixAngleEnd(start, end, grid, opt) {\n\n    var step = opt.step;\n\n    var diffX = end.x - start.x;\n    var diffY = end.y - start.y;\n\n    var gridStepsX = diffX / grid.x;\n    var gridStepsY = diffY / grid.y;\n\n    var distanceX = gridStepsX * step;\n    var distanceY = gridStepsY * step;\n\n    return new g.Point(start.x + distanceX, start.y + distanceY);\n}\n\n// return the change in direction between two direction angles\nfunction getDirectionChange(angle1, angle2) {\n\n    var directionChange = Math.abs(angle1 - angle2);\n    return (directionChange > 180) ? (360 - directionChange) : directionChange;\n}\n\n// fix direction offsets according to current grid\nfunction getGridOffsets(directions, grid, opt) {\n\n    var step = opt.step;\n\n    util.toArray(opt.directions).forEach(function(direction) {\n\n        direction.gridOffsetX = (direction.offsetX / step) * grid.x;\n        direction.gridOffsetY = (direction.offsetY / step) * grid.y;\n    });\n}\n\n// get grid size in x and y dimensions, adapted to source and target positions\nfunction getGrid(step, source, target) {\n\n    return {\n        source: source.clone(),\n        x: getGridDimension(target.x - source.x, step),\n        y: getGridDimension(target.y - source.y, step)\n    };\n}\n\n// helper function for getGrid()\nfunction getGridDimension(diff, step) {\n\n    // return step if diff = 0\n    if (!diff) return step;\n\n    var absDiff = Math.abs(diff);\n    var numSteps = Math.round(absDiff / step);\n\n    // return absDiff if less than one step apart\n    if (!numSteps) return absDiff;\n\n    // otherwise, return corrected step\n    var roundedDiff = numSteps * step;\n    var remainder = absDiff - roundedDiff;\n    var stepCorrection = remainder / numSteps;\n\n    return step + stepCorrection;\n}\n\n// return a clone of point snapped to grid\nfunction snapToGrid(point, grid) {\n\n    var source = grid.source;\n\n    var snappedX = g.snapToGrid(point.x - source.x, grid.x) + source.x;\n    var snappedY = g.snapToGrid(point.y - source.y, grid.y) + source.y;\n\n    return new g.Point(snappedX, snappedY);\n}\n\n// round the point to opt.precision\nfunction round(point, precision) {\n\n    return point.round(precision);\n}\n\n// snap to grid and then round the point\nfunction align(point, grid, precision) {\n\n    return round(snapToGrid(point.clone(), grid), precision);\n}\n\n// return a string representing the point\n// string is rounded in both dimensions\nfunction getKey(point) {\n\n    return point.clone().toString();\n}\n\n// return a normalized vector from given point\n// used to determine the direction of a difference of two points\nfunction normalizePoint(point) {\n\n    return new g.Point(\n        point.x === 0 ? 0 : Math.abs(point.x) / point.x,\n        point.y === 0 ? 0 : Math.abs(point.y) / point.y\n    );\n}\n\n// PATHFINDING //\n\n// reconstructs a route by concatenating points with their parents\nfunction reconstructRoute(parents, points, tailPoint, from, to, grid, opt) {\n\n    var route = [];\n\n    var prevDiff = normalizePoint(to.difference(tailPoint));\n\n    // tailPoint is assumed to be aligned already\n    var currentKey = getKey(tailPoint);\n    var parent = parents[currentKey];\n\n    var point;\n    while (parent) {\n\n        // point is assumed to be aligned already\n        point = points[currentKey];\n\n        var diff = normalizePoint(point.difference(parent));\n        if (!diff.equals(prevDiff)) {\n            route.unshift(point);\n            prevDiff = diff;\n        }\n\n        // parent is assumed to be aligned already\n        currentKey = getKey(parent);\n        parent = parents[currentKey];\n    }\n\n    // leadPoint is assumed to be aligned already\n    var leadPoint = points[currentKey];\n\n    var fromDiff = normalizePoint(leadPoint.difference(from));\n    if (!fromDiff.equals(prevDiff)) {\n        route.unshift(leadPoint);\n    }\n\n    return route;\n}\n\n// heuristic method to determine the distance between two points\nfunction estimateCost(from, endPoints) {\n\n    var min = Infinity;\n\n    for (var i = 0, len = endPoints.length; i < len; i++) {\n        var cost = from.manhattanDistance(endPoints[i]);\n        if (cost < min) min = cost;\n    }\n\n    return min;\n}\n\n// find points around the bbox taking given directions into account\n// lines are drawn from anchor in given directions, intersections recorded\n// if anchor is outside bbox, only those directions that intersect get a rect point\n// the anchor itself is returned as rect point (representing some directions)\n// (since those directions are unobstructed by the bbox)\nfunction getRectPoints(anchor, bbox, directionList, grid, opt) {\n\n    var precision = opt.precision;\n    var directionMap = opt.directionMap;\n\n    var anchorCenterVector = anchor.difference(bbox.center());\n\n    var keys = util.isObject(directionMap) ? Object.keys(directionMap) : [];\n    var dirList = util.toArray(directionList);\n    var rectPoints = keys.reduce(function(res, key) {\n\n        if (dirList.includes(key)) {\n            var direction = directionMap[key];\n\n            // create a line that is guaranteed to intersect the bbox if bbox is in the direction\n            // even if anchor lies outside of bbox\n            var endpoint = new g.Point(\n                anchor.x + direction.x * (Math.abs(anchorCenterVector.x) + bbox.width),\n                anchor.y + direction.y * (Math.abs(anchorCenterVector.y) + bbox.height)\n            );\n            var intersectionLine = new g.Line(anchor, endpoint);\n\n            // get the farther intersection, in case there are two\n            // (that happens if anchor lies next to bbox)\n            var intersections = intersectionLine.intersect(bbox) || [];\n            var numIntersections = intersections.length;\n            var farthestIntersectionDistance;\n            var farthestIntersection = null;\n            for (var i = 0; i < numIntersections; i++) {\n                var currentIntersection = intersections[i];\n                var distance = anchor.squaredDistance(currentIntersection);\n                if ((farthestIntersectionDistance === undefined) || (distance > farthestIntersectionDistance)) {\n                    farthestIntersectionDistance = distance;\n                    farthestIntersection = currentIntersection;\n                }\n            }\n\n            // if an intersection was found in this direction, it is our rectPoint\n            if (farthestIntersection) {\n                var point = align(farthestIntersection, grid, precision);\n\n                // if the rectPoint lies inside the bbox, offset it by one more step\n                if (bbox.containsPoint(point)) {\n                    point = align(point.offset(direction.x * grid.x, direction.y * grid.y), grid, precision);\n                }\n\n                // then add the point to the result array\n                // aligned\n                res.push(point);\n            }\n        }\n\n        return res;\n    }, []);\n\n    // if anchor lies outside of bbox, add it to the array of points\n    if (!bbox.containsPoint(anchor)) {\n        // aligned\n        rectPoints.push(align(anchor, grid, precision));\n    }\n\n    return rectPoints;\n}\n\n// finds the route between two points/rectangles (`from`, `to`) implementing A* algorithm\n// rectangles get rect points assigned by getRectPoints()\nfunction findRoute(from, to, isPointObstacle, opt) {\n\n    var precision = opt.precision;\n\n    // Get grid for this route.\n\n    var sourceAnchor, targetAnchor;\n\n    if (from instanceof g.Rect) { // `from` is sourceBBox\n        sourceAnchor = round(getSourceAnchor(this, opt).clone(), precision);\n    } else {\n        sourceAnchor = round(from.clone(), precision);\n    }\n\n    if (to instanceof g.Rect) { // `to` is targetBBox\n        targetAnchor = round(getTargetAnchor(this, opt).clone(), precision);\n    } else {\n        targetAnchor = round(to.clone(), precision);\n    }\n\n    var grid = getGrid(opt.step, sourceAnchor, targetAnchor);\n\n    // Get pathfinding points.\n\n    var start, end; // aligned with grid by definition\n    var startPoints, endPoints; // assumed to be aligned with grid already\n\n    // set of points we start pathfinding from\n    if (from instanceof g.Rect) { // `from` is sourceBBox\n        start = sourceAnchor;\n        startPoints = getRectPoints(start, from, opt.startDirections, grid, opt);\n\n    } else {\n        start = sourceAnchor;\n        startPoints = [start];\n    }\n\n    // set of points we want the pathfinding to finish at\n    if (to instanceof g.Rect) { // `to` is targetBBox\n        end = targetAnchor;\n        endPoints = getRectPoints(targetAnchor, to, opt.endDirections, grid, opt);\n\n    } else {\n        end = targetAnchor;\n        endPoints = [end];\n    }\n\n    // take into account only accessible rect points (those not under obstacles)\n    startPoints = startPoints.filter(p => !isPointObstacle(p));\n    endPoints = endPoints.filter(p => !isPointObstacle(p));\n\n    // Check that there is an accessible route point on both sides.\n    // Otherwise, use fallbackRoute().\n    if (startPoints.length > 0 && endPoints.length > 0) {\n\n        // The set of tentative points to be evaluated, initially containing the start points.\n        // Rounded to nearest integer for simplicity.\n        var openSet = new SortedSet();\n        // Keeps reference to actual points for given elements of the open set.\n        var points = {};\n        // Keeps reference to a point that is immediate predecessor of given element.\n        var parents = {};\n        // Cost from start to a point along best known path.\n        var costs = {};\n\n        for (var i = 0, n = startPoints.length; i < n; i++) {\n            // startPoint is assumed to be aligned already\n            var startPoint = startPoints[i];\n\n            var key = getKey(startPoint);\n\n            openSet.add(key, estimateCost(startPoint, endPoints));\n            points[key] = startPoint;\n            costs[key] = 0;\n        }\n\n        var previousRouteDirectionAngle = opt.previousDirectionAngle; // undefined for first route\n        var isPathBeginning = (previousRouteDirectionAngle === undefined);\n\n        // directions\n        var direction, directionChange;\n        var directions = opt.directions;\n        getGridOffsets(directions, grid, opt);\n\n        var numDirections = directions.length;\n\n        var endPointsKeys = util.toArray(endPoints).reduce(function(res, endPoint) {\n            // endPoint is assumed to be aligned already\n\n            var key = getKey(endPoint);\n            res.push(key);\n            return res;\n        }, []);\n\n        // main route finding loop\n        var loopsRemaining = opt.maximumLoops;\n        while (!openSet.isEmpty() && loopsRemaining > 0) {\n\n            // remove current from the open list\n            var currentKey = openSet.pop();\n            var currentPoint = points[currentKey];\n            var currentParent = parents[currentKey];\n            var currentCost = costs[currentKey];\n\n            var isRouteBeginning = (currentParent === undefined); // undefined for route starts\n            var isStart = currentPoint.equals(start); // (is source anchor or `from` point) = can leave in any direction\n\n            var previousDirectionAngle;\n            if (!isRouteBeginning) previousDirectionAngle = getDirectionAngle(currentParent, currentPoint, numDirections, grid, opt); // a vertex on the route\n            else if (!isPathBeginning) previousDirectionAngle = previousRouteDirectionAngle; // beginning of route on the path\n            else if (!isStart) previousDirectionAngle = getDirectionAngle(start, currentPoint, numDirections, grid, opt); // beginning of path, start rect point\n            else previousDirectionAngle = null; // beginning of path, source anchor or `from` point\n\n            // check if we reached any endpoint\n            var samePoints = startPoints.length === endPoints.length;\n            if (samePoints) {\n                for (var j = 0; j < startPoints.length; j++) {\n                    if (!startPoints[j].equals(endPoints[j])) {\n                        samePoints = false;\n                        break;\n                    }\n                }\n            }\n            var skipEndCheck = (isRouteBeginning && samePoints);\n            if (!skipEndCheck && (endPointsKeys.indexOf(currentKey) >= 0)) {\n                opt.previousDirectionAngle = previousDirectionAngle;\n                return reconstructRoute(parents, points, currentPoint, start, end, grid, opt);\n            }\n\n            // go over all possible directions and find neighbors\n            for (i = 0; i < numDirections; i++) {\n                direction = directions[i];\n\n                var directionAngle = direction.angle;\n                directionChange = getDirectionChange(previousDirectionAngle, directionAngle);\n\n                // if the direction changed rapidly, don't use this point\n                // any direction is allowed for starting points\n                if (!(isPathBeginning && isStart) && directionChange > opt.maxAllowedDirectionChange) continue;\n\n                var neighborPoint = align(currentPoint.clone().offset(direction.gridOffsetX, direction.gridOffsetY), grid, precision);\n                var neighborKey = getKey(neighborPoint);\n\n                // Closed points from the openSet were already evaluated.\n                if (openSet.isClose(neighborKey) || isPointObstacle(neighborPoint)) continue;\n\n                // We can only enter end points at an acceptable angle.\n                if (endPointsKeys.indexOf(neighborKey) >= 0) { // neighbor is an end point\n\n                    var isNeighborEnd = neighborPoint.equals(end); // (is target anchor or `to` point) = can be entered in any direction\n\n                    if (!isNeighborEnd) {\n                        var endDirectionAngle = getDirectionAngle(neighborPoint, end, numDirections, grid, opt);\n                        var endDirectionChange = getDirectionChange(directionAngle, endDirectionAngle);\n\n                        if (endDirectionChange > opt.maxAllowedDirectionChange) continue;\n                    }\n                }\n\n                // The current direction is ok.\n\n                var neighborCost = direction.cost;\n                var neighborPenalty = isStart ? 0 : opt.penalties[directionChange]; // no penalties for start point\n                var costFromStart = currentCost + neighborCost + neighborPenalty;\n\n                if (!openSet.isOpen(neighborKey) || (costFromStart < costs[neighborKey])) {\n                    // neighbor point has not been processed yet\n                    // or the cost of the path from start is lower than previously calculated\n\n                    points[neighborKey] = neighborPoint;\n                    parents[neighborKey] = currentPoint;\n                    costs[neighborKey] = costFromStart;\n                    openSet.add(neighborKey, costFromStart + estimateCost(neighborPoint, endPoints));\n                }\n            }\n\n            loopsRemaining--;\n        }\n    }\n\n    // no route found (`to` point either wasn't accessible or finding route took\n    // way too much calculation)\n    return opt.fallbackRoute.call(this, start, end, opt);\n}\n\n// resolve some of the options\nfunction resolveOptions(opt) {\n\n    opt.directions = util.result(opt, 'directions');\n    opt.penalties = util.result(opt, 'penalties');\n    opt.paddingBox = util.result(opt, 'paddingBox');\n    opt.padding = util.result(opt, 'padding');\n\n    if (opt.padding) {\n        // if both provided, opt.padding wins over opt.paddingBox\n        var sides = util.normalizeSides(opt.padding);\n        opt.paddingBox = {\n            x: -sides.left,\n            y: -sides.top,\n            width: sides.left + sides.right,\n            height: sides.top + sides.bottom\n        };\n    }\n\n    util.toArray(opt.directions).forEach(function(direction) {\n\n        var point1 = new g.Point(0, 0);\n        var point2 = new g.Point(direction.offsetX, direction.offsetY);\n\n        direction.angle = g.normalizeAngle(point1.theta(point2));\n    });\n}\n\n// initialization of the route finding\nfunction router(vertices, opt, linkView) {\n\n    resolveOptions(opt);\n\n    // enable/disable linkView perpendicular option\n    linkView.options.perpendicular = !!opt.perpendicular;\n\n    var sourceBBox = getSourceBBox(linkView, opt);\n    var targetBBox = getTargetBBox(linkView, opt);\n\n    var sourceAnchor = getSourceAnchor(linkView, opt);\n    //var targetAnchor = getTargetAnchor(linkView, opt);\n\n    // pathfinding\n    let isPointObstacle;\n    if (typeof opt.isPointObstacle === 'function') {\n        isPointObstacle = opt.isPointObstacle;\n    } else {\n        const map = new ObstacleMap(opt);\n        map.build(linkView.paper.model, linkView.model);\n        isPointObstacle = (point) => !map.isPointAccessible(point);\n    }\n\n    var oldVertices = util.toArray(vertices).map(g.Point);\n    var newVertices = [];\n    var tailPoint = sourceAnchor; // the origin of first route's grid, does not need snapping\n\n    // find a route by concatenating all partial routes (routes need to pass through vertices)\n    // source -> vertex[1] -> ... -> vertex[n] -> target\n    var to, from;\n\n    for (var i = 0, len = oldVertices.length; i <= len; i++) {\n\n        var partialRoute = null;\n\n        from = to || sourceBBox;\n        to = oldVertices[i];\n\n        if (!to) {\n            // this is the last iteration\n            // we ran through all vertices in oldVertices\n            // 'to' is not a vertex.\n\n            to = targetBBox;\n\n            // If the target is a point (i.e. it's not an element), we\n            // should use dragging route instead of main routing method if it has been provided.\n            var isEndingAtPoint = !linkView.model.get('source').id || !linkView.model.get('target').id;\n\n            if (isEndingAtPoint && util.isFunction(opt.draggingRoute)) {\n                // Make sure we are passing points only (not rects).\n                var dragFrom = (from === sourceBBox) ? sourceAnchor : from;\n                var dragTo = to.origin();\n\n                partialRoute = opt.draggingRoute.call(linkView, dragFrom, dragTo, opt);\n            }\n        }\n\n        // if partial route has not been calculated yet use the main routing method to find one\n        partialRoute = partialRoute || findRoute.call(linkView, from, to, isPointObstacle, opt);\n\n        if (partialRoute === null) { // the partial route cannot be found\n            return opt.fallbackRouter(vertices, opt, linkView);\n        }\n\n        var leadPoint = partialRoute[0];\n\n        // remove the first point if the previous partial route had the same point as last\n        if (leadPoint && leadPoint.equals(tailPoint)) partialRoute.shift();\n\n        // save tailPoint for next iteration\n        tailPoint = partialRoute[partialRoute.length - 1] || tailPoint;\n\n        Array.prototype.push.apply(newVertices, partialRoute);\n    }\n\n    return newVertices;\n}\n\n// public function\nexport const manhattan = function(vertices, opt, linkView) {\n    return router(vertices, util.assign({}, config, opt), linkView);\n};\n","import { manhattan } from './manhattan.mjs';\nimport * as util from '../util/index.mjs';\nimport * as g from '../g/index.mjs';\n\nvar config = {\n\n    maxAllowedDirectionChange: 45,\n\n    // cost of a diagonal step\n    diagonalCost: function() {\n\n        var step = this.step;\n        return Math.ceil(Math.sqrt(step * step << 1));\n    },\n\n    // an array of directions to find next points on the route\n    // different from start/end directions\n    directions: function() {\n\n        var step = this.step;\n        var cost = this.cost();\n        var diagonalCost = this.diagonalCost();\n\n        return [\n            { offsetX: step, offsetY: 0, cost: cost },\n            { offsetX: step, offsetY: step, cost: diagonalCost },\n            { offsetX: 0, offsetY: step, cost: cost },\n            { offsetX: -step, offsetY: step, cost: diagonalCost },\n            { offsetX: -step, offsetY: 0, cost: cost },\n            { offsetX: -step, offsetY: -step, cost: diagonalCost },\n            { offsetX: 0, offsetY: -step, cost: cost },\n            { offsetX: step, offsetY: -step, cost: diagonalCost }\n        ];\n    },\n\n    // a simple route used in situations when main routing method fails\n    // (exceed max number of loop iterations, inaccessible)\n    fallbackRoute: function(from, to, opt) {\n\n        // Find a route which breaks by 45 degrees ignoring all obstacles.\n\n        var theta = from.theta(to);\n\n        var route = [];\n\n        var a = { x: to.x, y: from.y };\n        var b = { x: from.x, y: to.y };\n\n        if (theta % 180 > 90) {\n            var t = a;\n            a = b;\n            b = t;\n        }\n\n        var p1 = (theta % 90) < 45 ? a : b;\n        var l1 = new g.Line(from, p1);\n\n        var alpha = 90 * Math.ceil(theta / 90);\n\n        var p2 = g.Point.fromPolar(l1.squaredLength(), g.toRad(alpha + 135), p1);\n        var l2 = new g.Line(to, p2);\n\n        var intersectionPoint = l1.intersection(l2);\n        var point = intersectionPoint ? intersectionPoint : to;\n\n        var directionFrom = intersectionPoint ? point : from;\n\n        var quadrant = 360 / opt.directions.length;\n        var angleTheta = directionFrom.theta(to);\n        var normalizedAngle = g.normalizeAngle(angleTheta + (quadrant / 2));\n        var directionAngle = quadrant * Math.floor(normalizedAngle / quadrant);\n\n        opt.previousDirectionAngle = directionAngle;\n\n        if (point) route.push(point.round());\n        route.push(to);\n\n        return route;\n    }\n};\n\n// public function\nexport const metro = function(vertices, opt, linkView) {\n\n    if (!util.isFunction(manhattan)) {\n        throw new Error('Metro requires the manhattan router.');\n    }\n\n    return manhattan(vertices, util.assign({}, config, opt), linkView);\n};\n\n","import * as g from '../g/index.mjs';\n\nconst Directions = {\n    AUTO: 'auto',\n    LEFT: 'left',\n    RIGHT: 'right',\n    TOP: 'top',\n    BOTTOM: 'bottom',\n    ANCHOR_SIDE: 'anchor-side',\n    MAGNET_SIDE: 'magnet-side'\n};\n\nconst DEFINED_DIRECTIONS = [Directions.LEFT, Directions.RIGHT, Directions.TOP, Directions.BOTTOM];\n\nfunction getDirectionForLinkConnection(linkOrigin, connectionPoint, linkView) {\n    const tangent = linkView.getTangentAtLength(linkView.getClosestPointLength(connectionPoint));\n    const roundedAngle = Math.round(tangent.angle() / 90) * 90;\n\n    switch (roundedAngle) {\n        case 0:\n        case 360:\n            return linkOrigin.y < connectionPoint.y ? Directions.TOP : Directions.BOTTOM;\n        case 90:\n            return linkOrigin.x < connectionPoint.x ? Directions.LEFT : Directions.RIGHT;\n        case 180:\n            return linkOrigin.y < connectionPoint.y ? Directions.TOP : Directions.BOTTOM;\n        case 270:\n            return linkOrigin.x < connectionPoint.x ? Directions.LEFT : Directions.RIGHT;\n    }\n}\n\nfunction rightAngleRouter(_vertices, opt, linkView) {\n    const margin = opt.margin || 20;\n    let { sourceDirection = Directions.AUTO, targetDirection = Directions.AUTO } = opt;\n\n    const sourceView = linkView.sourceView;\n    const targetView = linkView.targetView;\n\n    const isSourcePort = !!linkView.model.source().port;\n    const isTargetPort = !!linkView.model.target().port;\n\n    if (sourceDirection === Directions.AUTO) {\n        sourceDirection = isSourcePort ? Directions.MAGNET_SIDE : Directions.ANCHOR_SIDE;\n    }\n\n    if (targetDirection === Directions.AUTO) {\n        targetDirection = isTargetPort ? Directions.MAGNET_SIDE : Directions.ANCHOR_SIDE;\n    }\n\n    const sourceBBox = linkView.sourceBBox;\n    const targetBBox = linkView.targetBBox;\n    const sourcePoint = linkView.sourceAnchor;\n    const targetPoint = linkView.targetAnchor;\n    let {\n        x: sx0,\n        y: sy0,\n        width: sourceWidth = 0,\n        height: sourceHeight = 0\n    } = sourceView && sourceView.model.isElement() ? g.Rect.fromRectUnion(sourceBBox, sourceView.model.getBBox()) : linkView.sourceAnchor;\n\n    let {\n        x: tx0,\n        y: ty0,\n        width: targetWidth = 0,\n        height: targetHeight = 0\n    } = targetView && targetView.model.isElement() ? g.Rect.fromRectUnion(targetBBox, targetView.model.getBBox()) : linkView.targetAnchor;\n\n    const tx1 = tx0 + targetWidth;\n    const ty1 = ty0 + targetHeight;\n    const sx1 = sx0 + sourceWidth;\n    const sy1 = sy0 + sourceHeight;\n\n    // Key coordinates including the margin\n    const smx0 = sx0 - margin;\n    const smx1 = sx1 + margin;\n    const smy0 = sy0 - margin;\n    const smy1 = sy1 + margin;\n    const tmx0 = tx0 - margin;\n    const tmx1 = tx1 + margin;\n    const tmy0 = ty0 - margin;\n    const tmy1 = ty1 + margin;\n\n    const sourceOutsidePoint = sourcePoint.clone();\n\n    let sourceSide;\n\n    if (!sourceView) {\n        const sourceLinkAnchorBBox = new g.Rect(sx0, sy0, 0, 0);\n        sourceSide = DEFINED_DIRECTIONS.includes(sourceDirection) ? sourceDirection : sourceLinkAnchorBBox.sideNearestToPoint(targetPoint);\n    } else if (sourceView.model.isLink()) {\n        sourceSide = getDirectionForLinkConnection(targetPoint, sourcePoint, sourceView);\n    } else if (sourceDirection === Directions.ANCHOR_SIDE) {\n        sourceSide = sourceBBox.sideNearestToPoint(sourcePoint);\n    } else if (sourceDirection === Directions.MAGNET_SIDE) {\n        sourceSide = sourceView.model.getBBox().sideNearestToPoint(sourcePoint);\n    } else {\n        sourceSide = sourceDirection;\n    }\n\n    switch (sourceSide) {\n        case 'left':\n            sourceOutsidePoint.x = smx0;\n            break;\n        case 'right':\n            sourceOutsidePoint.x = smx1;\n            break;\n        case 'top':\n            sourceOutsidePoint.y = smy0;\n            break;\n        case 'bottom':\n            sourceOutsidePoint.y = smy1;\n            break;\n    }\n    const targetOutsidePoint = targetPoint.clone();\n\n\n    let targetSide;\n\n\n    if (!targetView) {\n        const targetLinkAnchorBBox = new g.Rect(tx0, ty0, 0, 0);\n        targetSide = DEFINED_DIRECTIONS.includes(targetDirection) ? targetDirection : targetLinkAnchorBBox.sideNearestToPoint(sourcePoint);\n    } else if (targetView.model.isLink()) {\n        targetSide = getDirectionForLinkConnection(sourcePoint, targetPoint, targetView);\n    } else if (targetDirection === Directions.ANCHOR_SIDE) {\n        targetSide = targetBBox.sideNearestToPoint(targetPoint);\n    } else if (targetDirection === Directions.MAGNET_SIDE) {\n        targetSide = targetView.model.getBBox().sideNearestToPoint(targetPoint);\n    } else {\n        targetSide = targetDirection;\n    }\n\n    switch (targetSide) {\n        case 'left':\n            targetOutsidePoint.x = tmx0;\n            break;\n        case 'right':\n            targetOutsidePoint.x = tmx1;\n            break;\n        case 'top':\n            targetOutsidePoint.y = tmy0;\n            break;\n        case 'bottom':\n            targetOutsidePoint.y = tmy1;\n            break;\n    }\n\n    const { x: sox, y: soy } = sourceOutsidePoint;\n    const { x: tox, y: toy } = targetOutsidePoint;\n    const tcx = (tx0 + tx1) / 2;\n    const tcy = (ty0 + ty1) / 2;\n    const scx = (sx0 + sx1) / 2;\n    const scy = (sy0 + sy1) / 2;\n    const middleOfVerticalSides = (scx < tcx ? (sx1 + tx0) : (tx1 + sx0)) / 2;\n    const middleOfHorizontalSides = (scy < tcy ? (sy1 + ty0) : (ty1 + sy0)) / 2;\n\n    if (sourceSide === 'left' && targetSide === 'right') {\n        if (smx0 <= tx1) {\n            let y = middleOfHorizontalSides;\n            if (sx1 <= tx0) {\n                if (ty1 >= smy0 && toy < soy) {\n                    y = Math.min(tmy0, smy0);\n                } else if (ty0 <= smy1 && toy >= soy) {\n                    y = Math.max(tmy1, smy1);\n                }\n            }\n            return [\n                { x: sox, y: soy },\n                { x: sox, y },\n                { x: tox, y },\n                { x: tox, y: toy }\n            ];\n        }\n\n        const x = (sox + tox) / 2;\n        return [\n            { x, y: soy },\n            { x, y: toy }\n        ];\n    } else if (sourceSide === 'right' && targetSide === 'left') {\n        if (smx1 >= tx0) {\n            let y = middleOfHorizontalSides;\n            if (sox > tx1) {\n                if (ty1 >= smy0 && toy < soy) {\n                    y = Math.min(tmy0, smy0);\n                } else if (ty0 <= smy1 && toy >= soy) {\n                    y = Math.max(tmy1, smy1);\n                }\n            }\n\n            return [\n                { x: sox, y: soy },\n                { x: sox, y },\n                { x: tox, y },\n                { x: tox, y: toy }\n            ];\n        }\n\n        const x = (sox + tox) / 2;\n        return [\n            { x, y: soy },\n            { x, y: toy }\n        ];\n    } else if (sourceSide === 'top' && targetSide === 'bottom') {\n        if (soy < toy) {\n            let x = middleOfVerticalSides;\n            let y = soy;\n\n            if (soy < ty0) {\n                if (tx1 >= smx0 && tox < sox) {\n                    x = Math.min(tmx0, smx0);\n                } else if (tx0 <= smx1 && tox >= sox) {\n                    x = Math.max(tmx1, smx1);\n                }\n            }\n\n            return [\n                { x: sox, y },\n                { x, y },\n                { x, y: toy },\n                { x: tox, y: toy }\n            ];\n        }\n        const y = (soy + toy) / 2;\n        return [\n            { x: sox, y },\n            { x: tox, y }\n        ];\n    } else if (sourceSide === 'bottom' && targetSide === 'top') {\n        if (soy - margin > toy) {\n            let x = middleOfVerticalSides;\n            let y = soy;\n\n            if (soy > ty1) {\n                if (tx1 >= smx0 && tox < sox) {\n                    x = Math.min(tmx0, smx0);\n                } else if (tx0 <= smx1 && tox >= sox) {\n                    x = Math.max(tmx1, smx1);\n                }\n            }\n\n            return [\n                { x: sox, y },\n                { x, y },\n                { x, y: toy },\n                { x: tox, y: toy }\n            ];\n        }\n        const y = (soy + toy) / 2;\n        return [\n            { x: sox, y },\n            { x: tox, y }\n        ];\n    } else if (sourceSide === 'top' && targetSide === 'top') {\n        let x;\n        let y1 = Math.min((sy1 + ty0) / 2, toy);\n        let y2 = Math.min((sy0 + ty1) / 2, soy);\n\n        if (toy < soy) {\n            if (sox >= tmx1 || sox <= tmx0) {\n                return [\n                    { x: sox, y: Math.min(soy,toy) },\n                    { x: tox, y: Math.min(soy,toy) }\n                ];\n            } else if (tox > sox) {\n                x = Math.min(sox, tmx0);\n            } else {\n                x = Math.max(sox, tmx1);\n            }\n        } else {\n            if (tox >= smx1 || tox <= smx0) {\n                return [\n                    { x: sox, y: Math.min(soy,toy) },\n                    { x: tox, y: Math.min(soy,toy) }\n                ];\n            } else if (tox >= sox) {\n                x = Math.max(tox, smx1);\n            } else {\n                x = Math.min(tox, smx0);\n            }\n        }\n\n        return [\n            { x: sox, y: y2 },\n            { x, y: y2 },\n            { x, y: y1 },\n            { x: tox, y: y1 }\n        ];\n    } else if (sourceSide === 'bottom' && targetSide === 'bottom') {\n        if (tx0 >= sox + margin || tx1 <= sox - margin) {\n            return [\n                { x: sox, y: Math.max(soy, toy) },\n                { x: tox, y: Math.max(soy, toy) }\n            ];\n        }\n\n        let x;\n        let y1;\n        let y2;\n\n        if (toy > soy) {\n            y1 = Math.max((sy1 + ty0) / 2, toy);\n            y2 = Math.max((sy1 + ty0) / 2, soy);\n\n            if (tox > sox) {\n                x = Math.min(sox, tmx0);\n            } else {\n                x = Math.max(sox, tmx1);\n            }\n        } else {\n            y1 = Math.max((sy0 + ty1) / 2, toy);\n            y2 = Math.max((sy0 + ty1) / 2, soy);\n\n            if (tox > sox) {\n                x = Math.min(tox, smx0);\n            } else {\n                x = Math.max(tox, smx1);\n            }\n        }\n\n        return [\n            { x: sox, y: y2 },\n            { x, y: y2 },\n            { x, y: y1 },\n            { x: tox, y: y1 }\n        ];\n    } else if (sourceSide === 'left' && targetSide === 'left') {\n        let y;\n        let x1 = Math.min((sx1 + tx0) / 2, tox);\n        let x2 = Math.min((sx0 + tx1) / 2, sox);\n\n        if (tox > sox) {\n            if (toy <= soy) {\n                y = Math.min(smy0, toy);\n            } else {\n                y = Math.max(smy1, toy);\n            }\n        } else {\n            if (toy >= soy) {\n                y = Math.min(tmy0, soy);\n            } else {\n                y = Math.max(tmy1, soy);\n            }\n        }\n\n        return [\n            { x: x2, y: soy },\n            { x: x2, y },\n            { x: x1, y },\n            { x: x1, y: toy }\n        ];\n    } else if (sourceSide === 'right' && targetSide === 'right') {\n        let y;\n        let x1 = Math.max((sx0 + tx1) / 2, tox);\n        let x2 = Math.max((sx1 + tx0) / 2, sox);\n\n        if (tox < sox) {\n            if (toy <= soy) {\n                y = Math.min(smy0, toy);\n            } else {\n                y = Math.max(smy1, toy);\n            }\n        } else {\n            if (toy >= soy) {\n                y = Math.min(tmy0, soy);\n            } else {\n                y = Math.max(tmy1, soy);\n            }\n        }\n\n        return [\n            { x: x2, y: soy },\n            { x: x2, y },\n            { x: x1, y },\n            { x: x1, y: toy }\n        ];\n    } else if (sourceSide === 'top' && targetSide === 'right') {\n        if (soy > toy) {\n            if (sox < tox) {\n                let y = (sy0 + ty1) / 2;\n                if (y > tcy && y < tmy1 && sox < tmx0) {\n                    y = tmy0;\n                }\n                return [\n                    { x: sox, y },\n                    { x: tox, y },\n                    { x: tox, y: toy }\n                ];\n            }\n            return [{ x: sox, y: toy }];\n        }\n\n        const x = (sx0 + tx1) / 2;\n\n        if (sox > tox && sy1 >= toy) {\n            return [\n                { x: sox, y: soy },\n                { x, y: soy },\n                { x, y: toy }];\n        }\n\n        if (x > smx0 && soy < ty1) {\n            const y = Math.min(sy0, ty0) - margin;\n            const x = Math.max(sx1, tx1) + margin;\n            return [\n                { x: sox, y },\n                { x, y },\n                { x, y: toy }\n            ];\n        }\n        return [\n            { x: sox, y: soy },\n            { x, y: soy },\n            { x, y: toy }\n        ];\n    } else if (sourceSide === 'top' && targetSide === 'left') {\n        if (soy > toy) {\n            if (sox > tox) {\n                let y = (sy0 + ty1) / 2;\n                if (y > tcy && y < tmy1 && sox > tmx1) {\n                    y = tmy0;\n                }\n                return [\n                    { x: sox, y },\n                    { x: tox, y },\n                    { x: tox, y: toy }\n                ];\n            }\n            return [{ x: sox, y: toy }];\n        }\n\n        const x = (sx1 + tx0) / 2;\n\n        if (sox < tox && sy1 >= toy) {\n            return [\n                { x: sox, y: soy },\n                { x, y: soy },\n                { x, y: toy }];\n        }\n\n        if (x < smx1 && soy < ty1) {\n            const y = Math.min(sy0, ty0) - margin;\n            const x = Math.min(sx0, tx0) - margin;\n            return [\n                { x: sox, y },\n                { x, y },\n                { x, y: toy }\n            ];\n        }\n        return [\n            { x: sox, y: soy },\n            { x, y: soy },\n            { x, y: toy }\n        ];\n    } else if (sourceSide === 'bottom' && targetSide === 'right') {\n        if (soy < toy) {\n            if (sox < tox) {\n                let y = (sy1 + ty0) / 2;\n                if (y < tcy && y > tmy0 && sox < tmx0) {\n                    y = tmy1;\n                }\n                return [\n                    { x: sox, y },\n                    { x: tox, y },\n                    { x: tox, y: toy }\n                ];\n            }\n            return [{ x: sox, y: toy }];\n        } else {\n            if (sx0 < tox) {\n                const y = Math.max(sy1, ty1) + margin;\n                const x = Math.max(sx1, tx1) + margin;\n                return [\n                    { x: sox, y },\n                    { x, y },\n                    { x, y: toy }\n                ];\n            }\n        }\n\n        const x = middleOfVerticalSides;\n\n        return [\n            { x: sox, y: soy },\n            { x, y: soy },\n            { x, y: toy }\n        ];\n    } else if (sourceSide === 'bottom' && targetSide === 'left') {\n        if (soy < toy) {\n            if (sox > tox) {\n                let y = (sy1 + ty0) / 2;\n                if (y < tcy && y > tmy0 && sox > tmx1) {\n                    y = tmy1;\n                }\n                return [\n                    { x: sox, y },\n                    { x: tox, y },\n                    { x: tox, y: toy }\n                ];\n            }\n            return [{ x: sox, y: toy }];\n        } else {\n            if (sx1 > tox) {\n                const y = Math.max(sy1, ty1) + margin;\n                const x = Math.min(sx0, tx0) - margin;\n                return [\n                    { x: sox, y },\n                    { x, y },\n                    { x, y: toy }\n                ];\n            }\n        }\n\n        const x = middleOfVerticalSides;\n\n        return [\n            { x: sox, y: soy },\n            { x, y: soy },\n            { x, y: toy }\n        ];\n    } else if (sourceSide === 'left' && targetSide === 'bottom') {\n        if (sox > tox && soy >= tmy1) {\n            return [{ x: tox, y: soy }];\n        }\n\n        if (sox >= tx1 && soy < toy) {\n            const x = (sx1 + tx0) / 2;\n            return [\n                { x, y: soy },\n                { x, y: toy },\n                { x: tox, y: toy }\n            ];\n        }\n\n        if (tox < sx1 && ty1 <= sy0) {\n            const y = (sy0 + ty1) / 2;\n\n            return [\n                { x: sox, y: soy },\n                { x: sox, y },\n                { x: tox, y }\n            ];\n        }\n\n        const x = Math.min(tmx0, sox);\n        const y = Math.max(sy1, ty1) + margin;\n\n        return [\n            { x, y: soy },\n            { x, y },\n            { x: tox, y }\n        ];\n    } else if (sourceSide === 'left' && targetSide === 'top') {\n        if (sox > tox && soy < tmy0) {\n            return [{ x: tox, y: soy }];\n        }\n\n        if (sox >= tx1) {\n            if (soy > toy) {\n                const x = (sx0 + tx1) / 2;\n                return [\n                    { x, y: soy },\n                    { x, y: toy },\n                    { x: tox, y: toy }\n                ];\n            }\n        }\n\n        if (tox <= sx1 && toy > soy) {\n            const y = (ty0 + sy1) / 2;\n\n            return [\n                { x: sox, y: soy },\n                { x: sox, y },\n                { x: tox, y },\n            ];\n        }\n\n        const x = toy < soy ? Math.min(sx0, tx0) - margin : smx0;\n        const y = Math.min(sy0, ty0) - margin;\n\n        return [\n            { x, y: soy },\n            { x, y },\n            { x: tox, y }\n        ];\n\n    } else if (sourceSide === 'right' && targetSide === 'top') {\n        if (sox < tox && soy < tmy0) {\n            return [{ x: tox, y: soy }];\n        }\n\n        if (sx1 < tx0 && soy > toy) {\n            let x = (sx1 + tx0) / 2;\n            return [\n                { x, y: soy },\n                { x, y: toy },\n                { x: tox, y: toy }\n            ];\n        }\n\n        if (tox < sox && ty0 > sy1) {\n            const y = (sy1 + ty0) / 2;\n\n            return [\n                { x: sox, y: soy },\n                { x: sox, y },\n                { x: tox, y }\n            ];\n        }\n\n        const x = Math.max(sx1, tx1) + margin;\n        const y = Math.min(sy0, ty0) - margin;\n        return [\n            { x, y: soy },\n            { x, y },\n            { x: tox, y }\n        ];\n    } else if (sourceSide === 'right' && targetSide === 'bottom') {\n        if (sox < tox && soy >= tmy1) {\n            return [{ x: tox, y: soy }];\n        }\n\n        if (sox <= tx0 && soy < toy) {\n            const x = (sx1 + tx0) / 2;\n            return [\n                { x, y: soy },\n                { x, y: toy },\n                { x: tox, y: toy }\n            ];\n        }\n\n        if (tox > sx0 && ty1 < sy0) {\n            const y = (sy0 + ty1) / 2;\n\n            return [\n                { x: sox, y: soy },\n                { x: sox, y },\n                { x: tox, y }\n            ];\n        }\n\n        const x = Math.max(tmx1, sox);\n        const y = Math.max(sy1, ty1) + margin;\n\n        return [\n            { x, y: soy },\n            { x, y },\n            { x: tox, y }\n        ];\n    }\n}\n\nrightAngleRouter.Directions = Directions;\n\nexport const rightAngle = rightAngleRouter;\n","import * as g from '../g/index.mjs';\n\nconst CornerTypes = {\n    POINT: 'point',\n    CUBIC: 'cubic',\n    LINE: 'line',\n    GAP: 'gap'\n};\n\nconst DEFINED_CORNER_TYPES = Object.values(CornerTypes);\n\nconst CORNER_RADIUS = 10;\nconst PRECISION = 1;\n\nexport const straight = function(sourcePoint, targetPoint, routePoints = [], opt = {}) {\n\n    const {\n        cornerType = CornerTypes.POINT,\n        cornerRadius = CORNER_RADIUS,\n        cornerPreserveAspectRatio = false,\n        precision = PRECISION,\n        raw = false\n    } = opt;\n\n    if (DEFINED_CORNER_TYPES.indexOf(cornerType) === -1) {\n        // unknown `cornerType` provided => error\n        throw new Error('Invalid `cornerType` provided to `straight` connector.');\n    }\n\n    let path;\n\n    if ((cornerType === CornerTypes.POINT) || !cornerRadius) {\n        // default option => normal connector\n        // simply connect all points with straight lines\n        const points = [sourcePoint].concat(routePoints).concat([targetPoint]);\n        const polyline = new g.Polyline(points);\n        path = new g.Path(polyline);\n\n    } else {\n        // `cornerType` is not unknown and not 'point' (default) => must be one of other valid types\n        path = new g.Path();\n\n        // add initial gap segment = to source point\n        path.appendSegment(g.Path.createSegment('M', sourcePoint));\n\n        let nextDistance;\n        const routePointsLength = routePoints.length;\n        for (let i = 0; i < routePointsLength; i++) {\n\n            const curr = new g.Point(routePoints[i]);\n            const prev = (routePoints[i - 1] || sourcePoint);\n            const next = (routePoints[i + 1] || targetPoint);\n            const prevDistance = (nextDistance || (curr.distance(prev) / 2)); // try to re-use previously-computed `nextDistance`\n            nextDistance = (curr.distance(next) / 2);\n\n            let startMove, endMove;\n            if (!cornerPreserveAspectRatio) {\n                // `startMove` and `endMove` may be different\n                // (this happens when next or previous path point is closer than `2 * cornerRadius`)\n                startMove = -Math.min(cornerRadius, prevDistance);\n                endMove = -Math.min(cornerRadius, nextDistance);\n            } else {\n                // force `startMove` and `endMove` to be the same\n                startMove = endMove = -Math.min(cornerRadius, prevDistance, nextDistance);\n            }\n\n            // to find `cornerStart` and `cornerEnd`, the logic is as follows (using `cornerStart` as example):\n            // - find a point lying on the line `prev - startMove` such that...\n            // - ...the point lies `abs(startMove)` distance away from `curr`...\n            // - ...and its coordinates are rounded to whole numbers\n            const cornerStart = curr.clone().move(prev, startMove).round(precision);\n            const cornerEnd = curr.clone().move(next, endMove).round(precision);\n\n            // add in-between straight segment = from previous route point to corner start point\n            // (may have zero length)\n            path.appendSegment(g.Path.createSegment('L', cornerStart));\n\n            // add corner segment = from corner start point to corner end point\n            switch (cornerType) {\n                case CornerTypes.CUBIC: {\n                    // corner is rounded\n                    const _13 = (1 / 3);\n                    const _23 = (2 / 3);\n                    const control1 = new g.Point((_13 * cornerStart.x) + (_23 * curr.x), (_23 * curr.y) + (_13 * cornerStart.y));\n                    const control2 = new g.Point((_13 * cornerEnd.x) + (_23 * curr.x), (_23 * curr.y) + (_13 * cornerEnd.y));\n                    path.appendSegment(g.Path.createSegment('C', control1, control2, cornerEnd));\n                    break;\n                }\n                case CornerTypes.LINE: {\n                    // corner has bevel\n                    path.appendSegment(g.Path.createSegment('L', cornerEnd));\n                    break;\n                }\n                case CornerTypes.GAP: {\n                    // corner has empty space\n                    path.appendSegment(g.Path.createSegment('M', cornerEnd));\n                    break;\n                }\n                // default: no segment is created\n            }\n        }\n\n        // add final straight segment = from last corner end point to target point\n        // (= or from start point to end point, if there are no route points)\n        // (may have zero length)\n        path.appendSegment(g.Path.createSegment('L', targetPoint));\n    }\n\n    return ((raw) ? path : path.serialize());\n};\n","import * as util from '../util/index.mjs';\nimport * as g from '../g/index.mjs';\n\n// default size of jump if not specified in options\nvar JUMP_SIZE = 5;\n\n// available jump types\n// first one taken as default\nvar JUMP_TYPES = ['arc', 'gap', 'cubic'];\n\n// default radius\nvar RADIUS = 0;\n\n// takes care of math. error for case when jump is too close to end of line\nvar CLOSE_PROXIMITY_PADDING = 1;\n\n// list of connector types not to jump over.\nvar IGNORED_CONNECTORS = ['smooth'];\n\n// internal constants for round segment\nvar _13 = 1 / 3;\nvar _23 = 2 / 3;\n\nfunction sortPointsAscending(p1, p2) {\n\n    let { x: x1, y: y1 } = p1;\n    let { x: x2, y: y2 } = p2;\n\n    if (x1 > x2) {\n\n        let swap = x1;\n        x1 = x2;\n        x2 = swap;\n\n        swap = y1;\n        y1 = y2;\n        y2 = swap;\n    }\n\n    if (y1 > y2) {\n        let swap = x1;\n        x1 = x2;\n        x2 = swap;\n\n        swap = y1;\n        y1 = y2;\n        y2 = swap;\n    }\n\n    return [new g.Point(x1, y1), new g.Point(x2, y2)];\n}\n\nfunction overlapExists(line1, line2) {\n\n    const [{ x: x1, y: y1 }, { x: x2, y: y2 }] = sortPointsAscending(line1.start, line1.end);\n    const [{ x: x3, y: y3 }, { x: x4, y: y4 }] = sortPointsAscending(line2.start, line2.end);\n\n    const xMatch = x1 <= x4 && x3 <= x2;\n    const yMatch = y1 <= y4 && y3 <= y2;\n\n    return xMatch && yMatch;\n}\n\n/**\n * Transform start/end and route into series of lines\n * @param {g.point} sourcePoint start point\n * @param {g.point} targetPoint end point\n * @param {g.point[]} route optional list of route\n * @return {g.line[]} [description]\n */\nfunction createLines(sourcePoint, targetPoint, route) {\n    // make a flattened array of all points\n    var points = [].concat(sourcePoint, route, targetPoint);\n    return points.reduce(function(resultLines, point, idx) {\n        // if there is a next point, make a line with it\n        var nextPoint = points[idx + 1];\n        if (nextPoint != null) {\n            resultLines[idx] = g.line(point, nextPoint);\n        }\n        return resultLines;\n    }, []);\n}\n\nfunction setupUpdating(jumpOverLinkView) {\n    var paper = jumpOverLinkView.paper;\n    var updateList = paper._jumpOverUpdateList;\n\n    // first time setup for this paper\n    if (updateList == null) {\n        updateList = paper._jumpOverUpdateList = [];\n        var graph = paper.model;\n        graph.on('batch:stop', function() {\n            if (this.hasActiveBatch()) return;\n            updateJumpOver(paper);\n        });\n        graph.on('reset', function() {\n            updateList = paper._jumpOverUpdateList = [];\n        });\n    }\n\n    // add this link to a list so it can be updated when some other link is updated\n    if (updateList.indexOf(jumpOverLinkView) < 0) {\n        updateList.push(jumpOverLinkView);\n\n        // watch for change of connector type or removal of link itself\n        // to remove the link from a list of jump over connectors\n        jumpOverLinkView.listenToOnce(jumpOverLinkView.model, 'change:connector remove', function() {\n            updateList.splice(updateList.indexOf(jumpOverLinkView), 1);\n        });\n    }\n}\n\n/**\n * Handler for a batch:stop event to force\n * update of all registered links with jump over connector\n * @param {object} batchEvent optional object with info about batch\n */\nfunction updateJumpOver(paper) {\n    var updateList = paper._jumpOverUpdateList;\n    for (var i = 0; i < updateList.length; i++) {\n        const linkView = updateList[i];\n        const updateFlag = linkView.getFlag(linkView.constructor.Flags.CONNECTOR);\n        linkView.requestUpdate(updateFlag);\n    }\n}\n\n/**\n * Utility function to collect all intersection points of a single\n * line against group of other lines.\n * @param {g.line} line where to find points\n * @param {g.line[]} crossCheckLines lines to cross\n * @return {g.point[]} list of intersection points\n */\nfunction findLineIntersections(line, crossCheckLines) {\n    return util.toArray(crossCheckLines).reduce(function(res, crossCheckLine) {\n        var intersection = line.intersection(crossCheckLine);\n        if (intersection) {\n            res.push(intersection);\n        }\n        return res;\n    }, []);\n}\n\n/**\n * Sorting function for list of points by their distance.\n * @param {g.point} p1 first point\n * @param {g.point} p2 second point\n * @return {number} squared distance between points\n */\nfunction sortPoints(p1, p2) {\n    return g.line(p1, p2).squaredLength();\n}\n\n/**\n * Split input line into multiple based on intersection points.\n * @param {g.line} line input line to split\n * @param {g.point[]} intersections points where to split the line\n * @param {number} jumpSize the size of jump arc (length empty spot on a line)\n * @return {g.line[]} list of lines being split\n */\nfunction createJumps(line, intersections, jumpSize) {\n    return intersections.reduce(function(resultLines, point, idx) {\n        // skipping points that were merged with the previous line\n        // to make bigger arc over multiple lines that are close to each other\n        if (point.skip === true) {\n            return resultLines;\n        }\n\n        // always grab the last line from buffer and modify it\n        var lastLine = resultLines.pop() || line;\n\n        // calculate start and end of jump by moving by a given size of jump\n        var jumpStart = g.point(point).move(lastLine.start, -(jumpSize));\n        var jumpEnd = g.point(point).move(lastLine.start, +(jumpSize));\n\n        // now try to look at the next intersection point\n        var nextPoint = intersections[idx + 1];\n        if (nextPoint != null) {\n            var distance = jumpEnd.distance(nextPoint);\n            if (distance <= jumpSize) {\n                // next point is close enough, move the jump end by this\n                // difference and mark the next point to be skipped\n                jumpEnd = nextPoint.move(lastLine.start, distance);\n                nextPoint.skip = true;\n            }\n        } else {\n            // this block is inside of `else` as an optimization so the distance is\n            // not calculated when we know there are no other intersection points\n            var endDistance = jumpStart.distance(lastLine.end);\n            // if the end is too close to possible jump, draw remaining line instead of a jump\n            if (endDistance < jumpSize * 2 + CLOSE_PROXIMITY_PADDING) {\n                resultLines.push(lastLine);\n                return resultLines;\n            }\n        }\n\n        var startDistance = jumpEnd.distance(lastLine.start);\n        if (startDistance < jumpSize * 2 + CLOSE_PROXIMITY_PADDING) {\n            // if the start of line is too close to jump, draw that line instead of a jump\n            resultLines.push(lastLine);\n            return resultLines;\n        }\n\n        // finally create a jump line\n        var jumpLine = g.line(jumpStart, jumpEnd);\n        // it's just simple line but with a `isJump` property\n        jumpLine.isJump = true;\n\n        resultLines.push(\n            g.line(lastLine.start, jumpStart),\n            jumpLine,\n            g.line(jumpEnd, lastLine.end)\n        );\n        return resultLines;\n    }, []);\n}\n\n/**\n * Assemble `D` attribute of a SVG path by iterating given lines.\n * @param {g.line[]} lines source lines to use\n * @param {number} jumpSize the size of jump arc (length empty spot on a line)\n * @param {number} radius the radius\n * @return {string}\n */\nfunction buildPath(lines, jumpSize, jumpType, radius) {\n\n    var path = new g.Path();\n    var segment;\n\n    // first move to the start of a first line\n    segment = g.Path.createSegment('M', lines[0].start);\n    path.appendSegment(segment);\n\n    // make a paths from lines\n    util.toArray(lines).forEach(function(line, index) {\n\n        if (line.isJump) {\n            var angle, diff;\n\n            var control1, control2;\n\n            if (jumpType === 'arc') { // approximates semicircle with 2 curves\n                angle = -90;\n                // determine rotation of arc based on difference between points\n                diff = line.start.difference(line.end);\n                // make sure the arc always points up (or right)\n                var xAxisRotate = Number((diff.x < 0) || (diff.x === 0 && diff.y < 0));\n                if (xAxisRotate) angle += 180;\n\n                var midpoint = line.midpoint();\n                var centerLine = new g.Line(midpoint, line.end).rotate(midpoint, angle);\n\n                var halfLine;\n\n                // first half\n                halfLine = new g.Line(line.start, midpoint);\n\n                control1 = halfLine.pointAt(2 / 3).rotate(line.start, angle);\n                control2 = centerLine.pointAt(1 / 3).rotate(centerLine.end, -angle);\n\n                segment = g.Path.createSegment('C', control1, control2, centerLine.end);\n                path.appendSegment(segment);\n\n                // second half\n                halfLine = new g.Line(midpoint, line.end);\n\n                control1 = centerLine.pointAt(1 / 3).rotate(centerLine.end, angle);\n                control2 = halfLine.pointAt(1 / 3).rotate(line.end, -angle);\n\n                segment = g.Path.createSegment('C', control1, control2, line.end);\n                path.appendSegment(segment);\n\n            } else if (jumpType === 'gap') {\n                segment = g.Path.createSegment('M', line.end);\n                path.appendSegment(segment);\n\n            } else if (jumpType === 'cubic') { // approximates semicircle with 1 curve\n                angle = line.start.theta(line.end);\n\n                var xOffset = jumpSize * 0.6;\n                var yOffset = jumpSize * 1.35;\n\n                // determine rotation of arc based on difference between points\n                diff = line.start.difference(line.end);\n                // make sure the arc always points up (or right)\n                xAxisRotate = Number((diff.x < 0) || (diff.x === 0 && diff.y < 0));\n                if (xAxisRotate) yOffset *= -1;\n\n                control1 = g.Point(line.start.x + xOffset, line.start.y + yOffset).rotate(line.start, angle);\n                control2 = g.Point(line.end.x - xOffset, line.end.y + yOffset).rotate(line.end, angle);\n\n                segment = g.Path.createSegment('C', control1, control2, line.end);\n                path.appendSegment(segment);\n            }\n\n        } else {\n            var nextLine = lines[index + 1];\n            if (radius == 0 || !nextLine || nextLine.isJump) {\n                segment = g.Path.createSegment('L', line.end);\n                path.appendSegment(segment);\n            } else {\n                buildRoundedSegment(radius, path, line.end, line.start, nextLine.end);\n            }\n        }\n    });\n\n    return path;\n}\n\nfunction buildRoundedSegment(offset, path, curr, prev, next) {\n    var prevDistance = curr.distance(prev) / 2;\n    var nextDistance = curr.distance(next) / 2;\n\n    var startMove = -Math.min(offset, prevDistance);\n    var endMove = -Math.min(offset, nextDistance);\n\n    var roundedStart = curr.clone().move(prev, startMove).round();\n    var roundedEnd = curr.clone().move(next, endMove).round();\n\n    var control1 = new g.Point((_13 * roundedStart.x) + (_23 * curr.x), (_23 * curr.y) + (_13 * roundedStart.y));\n    var control2 = new g.Point((_13 * roundedEnd.x) + (_23 * curr.x), (_23 * curr.y) + (_13 * roundedEnd.y));\n\n    var segment;\n    segment = g.Path.createSegment('L', roundedStart);\n    path.appendSegment(segment);\n\n    segment = g.Path.createSegment('C', control1, control2, roundedEnd);\n    path.appendSegment(segment);\n}\n\n/**\n * Actual connector function that will be run on every update.\n * @param {g.point} sourcePoint start point of this link\n * @param {g.point} targetPoint end point of this link\n * @param {g.point[]} route of this link\n * @param {object} opt options\n * @property {number} size optional size of a jump arc\n * @return {string} created `D` attribute of SVG path\n */\nexport const jumpover = function(sourcePoint, targetPoint, route, opt) { // eslint-disable-line max-params\n\n    setupUpdating(this);\n\n    var raw = opt.raw;\n    var jumpSize = opt.size || JUMP_SIZE;\n    var jumpType = opt.jump && ('' + opt.jump).toLowerCase();\n    var radius = opt.radius || RADIUS;\n    var ignoreConnectors = opt.ignoreConnectors || IGNORED_CONNECTORS;\n\n    // grab the first jump type as a default if specified one is invalid\n    if (JUMP_TYPES.indexOf(jumpType) === -1) {\n        jumpType = JUMP_TYPES[0];\n    }\n\n    var paper = this.paper;\n    var graph = paper.model;\n    var allLinks = graph.getLinks();\n\n    // there is just one link, draw it directly\n    if (allLinks.length === 1) {\n        return buildPath(\n            createLines(sourcePoint, targetPoint, route),\n            jumpSize, jumpType, radius\n        );\n    }\n\n    var thisModel = this.model;\n    var thisIndex = allLinks.indexOf(thisModel);\n    var defaultConnector = paper.options.defaultConnector || {};\n\n    // not all links are meant to be jumped over.\n    var links = allLinks.filter(function(link, idx) {\n\n        var connector = link.get('connector') || defaultConnector;\n\n        // avoid jumping over links with connector type listed in `ignored connectors`.\n        if (util.toArray(ignoreConnectors).includes(connector.name)) {\n            return false;\n        }\n        // filter out links that are above this one and  have the same connector type\n        // otherwise there would double hoops for each intersection\n        if (idx > thisIndex) {\n            return connector.name !== 'jumpover';\n        }\n        return true;\n    });\n\n    // find views for all links\n    var linkViews = links.map(function(link) {\n        return paper.findViewByModel(link);\n    });\n\n    // create lines for this link\n    var thisLines = createLines(\n        sourcePoint,\n        targetPoint,\n        route\n    );\n\n    // create lines for all other links\n    var linkLines = linkViews.map(function(linkView) {\n        if (linkView == null) {\n            return [];\n        }\n        if (linkView === this) {\n            return thisLines;\n        }\n        return createLines(\n            linkView.sourcePoint,\n            linkView.targetPoint,\n            linkView.route\n        );\n    }, this);\n\n    // transform lines for this link by splitting with jump lines at\n    // points of intersection with other links\n    var jumpingLines = thisLines.reduce(function(resultLines, thisLine) {\n        // iterate all links and grab the intersections with this line\n        // these are then sorted by distance so the line can be split more easily\n        var intersections = links.reduce(function(res, link, i) {\n            // don't intersection with itself\n            if (link !== thisModel) {\n\n                const linkLinesToTest = linkLines[i].slice();\n                const overlapIndex = linkLinesToTest.findIndex((line) => overlapExists(thisLine, line));\n\n                // Overlap occurs and the end point of one segment lies on thisLine\n                if (overlapIndex > -1 && thisLine.containsPoint(linkLinesToTest[overlapIndex].end)) {\n                    // Remove the next segment because there will never be a jump\n                    linkLinesToTest.splice(overlapIndex + 1, 1);\n                } \n                const lineIntersections = findLineIntersections(thisLine, linkLinesToTest);\n                res.push.apply(res, lineIntersections);\n            }\n            return res;\n        }, []).sort(function(a, b) {\n            return sortPoints(thisLine.start, a) - sortPoints(thisLine.start, b);\n        });\n\n        if (intersections.length > 0) {\n            // split the line based on found intersection points\n            resultLines.push.apply(resultLines, createJumps(thisLine, intersections, jumpSize));\n        } else {\n            // without any intersection the line goes uninterrupted\n            resultLines.push(thisLine);\n        }\n        return resultLines;\n    }, []);\n\n    var path = buildPath(jumpingLines, jumpSize, jumpType, radius);\n    return (raw) ? path : path.serialize();\n};\n","import { straight } from './straight.mjs';\n\nexport const normal = function(sourcePoint, targetPoint, route = [], opt = {}) {\n\n    const { raw } = opt;\n    const localOpt = {\n        cornerType: 'point',\n        raw\n    };\n\n    return straight(sourcePoint, targetPoint, route, localOpt);\n};\n","import { straight } from './straight.mjs';\n\nconst CORNER_RADIUS = 10;\nconst PRECISION = 0;\n\nexport const rounded = function(sourcePoint, targetPoint, route = [], opt = {}) {\n\n    const { radius = CORNER_RADIUS, raw } = opt;\n    const localOpt = {\n        cornerType: 'cubic',\n        cornerRadius: radius,\n        precision: PRECISION,\n        raw\n    };\n\n    return straight(sourcePoint, targetPoint, route, localOpt);\n};\n","import * as g from '../g/index.mjs';\n\nexport const smooth = function(sourcePoint, targetPoint, route, opt) {\n\n    var raw = opt && opt.raw;\n    var path;\n\n    if (route && route.length !== 0) {\n\n        var points = [sourcePoint].concat(route).concat([targetPoint]);\n        var curves = g.Curve.throughPoints(points);\n\n        path = new g.Path(curves);\n\n    } else {\n        // if we have no route, use a default cubic bezier curve\n        // cubic bezier requires two control points\n        // the control points have `x` midway between source and target\n        // this produces an S-like curve\n\n        path = new g.Path();\n\n        var segment;\n\n        segment = g.Path.createSegment('M', sourcePoint);\n        path.appendSegment(segment);\n\n        if ((Math.abs(sourcePoint.x - targetPoint.x)) >= (Math.abs(sourcePoint.y - targetPoint.y))) {\n            var controlPointX = (sourcePoint.x + targetPoint.x) / 2;\n\n            segment = g.Path.createSegment('C', controlPointX, sourcePoint.y, controlPointX, targetPoint.y, targetPoint.x, targetPoint.y);\n            path.appendSegment(segment);\n\n        } else {\n            var controlPointY = (sourcePoint.y + targetPoint.y) / 2;\n\n            segment = g.Path.createSegment('C', sourcePoint.x, controlPointY, targetPoint.x, controlPointY, targetPoint.x, targetPoint.y);\n            path.appendSegment(segment);\n\n        }\n    }\n\n    return (raw) ? path : path.serialize();\n};\n","import { Path, Point, Curve } from '../g/index.mjs';\n\nconst Directions = {\n    AUTO: 'auto',\n    HORIZONTAL: 'horizontal',\n    VERTICAL: 'vertical',\n    CLOSEST_POINT: 'closest-point',\n    OUTWARDS: 'outwards'\n};\n\nconst TangentDirections = {\n    UP: 'up',\n    DOWN: 'down',\n    LEFT: 'left',\n    RIGHT: 'right',\n    AUTO: 'auto',\n    CLOSEST_POINT: 'closest-point',\n    OUTWARDS: 'outwards'\n};\n\nexport const curve = function(sourcePoint, targetPoint, route = [], opt = {}, linkView) {\n    const raw = Boolean(opt.raw);\n    // distanceCoefficient - a coefficient of the tangent vector length relative to the distance between points.\n    // angleTangentCoefficient - a coefficient of the end tangents length in the case of angles larger than 45 degrees.\n    // tension - a Catmull-Rom curve tension parameter.\n    // sourceTangent - a tangent vector along the curve at the sourcePoint.\n    // sourceDirection - a unit direction vector along the curve at the sourcePoint.\n    // targetTangent - a tangent vector along the curve at the targetPoint.\n    // targetDirection - a unit direction vector along the curve at the targetPoint.\n    // precision - a rounding precision for path values.\n    const { direction = Directions.AUTO, precision = 3 } = opt;\n    const options = {\n        coeff: opt.distanceCoefficient || 0.6,\n        angleTangentCoefficient: opt.angleTangentCoefficient || 80,\n        tau: opt.tension || 0.5,\n        sourceTangent: opt.sourceTangent ? new Point(opt.sourceTangent) : null,\n        targetTangent: opt.targetTangent ? new Point(opt.targetTangent) : null,\n        rotate: Boolean(opt.rotate)\n    };\n    if (typeof opt.sourceDirection === 'string')\n        options.sourceDirection = opt.sourceDirection;\n    else if (typeof opt.sourceDirection === 'number')\n        options.sourceDirection = new Point(1, 0).rotate(null, opt.sourceDirection);\n    else\n        options.sourceDirection = opt.sourceDirection ? new Point(opt.sourceDirection).normalize() : null;\n\n    if (typeof opt.targetDirection === 'string')\n        options.targetDirection = opt.targetDirection;\n    else if (typeof opt.targetDirection === 'number')\n        options.targetDirection = new Point(1, 0).rotate(null, opt.targetDirection);\n    else\n        options.targetDirection = opt.targetDirection ? new Point(opt.targetDirection).normalize() : null;\n\n    const completeRoute = [sourcePoint, ...route, targetPoint].map(p => new Point(p));\n\n    // The calculation of a sourceTangent\n    let sourceTangent;\n    if (options.sourceTangent) {\n        sourceTangent = options.sourceTangent;\n    } else {\n        const sourceDirection = getSourceTangentDirection(linkView, completeRoute, direction, options);\n        const tangentLength = completeRoute[0].distance(completeRoute[1]) * options.coeff;\n        const pointsVector = completeRoute[1].difference(completeRoute[0]).normalize();\n        const angle = angleBetweenVectors(sourceDirection, pointsVector);\n        if (angle > Math.PI / 4) {\n            const updatedLength = tangentLength + (angle - Math.PI / 4) * options.angleTangentCoefficient;\n            sourceTangent = sourceDirection.clone().scale(updatedLength, updatedLength);\n        } else {\n            sourceTangent = sourceDirection.clone().scale(tangentLength, tangentLength);\n        }\n    }\n\n    // The calculation of a targetTangent\n    let targetTangent;\n    if (options.targetTangent) {\n        targetTangent = options.targetTangent;\n    } else {\n        const targetDirection = getTargetTangentDirection(linkView, completeRoute, direction, options);\n        const last = completeRoute.length - 1;\n        const tangentLength = completeRoute[last - 1].distance(completeRoute[last]) * options.coeff;\n        const pointsVector = completeRoute[last - 1].difference(completeRoute[last]).normalize();\n        const angle = angleBetweenVectors(targetDirection, pointsVector);\n        if (angle > Math.PI / 4) {\n            const updatedLength = tangentLength + (angle - Math.PI / 4) * options.angleTangentCoefficient;\n            targetTangent = targetDirection.clone().scale(updatedLength, updatedLength);\n        } else {\n            targetTangent = targetDirection.clone().scale(tangentLength, tangentLength);\n        }\n    }\n\n    const catmullRomCurves = createCatmullRomCurves(completeRoute, sourceTangent, targetTangent, options);\n    const bezierCurves = catmullRomCurves.map(curve => catmullRomToBezier(curve, options));\n    const path = new Path(bezierCurves).round(precision);\n\n    return (raw) ? path : path.serialize();\n};\ncurve.Directions = Directions;\ncurve.TangentDirections = TangentDirections;\n\nfunction getHorizontalSourceDirection(linkView, route, options) {\n    const { sourceBBox } = linkView;\n\n    let sourceSide;\n    let rotation;\n    if (!linkView.sourceView) {\n        if (sourceBBox.x > route[1].x)\n            sourceSide = 'right';\n        else\n            sourceSide = 'left';\n    } else {\n        rotation = linkView.sourceView.model.angle();\n        if (options.rotate && rotation) {\n            const unrotatedBBox = linkView.sourceView.getNodeUnrotatedBBox(linkView.sourceView.el);\n            const sourcePoint = route[0].clone();\n            sourcePoint.rotate(sourceBBox.center(), rotation);\n            sourceSide = unrotatedBBox.sideNearestToPoint(sourcePoint);\n        } else {\n            sourceSide = sourceBBox.sideNearestToPoint(route[0]);\n        }\n    }\n\n    let direction;\n    switch (sourceSide) {\n        case 'left':\n            direction = new Point(-1, 0);\n            break;\n        case 'right':\n        default:\n            direction = new Point(1, 0);\n            break;\n    }\n\n    if (options.rotate && rotation) {\n        direction.rotate(null, -rotation);\n    }\n\n    return direction;\n}\n\nfunction getHorizontalTargetDirection(linkView, route, options) {\n    const { targetBBox } = linkView;\n\n    let targetSide;\n    let rotation;\n    if (!linkView.targetView) {\n        if (targetBBox.x > route[route.length - 2].x)\n            targetSide = 'left';\n        else\n            targetSide = 'right';\n    } else {\n        rotation = linkView.targetView.model.angle();\n        if (options.rotate && rotation) {\n            const unrotatedBBox = linkView.targetView.getNodeUnrotatedBBox(linkView.targetView.el);\n            const targetPoint = route[route.length - 1].clone();\n            targetPoint.rotate(targetBBox.center(), rotation);\n            targetSide = unrotatedBBox.sideNearestToPoint(targetPoint);\n        } else {\n            targetSide = targetBBox.sideNearestToPoint(route[route.length - 1]);\n        }\n    }\n\n    let direction;\n    switch (targetSide) {\n        case 'left':\n            direction = new Point(-1, 0);\n            break;\n        case 'right':\n        default:\n            direction = new Point(1, 0);\n            break;\n    }\n\n    if (options.rotate && rotation) {\n        direction.rotate(null, -rotation);\n    }\n\n    return direction;\n}\n\nfunction getVerticalSourceDirection(linkView, route, options) {\n    const { sourceBBox } = linkView;\n\n    let sourceSide;\n    let rotation;\n    if (!linkView.sourceView) {\n        if (sourceBBox.y > route[1].y)\n            sourceSide = 'bottom';\n        else\n            sourceSide = 'top';\n    } else {\n        rotation = linkView.sourceView.model.angle();\n        if (options.rotate && rotation) {\n            const unrotatedBBox = linkView.sourceView.getNodeUnrotatedBBox(linkView.sourceView.el);\n            const sourcePoint = route[0].clone();\n            sourcePoint.rotate(sourceBBox.center(), rotation);\n            sourceSide = unrotatedBBox.sideNearestToPoint(sourcePoint);\n        } else {\n            sourceSide = sourceBBox.sideNearestToPoint(route[0]);\n        }\n    }\n\n    let direction;\n    switch (sourceSide) {\n        case 'top':\n            direction = new Point(0, -1);\n            break;\n        case 'bottom':\n        default:\n            direction = new Point(0, 1);\n            break;\n    }\n\n    if (options.rotate && rotation) {\n        direction.rotate(null, -rotation);\n    }\n\n    return direction;\n}\n\nfunction getVerticalTargetDirection(linkView, route, options) {\n    const { targetBBox } = linkView;\n\n    let targetSide;\n    let rotation;\n    if (!linkView.targetView) {\n        if (targetBBox.y > route[route.length - 2].y)\n            targetSide = 'top';\n        else\n            targetSide = 'bottom';\n    } else {\n        rotation = linkView.targetView.model.angle();\n        if (options.rotate && rotation) {\n            const unrotatedBBox = linkView.targetView.getNodeUnrotatedBBox(linkView.targetView.el);\n            const targetPoint = route[route.length - 1].clone();\n            targetPoint.rotate(targetBBox.center(), rotation);\n            targetSide = unrotatedBBox.sideNearestToPoint(targetPoint);\n        } else {\n            targetSide = targetBBox.sideNearestToPoint(route[route.length - 1]);\n        }\n    }\n\n\n    let direction;\n    switch (targetSide) {\n        case 'top':\n            direction = new Point(0, -1);\n            break;\n        case 'bottom':\n        default:\n            direction = new Point(0, 1);\n            break;\n    }\n\n    if (options.rotate && rotation) {\n        direction.rotate(null, -rotation);\n    }\n\n    return direction;\n}\n\nfunction getAutoSourceDirection(linkView, route, options) {\n    const { sourceBBox } = linkView;\n\n    let sourceSide;\n    let rotation;\n    if (!linkView.sourceView) {\n        sourceSide = sourceBBox.sideNearestToPoint(route[1]);\n    } else {\n        rotation = linkView.sourceView.model.angle();\n        if (options.rotate && rotation) {\n            const unrotatedBBox = linkView.sourceView.getNodeUnrotatedBBox(linkView.sourceView.el);\n            const sourcePoint = route[0].clone();\n            sourcePoint.rotate(sourceBBox.center(), rotation);\n            sourceSide = unrotatedBBox.sideNearestToPoint(sourcePoint);\n        } else {\n            sourceSide = sourceBBox.sideNearestToPoint(route[0]);\n        }\n    }\n\n    let direction;\n    switch (sourceSide) {\n        case 'top':\n            direction = new Point(0, -1);\n            break;\n        case 'bottom':\n            direction = new Point(0, 1);\n            break;\n        case 'right':\n            direction = new Point(1, 0);\n            break;\n        case 'left':\n            direction = new Point(-1, 0);\n            break;\n    }\n\n    if (options.rotate && rotation) {\n        direction.rotate(null, -rotation);\n    }\n\n    return direction;\n}\n\nfunction getAutoTargetDirection(linkView, route, options) {\n    const { targetBBox } = linkView;\n\n    let targetSide;\n    let rotation;\n    if (!linkView.targetView) {\n        targetSide = targetBBox.sideNearestToPoint(route[route.length - 2]);\n    } else {\n        rotation = linkView.targetView.model.angle();\n        if (options.rotate && rotation) {\n            const unrotatedBBox = linkView.targetView.getNodeUnrotatedBBox(linkView.targetView.el);\n            const targetPoint = route[route.length - 1].clone();\n            targetPoint.rotate(targetBBox.center(), rotation);\n            targetSide = unrotatedBBox.sideNearestToPoint(targetPoint);\n        } else {\n            targetSide = targetBBox.sideNearestToPoint(route[route.length - 1]);\n        }\n    }\n\n    let direction;\n    switch (targetSide) {\n        case 'top':\n            direction = new Point(0, -1);\n            break;\n        case 'bottom':\n            direction = new Point(0, 1);\n            break;\n        case 'right':\n            direction = new Point(1, 0);\n            break;\n        case 'left':\n            direction = new Point(-1, 0);\n            break;\n    }\n\n    if (options.rotate && rotation) {\n        direction.rotate(null, -rotation);\n    }\n\n    return direction;\n}\n\nfunction getClosestPointSourceDirection(linkView, route, options) {\n    return route[1].difference(route[0]).normalize();\n}\n\nfunction getClosestPointTargetDirection(linkView, route, options) {\n    const last = route.length - 1;\n    return route[last - 1].difference(route[last]).normalize();\n}\n\nfunction getOutwardsSourceDirection(linkView, route, options) {\n    const { sourceBBox } = linkView;\n    const sourceCenter = sourceBBox.center();\n    return route[0].difference(sourceCenter).normalize();\n}\n\nfunction getOutwardsTargetDirection(linkView, route, options) {\n    const { targetBBox } = linkView;\n    const targetCenter = targetBBox.center();\n    return route[route.length - 1].difference(targetCenter).normalize();\n}\n\nfunction getSourceTangentDirection(linkView, route, direction, options) {\n    if (options.sourceDirection) {\n        switch (options.sourceDirection) {\n            case TangentDirections.UP:\n                return new Point(0, -1);\n            case TangentDirections.DOWN:\n                return new Point(0, 1);\n            case TangentDirections.LEFT:\n                return new Point(-1, 0);\n            case TangentDirections.RIGHT:\n                return new Point(1, 0);\n            case TangentDirections.AUTO:\n                return getAutoSourceDirection(linkView, route, options);\n            case TangentDirections.CLOSEST_POINT:\n                return getClosestPointSourceDirection(linkView, route, options);\n            case TangentDirections.OUTWARDS:\n                return getOutwardsSourceDirection(linkView, route, options);\n            default:\n                return options.sourceDirection;\n        }\n    }\n\n    switch (direction) {\n        case Directions.HORIZONTAL:\n            return getHorizontalSourceDirection(linkView, route, options);\n        case Directions.VERTICAL:\n            return getVerticalSourceDirection(linkView, route, options);\n        case Directions.CLOSEST_POINT:\n            return getClosestPointSourceDirection(linkView, route, options);\n        case Directions.OUTWARDS:\n            return getOutwardsSourceDirection(linkView, route, options);\n        case Directions.AUTO:\n        default:\n            return getAutoSourceDirection(linkView, route, options);\n    }\n}\n\nfunction getTargetTangentDirection(linkView, route, direction, options) {\n    if (options.targetDirection) {\n        switch (options.targetDirection) {\n            case TangentDirections.UP:\n                return new Point(0, -1);\n            case TangentDirections.DOWN:\n                return new Point(0, 1);\n            case TangentDirections.LEFT:\n                return new Point(-1, 0);\n            case TangentDirections.RIGHT:\n                return new Point(0, 1);\n            case TangentDirections.AUTO:\n                return getAutoTargetDirection(linkView, route, options);\n            case TangentDirections.CLOSEST_POINT:\n                return getClosestPointTargetDirection(linkView, route, options);\n            case TangentDirections.OUTWARDS:\n                return getOutwardsTargetDirection(linkView, route, options);\n            default:\n                return options.targetDirection;\n        }\n    }\n\n    switch (direction) {\n        case Directions.HORIZONTAL:\n            return getHorizontalTargetDirection(linkView, route, options);\n        case Directions.VERTICAL:\n            return getVerticalTargetDirection(linkView, route, options);\n        case Directions.CLOSEST_POINT:\n            return getClosestPointTargetDirection(linkView, route, options);\n        case Directions.OUTWARDS:\n            return getOutwardsTargetDirection(linkView, route, options);\n        case Directions.AUTO:\n        default:\n            return getAutoTargetDirection(linkView, route, options);\n    }\n}\n\nfunction rotateVector(vector, angle) {\n    const cos = Math.cos(angle);\n    const sin = Math.sin(angle);\n    const x = cos * vector.x - sin * vector.y;\n    const y = sin * vector.x + cos * vector.y;\n    vector.x = x;\n    vector.y = y;\n}\n\nfunction angleBetweenVectors(v1, v2) {\n    let cos = v1.dot(v2) / (v1.magnitude() * v2.magnitude());\n    if (cos < -1) cos = -1;\n    if (cos > 1) cos = 1;\n    return Math.acos(cos);\n}\n\nfunction determinant(v1, v2) {\n    return v1.x * v2.y - v1.y * v2.x;\n}\n\nfunction createCatmullRomCurves(points, sourceTangent, targetTangent, options) {\n    const { tau, coeff } = options;\n    const distances = [];\n    const tangents = [];\n    const catmullRomCurves = [];\n    const n = points.length - 1;\n\n    for (let i = 0; i < n; i++) {\n        distances[i] = points[i].distance(points[i + 1]);\n    }\n\n    tangents[0] = sourceTangent;\n    tangents[n] = targetTangent;\n\n    // The calculation of tangents of vertices\n    for (let i = 1; i < n; i++) {\n        let tpPrev;\n        let tpNext;\n        if (i === 1) {\n            tpPrev = points[i - 1].clone().offset(tangents[i - 1].x, tangents[i - 1].y);\n        } else {\n            tpPrev = points[i - 1].clone();\n        }\n        if (i === n - 1) {\n            tpNext = points[i + 1].clone().offset(tangents[i + 1].x, tangents[i + 1].y);\n        } else {\n            tpNext = points[i + 1].clone();\n        }\n        const v1 = tpPrev.difference(points[i]).normalize();\n        const v2 = tpNext.difference(points[i]).normalize();\n        const vAngle = angleBetweenVectors(v1, v2);\n\n        let rot = (Math.PI - vAngle) / 2;\n        let t;\n        const vectorDeterminant = determinant(v1, v2);\n        let pointsDeterminant;\n        pointsDeterminant = determinant(points[i].difference(points[i + 1]), points[i].difference(points[i - 1]));\n        if (vectorDeterminant < 0) {\n            rot = -rot;\n        }\n        if ((vAngle < Math.PI / 2) && ((rot < 0 && pointsDeterminant < 0) || (rot > 0 && pointsDeterminant > 0))) {\n            rot = rot - Math.PI;\n        }\n        t = v2.clone();\n        rotateVector(t, rot);\n\n        const t1 = t.clone();\n        const t2 = t.clone();\n        const scaleFactor1 = distances[i - 1] * coeff;\n        const scaleFactor2 = distances[i] * coeff;\n        t1.scale(scaleFactor1, scaleFactor1);\n        t2.scale(scaleFactor2, scaleFactor2);\n\n        tangents[i] = [t1, t2];\n    }\n\n    // The building of a Catmull-Rom curve based of tangents of points\n    for (let i = 0; i < n; i++) {\n        let p0;\n        let p3;\n        if (i === 0) {\n            p0 = points[i + 1].difference(tangents[i].x / tau, tangents[i].y / tau);\n        } else {\n            p0 = points[i + 1].difference(tangents[i][1].x / tau, tangents[i][1].y / tau);\n        }\n        if (i === n - 1) {\n            p3 = points[i].clone().offset(tangents[i + 1].x / tau, tangents[i + 1].y / tau);\n        } else {\n            p3 = points[i].difference(tangents[i + 1][0].x / tau, tangents[i + 1][0].y / tau);\n        }\n\n        catmullRomCurves[i] = [p0, points[i], points[i + 1], p3];\n    }\n    return catmullRomCurves;\n}\n\n// The function to convert Catmull-Rom curve to Bezier curve using the tension (tau)\nfunction catmullRomToBezier(points, options) {\n    const { tau } = options;\n\n    const bcp1 = new Point();\n    bcp1.x = points[1].x + (points[2].x - points[0].x) / (6 * tau);\n    bcp1.y = points[1].y + (points[2].y - points[0].y) / (6 * tau);\n\n    const bcp2 = new Point();\n    bcp2.x = points[2].x + (points[3].x - points[1].x) / (6 * tau);\n    bcp2.y = points[2].y + (points[3].y - points[1].y) / (6 * tau);\n    return new Curve(\n        points[1],\n        bcp1,\n        bcp2,\n        points[2]\n    );\n}\n","import { CellView } from './CellView.mjs';\nimport { Link } from './Link.mjs';\nimport V from '../V/index.mjs';\nimport { addClassNamePrefix, removeClassNamePrefix, merge, template, assign, toArray, isObject, isFunction, clone, isPercentage, result, isEqual } from '../util/index.mjs';\nimport { Point, Line, Path, normalizeAngle, Rect, Polyline } from '../g/index.mjs';\nimport * as routers from '../routers/index.mjs';\nimport * as connectors from '../connectors/index.mjs';\nimport $ from 'jquery';\n\nconst Flags = {\n    TOOLS: CellView.Flags.TOOLS,\n    RENDER: 'RENDER',\n    UPDATE: 'UPDATE',\n    LEGACY_TOOLS: 'LEGACY_TOOLS',\n    LABELS: 'LABELS',\n    VERTICES: 'VERTICES',\n    SOURCE: 'SOURCE',\n    TARGET: 'TARGET',\n    CONNECTOR: 'CONNECTOR'\n};\n\n// Link base view and controller.\n// ----------------------------------------\n\nexport const LinkView = CellView.extend({\n\n    className: function() {\n\n        var classNames = CellView.prototype.className.apply(this).split(' ');\n\n        classNames.push('link');\n\n        return classNames.join(' ');\n    },\n\n    options: {\n\n        shortLinkLength: 105,\n        doubleLinkTools: false,\n        longLinkLength: 155,\n        linkToolsOffset: 40,\n        doubleLinkToolsOffset: 65,\n        sampleInterval: 50\n    },\n\n    _labelCache: null,\n    _labelSelectors: null,\n    _markerCache: null,\n    _V: null,\n    _dragData: null, // deprecated\n\n    metrics: null,\n    decimalsRounding: 2,\n\n    initialize: function() {\n\n        CellView.prototype.initialize.apply(this, arguments);\n\n        // `_.labelCache` is a mapping of indexes of labels in the `this.get('labels')` array to\n        // `<g class=\"label\">` nodes wrapped by Vectorizer. This allows for quick access to the\n        // nodes in `updateLabelPosition()` in order to update the label positions.\n        this._labelCache = {};\n\n        // a cache of label selectors\n        this._labelSelectors = {};\n\n        // keeps markers bboxes and positions again for quicker access\n        this._markerCache = {};\n\n        // cache of default markup nodes\n        this._V = {};\n\n        // connection path metrics\n        this.cleanNodesCache();\n    },\n\n    presentationAttributes: {\n        markup: [Flags.RENDER],\n        attrs: [Flags.UPDATE],\n        router: [Flags.UPDATE],\n        connector: [Flags.CONNECTOR],\n        smooth: [Flags.UPDATE],\n        manhattan: [Flags.UPDATE],\n        toolMarkup: [Flags.LEGACY_TOOLS],\n        labels: [Flags.LABELS],\n        labelMarkup: [Flags.LABELS],\n        vertices: [Flags.VERTICES, Flags.UPDATE],\n        vertexMarkup: [Flags.VERTICES],\n        source: [Flags.SOURCE, Flags.UPDATE],\n        target: [Flags.TARGET, Flags.UPDATE]\n    },\n\n    initFlag: [Flags.RENDER, Flags.SOURCE, Flags.TARGET, Flags.TOOLS],\n\n    UPDATE_PRIORITY: 1,\n\n    confirmUpdate: function(flags, opt) {\n\n        opt || (opt = {});\n\n        if (this.hasFlag(flags, Flags.SOURCE)) {\n            if (!this.updateEndProperties('source')) return flags;\n            flags = this.removeFlag(flags, Flags.SOURCE);\n        }\n\n        if (this.hasFlag(flags, Flags.TARGET)) {\n            if (!this.updateEndProperties('target')) return flags;\n            flags = this.removeFlag(flags, Flags.TARGET);\n        }\n\n        const { paper, sourceView, targetView } = this;\n        if (paper && ((sourceView && !paper.isViewMounted(sourceView)) || (targetView && !paper.isViewMounted(targetView)))) {\n            // Wait for the sourceView and targetView to be rendered\n            return flags;\n        }\n\n        if (this.hasFlag(flags, Flags.RENDER)) {\n            this.render();\n            this.updateHighlighters(true);\n            this.updateTools(opt);\n            flags = this.removeFlag(flags, [Flags.RENDER, Flags.UPDATE, Flags.VERTICES, Flags.LABELS, Flags.TOOLS, Flags.LEGACY_TOOLS, Flags.CONNECTOR]);\n            return flags;\n        }\n\n        let updateHighlighters = false;\n\n        if (this.hasFlag(flags, Flags.VERTICES)) {\n            this.renderVertexMarkers();\n            flags = this.removeFlag(flags, Flags.VERTICES);\n        }\n\n        const { model } = this;\n        const { attributes } = model;\n        let updateLabels = this.hasFlag(flags, Flags.LABELS);\n        let updateLegacyTools = this.hasFlag(flags, Flags.LEGACY_TOOLS);\n\n        if (updateLabels) {\n            this.onLabelsChange(model, attributes.labels, opt);\n            flags = this.removeFlag(flags, Flags.LABELS);\n            updateHighlighters = true;\n        }\n\n        if (updateLegacyTools) {\n            this.renderTools();\n            flags = this.removeFlag(flags, Flags.LEGACY_TOOLS);\n        }\n\n        const updateAll = this.hasFlag(flags, Flags.UPDATE);\n        const updateConnector = this.hasFlag(flags, Flags.CONNECTOR);\n        if (updateAll || updateConnector) {\n            if (!updateAll) {\n                // Keep the current route and update the geometry\n                this.updatePath();\n                this.updateDOM();\n            } else if (opt.translateBy && model.isRelationshipEmbeddedIn(opt.translateBy)) {\n                // The link is being translated by an ancestor that will\n                // shift source point, target point and all vertices\n                // by an equal distance.\n                this.translate(opt.tx, opt.ty);\n            } else {\n                this.update();\n            }\n            this.updateTools(opt);\n            flags = this.removeFlag(flags, [Flags.UPDATE, Flags.TOOLS, Flags.CONNECTOR]);\n            updateLabels = false;\n            updateLegacyTools = false;\n            updateHighlighters = true;\n        }\n\n        if (updateLabels) {\n            this.updateLabelPositions();\n        }\n\n        if (updateLegacyTools) {\n            this.updateToolsPosition();\n        }\n\n        if (updateHighlighters) {\n            this.updateHighlighters();\n        }\n\n        if (this.hasFlag(flags, Flags.TOOLS)) {\n            this.updateTools(opt);\n            flags = this.removeFlag(flags, Flags.TOOLS);\n        }\n\n        return flags;\n    },\n\n    requestConnectionUpdate: function(opt) {\n        this.requestUpdate(this.getFlag(Flags.UPDATE), opt);\n    },\n\n    isLabelsRenderRequired: function(opt = {}) {\n\n        const previousLabels = this.model.previous('labels');\n        if (!previousLabels) return true;\n\n        // Here is an optimization for cases when we know, that change does\n        // not require re-rendering of all labels.\n        if (('propertyPathArray' in opt) && ('propertyValue' in opt)) {\n            // The label is setting by `prop()` method\n            var pathArray = opt.propertyPathArray || [];\n            var pathLength = pathArray.length;\n            if (pathLength > 1) {\n                // We are changing a single label here e.g. 'labels/0/position'\n                var labelExists = !!previousLabels[pathArray[1]];\n                if (labelExists) {\n                    if (pathLength === 2) {\n                        // We are changing the entire label. Need to check if the\n                        // markup is also being changed.\n                        return ('markup' in Object(opt.propertyValue));\n                    } else if (pathArray[2] !== 'markup') {\n                        // We are changing a label property but not the markup\n                        return false;\n                    }\n                }\n            }\n        }\n\n        return true;\n    },\n\n    onLabelsChange: function(_link, _labels, opt) {\n\n        // Note: this optimization works in async=false mode only\n        if (this.isLabelsRenderRequired(opt)) {\n            this.renderLabels();\n        } else {\n            this.updateLabels();\n        }\n    },\n\n    // Rendering.\n    // ----------\n\n    render: function() {\n\n        this.vel.empty();\n        this.unmountLabels();\n        this._V = {};\n        this.renderMarkup();\n        // rendering labels has to be run after the link is appended to DOM tree. (otherwise <Text> bbox\n        // returns zero values)\n        this.renderLabels();\n        this.update();\n\n        return this;\n    },\n\n    renderMarkup: function() {\n\n        var link = this.model;\n        var markup = link.get('markup') || link.markup;\n        if (!markup) throw new Error('dia.LinkView: markup required');\n        if (Array.isArray(markup)) return this.renderJSONMarkup(markup);\n        if (typeof markup === 'string') return this.renderStringMarkup(markup);\n        throw new Error('dia.LinkView: invalid markup');\n    },\n\n    renderJSONMarkup: function(markup) {\n\n        var doc = this.parseDOMJSON(markup, this.el);\n        // Selectors\n        this.selectors = doc.selectors;\n        // Fragment\n        this.vel.append(doc.fragment);\n    },\n\n    renderStringMarkup: function(markup) {\n\n        // A special markup can be given in the `properties.markup` property. This might be handy\n        // if e.g. arrowhead markers should be `<image>` elements or any other element than `<path>`s.\n        // `.connection`, `.connection-wrap`, `.marker-source` and `.marker-target` selectors\n        // of elements with special meaning though. Therefore, those classes should be preserved in any\n        // special markup passed in `properties.markup`.\n        var children = V(markup);\n        // custom markup may contain only one children\n        if (!Array.isArray(children)) children = [children];\n        // Cache all children elements for quicker access.\n        var cache = this._V; // vectorized markup;\n        for (var i = 0, n = children.length; i < n; i++) {\n            var child = children[i];\n            var className = child.attr('class');\n            if (className) {\n                // Strip the joint class name prefix, if there is one.\n                className = removeClassNamePrefix(className);\n                cache[$.camelCase(className)] = child;\n            }\n        }\n        // partial rendering\n        this.renderTools();\n        this.renderVertexMarkers();\n        this.renderArrowheadMarkers();\n        this.vel.append(children);\n    },\n\n    _getLabelMarkup: function(labelMarkup) {\n\n        if (!labelMarkup) return undefined;\n\n        if (Array.isArray(labelMarkup)) return this.parseDOMJSON(labelMarkup, null);\n        if (typeof labelMarkup === 'string') return this._getLabelStringMarkup(labelMarkup);\n        throw new Error('dia.linkView: invalid label markup');\n    },\n\n    _getLabelStringMarkup: function(labelMarkup) {\n\n        var children = V(labelMarkup);\n        var fragment = document.createDocumentFragment();\n\n        if (!Array.isArray(children)) {\n            fragment.appendChild(children.node);\n\n        } else {\n            for (var i = 0, n = children.length; i < n; i++) {\n                var currentChild = children[i].node;\n                fragment.appendChild(currentChild);\n            }\n        }\n\n        return { fragment: fragment, selectors: {}}; // no selectors\n    },\n\n    // Label markup fragment may come wrapped in <g class=\"label\" />, or not.\n    // If it doesn't, add the <g /> container here.\n    _normalizeLabelMarkup: function(markup) {\n\n        if (!markup) return undefined;\n\n        var fragment = markup.fragment;\n        if (!(markup.fragment instanceof DocumentFragment) || !markup.fragment.hasChildNodes()) throw new Error('dia.LinkView: invalid label markup.');\n\n        var vNode;\n        var childNodes = fragment.childNodes;\n\n        if ((childNodes.length > 1) || childNodes[0].nodeName.toUpperCase() !== 'G') {\n            // default markup fragment is not wrapped in <g />\n            // add a <g /> container\n            vNode = V('g').append(fragment);\n        } else {\n            vNode = V(childNodes[0]);\n        }\n\n        vNode.addClass('label');\n\n        return { node: vNode.node, selectors: markup.selectors };\n    },\n\n    renderLabels: function() {\n\n        var cache = this._V;\n        var vLabels = cache.labels;\n        var labelCache = this._labelCache = {};\n        var labelSelectors = this._labelSelectors = {};\n        var model = this.model;\n        var labels = model.attributes.labels || [];\n        var labelsCount = labels.length;\n\n        if (labelsCount === 0) {\n            if (vLabels) vLabels.remove();\n            return this;\n        }\n\n        if (vLabels) {\n            vLabels.empty();\n        }  else {\n            // there is no label container in the markup but some labels are defined\n            // add a <g class=\"labels\" /> container\n            vLabels = cache.labels = V('g').addClass('labels');\n            if (this.options.labelsLayer) {\n                vLabels.addClass(addClassNamePrefix(result(this, 'className')));\n                vLabels.attr('model-id', model.id);\n            }\n        }\n\n        for (var i = 0; i < labelsCount; i++) {\n\n            var label = labels[i];\n            var labelMarkup = this._normalizeLabelMarkup(this._getLabelMarkup(label.markup));\n            var labelNode;\n            var selectors;\n            if (labelMarkup) {\n\n                labelNode = labelMarkup.node;\n                selectors = labelMarkup.selectors;\n\n            } else {\n\n                var builtinDefaultLabel =  model._builtins.defaultLabel;\n                var builtinDefaultLabelMarkup = this._normalizeLabelMarkup(this._getLabelMarkup(builtinDefaultLabel.markup));\n                var defaultLabel = model._getDefaultLabel();\n                var defaultLabelMarkup = this._normalizeLabelMarkup(this._getLabelMarkup(defaultLabel.markup));\n                var defaultMarkup = defaultLabelMarkup || builtinDefaultLabelMarkup;\n\n                labelNode = defaultMarkup.node;\n                selectors = defaultMarkup.selectors;\n            }\n\n            labelNode.setAttribute('label-idx', i); // assign label-idx\n            vLabels.append(labelNode);\n            labelCache[i] = labelNode; // cache node for `updateLabels()` so it can just update label node positions\n\n            var rootSelector = this.selector;\n            if (selectors[rootSelector]) throw new Error('dia.LinkView: ambiguous label root selector.');\n            selectors[rootSelector] = labelNode;\n\n            labelSelectors[i] = selectors; // cache label selectors for `updateLabels()`\n        }\n        if (!vLabels.parent()) {\n            this.mountLabels();\n        }\n\n        this.updateLabels();\n\n        return this;\n    },\n\n    mountLabels: function() {\n        const { el, paper, model, _V, options } = this;\n        const { labels: vLabels } = _V;\n        if (!vLabels || !model.hasLabels()) return;\n        const { node } = vLabels;\n        if (options.labelsLayer) {\n            paper.getLayerView(options.labelsLayer).insertSortedNode(node, model.get('z'));\n        } else {\n            if (node.parentNode !== el) {\n                el.appendChild(node);\n            }\n        }\n    },\n\n    unmountLabels: function() {\n        const { options, _V } = this;\n        if (!_V) return;\n        const { labels: vLabels } = _V;\n        if (vLabels && options.labelsLayer) {\n            vLabels.remove();\n        }\n    },\n\n    findLabelNode: function(labelIndex, selector) {\n        const labelRoot = this._labelCache[labelIndex];\n        if (!labelRoot) return null;\n        const labelSelectors = this._labelSelectors[labelIndex];\n        const [node = null] = this.findBySelector(selector, labelRoot, labelSelectors);\n        return node;\n    },\n\n\n    // merge default label attrs into label attrs (or use built-in default label attrs if neither is provided)\n    // keep `undefined` or `null` because `{}` means something else\n    _mergeLabelAttrs: function(hasCustomMarkup, labelAttrs, defaultLabelAttrs, builtinDefaultLabelAttrs) {\n\n        if (labelAttrs === null) return null;\n        if (labelAttrs === undefined) {\n\n            if (defaultLabelAttrs === null) return null;\n            if (defaultLabelAttrs === undefined) {\n\n                if (hasCustomMarkup) return undefined;\n                return builtinDefaultLabelAttrs;\n            }\n\n            if (hasCustomMarkup) return defaultLabelAttrs;\n            return merge({}, builtinDefaultLabelAttrs, defaultLabelAttrs);\n        }\n\n        if (hasCustomMarkup) return merge({}, defaultLabelAttrs, labelAttrs);\n        return merge({}, builtinDefaultLabelAttrs, defaultLabelAttrs, labelAttrs);\n    },\n\n    // merge default label size into label size (no built-in default)\n    // keep `undefined` or `null` because `{}` means something else\n    _mergeLabelSize: function(labelSize, defaultLabelSize) {\n\n        if (labelSize === null) return null;\n        if (labelSize === undefined) {\n\n            if (defaultLabelSize === null) return null;\n            if (defaultLabelSize === undefined) return undefined;\n\n            return defaultLabelSize;\n        }\n\n        return merge({}, defaultLabelSize, labelSize);\n    },\n\n    updateLabels: function() {\n\n        if (!this._V.labels) return this;\n\n        var model = this.model;\n        var labels = model.get('labels') || [];\n        var canLabelMove = this.can('labelMove');\n\n        var builtinDefaultLabel = model._builtins.defaultLabel;\n        var builtinDefaultLabelAttrs = builtinDefaultLabel.attrs;\n\n        var defaultLabel = model._getDefaultLabel();\n        var defaultLabelMarkup = defaultLabel.markup;\n        var defaultLabelAttrs = defaultLabel.attrs;\n        var defaultLabelSize = defaultLabel.size;\n\n        for (var i = 0, n = labels.length; i < n; i++) {\n\n            var labelNode = this._labelCache[i];\n            labelNode.setAttribute('cursor', (canLabelMove ? 'move' : 'default'));\n\n            var selectors = this._labelSelectors[i];\n\n            var label = labels[i];\n            var labelMarkup = label.markup;\n            var labelAttrs = label.attrs;\n            var labelSize = label.size;\n\n            var attrs = this._mergeLabelAttrs(\n                (labelMarkup || defaultLabelMarkup),\n                labelAttrs,\n                defaultLabelAttrs,\n                builtinDefaultLabelAttrs\n            );\n\n            var size = this._mergeLabelSize(\n                labelSize,\n                defaultLabelSize\n            );\n\n            this.updateDOMSubtreeAttributes(labelNode, attrs, {\n                rootBBox: new Rect(size),\n                selectors: selectors\n            });\n        }\n\n        return this;\n    },\n\n    renderTools: function() {\n\n        if (!this._V.linkTools) return this;\n\n        // Tools are a group of clickable elements that manipulate the whole link.\n        // A good example of this is the remove tool that removes the whole link.\n        // Tools appear after hovering the link close to the `source` element/point of the link\n        // but are offset a bit so that they don't cover the `marker-arrowhead`.\n\n        var $tools = $(this._V.linkTools.node).empty();\n        var toolTemplate = template(this.model.get('toolMarkup') || this.model.toolMarkup);\n        var tool = V(toolTemplate());\n\n        $tools.append(tool.node);\n\n        // Cache the tool node so that the `updateToolsPosition()` can update the tool position quickly.\n        this._toolCache = tool;\n\n        // If `doubleLinkTools` is enabled, we render copy of the tools on the other side of the\n        // link as well but only if the link is longer than `longLinkLength`.\n        if (this.options.doubleLinkTools) {\n\n            var tool2;\n            if (this.model.get('doubleToolMarkup') || this.model.doubleToolMarkup) {\n                toolTemplate = template(this.model.get('doubleToolMarkup') || this.model.doubleToolMarkup);\n                tool2 = V(toolTemplate());\n            } else {\n                tool2 = tool.clone();\n            }\n\n            $tools.append(tool2.node);\n            this._tool2Cache = tool2;\n        }\n\n        return this;\n    },\n\n    renderVertexMarkers: function() {\n\n        if (!this._V.markerVertices) return this;\n\n        var $markerVertices = $(this._V.markerVertices.node).empty();\n\n        // A special markup can be given in the `properties.vertexMarkup` property. This might be handy\n        // if default styling (elements) are not desired. This makes it possible to use any\n        // SVG elements for .marker-vertex and .marker-vertex-remove tools.\n        var markupTemplate = template(this.model.get('vertexMarkup') || this.model.vertexMarkup);\n\n        this.model.vertices().forEach(function(vertex, idx) {\n            $markerVertices.append(V(markupTemplate(assign({ idx: idx }, vertex))).node);\n        });\n\n        return this;\n    },\n\n    renderArrowheadMarkers: function() {\n\n        // Custom markups might not have arrowhead markers. Therefore, jump of this function immediately if that's the case.\n        if (!this._V.markerArrowheads) return this;\n\n        var $markerArrowheads = $(this._V.markerArrowheads.node);\n\n        $markerArrowheads.empty();\n\n        // A special markup can be given in the `properties.vertexMarkup` property. This might be handy\n        // if default styling (elements) are not desired. This makes it possible to use any\n        // SVG elements for .marker-vertex and .marker-vertex-remove tools.\n        var markupTemplate = template(this.model.get('arrowheadMarkup') || this.model.arrowheadMarkup);\n\n        this._V.sourceArrowhead = V(markupTemplate({ end: 'source' }));\n        this._V.targetArrowhead = V(markupTemplate({ end: 'target' }));\n\n        $markerArrowheads.append(this._V.sourceArrowhead.node, this._V.targetArrowhead.node);\n\n        return this;\n    },\n\n    // remove vertices that lie on (or nearly on) straight lines within the link\n    // return the number of removed points\n    removeRedundantLinearVertices: function(opt) {\n\n        const SIMPLIFY_THRESHOLD = 0.001;\n\n        const link = this.model;\n        const vertices = link.vertices();\n        const routePoints = [this.sourceAnchor, ...vertices, this.targetAnchor];\n        const numRoutePoints = routePoints.length;\n\n        // put routePoints into a polyline and try to simplify\n        const polyline = new Polyline(routePoints);\n        polyline.simplify({ threshold: SIMPLIFY_THRESHOLD });\n        const polylinePoints = polyline.points.map((point) => (point.toJSON())); // JSON of points after simplification\n        const numPolylinePoints = polylinePoints.length; // number of points after simplification\n\n        // shortcut if simplification did not remove any redundant vertices:\n        if (numRoutePoints === numPolylinePoints) return 0;\n\n        // else: set simplified polyline points as link vertices\n        // remove first and last polyline points again (= source/target anchors)\n        link.vertices(polylinePoints.slice(1, numPolylinePoints - 1), opt);\n        return (numRoutePoints - numPolylinePoints);\n    },\n\n    updateDefaultConnectionPath: function() {\n\n        var cache = this._V;\n\n        if (cache.connection) {\n            cache.connection.attr('d', this.getSerializedConnection());\n        }\n\n        if (cache.connectionWrap) {\n            cache.connectionWrap.attr('d', this.getSerializedConnection());\n        }\n\n        if (cache.markerSource && cache.markerTarget) {\n            this._translateAndAutoOrientArrows(cache.markerSource, cache.markerTarget);\n        }\n    },\n\n    getEndView: function(type) {\n        switch (type) {\n            case 'source':\n                return this.sourceView || null;\n            case 'target':\n                return this.targetView || null;\n            default:\n                throw new Error('dia.LinkView: type parameter required.');\n        }\n    },\n\n    getEndAnchor: function(type) {\n        switch (type) {\n            case 'source':\n                return new Point(this.sourceAnchor);\n            case 'target':\n                return new Point(this.targetAnchor);\n            default:\n                throw new Error('dia.LinkView: type parameter required.');\n        }\n    },\n\n    getEndConnectionPoint: function(type) {\n        switch (type) {\n            case 'source':\n                return new Point(this.sourcePoint);\n            case 'target':\n                return new Point(this.targetPoint);\n            default:\n                throw new Error('dia.LinkView: type parameter required.');\n        }\n    },\n\n    getEndMagnet: function(type) {\n        switch (type) {\n            case 'source':\n                var sourceView = this.sourceView;\n                if (!sourceView) break;\n                return this.sourceMagnet || sourceView.el;\n            case 'target':\n                var targetView = this.targetView;\n                if (!targetView) break;\n                return this.targetMagnet || targetView.el;\n            default:\n                throw new Error('dia.LinkView: type parameter required.');\n        }\n        return null;\n    },\n\n\n    // Updating.\n    // ---------\n\n    update: function() {\n        this.updateRoute();\n        this.updatePath();\n        this.updateDOM();\n        return this;\n    },\n\n    translate: function(tx = 0, ty = 0) {\n        const { route, path } = this;\n        if (!route || !path) return;\n        // translate the route\n        const polyline = new Polyline(route);\n        polyline.translate(tx, ty);\n        this.route = polyline.points;\n        // translate source and target connection and marker points.\n        this._translateConnectionPoints(tx, ty);\n        // translate the geometry path\n        path.translate(tx, ty);\n        this.updateDOM();\n    },\n\n    updateDOM() {\n        const { el, model, selectors } = this;\n        this.cleanNodesCache();\n        // update SVG attributes defined by 'attrs/'.\n        this.updateDOMSubtreeAttributes(el, model.attr(), { selectors });\n        // legacy link path update\n        this.updateDefaultConnectionPath();\n        // update the label position etc.\n        this.updateLabelPositions();\n        this.updateToolsPosition();\n        this.updateArrowheadMarkers();\n        // *Deprecated*\n        // Local perpendicular flag (as opposed to one defined on paper).\n        // Could be enabled inside a connector/router. It's valid only\n        // during the update execution.\n        this.options.perpendicular = null;\n    },\n\n    updateRoute: function() {\n        const { model } = this;\n        const vertices = model.vertices();\n        // 1. Find Anchors\n        const anchors = this.findAnchors(vertices);\n        const sourceAnchor = this.sourceAnchor = anchors.source;\n        const targetAnchor = this.targetAnchor = anchors.target;\n        // 2. Find Route\n        const route = this.findRoute(vertices);\n        this.route = route;\n        // 3. Find Connection Points\n        var connectionPoints = this.findConnectionPoints(route, sourceAnchor, targetAnchor);\n        this.sourcePoint = connectionPoints.source;\n        this.targetPoint = connectionPoints.target;\n    },\n\n    updatePath: function() {\n        const { route, sourcePoint, targetPoint } = this;\n        // 3b. Find Marker Connection Point - Backwards Compatibility\n        const markerPoints = this.findMarkerPoints(route, sourcePoint, targetPoint);\n        // 4. Find Connection\n        const path = this.findPath(route, markerPoints.source || sourcePoint, markerPoints.target || targetPoint);\n        this.path = path;\n    },\n\n    findMarkerPoints: function(route, sourcePoint, targetPoint) {\n\n        var firstWaypoint = route[0];\n        var lastWaypoint = route[route.length - 1];\n\n        // Move the source point by the width of the marker taking into account\n        // its scale around x-axis. Note that scale is the only transform that\n        // makes sense to be set in `.marker-source` attributes object\n        // as all other transforms (translate/rotate) will be replaced\n        // by the `translateAndAutoOrient()` function.\n        var cache = this._markerCache;\n        // cache source and target points\n        var sourceMarkerPoint, targetMarkerPoint;\n\n        if (this._V.markerSource) {\n\n            cache.sourceBBox = cache.sourceBBox || this._V.markerSource.getBBox();\n            sourceMarkerPoint = Point(sourcePoint).move(\n                firstWaypoint || targetPoint,\n                cache.sourceBBox.width * this._V.markerSource.scale().sx * -1\n            ).round();\n        }\n\n        if (this._V.markerTarget) {\n\n            cache.targetBBox = cache.targetBBox || this._V.markerTarget.getBBox();\n            targetMarkerPoint = Point(targetPoint).move(\n                lastWaypoint || sourcePoint,\n                cache.targetBBox.width * this._V.markerTarget.scale().sx * -1\n            ).round();\n        }\n\n        // if there was no markup for the marker, use the connection point.\n        cache.sourcePoint = sourceMarkerPoint || sourcePoint.clone();\n        cache.targetPoint = targetMarkerPoint || targetPoint.clone();\n\n        return {\n            source: sourceMarkerPoint,\n            target: targetMarkerPoint\n        };\n    },\n\n    findAnchorsOrdered: function(firstEndType, firstRef, secondEndType, secondRef) {\n\n        var firstAnchor, secondAnchor;\n        var firstAnchorRef, secondAnchorRef;\n        var model = this.model;\n        var firstDef = model.get(firstEndType);\n        var secondDef = model.get(secondEndType);\n        var firstView = this.getEndView(firstEndType);\n        var secondView = this.getEndView(secondEndType);\n        var firstMagnet = this.getEndMagnet(firstEndType);\n        var secondMagnet = this.getEndMagnet(secondEndType);\n\n        // Anchor first\n        if (firstView) {\n            if (firstRef) {\n                firstAnchorRef = new Point(firstRef);\n            } else if (secondView) {\n                firstAnchorRef = secondMagnet;\n            } else {\n                firstAnchorRef = new Point(secondDef);\n            }\n            firstAnchor = this.getAnchor(firstDef.anchor, firstView, firstMagnet, firstAnchorRef, firstEndType);\n        } else {\n            firstAnchor = new Point(firstDef);\n        }\n\n        // Anchor second\n        if (secondView) {\n            secondAnchorRef = new Point(secondRef || firstAnchor);\n            secondAnchor = this.getAnchor(secondDef.anchor, secondView, secondMagnet, secondAnchorRef, secondEndType);\n        } else {\n            secondAnchor = new Point(secondDef);\n        }\n\n        var res = {};\n        res[firstEndType] = firstAnchor;\n        res[secondEndType] = secondAnchor;\n        return res;\n    },\n\n    findAnchors: function(vertices) {\n\n        var model = this.model;\n        var firstVertex = vertices[0];\n        var lastVertex = vertices[vertices.length - 1];\n\n        if (model.target().priority && !model.source().priority) {\n            // Reversed order\n            return this.findAnchorsOrdered('target', lastVertex, 'source', firstVertex);\n        }\n\n        // Usual order\n        return this.findAnchorsOrdered('source', firstVertex, 'target', lastVertex);\n    },\n\n    findConnectionPoints: function(route, sourceAnchor, targetAnchor) {\n\n        var firstWaypoint = route[0];\n        var lastWaypoint = route[route.length - 1];\n        var model = this.model;\n        var sourceDef = model.get('source');\n        var targetDef = model.get('target');\n        var sourceView = this.sourceView;\n        var targetView = this.targetView;\n        var paperOptions = this.paper.options;\n        var sourceMagnet, targetMagnet;\n\n        // Connection Point Source\n        var sourcePoint;\n        if (sourceView && !sourceView.isNodeConnection(this.sourceMagnet)) {\n            sourceMagnet = (this.sourceMagnet || sourceView.el);\n            var sourceConnectionPointDef = sourceDef.connectionPoint || paperOptions.defaultConnectionPoint;\n            var sourcePointRef = firstWaypoint || targetAnchor;\n            var sourceLine = new Line(sourcePointRef, sourceAnchor);\n            sourcePoint = this.getConnectionPoint(\n                sourceConnectionPointDef,\n                sourceView,\n                sourceMagnet,\n                sourceLine,\n                'source'\n            );\n        } else {\n            sourcePoint = sourceAnchor;\n        }\n        // Connection Point Target\n        var targetPoint;\n        if (targetView && !targetView.isNodeConnection(this.targetMagnet)) {\n            targetMagnet = (this.targetMagnet || targetView.el);\n            var targetConnectionPointDef = targetDef.connectionPoint || paperOptions.defaultConnectionPoint;\n            var targetPointRef = lastWaypoint || sourceAnchor;\n            var targetLine = new Line(targetPointRef, targetAnchor);\n            targetPoint = this.getConnectionPoint(\n                targetConnectionPointDef,\n                targetView,\n                targetMagnet,\n                targetLine,\n                'target'\n            );\n        } else {\n            targetPoint = targetAnchor;\n        }\n\n        return {\n            source: sourcePoint,\n            target: targetPoint\n        };\n    },\n\n    getAnchor: function(anchorDef, cellView, magnet, ref, endType) {\n\n        var isConnection = cellView.isNodeConnection(magnet);\n        var paperOptions = this.paper.options;\n        if (!anchorDef) {\n            if (isConnection) {\n                anchorDef = paperOptions.defaultLinkAnchor;\n            } else {\n                if (paperOptions.perpendicularLinks || this.options.perpendicular) {\n                    // Backwards compatibility\n                    // If `perpendicularLinks` flag is set on the paper and there are vertices\n                    // on the link, then try to find a connection point that makes the link perpendicular\n                    // even though the link won't point to the center of the targeted object.\n                    anchorDef = { name: 'perpendicular' };\n                } else {\n                    anchorDef = paperOptions.defaultAnchor;\n                }\n            }\n        }\n\n        if (!anchorDef) throw new Error('Anchor required.');\n        var anchorFn;\n        if (typeof anchorDef === 'function') {\n            anchorFn = anchorDef;\n        } else {\n            var anchorName = anchorDef.name;\n            var anchorNamespace = isConnection ? 'linkAnchorNamespace' : 'anchorNamespace';\n            anchorFn = paperOptions[anchorNamespace][anchorName];\n            if (typeof anchorFn !== 'function') throw new Error('Unknown anchor: ' + anchorName);\n        }\n        var anchor = anchorFn.call(\n            this,\n            cellView,\n            magnet,\n            ref,\n            anchorDef.args || {},\n            endType,\n            this\n        );\n        if (!anchor) return new Point();\n        return anchor.round(this.decimalsRounding);\n    },\n\n\n    getConnectionPoint: function(connectionPointDef, view, magnet, line, endType) {\n\n        var connectionPoint;\n        var anchor = line.end;\n        var paperOptions = this.paper.options;\n\n        // Backwards compatibility\n        if (typeof paperOptions.linkConnectionPoint === 'function') {\n            var linkConnectionMagnet = (magnet === view.el) ? undefined : magnet;\n            connectionPoint = paperOptions.linkConnectionPoint(this, view, linkConnectionMagnet, line.start, endType);\n            if (connectionPoint) return connectionPoint;\n        }\n\n        if (!connectionPointDef) return anchor;\n        var connectionPointFn;\n        if (typeof connectionPointDef === 'function') {\n            connectionPointFn = connectionPointDef;\n        } else {\n            var connectionPointName = connectionPointDef.name;\n            connectionPointFn = paperOptions.connectionPointNamespace[connectionPointName];\n            if (typeof connectionPointFn !== 'function') throw new Error('Unknown connection point: ' + connectionPointName);\n        }\n        connectionPoint = connectionPointFn.call(this, line, view, magnet, connectionPointDef.args || {}, endType, this);\n        if (!connectionPoint) return anchor;\n        return connectionPoint.round(this.decimalsRounding);\n    },\n\n    _translateConnectionPoints: function(tx, ty) {\n\n        var cache = this._markerCache;\n\n        cache.sourcePoint.offset(tx, ty);\n        cache.targetPoint.offset(tx, ty);\n        this.sourcePoint.offset(tx, ty);\n        this.targetPoint.offset(tx, ty);\n        this.sourceAnchor.offset(tx, ty);\n        this.targetAnchor.offset(tx, ty);\n    },\n\n    // combine default label position with built-in default label position\n    _getDefaultLabelPositionProperty: function() {\n\n        var model = this.model;\n\n        var builtinDefaultLabel = model._builtins.defaultLabel;\n        var builtinDefaultLabelPosition = builtinDefaultLabel.position;\n\n        var defaultLabel = model._getDefaultLabel();\n        var defaultLabelPosition = this._normalizeLabelPosition(defaultLabel.position);\n\n        return merge({}, builtinDefaultLabelPosition, defaultLabelPosition);\n    },\n\n    // if label position is a number, normalize it to a position object\n    // this makes sure that label positions can be merged properly\n    _normalizeLabelPosition: function(labelPosition) {\n\n        if (typeof labelPosition === 'number') return { distance: labelPosition, offset: null, angle: 0, args: null };\n        return labelPosition;\n    },\n\n    // expects normalized position properties\n    // e.g. `this._normalizeLabelPosition(labelPosition)` and `this._getDefaultLabelPositionProperty()`\n    _mergeLabelPositionProperty: function(normalizedLabelPosition, normalizedDefaultLabelPosition) {\n\n        if (normalizedLabelPosition === null) return null;\n        if (normalizedLabelPosition === undefined) {\n\n            if (normalizedDefaultLabelPosition === null) return null;\n            return normalizedDefaultLabelPosition;\n        }\n\n        return merge({}, normalizedDefaultLabelPosition, normalizedLabelPosition);\n    },\n\n    updateLabelPositions: function() {\n\n        if (!this._V.labels) return this;\n\n        var path = this.path;\n        if (!path) return this;\n\n        // This method assumes all the label nodes are stored in the `this._labelCache` hash table\n        // by their indices in the `this.get('labels')` array. This is done in the `renderLabels()` method.\n\n        var model = this.model;\n        var labels = model.get('labels') || [];\n        if (!labels.length) return this;\n\n        var defaultLabelPosition = this._getDefaultLabelPositionProperty();\n\n        for (var idx = 0, n = labels.length; idx < n; idx++) {\n            var labelNode = this._labelCache[idx];\n            if (!labelNode) continue;\n            var label = labels[idx];\n            var labelPosition = this._normalizeLabelPosition(label.position);\n            var position = this._mergeLabelPositionProperty(labelPosition, defaultLabelPosition);\n            var transformationMatrix = this._getLabelTransformationMatrix(position);\n            labelNode.setAttribute('transform', V.matrixToTransformString(transformationMatrix));\n            this._cleanLabelMatrices(idx);\n        }\n\n        return this;\n    },\n\n    _cleanLabelMatrices: function(index) {\n        // Clean magnetMatrix for all nodes of the label.\n        // Cached BoundingRect does not need to updated when the position changes\n        // TODO: this doesn't work for labels with XML String markups.\n        const { metrics, _labelSelectors } = this;\n        const selectors = _labelSelectors[index];\n        if (!selectors) return;\n        for (let selector in selectors) {\n            const { id } = selectors[selector];\n            if (id && (id in metrics)) delete metrics[id].magnetMatrix;\n        }\n    },\n\n    updateToolsPosition: function() {\n\n        if (!this._V.linkTools) return this;\n\n        // Move the tools a bit to the target position but don't cover the `sourceArrowhead` marker.\n        // Note that the offset is hardcoded here. The offset should be always\n        // more than the `this.$('.marker-arrowhead[end=\"source\"]')[0].bbox().width` but looking\n        // this up all the time would be slow.\n\n        var scale = '';\n        var offset = this.options.linkToolsOffset;\n        var connectionLength = this.getConnectionLength();\n\n        // Firefox returns connectionLength=NaN in odd cases (for bezier curves).\n        // In that case we won't update tools position at all.\n        if (!Number.isNaN(connectionLength)) {\n\n            // If the link is too short, make the tools half the size and the offset twice as low.\n            if (connectionLength < this.options.shortLinkLength) {\n                scale = 'scale(.5)';\n                offset /= 2;\n            }\n\n            var toolPosition = this.getPointAtLength(offset);\n\n            this._toolCache.attr('transform', 'translate(' + toolPosition.x + ', ' + toolPosition.y + ') ' + scale);\n\n            if (this.options.doubleLinkTools && connectionLength >= this.options.longLinkLength) {\n\n                var doubleLinkToolsOffset = this.options.doubleLinkToolsOffset || offset;\n\n                toolPosition = this.getPointAtLength(connectionLength - doubleLinkToolsOffset);\n                this._tool2Cache.attr('transform', 'translate(' + toolPosition.x + ', ' + toolPosition.y + ') ' + scale);\n                this._tool2Cache.attr('visibility', 'visible');\n\n            } else if (this.options.doubleLinkTools) {\n\n                this._tool2Cache.attr('visibility', 'hidden');\n            }\n        }\n\n        return this;\n    },\n\n    updateArrowheadMarkers: function() {\n\n        if (!this._V.markerArrowheads) return this;\n\n        // getting bbox of an element with `display=\"none\"` in IE9 ends up with access violation\n        if ($.css(this._V.markerArrowheads.node, 'display') === 'none') return this;\n\n        var sx = this.getConnectionLength() < this.options.shortLinkLength ? .5 : 1;\n        this._V.sourceArrowhead.scale(sx);\n        this._V.targetArrowhead.scale(sx);\n\n        this._translateAndAutoOrientArrows(this._V.sourceArrowhead, this._V.targetArrowhead);\n\n        return this;\n    },\n\n    updateEndProperties: function(endType) {\n\n        const { model, paper } = this;\n        const endViewProperty = `${endType}View`;\n        const endDef = model.get(endType);\n        const endId = endDef && endDef.id;\n\n        if (!endId) {\n            // the link end is a point ~ rect 0x0\n            this[endViewProperty] = null;\n            this.updateEndMagnet(endType);\n            return true;\n        }\n\n        const endModel = paper.getModelById(endId);\n        if (!endModel) throw new Error('LinkView: invalid ' + endType + ' cell.');\n\n        const endView = endModel.findView(paper);\n        if (!endView) {\n            // A view for a model should always exist\n            return false;\n        }\n\n        this[endViewProperty] = endView;\n        this.updateEndMagnet(endType);\n        return true;\n    },\n\n    updateEndMagnet: function(endType) {\n\n        const endMagnetProperty = `${endType}Magnet`;\n        const endView = this.getEndView(endType);\n        if (endView) {\n            let connectedMagnet = endView.getMagnetFromLinkEnd(this.model.get(endType));\n            if (connectedMagnet === endView.el) connectedMagnet = null;\n            this[endMagnetProperty] = connectedMagnet;\n        } else {\n            this[endMagnetProperty] = null;\n        }\n    },\n\n    _translateAndAutoOrientArrows: function(sourceArrow, targetArrow) {\n\n        // Make the markers \"point\" to their sticky points being auto-oriented towards\n        // `targetPosition`/`sourcePosition`. And do so only if there is a markup for them.\n        var route = toArray(this.route);\n        if (sourceArrow) {\n            sourceArrow.translateAndAutoOrient(\n                this.sourcePoint,\n                route[0] || this.targetPoint,\n                this.paper.cells\n            );\n        }\n\n        if (targetArrow) {\n            targetArrow.translateAndAutoOrient(\n                this.targetPoint,\n                route[route.length - 1] || this.sourcePoint,\n                this.paper.cells\n            );\n        }\n    },\n\n    _getLabelPositionProperty: function(idx) {\n\n        return (this.model.label(idx).position || {});\n    },\n\n    _getLabelPositionAngle: function(idx) {\n\n        var labelPosition = this._getLabelPositionProperty(idx);\n        return (labelPosition.angle || 0);\n    },\n\n    _getLabelPositionArgs: function(idx) {\n\n        var labelPosition = this._getLabelPositionProperty(idx);\n        return labelPosition.args;\n    },\n\n    _getDefaultLabelPositionArgs: function() {\n\n        var defaultLabel = this.model._getDefaultLabel();\n        var defaultLabelPosition = defaultLabel.position || {};\n        return defaultLabelPosition.args;\n    },\n\n    // merge default label position args into label position args\n    // keep `undefined` or `null` because `{}` means something else\n    _mergeLabelPositionArgs: function(labelPositionArgs, defaultLabelPositionArgs) {\n\n        if (labelPositionArgs === null) return null;\n        if (labelPositionArgs === undefined) {\n\n            if (defaultLabelPositionArgs === null) return null;\n            return defaultLabelPositionArgs;\n        }\n\n        return merge({}, defaultLabelPositionArgs, labelPositionArgs);\n    },\n\n    // Add default label at given position at end of `labels` array.\n    // Four signatures:\n    // - obj, obj = point, opt\n    // - obj, num, obj = point, angle, opt\n    // - num, num, obj = x, y, opt\n    // - num, num, num, obj = x, y, angle, opt\n    // Assigns relative coordinates by default:\n    // `opt.absoluteDistance` forces absolute coordinates.\n    // `opt.reverseDistance` forces reverse absolute coordinates (if absoluteDistance = true).\n    // `opt.absoluteOffset` forces absolute coordinates for offset.\n    // Additional args:\n    // `opt.keepGradient` auto-adjusts the angle of the label to match path gradient at position.\n    // `opt.ensureLegibility` rotates labels so they are never upside-down.\n    addLabel: function(p1, p2, p3, p4) {\n\n        // normalize data from the four possible signatures\n        var localX;\n        var localY;\n        var localAngle = 0;\n        var localOpt;\n        if (typeof p1 !== 'number') {\n            // {x, y} object provided as first parameter\n            localX = p1.x;\n            localY = p1.y;\n            if (typeof p2 === 'number') {\n                // angle and opt provided as second and third parameters\n                localAngle = p2;\n                localOpt = p3;\n            } else {\n                // opt provided as second parameter\n                localOpt = p2;\n            }\n        } else {\n            // x and y provided as first and second parameters\n            localX = p1;\n            localY = p2;\n            if (typeof p3 === 'number') {\n                // angle and opt provided as third and fourth parameters\n                localAngle = p3;\n                localOpt = p4;\n            } else {\n                // opt provided as third parameter\n                localOpt = p3;\n            }\n        }\n\n        // merge label position arguments\n        var defaultLabelPositionArgs = this._getDefaultLabelPositionArgs();\n        var labelPositionArgs = localOpt;\n        var positionArgs = this._mergeLabelPositionArgs(labelPositionArgs, defaultLabelPositionArgs);\n\n        // append label to labels array\n        var label = { position: this.getLabelPosition(localX, localY, localAngle, positionArgs) };\n        var idx = -1;\n        this.model.insertLabel(idx, label, localOpt);\n        return idx;\n    },\n\n    // Add a new vertex at calculated index to the `vertices` array.\n    addVertex: function(x, y, opt) {\n\n        // accept input in form `{ x, y }, opt` or `x, y, opt`\n        var isPointProvided = (typeof x !== 'number');\n        var localX = isPointProvided ? x.x : x;\n        var localY = isPointProvided ? x.y : y;\n        var localOpt = isPointProvided ? y : opt;\n\n        var vertex = { x: localX, y: localY };\n        var idx = this.getVertexIndex(localX, localY);\n        this.model.insertVertex(idx, vertex, localOpt);\n        return idx;\n    },\n\n    // Send a token (an SVG element, usually a circle) along the connection path.\n    // Example: `link.findView(paper).sendToken(V('circle', { r: 7, fill: 'green' }).node)`\n    // `opt.duration` is optional and is a time in milliseconds that the token travels from the source to the target of the link. Default is `1000`.\n    // `opt.directon` is optional and it determines whether the token goes from source to target or other way round (`reverse`)\n    // `opt.connection` is an optional selector to the connection path.\n    // `callback` is optional and is a function to be called once the token reaches the target.\n    sendToken: function(token, opt, callback) {\n\n        function onAnimationEnd(vToken, callback) {\n            return function() {\n                vToken.remove();\n                if (typeof callback === 'function') {\n                    callback();\n                }\n            };\n        }\n\n        var duration, isReversed, selector;\n        if (isObject(opt)) {\n            duration = opt.duration;\n            isReversed = (opt.direction === 'reverse');\n            selector = opt.connection;\n        } else {\n            // Backwards compatibility\n            duration = opt;\n            isReversed = false;\n            selector = null;\n        }\n\n        duration = duration || 1000;\n\n        var animationAttributes = {\n            dur: duration + 'ms',\n            repeatCount: 1,\n            calcMode: 'linear',\n            fill: 'freeze'\n        };\n\n        if (isReversed) {\n            animationAttributes.keyPoints = '1;0';\n            animationAttributes.keyTimes = '0;1';\n        }\n\n        var vToken = V(token);\n        var connection;\n        if (typeof selector === 'string') {\n            // Use custom connection path.\n            connection = this.findBySelector(selector, this.el, this.selectors)[0];\n        } else {\n            // Select connection path automatically.\n            var cache = this._V;\n            connection = (cache.connection) ? cache.connection.node : this.el.querySelector('path');\n        }\n\n        if (!(connection instanceof SVGPathElement)) {\n            throw new Error('dia.LinkView: token animation requires a valid connection path.');\n        }\n\n        vToken\n            .appendTo(this.paper.cells)\n            .animateAlongPath(animationAttributes, connection);\n\n        setTimeout(onAnimationEnd(vToken, callback), duration);\n    },\n\n    findRoute: function(vertices) {\n\n        vertices || (vertices = []);\n\n        var namespace = this.paper.options.routerNamespace || routers;\n        var router = this.model.router();\n        var defaultRouter = this.paper.options.defaultRouter;\n\n        if (!router) {\n            if (defaultRouter) router = defaultRouter;\n            else return vertices.map(Point); // no router specified\n        }\n\n        var routerFn = isFunction(router) ? router : namespace[router.name];\n        if (!isFunction(routerFn)) {\n            throw new Error('dia.LinkView: unknown router: \"' + router.name + '\".');\n        }\n\n        var args = router.args || {};\n\n        var route = routerFn.call(\n            this, // context\n            vertices, // vertices\n            args, // options\n            this // linkView\n        );\n\n        if (!route) return vertices.map(Point);\n        return route;\n    },\n\n    // Return the `d` attribute value of the `<path>` element representing the link\n    // between `source` and `target`.\n    findPath: function(route, sourcePoint, targetPoint) {\n\n        var namespace = this.paper.options.connectorNamespace || connectors;\n        var connector = this.model.connector();\n        var defaultConnector = this.paper.options.defaultConnector;\n\n        if (!connector) {\n            connector = defaultConnector || {};\n        }\n\n        var connectorFn = isFunction(connector) ? connector : namespace[connector.name];\n        if (!isFunction(connectorFn)) {\n            throw new Error('dia.LinkView: unknown connector: \"' + connector.name + '\".');\n        }\n\n        var args = clone(connector.args || {});\n        args.raw = true; // Request raw g.Path as the result.\n\n        var path = connectorFn.call(\n            this, // context\n            sourcePoint, // start point\n            targetPoint, // end point\n            route, // vertices\n            args, // options\n            this // linkView\n        );\n\n        if (typeof path === 'string') {\n            // Backwards compatibility for connectors not supporting `raw` option.\n            path = new Path(V.normalizePathData(path));\n        }\n\n        return path;\n    },\n\n    // Public API.\n    // -----------\n\n    getConnection: function() {\n\n        var path = this.path;\n        if (!path) return null;\n\n        return path.clone();\n    },\n\n    getSerializedConnection: function() {\n\n        var path = this.path;\n        if (!path) return null;\n\n        var metrics = this.metrics;\n        if (metrics.hasOwnProperty('data')) return metrics.data;\n        var data = path.serialize();\n        metrics.data = data;\n        return data;\n    },\n\n    getConnectionSubdivisions: function() {\n\n        var path = this.path;\n        if (!path) return null;\n\n        var metrics = this.metrics;\n        if (metrics.hasOwnProperty('segmentSubdivisions')) return metrics.segmentSubdivisions;\n        var subdivisions = path.getSegmentSubdivisions();\n        metrics.segmentSubdivisions = subdivisions;\n        return subdivisions;\n    },\n\n    getConnectionLength: function() {\n\n        var path = this.path;\n        if (!path) return 0;\n\n        var metrics = this.metrics;\n        if (metrics.hasOwnProperty('length')) return metrics.length;\n        var length = path.length({ segmentSubdivisions: this.getConnectionSubdivisions() });\n        metrics.length = length;\n        return length;\n    },\n\n    getPointAtLength: function(length) {\n\n        var path = this.path;\n        if (!path) return null;\n\n        return path.pointAtLength(length, { segmentSubdivisions: this.getConnectionSubdivisions() });\n    },\n\n    getPointAtRatio: function(ratio) {\n\n        var path = this.path;\n        if (!path) return null;\n        if (isPercentage(ratio)) ratio = parseFloat(ratio) / 100;\n        return path.pointAt(ratio, { segmentSubdivisions: this.getConnectionSubdivisions() });\n    },\n\n    getTangentAtLength: function(length) {\n\n        var path = this.path;\n        if (!path) return null;\n\n        return path.tangentAtLength(length, { segmentSubdivisions: this.getConnectionSubdivisions() });\n    },\n\n    getTangentAtRatio: function(ratio) {\n\n        var path = this.path;\n        if (!path) return null;\n\n        return path.tangentAt(ratio, { segmentSubdivisions: this.getConnectionSubdivisions() });\n    },\n\n    getClosestPoint: function(point) {\n\n        var path = this.path;\n        if (!path) return null;\n\n        return path.closestPoint(point, { segmentSubdivisions: this.getConnectionSubdivisions() });\n    },\n\n    getClosestPointLength: function(point) {\n\n        var path = this.path;\n        if (!path) return null;\n\n        return path.closestPointLength(point, { segmentSubdivisions: this.getConnectionSubdivisions() });\n    },\n\n    getClosestPointRatio: function(point) {\n\n        var path = this.path;\n        if (!path) return null;\n\n        return path.closestPointNormalizedLength(point, { segmentSubdivisions: this.getConnectionSubdivisions() });\n    },\n\n    // Get label position object based on two provided coordinates, x and y.\n    // (Used behind the scenes when user moves labels around.)\n    // Two signatures:\n    // - num, num, obj = x, y, options\n    // - num, num, num, obj = x, y, angle, options\n    // Accepts distance/offset options = `absoluteDistance: boolean`, `reverseDistance: boolean`, `absoluteOffset: boolean`\n    // - `absoluteOffset` is necessary in order to move beyond connection endpoints\n    // Additional options = `keepGradient: boolean`, `ensureLegibility: boolean`\n    getLabelPosition: function(x, y, p3, p4) {\n\n        var position = {};\n\n        // normalize data from the two possible signatures\n        var localAngle = 0;\n        var localOpt;\n        if (typeof p3 === 'number') {\n            // angle and opt provided as third and fourth argument\n            localAngle = p3;\n            localOpt = p4;\n        } else {\n            // opt provided as third argument\n            localOpt = p3;\n        }\n\n        // save localOpt as `args` of the position object that is passed along\n        if (localOpt) position.args = localOpt;\n\n        // identify distance/offset settings\n        var isDistanceRelative = !(localOpt && localOpt.absoluteDistance); // relative by default\n        var isDistanceAbsoluteReverse = (localOpt && localOpt.absoluteDistance && localOpt.reverseDistance); // non-reverse by default\n        var isOffsetAbsolute = localOpt && localOpt.absoluteOffset; // offset is non-absolute by default\n\n        // find closest point t\n        var path = this.path;\n        var pathOpt = { segmentSubdivisions: this.getConnectionSubdivisions() };\n        var labelPoint = new Point(x, y);\n        var t = path.closestPointT(labelPoint, pathOpt);\n\n        // DISTANCE:\n        var labelDistance = path.lengthAtT(t, pathOpt);\n        if (isDistanceRelative) labelDistance = (labelDistance / this.getConnectionLength()) || 0; // fix to prevent NaN for 0 length\n        if (isDistanceAbsoluteReverse) labelDistance = (-1 * (this.getConnectionLength() - labelDistance)) || 1; // fix for end point (-0 => 1)\n        position.distance = labelDistance;\n\n        // OFFSET:\n        // use absolute offset if:\n        // - opt.absoluteOffset is true,\n        // - opt.absoluteOffset is not true but there is no tangent\n        var tangent;\n        if (!isOffsetAbsolute) tangent = path.tangentAtT(t);\n        var labelOffset;\n        if (tangent) {\n            labelOffset = tangent.pointOffset(labelPoint);\n        } else {\n            var closestPoint = path.pointAtT(t);\n            var labelOffsetDiff = labelPoint.difference(closestPoint);\n            labelOffset = { x: labelOffsetDiff.x, y: labelOffsetDiff.y };\n        }\n        position.offset = labelOffset;\n\n        // ANGLE:\n        position.angle = localAngle;\n\n        return position;\n    },\n\n    _getLabelTransformationMatrix: function(labelPosition) {\n\n        var labelDistance;\n        var labelAngle = 0;\n        var args = {};\n        if (typeof labelPosition === 'number') {\n            labelDistance = labelPosition;\n        } else if (typeof labelPosition.distance === 'number') {\n            args = labelPosition.args || {};\n            labelDistance = labelPosition.distance;\n            labelAngle = labelPosition.angle || 0;\n        } else {\n            throw new Error('dia.LinkView: invalid label position distance.');\n        }\n\n        var isDistanceRelative = ((labelDistance > 0) && (labelDistance <= 1));\n\n        var labelOffset = 0;\n        var labelOffsetCoordinates = { x: 0, y: 0 };\n        if (labelPosition.offset) {\n            var positionOffset = labelPosition.offset;\n            if (typeof positionOffset === 'number') labelOffset = positionOffset;\n            if (positionOffset.x) labelOffsetCoordinates.x = positionOffset.x;\n            if (positionOffset.y) labelOffsetCoordinates.y = positionOffset.y;\n        }\n\n        var isOffsetAbsolute = ((labelOffsetCoordinates.x !== 0) || (labelOffsetCoordinates.y !== 0) || labelOffset === 0);\n\n        var isKeepGradient = args.keepGradient;\n        var isEnsureLegibility = args.ensureLegibility;\n\n        var path = this.path;\n        var pathOpt = { segmentSubdivisions: this.getConnectionSubdivisions() };\n\n        var distance = isDistanceRelative ? (labelDistance * this.getConnectionLength()) : labelDistance;\n        var tangent = path.tangentAtLength(distance, pathOpt);\n\n        var translation;\n        var angle = labelAngle;\n        if (tangent) {\n            if (isOffsetAbsolute) {\n                translation = tangent.start.clone();\n                translation.offset(labelOffsetCoordinates);\n            } else {\n                var normal = tangent.clone();\n                normal.rotate(tangent.start, -90);\n                normal.setLength(labelOffset);\n                translation = normal.end;\n            }\n\n            if (isKeepGradient) {\n                angle = (tangent.angle() + labelAngle);\n                if (isEnsureLegibility) {\n                    angle = normalizeAngle(((angle + 90) % 180) - 90);\n                }\n            }\n\n        } else {\n            // fallback - the connection has zero length\n            translation = path.start.clone();\n            if (isOffsetAbsolute) translation.offset(labelOffsetCoordinates);\n        }\n\n        return V.createSVGMatrix()\n            .translate(translation.x, translation.y)\n            .rotate(angle);\n    },\n\n    getLabelCoordinates: function(labelPosition) {\n\n        var transformationMatrix = this._getLabelTransformationMatrix(labelPosition);\n        return new Point(transformationMatrix.e, transformationMatrix.f);\n    },\n\n    getVertexIndex: function(x, y) {\n\n        var model = this.model;\n        var vertices = model.vertices();\n\n        var vertexLength = this.getClosestPointLength(new Point(x, y));\n\n        var idx = 0;\n        for (var n = vertices.length; idx < n; idx++) {\n            var currentVertex = vertices[idx];\n            var currentVertexLength = this.getClosestPointLength(currentVertex);\n            if (vertexLength < currentVertexLength) break;\n        }\n\n        return idx;\n    },\n\n    // Interaction. The controller part.\n    // ---------------------------------\n\n    notifyPointerdown(evt, x, y) {\n        CellView.prototype.pointerdown.call(this, evt, x, y);\n        this.notify('link:pointerdown', evt, x, y);\n    },\n\n    notifyPointermove(evt, x, y) {\n        CellView.prototype.pointermove.call(this, evt, x, y);\n        this.notify('link:pointermove', evt, x, y);\n    },\n\n    notifyPointerup(evt, x, y) {\n        this.notify('link:pointerup', evt, x, y);\n        CellView.prototype.pointerup.call(this, evt, x, y);\n    },\n\n    pointerdblclick: function(evt, x, y) {\n\n        CellView.prototype.pointerdblclick.apply(this, arguments);\n        this.notify('link:pointerdblclick', evt, x, y);\n    },\n\n    pointerclick: function(evt, x, y) {\n\n        CellView.prototype.pointerclick.apply(this, arguments);\n        this.notify('link:pointerclick', evt, x, y);\n    },\n\n    contextmenu: function(evt, x, y) {\n\n        CellView.prototype.contextmenu.apply(this, arguments);\n        this.notify('link:contextmenu', evt, x, y);\n    },\n\n    pointerdown: function(evt, x, y) {\n\n        this.notifyPointerdown(evt, x, y);\n\n        // Backwards compatibility for the default markup\n        var className = evt.target.getAttribute('class');\n        switch (className) {\n\n            case 'marker-vertex':\n                this.dragVertexStart(evt, x, y);\n                return;\n\n            case 'marker-vertex-remove':\n            case 'marker-vertex-remove-area':\n                this.dragVertexRemoveStart(evt, x, y);\n                return;\n\n            case 'marker-arrowhead':\n                this.dragArrowheadStart(evt, x, y);\n                return;\n\n            case 'connection':\n            case 'connection-wrap':\n                this.dragConnectionStart(evt, x, y);\n                return;\n\n            case 'marker-source':\n            case 'marker-target':\n                return;\n        }\n\n        this.dragStart(evt, x, y);\n    },\n\n    pointermove: function(evt, x, y) {\n\n        // Backwards compatibility\n        var dragData = this._dragData;\n        if (dragData) this.eventData(evt, dragData);\n\n        var data = this.eventData(evt);\n        switch (data.action) {\n\n            case 'vertex-move':\n                this.dragVertex(evt, x, y);\n                break;\n\n            case 'label-move':\n                this.dragLabel(evt, x, y);\n                break;\n\n            case 'arrowhead-move':\n                this.dragArrowhead(evt, x, y);\n                break;\n\n            case 'move':\n                this.drag(evt, x, y);\n                break;\n        }\n\n        // Backwards compatibility\n        if (dragData) assign(dragData, this.eventData(evt));\n\n        this.notifyPointermove(evt, x, y);\n    },\n\n    pointerup: function(evt, x, y) {\n\n        // Backwards compatibility\n        var dragData = this._dragData;\n        if (dragData) {\n            this.eventData(evt, dragData);\n            this._dragData = null;\n        }\n\n        var data = this.eventData(evt);\n        switch (data.action) {\n\n            case 'vertex-move':\n                this.dragVertexEnd(evt, x, y);\n                break;\n\n            case 'label-move':\n                this.dragLabelEnd(evt, x, y);\n                break;\n\n            case 'arrowhead-move':\n                this.dragArrowheadEnd(evt, x, y);\n                break;\n\n            case 'move':\n                this.dragEnd(evt, x, y);\n        }\n\n        this.notifyPointerup(evt, x, y);\n        this.checkMouseleave(evt);\n    },\n\n    mouseover: function(evt) {\n\n        CellView.prototype.mouseover.apply(this, arguments);\n        this.notify('link:mouseover', evt);\n    },\n\n    mouseout: function(evt) {\n\n        CellView.prototype.mouseout.apply(this, arguments);\n        this.notify('link:mouseout', evt);\n    },\n\n    mouseenter: function(evt) {\n\n        CellView.prototype.mouseenter.apply(this, arguments);\n        this.notify('link:mouseenter', evt);\n    },\n\n    mouseleave: function(evt) {\n\n        CellView.prototype.mouseleave.apply(this, arguments);\n        this.notify('link:mouseleave', evt);\n    },\n\n    mousewheel: function(evt, x, y, delta) {\n\n        CellView.prototype.mousewheel.apply(this, arguments);\n        this.notify('link:mousewheel', evt, x, y, delta);\n    },\n\n    onevent: function(evt, eventName, x, y) {\n\n        // Backwards compatibility\n        var linkTool = V(evt.target).findParentByClass('link-tool', this.el);\n        if (linkTool) {\n            // No further action to be executed\n            evt.stopPropagation();\n\n            // Allow `interactive.useLinkTools=false`\n            if (this.can('useLinkTools')) {\n                if (eventName === 'remove') {\n                    // Built-in remove event\n                    this.model.remove({ ui: true });\n                    // Do not trigger link pointerdown\n                    return;\n\n                } else {\n                    // link:options and other custom events inside the link tools\n                    this.notify(eventName, evt, x, y);\n                }\n            }\n\n            this.notifyPointerdown(evt, x, y);\n            this.paper.delegateDragEvents(this, evt.data);\n\n        } else {\n            CellView.prototype.onevent.apply(this, arguments);\n        }\n    },\n\n    onlabel: function(evt, x, y) {\n\n        this.notifyPointerdown(evt, x, y);\n\n        this.dragLabelStart(evt, x, y);\n\n        var stopPropagation = this.eventData(evt).stopPropagation;\n        if (stopPropagation) evt.stopPropagation();\n    },\n\n    // Drag Start Handlers\n\n    dragConnectionStart: function(evt, x, y) {\n\n        if (!this.can('vertexAdd')) return;\n\n        // Store the index at which the new vertex has just been placed.\n        // We'll be update the very same vertex position in `pointermove()`.\n        var vertexIdx = this.addVertex({ x: x, y: y }, { ui: true });\n        this.eventData(evt, {\n            action: 'vertex-move',\n            vertexIdx: vertexIdx\n        });\n    },\n\n    dragLabelStart: function(evt, x, y) {\n\n        if (this.can('labelMove')) {\n\n            if (this.isDefaultInteractionPrevented(evt)) return;\n\n            var labelNode = evt.currentTarget;\n            var labelIdx = parseInt(labelNode.getAttribute('label-idx'), 10);\n\n            var defaultLabelPosition = this._getDefaultLabelPositionProperty();\n            var initialLabelPosition = this._normalizeLabelPosition(this._getLabelPositionProperty(labelIdx));\n            var position = this._mergeLabelPositionProperty(initialLabelPosition, defaultLabelPosition);\n\n            var coords = this.getLabelCoordinates(position);\n            var dx = coords.x - x; // how much needs to be added to cursor x to get to label x\n            var dy = coords.y - y; // how much needs to be added to cursor y to get to label y\n\n            var positionAngle = this._getLabelPositionAngle(labelIdx);\n            var labelPositionArgs = this._getLabelPositionArgs(labelIdx);\n            var defaultLabelPositionArgs = this._getDefaultLabelPositionArgs();\n            var positionArgs = this._mergeLabelPositionArgs(labelPositionArgs, defaultLabelPositionArgs);\n\n            this.eventData(evt, {\n                action: 'label-move',\n                labelIdx: labelIdx,\n                dx: dx,\n                dy: dy,\n                positionAngle: positionAngle,\n                positionArgs: positionArgs,\n                stopPropagation: true\n            });\n\n        } else {\n\n            // Backwards compatibility:\n            // If labels can't be dragged no default action is triggered.\n            this.eventData(evt, { stopPropagation: true });\n        }\n\n        this.paper.delegateDragEvents(this, evt.data);\n    },\n\n    dragVertexStart: function(evt, x, y) {\n\n        if (!this.can('vertexMove')) return;\n\n        var vertexNode = evt.target;\n        var vertexIdx = parseInt(vertexNode.getAttribute('idx'), 10);\n        this.eventData(evt, {\n            action: 'vertex-move',\n            vertexIdx: vertexIdx\n        });\n    },\n\n    dragVertexRemoveStart: function(evt, x, y) {\n\n        if (!this.can('vertexRemove')) return;\n\n        var removeNode = evt.target;\n        var vertexIdx = parseInt(removeNode.getAttribute('idx'), 10);\n        this.model.removeVertex(vertexIdx);\n    },\n\n    dragArrowheadStart: function(evt, x, y) {\n\n        if (!this.can('arrowheadMove')) return;\n\n        var arrowheadNode = evt.target;\n        var arrowheadType = arrowheadNode.getAttribute('end');\n        var data = this.startArrowheadMove(arrowheadType, { ignoreBackwardsCompatibility: true });\n\n        this.eventData(evt, data);\n    },\n\n    dragStart: function(evt, x, y) {\n\n        if (this.isDefaultInteractionPrevented(evt)) return;\n\n        if (!this.can('linkMove')) return;\n\n        this.eventData(evt, {\n            action: 'move',\n            dx: x,\n            dy: y\n        });\n    },\n\n    // Drag Handlers\n    dragLabel: function(evt, x, y) {\n\n        var data = this.eventData(evt);\n        var label = { position: this.getLabelPosition((x + data.dx), (y + data.dy), data.positionAngle, data.positionArgs) };\n        if (this.paper.options.snapLabels) delete label.position.offset;\n        // The `touchmove' events are not fired\n        // when the original event target is removed from the DOM.\n        // The labels are currently re-rendered completely when only\n        // the position changes. This is why we need to make sure that\n        // the label is updated synchronously.\n        // TODO: replace `touchmove` with `pointermove` (breaking change).\n        const setOptions = { ui: true };\n        if (this.paper.isAsync() && evt.type === 'touchmove') {\n            setOptions.async = false;\n        }\n        this.model.label(data.labelIdx, label, setOptions);\n    },\n\n    dragVertex: function(evt, x, y) {\n\n        var data = this.eventData(evt);\n        this.model.vertex(data.vertexIdx, { x: x, y: y }, { ui: true });\n    },\n\n    dragArrowhead: function(evt, x, y) {\n        if (this.paper.options.snapLinks) {\n            const isSnapped = this._snapArrowhead(evt, x, y);\n            if (!isSnapped && this.paper.options.snapLinksSelf) {\n                this._snapArrowheadSelf(evt, x, y);\n            }\n        } else {\n            if (this.paper.options.snapLinksSelf) {\n                this._snapArrowheadSelf(evt, x, y);\n            } else {\n                this._connectArrowhead(this.getEventTarget(evt), x, y, this.eventData(evt));\n            }\n        }\n    },\n\n    drag: function(evt, x, y) {\n\n        var data = this.eventData(evt);\n        this.model.translate(x - data.dx, y - data.dy, { ui: true });\n        this.eventData(evt, {\n            dx: x,\n            dy: y\n        });\n    },\n\n    // Drag End Handlers\n\n    dragLabelEnd: function() {\n        // noop\n    },\n\n    dragVertexEnd: function() {\n        // noop\n    },\n\n    dragArrowheadEnd: function(evt, x, y) {\n\n        var data = this.eventData(evt);\n        var paper = this.paper;\n\n        if (paper.options.snapLinks) {\n            this._snapArrowheadEnd(data);\n        } else {\n            this._connectArrowheadEnd(data, x, y);\n        }\n\n        if (!paper.linkAllowed(this)) {\n            // If the changed link is not allowed, revert to its previous state.\n            this._disallow(data);\n        } else {\n            this._finishEmbedding(data);\n            this._notifyConnectEvent(data, evt);\n        }\n\n        this._afterArrowheadMove(data);\n    },\n\n    dragEnd: function() {\n        // noop\n    },\n\n    _disallow: function(data) {\n\n        switch (data.whenNotAllowed) {\n\n            case 'remove':\n                this.model.remove({ ui: true });\n                break;\n\n            case 'revert':\n            default:\n                this.model.set(data.arrowhead, data.initialEnd, { ui: true });\n                break;\n        }\n    },\n\n    _finishEmbedding: function(data) {\n\n        // Reparent the link if embedding is enabled\n        if (this.paper.options.embeddingMode && this.model.reparent()) {\n            // Make sure we don't reverse to the original 'z' index (see afterArrowheadMove()).\n            data.z = null;\n        }\n    },\n\n    _notifyConnectEvent: function(data, evt) {\n\n        var arrowhead = data.arrowhead;\n        var initialEnd = data.initialEnd;\n        var currentEnd = this.model.prop(arrowhead);\n        var endChanged = currentEnd && !Link.endsEqual(initialEnd, currentEnd);\n        if (endChanged) {\n            var paper = this.paper;\n            if (initialEnd.id) {\n                this.notify('link:disconnect', evt, paper.findViewByModel(initialEnd.id), data.initialMagnet, arrowhead);\n            }\n            if (currentEnd.id) {\n                this.notify('link:connect', evt, paper.findViewByModel(currentEnd.id), data.magnetUnderPointer, arrowhead);\n            }\n        }\n    },\n\n    _snapToPoints: function(snapPoint, points, radius) {\n        let closestPointX = null;\n        let closestDistanceX = Infinity;\n\n        let closestPointY = null;\n        let closestDistanceY = Infinity;\n\n        let x = snapPoint.x;\n        let y = snapPoint.y;\n\n        for (let i = 0; i < points.length; i++) {\n            const distX = Math.abs(points[i].x - snapPoint.x);\n            if (distX < closestDistanceX) {\n                closestDistanceX = distX;\n                closestPointX = points[i];\n            }\n\n            const distY = Math.abs(points[i].y - snapPoint.y);\n            if (distY < closestDistanceY) {\n                closestDistanceY = distY;\n                closestPointY = points[i];\n            }\n        }\n\n        if (closestDistanceX < radius) {\n            x = closestPointX.x;\n        }\n        if (closestDistanceY < radius) {\n            y = closestPointY.y;\n        }\n\n        return { x, y };\n    },\n\n    _snapArrowheadSelf: function(evt, x, y) {\n\n        const { paper, model } = this;\n        const { snapLinksSelf } = paper.options;\n        const data = this.eventData(evt);\n        const radius = snapLinksSelf.radius || 20;\n\n        const anchor = this.getEndAnchor(data.arrowhead === 'source' ? 'target' : 'source');\n        const vertices = model.vertices();\n        const points = [anchor, ...vertices];\n\n        const snapPoint = this._snapToPoints({ x: x, y: y }, points, radius);\n\n        const point = paper.localToClientPoint(snapPoint);\n        this._connectArrowhead(document.elementFromPoint(point.x, point.y), snapPoint.x, snapPoint.y, this.eventData(evt));\n    },\n\n    _snapArrowhead: function(evt, x, y) {\n\n        const { paper } = this;\n        const { snapLinks, connectionStrategy } = paper.options;\n        const data = this.eventData(evt);\n        let isSnapped = false;\n        // checking view in close area of the pointer\n\n        var r = snapLinks.radius || 50;\n        var viewsInArea = paper.findViewsInArea({ x: x - r, y: y - r, width: 2 * r, height: 2 * r });\n\n        var prevClosestView = data.closestView || null;\n        var prevClosestMagnet = data.closestMagnet || null;\n        var prevMagnetProxy = data.magnetProxy || null;\n\n        data.closestView = data.closestMagnet = data.magnetProxy = null;\n\n        var minDistance = Number.MAX_VALUE;\n        var pointer = new Point(x, y);\n\n        viewsInArea.forEach(function(view) {\n            const candidates = [];\n            // skip connecting to the element in case '.': { magnet: false } attribute present\n            if (view.el.getAttribute('magnet') !== 'false') {\n                candidates.push({\n                    bbox: view.model.getBBox(),\n                    magnet: view.el\n                });\n            }\n\n            view.$('[magnet]').toArray().forEach(magnet => {\n                candidates.push({\n                    bbox: view.getNodeBBox(magnet),\n                    magnet\n                });\n            });\n\n            candidates.forEach(candidate => {\n                const { magnet, bbox } = candidate;\n                // find distance from the center of the model to pointer coordinates\n                const distance = bbox.center().squaredDistance(pointer);\n                // the connection is looked up in a circle area by `distance < r`\n                if (distance < minDistance) {\n                    const isAlreadyValidated = prevClosestMagnet === magnet;\n                    if (isAlreadyValidated || paper.options.validateConnection.apply(\n                        paper, data.validateConnectionArgs(view, (view.el === magnet) ? null : magnet)\n                    )) {\n                        minDistance = distance;\n                        data.closestView = view;\n                        data.closestMagnet = magnet;\n                    }\n                }\n            });\n\n        }, this);\n\n        var end;\n        var magnetProxy = null;\n        var closestView = data.closestView;\n        var closestMagnet = data.closestMagnet;\n        if (closestMagnet) {\n            magnetProxy = data.magnetProxy = closestView.findProxyNode(closestMagnet, 'highlighter');\n        }\n        var endType = data.arrowhead;\n        var newClosestMagnet = (prevClosestMagnet !== closestMagnet);\n        if (prevClosestView && newClosestMagnet) {\n            prevClosestView.unhighlight(prevMagnetProxy, {\n                connecting: true,\n                snapping: true\n            });\n        }\n\n        if (closestView) {\n            const { prevEnd, prevX, prevY } = data;\n            data.prevX = x;\n            data.prevY = y;\n            isSnapped = true;\n\n            if (!newClosestMagnet)  {\n                if (typeof connectionStrategy !== 'function' || (prevX === x && prevY === y)) {\n                    // the magnet has not changed and the link's end does not depend on the x and y\n                    return isSnapped;\n                }\n            }\n\n            end = closestView.getLinkEnd(closestMagnet, x, y, this.model, endType);\n            if (!newClosestMagnet && isEqual(prevEnd, end)) {\n                // the source/target json has not changed\n                return isSnapped;\n            }\n\n            data.prevEnd = end;\n\n            if (newClosestMagnet) {\n                closestView.highlight(magnetProxy, {\n                    connecting: true,\n                    snapping: true\n                });\n            }\n\n        } else {\n\n            end = { x: x, y: y };\n        }\n\n        this.model.set(endType, end || { x: x, y: y }, { ui: true });\n\n        if (prevClosestView) {\n            this.notify('link:snap:disconnect', evt, prevClosestView, prevClosestMagnet, endType);\n        }\n        if (closestView) {\n            this.notify('link:snap:connect', evt, closestView, closestMagnet, endType);\n        }\n\n        return isSnapped;\n    },\n\n    _snapArrowheadEnd: function(data) {\n\n        // Finish off link snapping.\n        // Everything except view unhighlighting was already done on pointermove.\n        var closestView = data.closestView;\n        var closestMagnet = data.closestMagnet;\n        if (closestView && closestMagnet) {\n\n            closestView.unhighlight(data.magnetProxy, { connecting: true, snapping: true });\n            data.magnetUnderPointer = closestView.findMagnet(closestMagnet);\n        }\n\n        data.closestView = data.closestMagnet = null;\n    },\n\n    _connectArrowhead: function(target, x, y, data) {\n\n        // checking views right under the pointer\n        const { paper, model } = this;\n\n        if (data.eventTarget !== target) {\n            // Unhighlight the previous view under pointer if there was one.\n            if (data.magnetProxy) {\n                data.viewUnderPointer.unhighlight(data.magnetProxy, {\n                    connecting: true\n                });\n            }\n\n            const viewUnderPointer = data.viewUnderPointer = paper.findView(target);\n            if (viewUnderPointer) {\n                // If we found a view that is under the pointer, we need to find the closest\n                // magnet based on the real target element of the event.\n                const magnetUnderPointer = data.magnetUnderPointer = viewUnderPointer.findMagnet(target);\n                const magnetProxy = data.magnetProxy = viewUnderPointer.findProxyNode(magnetUnderPointer, 'highlighter');\n\n                if (magnetUnderPointer && this.paper.options.validateConnection.apply(\n                    paper,\n                    data.validateConnectionArgs(viewUnderPointer, magnetUnderPointer)\n                )) {\n                    // If there was no magnet found, do not highlight anything and assume there\n                    // is no view under pointer we're interested in reconnecting to.\n                    // This can only happen if the overall element has the attribute `'.': { magnet: false }`.\n                    if (magnetProxy) {\n                        viewUnderPointer.highlight(magnetProxy, {\n                            connecting: true\n                        });\n                    }\n                } else {\n                    // This type of connection is not valid. Disregard this magnet.\n                    data.magnetUnderPointer = null;\n                    data.magnetProxy = null;\n                }\n            } else {\n                // Make sure we'll unset previous magnet.\n                data.magnetUnderPointer = null;\n                data.magnetProxy = null;\n            }\n        }\n\n        data.eventTarget = target;\n\n        model.set(data.arrowhead, { x: x, y: y }, { ui: true });\n    },\n\n    _connectArrowheadEnd: function(data = {}, x, y) {\n\n        const { model } = this;\n        const { viewUnderPointer, magnetUnderPointer, magnetProxy, arrowhead } = data;\n\n        if (!magnetUnderPointer || !magnetProxy || !viewUnderPointer) return;\n\n        viewUnderPointer.unhighlight(magnetProxy, { connecting: true });\n\n        // The link end is taken from the magnet under the pointer, not the proxy.\n        const end = viewUnderPointer.getLinkEnd(magnetUnderPointer, x, y, model, arrowhead);\n        model.set(arrowhead, end, { ui: true });\n    },\n\n    _beforeArrowheadMove: function(data) {\n\n        data.z = this.model.get('z');\n        this.model.toFront();\n\n        // Let the pointer propagate through the link view elements so that\n        // the `evt.target` is another element under the pointer, not the link itself.\n        var style = this.el.style;\n        data.pointerEvents = style.pointerEvents;\n        style.pointerEvents = 'none';\n\n        if (this.paper.options.markAvailable) {\n            this._markAvailableMagnets(data);\n        }\n    },\n\n    _afterArrowheadMove: function(data) {\n\n        if (data.z !== null) {\n            this.model.set('z', data.z, { ui: true });\n            data.z = null;\n        }\n\n        // Put `pointer-events` back to its original value. See `_beforeArrowheadMove()` for explanation.\n        this.el.style.pointerEvents = data.pointerEvents;\n\n        if (this.paper.options.markAvailable) {\n            this._unmarkAvailableMagnets(data);\n        }\n    },\n\n    _createValidateConnectionArgs: function(arrowhead) {\n        // It makes sure the arguments for validateConnection have the following form:\n        // (source view, source magnet, target view, target magnet and link view)\n        var args = [];\n\n        args[4] = arrowhead;\n        args[5] = this;\n\n        var oppositeArrowhead;\n        var i = 0;\n        var j = 0;\n\n        if (arrowhead === 'source') {\n            i = 2;\n            oppositeArrowhead = 'target';\n        } else {\n            j = 2;\n            oppositeArrowhead = 'source';\n        }\n\n        var end = this.model.get(oppositeArrowhead);\n\n        if (end.id) {\n            var view = args[i] = this.paper.findViewByModel(end.id);\n            var magnet = view.getMagnetFromLinkEnd(end);\n            if (magnet === view.el) magnet = undefined;\n            args[i + 1] = magnet;\n        }\n\n        function validateConnectionArgs(cellView, magnet) {\n            args[j] = cellView;\n            args[j + 1] = cellView.el === magnet ? undefined : magnet;\n            return args;\n        }\n\n        return validateConnectionArgs;\n    },\n\n    _markAvailableMagnets: function(data) {\n\n        function isMagnetAvailable(view, magnet) {\n            var paper = view.paper;\n            var validate = paper.options.validateConnection;\n            return validate.apply(paper, this.validateConnectionArgs(view, magnet));\n        }\n\n        var paper = this.paper;\n        var elements = paper.model.getCells();\n        data.marked = {};\n\n        for (var i = 0, n = elements.length; i < n; i++) {\n            var view = elements[i].findView(paper);\n\n            if (!view) {\n                continue;\n            }\n\n            var magnets = Array.prototype.slice.call(view.el.querySelectorAll('[magnet]'));\n            if (view.el.getAttribute('magnet') !== 'false') {\n                // Element wrapping group is also a magnet\n                magnets.push(view.el);\n            }\n\n            var availableMagnets = magnets.filter(isMagnetAvailable.bind(data, view));\n\n            if (availableMagnets.length > 0) {\n                // highlight all available magnets\n                for (var j = 0, m = availableMagnets.length; j < m; j++) {\n                    view.highlight(availableMagnets[j], { magnetAvailability: true });\n                }\n                // highlight the entire view\n                view.highlight(null, { elementAvailability: true });\n\n                data.marked[view.model.id] = availableMagnets;\n            }\n        }\n    },\n\n    _unmarkAvailableMagnets: function(data) {\n\n        var markedKeys = Object.keys(data.marked);\n        var id;\n        var markedMagnets;\n\n        for (var i = 0, n = markedKeys.length; i < n; i++) {\n            id = markedKeys[i];\n            markedMagnets = data.marked[id];\n\n            var view = this.paper.findViewByModel(id);\n            if (view) {\n                for (var j = 0, m = markedMagnets.length; j < m; j++) {\n                    view.unhighlight(markedMagnets[j], { magnetAvailability: true });\n                }\n                view.unhighlight(null, { elementAvailability: true });\n            }\n        }\n\n        data.marked = null;\n    },\n\n    startArrowheadMove: function(end, opt) {\n\n        opt || (opt = {});\n\n        // Allow to delegate events from an another view to this linkView in order to trigger arrowhead\n        // move without need to click on the actual arrowhead dom element.\n        var data = {\n            action: 'arrowhead-move',\n            arrowhead: end,\n            whenNotAllowed: opt.whenNotAllowed || 'revert',\n            initialMagnet: this[end + 'Magnet'] || (this[end + 'View'] ? this[end + 'View'].el : null),\n            initialEnd: clone(this.model.get(end)),\n            validateConnectionArgs: this._createValidateConnectionArgs(end)\n        };\n\n        this._beforeArrowheadMove(data);\n\n        if (opt.ignoreBackwardsCompatibility !== true) {\n            this._dragData = data;\n        }\n\n        return data;\n    },\n\n    // Lifecycle methods\n\n    onMount: function() {\n        CellView.prototype.onMount.apply(this, arguments);\n        this.mountLabels();\n    },\n\n    onDetach: function() {\n        CellView.prototype.onDetach.apply(this, arguments);\n        this.unmountLabels();\n    },\n\n    onRemove: function() {\n        CellView.prototype.onRemove.apply(this, arguments);\n        this.unmountLabels();\n    }\n\n}, {\n\n    Flags: Flags,\n});\n\nObject.defineProperty(LinkView.prototype, 'sourceBBox', {\n\n    enumerable: true,\n\n    get: function() {\n        var sourceView = this.sourceView;\n        if (!sourceView) {\n            var sourceDef = this.model.source();\n            return new Rect(sourceDef.x, sourceDef.y);\n        }\n        var sourceMagnet = this.sourceMagnet;\n        if (sourceView.isNodeConnection(sourceMagnet)) {\n            return new Rect(this.sourceAnchor);\n        }\n        return sourceView.getNodeBBox(sourceMagnet || sourceView.el);\n    }\n\n});\n\nObject.defineProperty(LinkView.prototype, 'targetBBox', {\n\n    enumerable: true,\n\n    get: function() {\n        var targetView = this.targetView;\n        if (!targetView) {\n            var targetDef = this.model.target();\n            return new Rect(targetDef.x, targetDef.y);\n        }\n        var targetMagnet = this.targetMagnet;\n        if (targetView.isNodeConnection(targetMagnet)) {\n            return new Rect(this.targetAnchor);\n        }\n        return targetView.getNodeBBox(targetMagnet || targetView.el);\n    }\n});\n\n","import { assign } from '../util/index.mjs';\nimport V from '../V/index.mjs';\nimport { HighlighterView } from '../dia/HighlighterView.mjs';\n\nexport const stroke = HighlighterView.extend({\n\n    tagName: 'path',\n    className: 'highlight-stroke',\n    attributes: {\n        'pointer-events': 'none',\n        'vector-effect': 'non-scaling-stroke',\n        'fill': 'none'\n    },\n\n    options: {\n        padding: 3,\n        rx: 0,\n        ry: 0,\n        useFirstSubpath: false,\n        attrs: {\n            'stroke-width': 3,\n            'stroke': '#FEB663'\n        }\n    },\n\n    getPathData(cellView, node) {\n        const { options } = this;\n        const { useFirstSubpath } = options;\n        let d;\n        try {\n            const vNode = V(node);\n            d = vNode.convertToPathData().trim();\n            if (vNode.tagName() === 'PATH' && useFirstSubpath) {\n                const secondSubpathIndex = d.search(/.M/i) + 1;\n                if (secondSubpathIndex > 0) {\n                    d = d.substr(0, secondSubpathIndex);\n                }\n            }\n        } catch (error) {\n            // Failed to get path data from magnet element.\n            // Draw a rectangle around the node instead.\n            const nodeBBox = cellView.getNodeBoundingRect(node);\n            d = V.rectToPath(assign({}, options, nodeBBox.toJSON()));\n        }\n        return d;\n    },\n\n    highlightConnection(cellView) {\n        this.vel.attr('d', cellView.getSerializedConnection());\n    },\n\n    highlightNode(cellView, node) {\n        const { vel, options } = this;\n        const { padding, layer } = options;\n        let highlightMatrix = this.getNodeMatrix(cellView, node);\n        // Add padding to the highlight element.\n        if (padding) {\n            if (!layer && node === cellView.el) {\n                // If the highlighter is appended to the cellView\n                // and we measure the size of the cellView wrapping group\n                // it's necessary to remove the highlighter first\n                vel.remove();\n            }\n            let nodeBBox = cellView.getNodeBoundingRect(node);\n            const cx = nodeBBox.x + (nodeBBox.width / 2);\n            const cy = nodeBBox.y + (nodeBBox.height / 2);\n            nodeBBox = V.transformRect(nodeBBox, highlightMatrix);\n            const width = Math.max(nodeBBox.width, 1);\n            const height = Math.max(nodeBBox.height, 1);\n            const sx = (width + padding) / width;\n            const sy = (height + padding) / height;\n            const paddingMatrix = V.createSVGMatrix({\n                a: sx,\n                b: 0,\n                c: 0,\n                d: sy,\n                e: cx - sx * cx,\n                f: cy - sy * cy\n            });\n            highlightMatrix = highlightMatrix.multiply(paddingMatrix);\n        }\n        vel.attr({\n            'd': this.getPathData(cellView, node),\n            'transform': V.matrixToTransformString(highlightMatrix)\n        });\n    },\n\n    highlight(cellView, node) {\n        const { vel, options } = this;\n        vel.attr(options.attrs);\n        if (cellView.isNodeConnection(node)) {\n            this.highlightConnection(cellView);\n        } else {\n            this.highlightNode(cellView, node);\n        }\n    }\n\n});\n","import V from '../V/index.mjs';\nimport { HighlighterView } from '../dia/HighlighterView.mjs';\n\nconst MASK_CLIP = 20;\n\nfunction forEachDescendant(vel, fn) {\n    const descendants = vel.children();\n    while (descendants.length > 0) {\n        const descendant = descendants.shift();\n        if (fn(descendant)) {\n            descendants.push(...descendant.children());\n        }\n    }\n}\n\nexport const mask = HighlighterView.extend({\n\n    tagName: 'rect',\n    className: 'highlight-mask',\n    attributes: {\n        'pointer-events': 'none'\n    },\n\n    options: {\n        padding: 3,\n        maskClip: MASK_CLIP,\n        deep: false,\n        attrs: {\n            'stroke': '#FEB663',\n            'stroke-width': 3,\n            'stroke-linecap': 'butt',\n            'stroke-linejoin': 'miter',\n        }\n    },\n\n    VISIBLE: 'white',\n    INVISIBLE: 'black',\n\n    MASK_ROOT_ATTRIBUTE_BLACKLIST: [\n        'marker-start',\n        'marker-end',\n        'marker-mid',\n        'transform',\n        'stroke-dasharray',\n        'class',\n    ],\n\n    MASK_CHILD_ATTRIBUTE_BLACKLIST: [\n        'stroke',\n        'fill',\n        'stroke-width',\n        'stroke-opacity',\n        'stroke-dasharray',\n        'fill-opacity',\n        'marker-start',\n        'marker-end',\n        'marker-mid',\n        'class',\n    ],\n\n    // TODO: change the list to a function callback\n    MASK_REPLACE_TAGS: [\n        'FOREIGNOBJECT',\n        'IMAGE',\n        'USE',\n        'TEXT',\n        'TSPAN',\n        'TEXTPATH'\n    ],\n\n    // TODO: change the list to a function callback\n    MASK_REMOVE_TAGS: [\n        'TEXT',\n        'TSPAN',\n        'TEXTPATH'\n    ],\n\n    transformMaskChild(cellView, childEl) {\n        const {\n            MASK_CHILD_ATTRIBUTE_BLACKLIST,\n            MASK_REPLACE_TAGS,\n            MASK_REMOVE_TAGS\n        } = this;\n        const childTagName = childEl.tagName();\n        // Do not include the element in the mask's image\n        if (!V.isSVGGraphicsElement(childEl) || MASK_REMOVE_TAGS.includes(childTagName)) {\n            childEl.remove();\n            return false;\n        }\n        // Replace the element with a rectangle\n        if (MASK_REPLACE_TAGS.includes(childTagName)) {\n            // Note: clone() method does not change the children ids\n            const originalChild = cellView.vel.findOne(`#${childEl.id}`);\n            if (originalChild) {\n                const { node: originalNode } = originalChild;\n                let childBBox = cellView.getNodeBoundingRect(originalNode);\n                if (cellView.model.isElement()) {\n                    childBBox = V.transformRect(childBBox, cellView.getNodeMatrix(originalNode));\n                }\n                const replacement = V('rect', childBBox.toJSON());\n                const { x: ox, y: oy } = childBBox.center();\n                const { angle, cx = ox, cy = oy } = originalChild.rotate();\n                if (angle) replacement.rotate(angle, cx, cy);\n                // Note: it's not important to keep the same sibling index since all subnodes are filled\n                childEl.parent().append(replacement);\n            }\n            childEl.remove();\n            return false;\n        }\n        // Keep the element, but clean it from certain attributes\n        MASK_CHILD_ATTRIBUTE_BLACKLIST.forEach(attrName => {\n            if (attrName === 'fill' && childEl.attr('fill') === 'none') return;\n            childEl.removeAttr(attrName);\n        });\n        return true;\n    },\n\n    transformMaskRoot(_cellView, rootEl) {\n        const { MASK_ROOT_ATTRIBUTE_BLACKLIST } = this;\n        MASK_ROOT_ATTRIBUTE_BLACKLIST.forEach(attrName => {\n            rootEl.removeAttr(attrName);\n        });\n    },\n\n    getMaskShape(cellView, vel) {\n        const { options, MASK_REPLACE_TAGS } = this;\n        const { deep } = options;\n        const tagName = vel.tagName();\n        let maskRoot;\n        if (tagName === 'G') {\n            if (!deep) return null;\n            maskRoot = vel.clone();\n            forEachDescendant(maskRoot, maskChild => this.transformMaskChild(cellView, maskChild));\n        } else {\n            if (MASK_REPLACE_TAGS.includes(tagName)) return null;\n            maskRoot = vel.clone();\n        }\n        this.transformMaskRoot(cellView, maskRoot);\n        return maskRoot;\n    },\n\n    getMaskId() {\n        return `highlight-mask-${this.cid}`;\n    },\n\n    getMask(cellView, vNode) {\n\n        const { VISIBLE, INVISIBLE, options } = this;\n        const { padding, attrs } = options;\n\n        const strokeWidth = ('stroke-width' in attrs) ? attrs['stroke-width'] : 1;\n        const hasNodeFill = vNode.attr('fill') !== 'none';\n        let magnetStrokeWidth = parseFloat(vNode.attr('stroke-width'));\n        if (isNaN(magnetStrokeWidth)) magnetStrokeWidth = 1;\n        // stroke of the invisible shape\n        const minStrokeWidth = magnetStrokeWidth + padding * 2;\n        // stroke of the visible shape\n        const maxStrokeWidth = minStrokeWidth + strokeWidth * 2;\n        let maskEl = this.getMaskShape(cellView, vNode);\n        if (!maskEl) {\n            const nodeBBox = cellView.getNodeBoundingRect(vNode.node);\n            // Make sure the rect is visible\n            nodeBBox.inflate(nodeBBox.width ? 0 : 0.5, nodeBBox.height ? 0 : 0.5);\n            maskEl =  V('rect', nodeBBox.toJSON());\n        }\n        maskEl.attr(attrs);\n        return V('mask', {\n            'id': this.getMaskId()\n        }).append([\n            maskEl.clone().attr({\n                'fill': hasNodeFill ? VISIBLE : 'none',\n                'stroke': VISIBLE,\n                'stroke-width': maxStrokeWidth\n            }),\n            maskEl.clone().attr({\n                'fill': hasNodeFill ? INVISIBLE : 'none',\n                'stroke': INVISIBLE,\n                'stroke-width': minStrokeWidth\n            })\n        ]);\n    },\n\n    removeMask(paper) {\n        const maskNode = paper.svg.getElementById(this.getMaskId());\n        if (maskNode) {\n            paper.defs.removeChild(maskNode);\n        }\n    },\n\n    addMask(paper, maskEl) {\n        paper.defs.appendChild(maskEl.node);\n    },\n\n    highlight(cellView, node) {\n        const { options, vel } = this;\n        const { padding, attrs, maskClip = MASK_CLIP, layer } = options;\n        const color = ('stroke' in attrs) ? attrs['stroke'] : '#000000';\n        if (!layer && node === cellView.el) {\n            // If the highlighter is appended to the cellView\n            // and we measure the size of the cellView wrapping group\n            // it's necessary to remove the highlighter first\n            vel.remove();\n        }\n        const highlighterBBox = cellView.getNodeBoundingRect(node).inflate(padding + maskClip);\n        const highlightMatrix = this.getNodeMatrix(cellView, node);\n        const maskEl = this.getMask(cellView, V(node));\n        this.addMask(cellView.paper, maskEl);\n        vel.attr(highlighterBBox.toJSON());\n        vel.attr({\n            'transform': V.matrixToTransformString(highlightMatrix),\n            'mask': `url(#${maskEl.id})`,\n            'fill': color\n        });\n    },\n\n    unhighlight(cellView) {\n        this.removeMask(cellView.paper);\n    }\n\n});\n","import * as util from '../util/index.mjs';\nimport V from '../V/index.mjs';\nimport { HighlighterView } from '../dia/HighlighterView.mjs';\n\nexport const opacity = HighlighterView.extend({\n\n    UPDATABLE: false,\n    MOUNTABLE: false,\n\n    opacityClassName: util.addClassNamePrefix('highlight-opacity'),\n\n    highlight: function(_cellView, node) {\n        V(node).addClass(this.opacityClassName);\n    },\n\n    unhighlight: function(_cellView, node) {\n        V(node).removeClass(this.opacityClassName);\n    }\n\n});\n","import * as util from '../util/index.mjs';\nimport V from '../V/index.mjs';\nimport { HighlighterView } from '../dia/HighlighterView.mjs';\n\nconst className = util.addClassNamePrefix('highlighted');\n\nexport const addClass = HighlighterView.extend({\n\n    UPDATABLE: false,\n    MOUNTABLE: false,\n\n    options: {\n        className\n    },\n\n    highlight: function(_cellView, node) {\n        V(node).addClass(this.options.className);\n    },\n\n    unhighlight: function(_cellView, node) {\n        V(node).removeClass(this.options.className);\n    }\n\n}, {\n    // Backwards Compatibility\n    className\n});\n","import { Rect } from '../g/index.mjs';\nimport { HighlighterView } from '../dia/HighlighterView.mjs';\nimport {\n    normalizeSides,\n    isEqual,\n} from '../util/index.mjs';\nimport {\n    Positions,\n    getRectPoint,\n} from '../util/getRectPoint.mjs';\n\nconst Directions = {\n    ROW: 'row',\n    COLUMN: 'column'\n};\n\nexport const list = HighlighterView.extend({\n\n    tagName: 'g',\n    MOUNTABLE: true,\n    UPDATE_ATTRIBUTES: function() {\n        return [this.options.attribute];\n    },\n\n    _prevItems: null,\n\n    highlight(elementView, node) {\n        const element = elementView.model;\n        const { attribute, size = 20, gap = 5, direction = Directions.ROW } = this.options;\n        if (!attribute) throw new Error('List: attribute is required');\n        const normalizedSize = (typeof size === 'number') ? { width: size, height: size } : size;\n        const isRowDirection = (direction === Directions.ROW);\n        const itemWidth = isRowDirection ? normalizedSize.width : normalizedSize.height;\n        let items = element.get(attribute);\n        if (!Array.isArray(items)) items = [];\n        const prevItems = this._prevItems || [];\n        const comparison = items.map((item, index) => isEqual(prevItems[index], items[index]));\n        if (prevItems.length !== items.length || comparison.some(unchanged => !unchanged)) {\n            const prevEls = this.vel.children();\n            const itemsEls = items.map((item, index) => {\n                const prevEl = (index in prevEls) ? prevEls[index].node : null;\n                if (comparison[index]) return prevEl;\n                const itemEl = this.createListItem(item, normalizedSize, prevEl);\n                if (!itemEl) return null;\n                if (!(itemEl instanceof SVGElement)) throw new Error('List: item must be an SVGElement');\n                itemEl.dataset.index = index;\n                itemEl.dataset.attribute = attribute;\n                const offset = index * (itemWidth + gap);\n                itemEl.setAttribute('transform', (isRowDirection)\n                    ? `translate(${offset}, 0)`\n                    : `translate(0, ${offset})`\n                );\n                return itemEl;\n            });\n            this.vel.empty().append(itemsEls);\n            this._prevItems = items;\n        }\n        const itemsCount = items.length;\n        const length = (itemsCount === 0)\n            ? 0\n            : (itemsCount * itemWidth + (itemsCount - 1) * gap);\n        const listSize = (isRowDirection)\n            ? { width: length, height: normalizedSize.height }\n            : { width: normalizedSize.width, height: length };\n\n        this.position(element, listSize);\n    },\n\n    position(element, listSize) {\n        const { vel, options } = this;\n        const { margin = 5, position = 'top-left' } = options;\n        const { width, height } = element.size();\n        const { left, right, top, bottom } = normalizeSides(margin);\n        const bbox = new Rect(left, top, width - (left + right), height - (top + bottom));\n        let { x, y } = getRectPoint(bbox, position);\n        // x\n        switch (position) {\n            case Positions.CENTER:\n            case Positions.TOP:\n            case Positions.BOTTOM: {\n                x -= listSize.width / 2;\n                break;\n            }\n            case Positions.RIGHT:\n            case Positions.BOTTOM_RIGHT:\n            case Positions.TOP_RIGHT: {\n                x -= listSize.width;\n                break;\n            }\n        }\n        // y\n        switch (position) {\n            case Positions.CENTER:\n            case Positions.RIGHT:\n            case Positions.LEFT: {\n                y -= listSize.height / 2;\n                break;\n            }\n            case Positions.BOTTOM:\n            case Positions.BOTTOM_RIGHT:\n            case Positions.BOTTOM_LEFT: {\n                y -= listSize.height;\n                break;\n            }\n        }\n        vel.attr('transform', `translate(${x}, ${y})`);\n    }\n}, {\n    Directions,\n    Positions\n});\n","import { Line, Point } from '../g/index.mjs';\nimport { isPercentage } from '../util/index.mjs';\n\nfunction connectionRatio(view, _magnet, _refPoint, opt) {\n\n    var ratio = ('ratio' in opt) ? opt.ratio : 0.5;\n    return view.getPointAtRatio(ratio);\n}\n\nfunction connectionLength(view, _magnet, _refPoint, opt) {\n\n    var length = ('length' in opt) ? opt.length : 20;\n    return view.getPointAtLength(length);\n}\n\nfunction _connectionPerpendicular(view, _magnet, refPoint, opt) {\n\n    var OFFSET = 1e6;\n    var path = view.getConnection();\n    var segmentSubdivisions = view.getConnectionSubdivisions();\n    var verticalLine = new Line(refPoint.clone().offset(0, OFFSET), refPoint.clone().offset(0, -OFFSET));\n    var horizontalLine = new Line(refPoint.clone().offset(OFFSET, 0), refPoint.clone().offset(-OFFSET, 0));\n    var verticalIntersections = verticalLine.intersect(path, { segmentSubdivisions: segmentSubdivisions });\n    var horizontalIntersections = horizontalLine.intersect(path, { segmentSubdivisions: segmentSubdivisions });\n    var intersections = [];\n    if (verticalIntersections) Array.prototype.push.apply(intersections, verticalIntersections);\n    if (horizontalIntersections) Array.prototype.push.apply(intersections, horizontalIntersections);\n    if (intersections.length > 0) return refPoint.chooseClosest(intersections);\n    if ('fallbackAt' in opt) {\n        return getPointAtLink(view, opt.fallbackAt);\n    }\n    return connectionClosest(view, _magnet, refPoint, opt);\n}\n\nfunction _connectionClosest(view, _magnet, refPoint, _opt) {\n\n    var closestPoint = view.getClosestPoint(refPoint);\n    if (!closestPoint) return new Point();\n    return closestPoint;\n}\n\nexport function resolveRef(fn) {\n    return function(view, magnet, ref, opt) {\n        if (ref instanceof Element) {\n            var refView = this.paper.findView(ref);\n            var refPoint;\n            if (refView) {\n                if (refView.isNodeConnection(ref)) {\n                    var distance = ('fixedAt' in opt) ? opt.fixedAt : '50%';\n                    refPoint = getPointAtLink(refView, distance);\n                } else {\n                    refPoint = refView.getNodeBBox(ref).center();\n                }\n            } else {\n                // Something went wrong\n                refPoint = new Point();\n            }\n            return fn.call(this, view, magnet, refPoint, opt);\n        }\n        return fn.apply(this, arguments);\n    };\n}\n\nfunction getPointAtLink(view, value) {\n    var parsedValue = parseFloat(value);\n    if (isPercentage(value)) {\n        return view.getPointAtRatio(parsedValue / 100);\n    } else {\n        return view.getPointAtLength(parsedValue);\n    }\n}\n\n// joint.linkAnchors\nexport { connectionRatio, connectionLength };\nexport const connectionPerpendicular = resolveRef(_connectionPerpendicular);\nexport const connectionClosest = resolveRef(_connectionClosest);\n","import * as g from '../g/index.mjs';\nimport V from '../V/index.mjs';\nimport * as util from '../util/index.mjs';\n\nfunction offsetPoint(p1, p2, offset) {\n    if (util.isPlainObject(offset)) {\n        const { x, y } = offset;\n        if (isFinite(y)) {\n            const line =  new g.Line(p2, p1);\n            const { start, end } = line.parallel(y);\n            p2 = start;\n            p1 = end;\n        }\n        offset = x;\n    }\n    if (!isFinite(offset)) return p1;\n    var length = p1.distance(p2);\n    if (offset === 0 && length > 0) return p1;\n    return p1.move(p2, -Math.min(offset, length - 1));\n}\n\nfunction stroke(magnet) {\n\n    var stroke = magnet.getAttribute('stroke-width');\n    if (stroke === null) return 0;\n    return parseFloat(stroke) || 0;\n}\n\nfunction alignLine(line, type, offset = 0) {\n    let coordinate, a, b, direction;\n    const { start, end } = line;\n    switch (type) {\n        case 'left':\n            coordinate = 'x';\n            a = end;\n            b = start;\n            direction = -1;\n            break;\n        case 'right':\n            coordinate = 'x';\n            a = start;\n            b = end;\n            direction = 1;\n            break;\n        case 'top':\n            coordinate = 'y';\n            a = end;\n            b = start;\n            direction = -1;\n            break;\n        case 'bottom':\n            coordinate = 'y';\n            a = start;\n            b = end;\n            direction = 1;\n            break;\n        default:\n            return;\n    }\n    if (start[coordinate] < end[coordinate]) {\n        a[coordinate] = b[coordinate];\n    } else {\n        b[coordinate] = a[coordinate];\n    }\n    if (isFinite(offset)) {\n        a[coordinate] += direction * offset;\n        b[coordinate] += direction * offset;\n    }\n}\n\n// Connection Points\n\nfunction anchorConnectionPoint(line, _view, _magnet, opt) {\n    let { offset, alignOffset, align } = opt;\n    if (align) alignLine(line, align, alignOffset);\n    return offsetPoint(line.end, line.start, offset);\n}\n\nfunction bboxIntersection(line, view, magnet, opt) {\n\n    var bbox = view.getNodeBBox(magnet);\n    if (opt.stroke) bbox.inflate(stroke(magnet) / 2);\n    var intersections = line.intersect(bbox);\n    var cp = (intersections)\n        ? line.start.chooseClosest(intersections)\n        : line.end;\n    return offsetPoint(cp, line.start, opt.offset);\n}\n\nfunction rectangleIntersection(line, view, magnet, opt) {\n\n    var angle = view.model.angle();\n    if (angle === 0) {\n        return bboxIntersection(line, view, magnet, opt);\n    }\n\n    var bboxWORotation = view.getNodeUnrotatedBBox(magnet);\n    if (opt.stroke) bboxWORotation.inflate(stroke(magnet) / 2);\n    var center = bboxWORotation.center();\n    var lineWORotation = line.clone().rotate(center, angle);\n    var intersections = lineWORotation.setLength(1e6).intersect(bboxWORotation);\n    var cp = (intersections)\n        ? lineWORotation.start.chooseClosest(intersections).rotate(center, -angle)\n        : line.end;\n    return offsetPoint(cp, line.start, opt.offset);\n}\n\nfunction findShapeNode(magnet) {\n    if (!magnet) return null;\n    var node = magnet;\n    do {\n        var tagName = node.tagName;\n        if (typeof tagName !== 'string') return null;\n        tagName = tagName.toUpperCase();\n        if (tagName === 'G') {\n            node = node.firstElementChild;\n        } else if (tagName === 'TITLE') {\n            node = node.nextElementSibling;\n        } else break;\n    } while (node);\n    return node;\n}\n\nvar BNDR_SUBDIVISIONS = 'segmentSubdivisons';\nvar BNDR_SHAPE_BBOX = 'shapeBBox';\n\nfunction boundaryIntersection(line, view, magnet, opt) {\n\n    var node, intersection;\n    var selector = opt.selector;\n    var anchor = line.end;\n\n    if (typeof selector === 'string') {\n        node = view.findBySelector(selector)[0];\n    } else if (selector === false) {\n        node = magnet;\n    } else if (Array.isArray(selector)) {\n        node = util.getByPath(magnet, selector);\n    } else {\n        node = findShapeNode(magnet);\n    }\n\n    if (!V.isSVGGraphicsElement(node)) {\n        if (node === magnet || !V.isSVGGraphicsElement(magnet)) return anchor;\n        node = magnet;\n    }\n\n    var localShape = view.getNodeShape(node);\n    var magnetMatrix = view.getNodeMatrix(node);\n    var translateMatrix = view.getRootTranslateMatrix();\n    var rotateMatrix = view.getRootRotateMatrix();\n    var targetMatrix = translateMatrix.multiply(rotateMatrix).multiply(magnetMatrix);\n    var localMatrix = targetMatrix.inverse();\n    var localLine = V.transformLine(line, localMatrix);\n    var localRef = localLine.start.clone();\n    var data = view.getNodeData(node);\n\n    if (opt.insideout === false) {\n        if (!data[BNDR_SHAPE_BBOX]) data[BNDR_SHAPE_BBOX] = localShape.bbox();\n        var localBBox = data[BNDR_SHAPE_BBOX];\n        if (localBBox.containsPoint(localRef)) return anchor;\n    }\n\n    // Caching segment subdivisions for paths\n    var pathOpt;\n    if (localShape instanceof g.Path) {\n        var precision = opt.precision || 2;\n        if (!data[BNDR_SUBDIVISIONS]) data[BNDR_SUBDIVISIONS] = localShape.getSegmentSubdivisions({ precision: precision });\n        pathOpt = {\n            precision: precision,\n            segmentSubdivisions: data[BNDR_SUBDIVISIONS]\n        };\n    }\n\n    if (opt.extrapolate === true) localLine.setLength(1e6);\n\n    intersection = localLine.intersect(localShape, pathOpt);\n    if (intersection) {\n        // More than one intersection\n        if (V.isArray(intersection)) intersection = localRef.chooseClosest(intersection);\n    } else if (opt.sticky === true) {\n        // No intersection, find the closest point instead\n        if (localShape instanceof g.Rect) {\n            intersection = localShape.pointNearestToPoint(localRef);\n        } else if (localShape instanceof g.Ellipse) {\n            intersection = localShape.intersectionWithLineFromCenterToPoint(localRef);\n        } else {\n            intersection = localShape.closestPoint(localRef, pathOpt);\n        }\n    }\n\n    var cp = (intersection) ? V.transformPoint(intersection, targetMatrix) : anchor;\n    var cpOffset = opt.offset || 0;\n    if (opt.stroke) cpOffset += stroke(node) / 2;\n\n    return offsetPoint(cp, line.start, cpOffset);\n}\n\nexport const anchor = anchorConnectionPoint;\nexport const bbox = bboxIntersection;\nexport const rectangle = rectangleIntersection;\nexport const boundary = boundaryIntersection;\n","import * as util from '../util/index.mjs';\nimport { toRad } from '../g/index.mjs';\nimport { resolveRef } from '../linkAnchors/index.mjs';\n\nfunction bboxWrapper(method) {\n\n    return function(view, magnet, ref, opt) {\n\n        var rotate = !!opt.rotate;\n        var bbox = (rotate) ? view.getNodeUnrotatedBBox(magnet) : view.getNodeBBox(magnet);\n        var anchor = bbox[method]();\n\n        var dx = opt.dx;\n        if (dx) {\n            var dxPercentage = util.isPercentage(dx);\n            dx = parseFloat(dx);\n            if (isFinite(dx)) {\n                if (dxPercentage) {\n                    dx /= 100;\n                    dx *= bbox.width;\n                }\n                anchor.x += dx;\n            }\n        }\n\n        var dy = opt.dy;\n        if (dy) {\n            var dyPercentage = util.isPercentage(dy);\n            dy = parseFloat(dy);\n            if (isFinite(dy)) {\n                if (dyPercentage) {\n                    dy /= 100;\n                    dy *= bbox.height;\n                }\n                anchor.y += dy;\n            }\n        }\n\n        return (rotate) ? anchor.rotate(view.model.getBBox().center(), -view.model.angle()) : anchor;\n    };\n}\n\nfunction _perpendicular(view, magnet, refPoint, opt) {\n\n    var angle = view.model.angle();\n    var bbox = view.getNodeBBox(magnet);\n    var anchor = bbox.center();\n    var topLeft = bbox.origin();\n    var bottomRight = bbox.corner();\n\n    var padding = opt.padding;\n    if (!isFinite(padding)) padding = 0;\n\n    if ((topLeft.y + padding) <= refPoint.y && refPoint.y <= (bottomRight.y - padding)) {\n        var dy = (refPoint.y - anchor.y);\n        anchor.x += (angle === 0 || angle === 180) ? 0 : dy * 1 / Math.tan(toRad(angle));\n        anchor.y += dy;\n    } else if ((topLeft.x + padding) <= refPoint.x && refPoint.x <= (bottomRight.x - padding)) {\n        var dx = (refPoint.x - anchor.x);\n        anchor.y += (angle === 90 || angle === 270) ? 0 : dx * Math.tan(toRad(angle));\n        anchor.x += dx;\n    }\n\n    return anchor;\n}\n\nfunction _midSide(view, magnet, refPoint, opt) {\n\n    var rotate = !!opt.rotate;\n    var bbox, angle, center;\n    if (rotate) {\n        bbox = view.getNodeUnrotatedBBox(magnet);\n        center = view.model.getBBox().center();\n        angle = view.model.angle();\n    } else {\n        bbox = view.getNodeBBox(magnet);\n    }\n\n    var padding = opt.padding;\n    if (isFinite(padding)) bbox.inflate(padding);\n\n    if (rotate) refPoint.rotate(center, angle);\n\n    var side = bbox.sideNearestToPoint(refPoint);\n    var anchor;\n    switch (side) {\n        case 'left':\n            anchor = bbox.leftMiddle();\n            break;\n        case 'right':\n            anchor = bbox.rightMiddle();\n            break;\n        case 'top':\n            anchor = bbox.topMiddle();\n            break;\n        case 'bottom':\n            anchor = bbox.bottomMiddle();\n            break;\n    }\n\n    return (rotate) ? anchor.rotate(center, -angle) : anchor;\n}\n\n// Can find anchor from model, when there is no selector or the link end\n// is connected to a port\nfunction _modelCenter(view, _magnet, _refPoint, opt, endType) {\n    return view.model.getPointFromConnectedLink(this.model, endType).offset(opt.dx, opt.dy);\n}\n\n//joint.anchors\nexport const center = bboxWrapper('center');\nexport const top = bboxWrapper('topMiddle');\nexport const bottom = bboxWrapper('bottomMiddle');\nexport const left = bboxWrapper('leftMiddle');\nexport const right = bboxWrapper('rightMiddle');\nexport const topLeft = bboxWrapper('origin');\nexport const topRight = bboxWrapper('topRight');\nexport const bottomLeft = bboxWrapper('bottomLeft');\nexport const bottomRight = bboxWrapper('corner');\nexport const perpendicular = resolveRef(_perpendicular);\nexport const midSide = resolveRef(_midSide);\nexport const modelCenter = _modelCenter;\n\n","import V from '../V/index.mjs';\nimport {\n    isNumber,\n    assign,\n    nextFrame,\n    isObject,\n    cancelFrame,\n    defaults,\n    defaultsDeep,\n    addClassNamePrefix,\n    normalizeSides,\n    isFunction,\n    isPlainObject,\n    getByPath,\n    sortElements,\n    isString,\n    guid,\n    normalizeEvent,\n    normalizeWheel,\n    cap,\n    debounce,\n    omit,\n    result,\n    merge,\n    camelCase,\n    cloneDeep,\n    invoke,\n    hashCode,\n    filter as _filter,\n    parseDOMJSON,\n    toArray,\n    has\n} from '../util/index.mjs';\nimport { Rect, Point, toRad } from '../g/index.mjs';\nimport { View, views } from '../mvc/index.mjs';\nimport { CellView } from './CellView.mjs';\nimport { ElementView } from './ElementView.mjs';\nimport { LinkView } from './LinkView.mjs';\nimport { Link } from './Link.mjs';\nimport { Cell } from './Cell.mjs';\nimport { Graph } from './Graph.mjs';\nimport { LayersNames, PaperLayer } from './PaperLayer.mjs';\nimport * as highlighters from '../highlighters/index.mjs';\nimport * as linkAnchors from '../linkAnchors/index.mjs';\nimport * as connectionPoints from '../connectionPoints/index.mjs';\nimport * as anchors from '../anchors/index.mjs';\n\nimport $ from 'jquery';\nimport Backbone from 'backbone';\n\nconst sortingTypes = {\n    NONE: 'sorting-none',\n    APPROX: 'sorting-approximate',\n    EXACT: 'sorting-exact'\n};\n\nconst WHEEL_CAP = 50;\nconst WHEEL_WAIT_MS = 20;\nconst MOUNT_BATCH_SIZE = 1000;\nconst UPDATE_BATCH_SIZE = Infinity;\nconst MIN_PRIORITY = 9007199254740991; // Number.MAX_SAFE_INTEGER\n\nconst HighlightingTypes = CellView.Highlighting;\n\nconst defaultHighlighting = {\n    [HighlightingTypes.DEFAULT]: {\n        name: 'stroke',\n        options: {\n            padding: 3\n        }\n    },\n    [HighlightingTypes.MAGNET_AVAILABILITY]: {\n        name: 'addClass',\n        options: {\n            className: 'available-magnet'\n        }\n    },\n    [HighlightingTypes.ELEMENT_AVAILABILITY]: {\n        name: 'addClass',\n        options: {\n            className: 'available-cell'\n        }\n    }\n};\n\nconst defaultLayers = [{\n    name: LayersNames.BACK,\n}, {\n    name: LayersNames.CELLS,\n}, {\n    name: LayersNames.LABELS,\n}, {\n    name: LayersNames.FRONT\n}, {\n    name: LayersNames.TOOLS\n}];\n\nexport const Paper = View.extend({\n\n    className: 'paper',\n\n    options: {\n\n        width: 800,\n        height: 600,\n        origin: { x: 0, y: 0 }, // x,y coordinates in top-left corner\n        gridSize: 1,\n        // Whether or not to draw the grid lines on the paper's DOM element.\n        // e.g drawGrid: true, drawGrid: { color: 'red', thickness: 2 }\n        drawGrid: false,\n        // If not set, the size of the visual grid is the same as the `gridSize`.\n        drawGridSize: null,\n\n        // Whether or not to draw the background on the paper's DOM element.\n        // e.g. background: { color: 'lightblue', image: '/paper-background.png', repeat: 'flip-xy' }\n        background: false,\n\n        perpendicularLinks: false,\n        elementView: ElementView,\n        linkView: LinkView,\n        snapLabels: false, // false, true\n        snapLinks: false, // false, true, { radius: value }\n        snapLinksSelf: false, // false, true, { radius: value }\n\n        // Should the link labels be rendered into its own layer?\n        // `false` - the labels are part of the links\n        // `true` - the labels are appended to LayersName.LABELS\n        // [LayersName] - the labels are appended to the layer specified\n        labelsLayer: false,\n\n        // When set to FALSE, an element may not have more than 1 link with the same source and target element.\n        multiLinks: true,\n\n        // For adding custom guard logic.\n        guard: function(evt, view) {\n\n            // FALSE means the event isn't guarded.\n            return false;\n        },\n\n        highlighting: defaultHighlighting,\n\n        // Prevent the default context menu from being displayed.\n        preventContextMenu: true,\n\n        // Prevent the default action for blank:pointer<action>.\n        preventDefaultBlankAction: true,\n\n        // Prevent the default action for cell:pointer<action>.\n        preventDefaultViewAction: true,\n\n        // Restrict the translation of elements by given bounding box.\n        // Option accepts a boolean:\n        //  true - the translation is restricted to the paper area\n        //  false - no restrictions\n        // A method:\n        // restrictTranslate: function(elementView) {\n        //     var parentId = elementView.model.get('parent');\n        //     return parentId && this.model.getCell(parentId).getBBox();\n        // },\n        // Or a bounding box:\n        // restrictTranslate: { x: 10, y: 10, width: 790, height: 590 }\n        restrictTranslate: false,\n\n        // Marks all available magnets with 'available-magnet' class name and all available cells with\n        // 'available-cell' class name. Marks them when dragging a link is started and unmark\n        // when the dragging is stopped.\n        markAvailable: false,\n\n        // Defines what link model is added to the graph after an user clicks on an active magnet.\n        // Value could be the Backbone.model or a function returning the Backbone.model\n        // defaultLink: function(elementView, magnet) { return condition ? new customLink1() : new customLink2() }\n        defaultLink: new Link,\n\n        // A connector that is used by links with no connector defined on the model.\n        // e.g. { name: 'rounded', args: { radius: 5 }} or a function\n        defaultConnector: { name: 'normal' },\n\n        // A router that is used by links with no router defined on the model.\n        // e.g. { name: 'oneSide', args: { padding: 10 }} or a function\n        defaultRouter: { name: 'normal' },\n\n        defaultAnchor: { name: 'center' },\n\n        defaultLinkAnchor: { name: 'connectionRatio' },\n\n        defaultConnectionPoint: { name: 'bbox' },\n\n        /* CONNECTING */\n\n        connectionStrategy: null,\n\n        // Check whether to add a new link to the graph when user clicks on an a magnet.\n        validateMagnet: function(_cellView, magnet, _evt) {\n            return magnet.getAttribute('magnet') !== 'passive';\n        },\n\n        // Check whether to allow or disallow the link connection while an arrowhead end (source/target)\n        // being changed.\n        validateConnection: function(cellViewS, _magnetS, cellViewT, _magnetT, end, _linkView) {\n            return (end === 'target' ? cellViewT : cellViewS) instanceof ElementView;\n        },\n\n        /* EMBEDDING */\n\n        // Enables embedding. Re-parent the dragged element with elements under it and makes sure that\n        // all links and elements are visible taken the level of embedding into account.\n        embeddingMode: false,\n\n        // Check whether to allow or disallow the element embedding while an element being translated.\n        validateEmbedding: function(childView, parentView) {\n            // by default all elements can be in relation child-parent\n            return true;\n        },\n\n        // Check whether to allow or disallow an embedded element to be unembedded / to become a root.\n        validateUnembedding: function(childView) {\n            // by default all elements can become roots\n            return true;\n        },\n\n        // Determines the way how a cell finds a suitable parent when it's dragged over the paper.\n        // The cell with the highest z-index (visually on the top) will be chosen.\n        findParentBy: 'bbox', // 'bbox'|'center'|'origin'|'corner'|'topRight'|'bottomLeft'\n\n        // If enabled only the element on the very front is taken into account for the embedding.\n        // If disabled the elements under the dragged view are tested one by one\n        // (from front to back) until a valid parent found.\n        frontParentOnly: true,\n\n        // Interactive flags. See online docs for the complete list of interactive flags.\n        interactive: {\n            labelMove: false\n        },\n\n        // When set to true the links can be pinned to the paper.\n        // i.e. link source/target can be a point e.g. link.get('source') ==> { x: 100, y: 100 };\n        linkPinning: true,\n\n        // Custom validation after an interaction with a link ends.\n        // Recognizes a function. If `false` is returned, the link is disallowed (removed or reverted)\n        // (linkView, paper) => boolean\n        allowLink: null,\n\n        // Allowed number of mousemove events after which the pointerclick event will be still triggered.\n        clickThreshold: 0,\n\n        // Number of required mousemove events before the first pointermove event will be triggered.\n        moveThreshold: 0,\n\n        // Number of required mousemove events before a link is created out of the magnet.\n        // Or string `onleave` so the link is created when the pointer leaves the magnet\n        magnetThreshold: 0,\n\n        // Rendering Options\n\n        sorting: sortingTypes.EXACT,\n\n        frozen: false,\n\n        autoFreeze: false,\n\n        // no docs yet\n        onViewUpdate: function(view, flag, priority, opt, paper) {\n            // Do not update connected links when:\n            // 1. the view was just inserted (added to the graph and rendered)\n            // 2. the view was just mounted (added back to the paper by viewport function)\n            // 3. the change was marked as `isolate`.\n            // 4. the view model was just removed from the graph\n            if ((flag & (view.FLAG_INSERT | view.FLAG_REMOVE)) || opt.mounting || opt.isolate) return;\n            paper.requestConnectedLinksUpdate(view, priority, opt);\n        },\n\n        // no docs yet\n        onViewPostponed: function(view, flag, paper) {\n            return paper.forcePostponedViewUpdate(view, flag);\n        },\n\n        beforeRender: null, // function(opt, paper) { },\n\n        afterRender: null, // function(stats, opt, paper) {\n\n        viewport: null,\n\n        // Default namespaces\n\n        cellViewNamespace: null,\n\n        routerNamespace: null,\n\n        connectorNamespace: null,\n\n        highlighterNamespace: highlighters,\n\n        anchorNamespace: anchors,\n\n        linkAnchorNamespace: linkAnchors,\n\n        connectionPointNamespace: connectionPoints,\n\n        overflow: false\n    },\n\n    events: {\n        'dblclick': 'pointerdblclick',\n        'dbltap': 'pointerdblclick',\n        'contextmenu': 'contextmenu',\n        'mousedown': 'pointerdown',\n        'touchstart': 'pointerdown',\n        'mouseover': 'mouseover',\n        'mouseout': 'mouseout',\n        'mouseenter': 'mouseenter',\n        'mouseleave': 'mouseleave',\n        'wheel': 'mousewheel',\n        'mouseenter .joint-cell': 'mouseenter',\n        'mouseleave .joint-cell': 'mouseleave',\n        'mouseenter .joint-tools': 'mouseenter',\n        'mouseleave .joint-tools': 'mouseleave',\n        'dblclick .joint-cell [magnet]': 'magnetpointerdblclick',\n        'contextmenu .joint-cell [magnet]': 'magnetcontextmenu',\n        'mousedown .joint-link .label': 'onlabel', // interaction with link label\n        'touchstart .joint-link .label': 'onlabel',\n        'dragstart .joint-cell image': 'onImageDragStart' // firefox fix\n    },\n\n    documentEvents: {\n        'mousemove': 'pointermove',\n        'touchmove': 'pointermove',\n        'mouseup': 'pointerup',\n        'touchend': 'pointerup',\n        'touchcancel': 'pointerup'\n    },\n\n    svg: null,\n    viewport: null,\n    defs: null,\n    tools: null,\n    $background: null,\n    layers: null,\n    $grid: null,\n    $document: null,\n\n    // For storing the current transformation matrix (CTM) of the paper's viewport.\n    _viewportMatrix: null,\n    // For verifying whether the CTM is up-to-date. The viewport transform attribute\n    // could have been manipulated directly.\n    _viewportTransformString: null,\n    // Updates data (priorities, unmounted views etc.)\n    _updates: null,\n    // Paper Layers\n    _layers: null,\n\n    SORT_DELAYING_BATCHES: ['add', 'to-front', 'to-back'],\n    UPDATE_DELAYING_BATCHES: ['translate'],\n    // If you interact with these elements,\n    // the default interaction such as `element move` is prevented.\n    FORM_CONTROL_TAG_NAMES: ['TEXTAREA', 'INPUT', 'BUTTON', 'SELECT', 'OPTION'] ,\n    // If you interact with these elements, the events are not propagated to the paper\n    // i.e. paper events such as `element:pointerdown` are not triggered.\n    GUARDED_TAG_NAMES: [\n        // Guard <select> for consistency. When you click on it:\n        // Chrome: triggers `pointerdown`, `pointerup`, `pointerclick` to open\n        // Firefox: triggers `pointerdown` on open, `pointerup` (and `pointerclick` only if you haven't moved).\n        //          on close. However, if you open and then close by clicking elsewhere on the page,\n        //           no other event is triggered.\n        // Safari: when you open it, it triggers `pointerdown`. That's it.\n        'SELECT',\n    ],\n    MIN_SCALE: 1e-6,\n\n    init: function() {\n\n        const { options, el } = this;\n        if (!options.cellViewNamespace) {\n            /* eslint-disable no-undef */\n            options.cellViewNamespace = typeof joint !== 'undefined' && has(joint, 'shapes') ? joint.shapes : null;\n            /* eslint-enable no-undef */\n        }\n\n        const model = this.model = options.model || new Graph;\n\n        // Layers (SVGGroups)\n        this._layers = {};\n\n        this.setGrid(options.drawGrid);\n        this.cloneOptions();\n        this.render();\n        this._setDimensions();\n        this.startListening();\n\n        // Hash of all cell views.\n        this._views = {};\n\n        // Mouse wheel events buffer\n        this._mw_evt_buffer = {\n            event: null,\n            deltas: [],\n        };\n\n        // Reference to the paper owner document\n        this.$document = $(el.ownerDocument);\n        // Render existing cells in the graph\n        this.resetViews(model.attributes.cells.models);\n        // Start the Rendering Loop\n        if (!this.isFrozen() && this.isAsync()) this.updateViewsAsync();\n    },\n\n    _resetUpdates: function() {\n        return this._updates = {\n            id: null,\n            priorities: [{}, {}, {}],\n            unmountedCids: [],\n            mountedCids: [],\n            unmounted: {},\n            mounted: {},\n            count: 0,\n            keyFrozen: false,\n            freezeKey: null,\n            sort: false,\n            disabled: false,\n            idle: false\n        };\n    },\n\n    startListening: function() {\n        var model = this.model;\n        this.listenTo(model, 'add', this.onCellAdded)\n            .listenTo(model, 'remove', this.onCellRemoved)\n            .listenTo(model, 'change', this.onCellChange)\n            .listenTo(model, 'reset', this.onGraphReset)\n            .listenTo(model, 'sort', this.onGraphSort)\n            .listenTo(model, 'batch:stop', this.onGraphBatchStop);\n        this.on('cell:highlight', this.onCellHighlight)\n            .on('cell:unhighlight', this.onCellUnhighlight)\n            .on('scale translate', this.update);\n    },\n\n    onCellAdded: function(cell, _, opt) {\n        var position = opt.position;\n        if (this.isAsync() || !isNumber(position)) {\n            this.renderView(cell, opt);\n        } else {\n            if (opt.maxPosition === position) this.freeze({ key: 'addCells' });\n            this.renderView(cell, opt);\n            if (position === 0) this.unfreeze({ key: 'addCells' });\n        }\n    },\n\n    onCellRemoved: function(cell, _, opt) {\n        const view = this.findViewByModel(cell);\n        if (view) this.requestViewUpdate(view, view.FLAG_REMOVE, view.UPDATE_PRIORITY, opt);\n    },\n\n    onCellChange: function(cell, opt) {\n        if (cell === this.model.attributes.cells) return;\n        if (cell.hasChanged('z') && this.options.sorting === sortingTypes.APPROX) {\n            const view = this.findViewByModel(cell);\n            if (view) this.requestViewUpdate(view, view.FLAG_INSERT, view.UPDATE_PRIORITY, opt);\n        }\n    },\n\n    onGraphReset: function(collection, opt) {\n        this.resetLayers();\n        this.resetViews(collection.models, opt);\n    },\n\n    onGraphSort: function() {\n        if (this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)) return;\n        this.sortViews();\n    },\n\n    onGraphBatchStop: function(data) {\n        if (this.isFrozen()) return;\n        var name = data && data.batchName;\n        var graph = this.model;\n        if (!this.isAsync()) {\n            var updateDelayingBatches = this.UPDATE_DELAYING_BATCHES;\n            if (updateDelayingBatches.includes(name) && !graph.hasActiveBatch(updateDelayingBatches)) {\n                this.updateViews(data);\n            }\n        }\n        var sortDelayingBatches = this.SORT_DELAYING_BATCHES;\n        if (sortDelayingBatches.includes(name) && !graph.hasActiveBatch(sortDelayingBatches)) {\n            this.sortViews();\n        }\n    },\n\n    cloneOptions: function() {\n\n        const { options } = this;\n        const {\n            defaultConnector,\n            defaultRouter,\n            defaultConnectionPoint,\n            defaultAnchor,\n            defaultLinkAnchor,\n            origin,\n            highlighting,\n            cellViewNamespace,\n            interactive\n        } = options;\n\n        // Default cellView namespace for ES5\n        /* eslint-disable no-undef */\n        if (!cellViewNamespace && typeof joint !== 'undefined' && has(joint, 'shapes')) {\n            options.cellViewNamespace = joint.shapes;\n        }\n        /* eslint-enable no-undef */\n\n        // Here if a function was provided, we can not clone it, as this would result in loosing the function.\n        // If the default is used, the cloning is necessary in order to prevent modifying the options on prototype.\n        if (!isFunction(defaultConnector)) {\n            options.defaultConnector = cloneDeep(defaultConnector);\n        }\n        if (!isFunction(defaultRouter)) {\n            options.defaultRouter = cloneDeep(defaultRouter);\n        }\n        if (!isFunction(defaultConnectionPoint)) {\n            options.defaultConnectionPoint = cloneDeep(defaultConnectionPoint);\n        }\n        if (!isFunction(defaultAnchor)) {\n            options.defaultAnchor = cloneDeep(defaultAnchor);\n        }\n        if (!isFunction(defaultLinkAnchor)) {\n            options.defaultLinkAnchor = cloneDeep(defaultLinkAnchor);\n        }\n        if (isPlainObject(interactive)) {\n            options.interactive = assign({}, interactive);\n        }\n        if (isPlainObject(highlighting)) {\n            // Return the default highlighting options into the user specified options.\n            options.highlighting = defaultsDeep({}, highlighting, defaultHighlighting);\n        }\n        options.origin = assign({}, origin);\n    },\n\n    children: function() {\n        var ns = V.namespace;\n        return [{\n            namespaceURI: ns.xhtml,\n            tagName: 'div',\n            className: addClassNamePrefix('paper-background'),\n            selector: 'background'\n        }, {\n            namespaceURI: ns.xhtml,\n            tagName: 'div',\n            className: addClassNamePrefix('paper-grid'),\n            selector: 'grid'\n        }, {\n            namespaceURI: ns.svg,\n            tagName: 'svg',\n            attributes: {\n                'width': '100%',\n                'height': '100%',\n                'xmlns:xlink': ns.xlink\n            },\n            selector: 'svg',\n            children: [{\n                // Append `<defs>` element to the SVG document. This is useful for filters and gradients.\n                // It's desired to have the defs defined before the viewport (e.g. to make a PDF document pick up defs properly).\n                tagName: 'defs',\n                selector: 'defs'\n            }, {\n                tagName: 'g',\n                className: addClassNamePrefix('layers'),\n                selector: 'layers'\n            }]\n        }];\n    },\n\n    hasLayerView(layerName) {\n        return  (layerName in this._layers);\n    },\n\n    getLayerView(layerName) {\n        const { _layers } = this;\n        if (layerName in _layers) return _layers[layerName];\n        throw new Error(`dia.Paper: Unknown layer \"${layerName}\"`);\n    },\n\n    getLayerNode(layerName) {\n        return this.getLayerView(layerName).el;\n    },\n\n    render: function() {\n\n        this.renderChildren();\n        const { childNodes, options } = this;\n        const { svg, defs, layers, background, grid } = childNodes;\n\n        svg.style.overflow = options.overflow ? 'visible' : 'hidden';\n\n        this.svg = svg;\n        this.defs = defs;\n        this.layers = layers;\n        this.$background = $(background);\n        this.$grid = $(grid);\n\n        this.renderLayers();\n\n        V.ensureId(svg);\n\n        if (options.background) {\n            this.drawBackground(options.background);\n        }\n\n        if (options.drawGrid) {\n            this.drawGrid();\n        }\n\n        return this;\n    },\n\n    renderLayers: function(layers = defaultLayers) {\n        this.removeLayers();\n        // TODO: Layers to be read from the graph `layers` attribute\n        layers.forEach(({ name, sorted }) => {\n            const layerView = new PaperLayer({ name });\n            this.layers.appendChild(layerView.el);\n            this._layers[name] = layerView;\n        });\n        // Throws an exception if doesn't exist\n        const cellsLayerView = this.getLayerView(LayersNames.CELLS);\n        const toolsLayerView = this.getLayerView(LayersNames.TOOLS);\n        const labelsLayerView = this.getLayerView(LayersNames.LABELS);\n        // backwards compatibility\n        this.tools = toolsLayerView.el;\n        this.cells = this.viewport = cellsLayerView.el;\n        // user-select: none;\n        cellsLayerView.vel.addClass(addClassNamePrefix('viewport'));\n        labelsLayerView.vel.addClass(addClassNamePrefix('viewport'));\n    },\n\n    removeLayers: function() {\n        const { _layers } = this;\n        Object.keys(_layers).forEach(name => {\n            _layers[name].remove();\n            delete _layers[name];\n        });\n    },\n\n    resetLayers: function() {\n        const { _layers } = this;\n        Object.keys(_layers).forEach(name => {\n            _layers[name].removePivots();\n        });\n    },\n\n    update: function() {\n\n        if (this.options.drawGrid) {\n            this.drawGrid();\n        }\n\n        if (this._background) {\n            this.updateBackgroundImage(this._background);\n        }\n\n        return this;\n    },\n\n    matrix: function(ctm) {\n\n        var viewport = this.layers;\n\n        // Getter:\n        if (ctm === undefined) {\n\n            var transformString = viewport.getAttribute('transform');\n\n            if ((this._viewportTransformString || null) === transformString) {\n                // It's ok to return the cached matrix. The transform attribute has not changed since\n                // the matrix was stored.\n                ctm = this._viewportMatrix;\n            } else {\n                // The viewport transform attribute has changed. Measure the matrix and cache again.\n                ctm = viewport.getCTM();\n                this._viewportMatrix = ctm;\n                this._viewportTransformString = transformString;\n            }\n\n            // Clone the cached current transformation matrix.\n            // If no matrix previously stored the identity matrix is returned.\n            return V.createSVGMatrix(ctm);\n        }\n\n        // Setter:\n        ctm = V.createSVGMatrix(ctm);\n        var ctmString = V.matrixToTransformString(ctm);\n        viewport.setAttribute('transform', ctmString);\n\n        this._viewportMatrix = ctm;\n        this._viewportTransformString = viewport.getAttribute('transform');\n\n        return this;\n    },\n\n    clientMatrix: function() {\n\n        return V.createSVGMatrix(this.cells.getScreenCTM());\n    },\n\n    requestConnectedLinksUpdate: function(view, priority, opt) {\n        if (view instanceof CellView) {\n            var model = view.model;\n            var links = this.model.getConnectedLinks(model);\n            for (var j = 0, n = links.length; j < n; j++) {\n                var link = links[j];\n                var linkView = this.findViewByModel(link);\n                if (!linkView) continue;\n                var flagLabels = ['UPDATE'];\n                if (link.getTargetCell() === model) flagLabels.push('TARGET');\n                if (link.getSourceCell() === model) flagLabels.push('SOURCE');\n                var nextPriority = Math.max(priority + 1, linkView.UPDATE_PRIORITY);\n                this.scheduleViewUpdate(linkView, linkView.getFlag(flagLabels), nextPriority, opt);\n            }\n        }\n    },\n\n    forcePostponedViewUpdate: function(view, flag) {\n        if (!view || !(view instanceof CellView)) return false;\n        var model = view.model;\n        if (model.isElement()) return false;\n        if ((flag & view.getFlag(['SOURCE', 'TARGET'])) === 0) {\n            var dumpOptions = { silent: true };\n            // LinkView is waiting for the target or the source cellView to be rendered\n            // This can happen when the cells are not in the viewport.\n            var sourceFlag = 0;\n            var sourceView = this.findViewByModel(model.getSourceCell());\n            if (sourceView && !this.isViewMounted(sourceView)) {\n                sourceFlag = this.dumpView(sourceView, dumpOptions);\n                view.updateEndMagnet('source');\n            }\n            var targetFlag = 0;\n            var targetView = this.findViewByModel(model.getTargetCell());\n            if (targetView && !this.isViewMounted(targetView)) {\n                targetFlag = this.dumpView(targetView, dumpOptions);\n                view.updateEndMagnet('target');\n            }\n            if (sourceFlag === 0 && targetFlag === 0) {\n                // If leftover flag is 0, all view updates were done.\n                return !this.dumpView(view, dumpOptions);\n            }\n        }\n        return false;\n    },\n\n    requestViewUpdate: function(view, flag, priority, opt) {\n        opt || (opt = {});\n        this.scheduleViewUpdate(view, flag, priority, opt);\n        var isAsync = this.isAsync();\n        if (this.isFrozen() || (isAsync && opt.async !== false)) return;\n        if (this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES)) return;\n        var stats = this.updateViews(opt);\n        if (isAsync) this.notifyAfterRender(stats, opt);\n    },\n\n    scheduleViewUpdate: function(view, type, priority, opt) {\n        const { _updates: updates, options } = this;\n        if (updates.idle) {\n            if (options.autoFreeze) {\n                updates.idle = false;\n                this.unfreeze();\n            }\n        }\n        const { FLAG_REMOVE, FLAG_INSERT, UPDATE_PRIORITY, cid } = view;\n        let priorityUpdates = updates.priorities[priority];\n        if (!priorityUpdates) priorityUpdates = updates.priorities[priority] = {};\n        // Move higher priority updates to this priority\n        if (priority > UPDATE_PRIORITY) {\n            // Not the default priority for this view. It's most likely a link view\n            // connected to another link view, which triggered the update.\n            // TODO: If there is an update scheduled with a lower priority already, we should\n            // change the requested priority to the lowest one. Does not seem to be critical\n            // right now, as it \"only\" results in multiple updates on the same view.\n            for (let i = priority - 1; i >= UPDATE_PRIORITY; i--) {\n                const prevPriorityUpdates = updates.priorities[i];\n                if (!prevPriorityUpdates || !(cid in prevPriorityUpdates)) continue;\n                priorityUpdates[cid] |= prevPriorityUpdates[cid];\n                delete prevPriorityUpdates[cid];\n            }\n        }\n        let currentType = priorityUpdates[cid] || 0;\n        // Prevent cycling\n        if ((currentType & type) === type) return;\n        if (!currentType) updates.count++;\n        if (type & FLAG_REMOVE && currentType & FLAG_INSERT) {\n            // When a view is removed we need to remove the insert flag as this is a reinsert\n            priorityUpdates[cid] ^= FLAG_INSERT;\n        } else if (type & FLAG_INSERT && currentType & FLAG_REMOVE) {\n            // When a view is added we need to remove the remove flag as this is view was previously removed\n            priorityUpdates[cid] ^= FLAG_REMOVE;\n        }\n        priorityUpdates[cid] |= type;\n        const viewUpdateFn = options.onViewUpdate;\n        if (typeof viewUpdateFn === 'function') viewUpdateFn.call(this, view, type, priority, opt || {}, this);\n    },\n\n    dumpViewUpdate: function(view) {\n        if (!view) return 0;\n        var updates = this._updates;\n        var cid = view.cid;\n        var priorityUpdates = updates.priorities[view.UPDATE_PRIORITY];\n        var flag = this.registerMountedView(view) | priorityUpdates[cid];\n        delete priorityUpdates[cid];\n        return flag;\n    },\n\n    dumpView: function(view, opt = {}) {\n        const flag = this.dumpViewUpdate(view);\n        if (!flag) return 0;\n        const shouldNotify = !opt.silent;\n        if (shouldNotify) this.notifyBeforeRender(opt);\n        const leftover = this.updateView(view, flag, opt);\n        if (shouldNotify) {\n            const stats = { updated: 1, priority: view.UPDATE_PRIORITY };\n            this.notifyAfterRender(stats, opt);\n        }\n        return leftover;\n    },\n\n    updateView: function(view, flag, opt) {\n        if (!view) return 0;\n        const { FLAG_REMOVE, FLAG_INSERT, FLAG_INIT, model } = view;\n        if (view instanceof CellView) {\n            if (flag & FLAG_REMOVE) {\n                this.removeView(model);\n                return 0;\n            }\n            if (flag & FLAG_INSERT) {\n                const isInitialInsert = !!(flag & FLAG_INIT);\n                if (isInitialInsert) {\n                    flag ^= FLAG_INIT;\n                }\n                this.insertView(view, isInitialInsert);\n                flag ^= FLAG_INSERT;\n            }\n        }\n        if (!flag) return 0;\n        return view.confirmUpdate(flag, opt || {});\n    },\n\n    requireView: function(model, opt) {\n        var view = this.findViewByModel(model);\n        if (!view) return null;\n        this.dumpView(view, opt);\n        return view;\n    },\n\n    registerUnmountedView: function(view) {\n        var cid = view.cid;\n        var updates = this._updates;\n        if (cid in updates.unmounted) return 0;\n        var flag = updates.unmounted[cid] |= view.FLAG_INSERT;\n        updates.unmountedCids.push(cid);\n        delete updates.mounted[cid];\n        return flag;\n    },\n\n    registerMountedView: function(view) {\n        var cid = view.cid;\n        var updates = this._updates;\n        if (cid in updates.mounted) return 0;\n        updates.mounted[cid] = true;\n        updates.mountedCids.push(cid);\n        var flag = updates.unmounted[cid] || 0;\n        delete updates.unmounted[cid];\n        return flag;\n    },\n\n    isViewMounted: function(view) {\n        if (!view) return false;\n        var cid = view.cid;\n        var updates = this._updates;\n        return (cid in updates.mounted);\n    },\n\n    dumpViews: function(opt) {\n        var passingOpt = defaults({}, opt, { viewport: null });\n        this.checkViewport(passingOpt);\n        this.updateViews(passingOpt);\n    },\n\n    // Synchronous views update\n    updateViews: function(opt) {\n        this.notifyBeforeRender(opt);\n        let batchStats;\n        let updateCount = 0;\n        let batchCount = 0;\n        let priority = MIN_PRIORITY;\n        do {\n            batchCount++;\n            batchStats = this.updateViewsBatch(opt);\n            updateCount += batchStats.updated;\n            priority = Math.min(batchStats.priority, priority);\n        } while (!batchStats.empty);\n        const stats = { updated: updateCount, batches: batchCount, priority };\n        this.notifyAfterRender(stats, opt);\n        return stats;\n    },\n\n    hasScheduledUpdates: function() {\n        const priorities = this._updates.priorities;\n        const priorityIndexes = Object.keys(priorities); // convert priorities to a dense array\n        let i = priorityIndexes.length;\n        while (i > 0 && i--) {\n            // a faster way how to check if an object is empty\n            for (let _key in priorities[priorityIndexes[i]]) return true;\n        }\n        return false;\n    },\n\n    updateViewsAsync: function(opt, data) {\n        opt || (opt = {});\n        data || (data = { processed: 0, priority: MIN_PRIORITY });\n        const { _updates: updates, options } = this;\n        const id = updates.id;\n        if (id) {\n            cancelFrame(id);\n            if (data.processed === 0 && this.hasScheduledUpdates()) {\n                this.notifyBeforeRender(opt);\n            }\n            const stats = this.updateViewsBatch(opt);\n            const passingOpt = defaults({}, opt, {\n                mountBatchSize: MOUNT_BATCH_SIZE - stats.mounted,\n                unmountBatchSize: MOUNT_BATCH_SIZE - stats.unmounted\n            });\n            const checkStats = this.checkViewport(passingOpt);\n            const unmountCount = checkStats.unmounted;\n            const mountCount = checkStats.mounted;\n            let processed = data.processed;\n            const total = updates.count;\n            if (stats.updated > 0) {\n                // Some updates have been just processed\n                processed += stats.updated + stats.unmounted;\n                stats.processed = processed;\n                data.priority = Math.min(stats.priority, data.priority);\n                if (stats.empty && mountCount === 0) {\n                    stats.unmounted += unmountCount;\n                    stats.mounted += mountCount;\n                    stats.priority = data.priority;\n                    this.notifyAfterRender(stats, opt);\n                    data.processed = 0;\n                    data.priority = MIN_PRIORITY;\n                    updates.count = 0;\n                } else {\n                    data.processed = processed;\n                }\n            } else {\n                if (!updates.idle) {\n                    if (options.autoFreeze) {\n                        this.freeze();\n                        updates.idle = true;\n                        this.trigger('render:idle', opt);\n                    }\n                }\n            }\n            // Progress callback\n            const progressFn = opt.progress;\n            if (total && typeof progressFn === 'function') {\n                progressFn.call(this, stats.empty, processed, total, stats, this);\n            }\n            // The current frame could have been canceled in a callback\n            if (updates.id !== id) return;\n        }\n        if (updates.disabled) {\n            throw new Error('dia.Paper: can not unfreeze the paper after it was removed');\n        }\n        updates.id = nextFrame(this.updateViewsAsync, this, opt, data);\n    },\n\n    notifyBeforeRender: function(opt = {}) {\n        let beforeFn = opt.beforeRender;\n        if (typeof beforeFn !== 'function') {\n            beforeFn = this.options.beforeRender;\n            if (typeof beforeFn !== 'function') return;\n        }\n        beforeFn.call(this, opt, this);\n    },\n\n    notifyAfterRender: function(stats, opt = {}) {\n        let afterFn = opt.afterRender;\n        if (typeof afterFn !== 'function') {\n            afterFn = this.options.afterRender;\n        }\n        if (typeof afterFn === 'function') {\n            afterFn.call(this, stats, opt, this);\n        }\n        this.trigger('render:done', stats, opt);\n    },\n\n    updateViewsBatch: function(opt) {\n        opt || (opt = {});\n        var batchSize = opt.batchSize || UPDATE_BATCH_SIZE;\n        var updates = this._updates;\n        var updateCount = 0;\n        var postponeCount = 0;\n        var unmountCount = 0;\n        var mountCount = 0;\n        var maxPriority = MIN_PRIORITY;\n        var empty = true;\n        var options = this.options;\n        var priorities = updates.priorities;\n        var viewportFn = 'viewport' in opt ? opt.viewport : options.viewport;\n        if (typeof viewportFn !== 'function') viewportFn = null;\n        var postponeViewFn = options.onViewPostponed;\n        if (typeof postponeViewFn !== 'function') postponeViewFn = null;\n        var priorityIndexes = Object.keys(priorities); // convert priorities to a dense array\n        main: for (var i = 0, n = priorityIndexes.length; i < n; i++) {\n            var priority = +priorityIndexes[i];\n            var priorityUpdates = priorities[priority];\n            for (var cid in priorityUpdates) {\n                if (updateCount >= batchSize) {\n                    empty = false;\n                    break main;\n                }\n                var view = views[cid];\n                if (!view) {\n                    // This should not occur\n                    delete priorityUpdates[cid];\n                    continue;\n                }\n                var currentFlag = priorityUpdates[cid];\n                if ((currentFlag & view.FLAG_REMOVE) === 0) {\n                    // We should never check a view for viewport if we are about to remove the view\n                    var isDetached = cid in updates.unmounted;\n                    if (view.DETACHABLE && viewportFn && !viewportFn.call(this, view, !isDetached, this)) {\n                        // Unmount View\n                        if (!isDetached) {\n                            this.registerUnmountedView(view);\n                            this.detachView(view);\n                        }\n                        updates.unmounted[cid] |= currentFlag;\n                        delete priorityUpdates[cid];\n                        unmountCount++;\n                        continue;\n                    }\n                    // Mount View\n                    if (isDetached) {\n                        currentFlag |= view.FLAG_INSERT;\n                        mountCount++;\n                    }\n                    currentFlag |= this.registerMountedView(view);\n                }\n                var leftoverFlag = this.updateView(view, currentFlag, opt);\n                if (leftoverFlag > 0) {\n                    // View update has not finished completely\n                    priorityUpdates[cid] = leftoverFlag;\n                    if (!postponeViewFn || !postponeViewFn.call(this, view, leftoverFlag, this) || priorityUpdates[cid]) {\n                        postponeCount++;\n                        empty = false;\n                        continue;\n                    }\n                }\n                if (maxPriority > priority) maxPriority = priority;\n                updateCount++;\n                delete priorityUpdates[cid];\n            }\n        }\n        return {\n            priority: maxPriority,\n            updated: updateCount,\n            postponed: postponeCount,\n            unmounted: unmountCount,\n            mounted: mountCount,\n            empty: empty\n        };\n    },\n\n    getUnmountedViews: function() {\n        const updates = this._updates;\n        const unmountedCids = Object.keys(updates.unmounted);\n        const n = unmountedCids.length;\n        const unmountedViews = new Array(n);\n        for (var i = 0; i < n; i++) {\n            unmountedViews[i] = views[unmountedCids[i]];\n        }\n        return unmountedViews;\n    },\n\n    getMountedViews: function() {\n        const updates = this._updates;\n        const mountedCids = Object.keys(updates.mounted);\n        const n = mountedCids.length;\n        const mountedViews = new Array(n);\n        for (var i = 0; i < n; i++) {\n            mountedViews[i] = views[mountedCids[i]];\n        }\n        return mountedViews;\n    },\n\n    checkUnmountedViews: function(viewportFn, opt) {\n        opt || (opt  = {});\n        var mountCount = 0;\n        if (typeof viewportFn !== 'function') viewportFn = null;\n        var batchSize = 'mountBatchSize' in opt ? opt.mountBatchSize : Infinity;\n        var updates = this._updates;\n        var unmountedCids = updates.unmountedCids;\n        var unmounted = updates.unmounted;\n        for (var i = 0, n = Math.min(unmountedCids.length, batchSize); i < n; i++) {\n            var cid = unmountedCids[i];\n            if (!(cid in unmounted)) continue;\n            var view = views[cid];\n            if (!view) continue;\n            if (view.DETACHABLE && viewportFn && !viewportFn.call(this, view, false, this)) {\n                // Push at the end of all unmounted ids, so this can be check later again\n                unmountedCids.push(cid);\n                continue;\n            }\n            mountCount++;\n            var flag = this.registerMountedView(view);\n            if (flag) this.scheduleViewUpdate(view, flag, view.UPDATE_PRIORITY, { mounting: true });\n        }\n        // Get rid of views, that have been mounted\n        unmountedCids.splice(0, i);\n        return mountCount;\n    },\n\n    checkMountedViews: function(viewportFn, opt) {\n        opt || (opt = {});\n        var unmountCount = 0;\n        if (typeof viewportFn !== 'function') return unmountCount;\n        var batchSize = 'unmountBatchSize' in opt ? opt.unmountBatchSize : Infinity;\n        var updates = this._updates;\n        var mountedCids = updates.mountedCids;\n        var mounted = updates.mounted;\n        for (var i = 0, n = Math.min(mountedCids.length, batchSize); i < n; i++) {\n            var cid = mountedCids[i];\n            if (!(cid in mounted)) continue;\n            var view = views[cid];\n            if (!view) continue;\n            if (!view.DETACHABLE || viewportFn.call(this, view, true, this)) {\n                // Push at the end of all mounted ids, so this can be check later again\n                mountedCids.push(cid);\n                continue;\n            }\n            unmountCount++;\n            var flag = this.registerUnmountedView(view);\n            if (flag) this.detachView(view);\n        }\n        // Get rid of views, that have been unmounted\n        mountedCids.splice(0, i);\n        return unmountCount;\n    },\n\n    checkViewVisibility: function(cellView, opt = {}) {\n        let viewportFn = 'viewport' in opt ? opt.viewport : this.options.viewport;\n        if (typeof viewportFn !== 'function') viewportFn = null;\n        const updates = this._updates;\n        const { mounted, unmounted } = updates;\n        const visible = !cellView.DETACHABLE || !viewportFn || viewportFn.call(this, cellView, false, this);\n\n        let isUnmounted = false;\n        let isMounted = false;\n\n        if (cellView.cid in mounted && !visible) {\n            const flag = this.registerUnmountedView(cellView);\n            if (flag) this.detachView(cellView);\n            const i = updates.mountedCids.indexOf(cellView.cid);\n            updates.mountedCids.splice(i, 1);\n            isUnmounted = true;\n        }\n\n        if (!isUnmounted && cellView.cid in unmounted && visible) {\n            const i = updates.unmountedCids.indexOf(cellView.cid);\n            updates.unmountedCids.splice(i, 1);\n            var flag = this.registerMountedView(cellView);\n            if (flag) this.scheduleViewUpdate(cellView, flag, cellView.UPDATE_PRIORITY, { mounting: true });\n            isMounted = true;\n        }\n\n        return {\n            mounted: isMounted ? 1 : 0,\n            unmounted: isUnmounted ? 1 : 0\n        };\n    },\n\n    checkViewport: function(opt) {\n        var passingOpt = defaults({}, opt, {\n            mountBatchSize: Infinity,\n            unmountBatchSize: Infinity\n        });\n        var viewportFn = 'viewport' in passingOpt ? passingOpt.viewport : this.options.viewport;\n        var unmountedCount = this.checkMountedViews(viewportFn, passingOpt);\n        if (unmountedCount > 0) {\n            // Do not check views, that have been just unmounted and pushed at the end of the cids array\n            var unmountedCids = this._updates.unmountedCids;\n            passingOpt.mountBatchSize = Math.min(unmountedCids.length - unmountedCount, passingOpt.mountBatchSize);\n        }\n        var mountedCount = this.checkUnmountedViews(viewportFn, passingOpt);\n        return {\n            mounted: mountedCount,\n            unmounted: unmountedCount\n        };\n    },\n\n    freeze: function(opt) {\n        opt || (opt = {});\n        var updates = this._updates;\n        var key = opt.key;\n        var isFrozen = this.options.frozen;\n        var freezeKey = updates.freezeKey;\n        if (key && key !== freezeKey)  {\n            // key passed, but the paper is already freezed with another key\n            if (isFrozen && freezeKey) return;\n            updates.freezeKey = key;\n            updates.keyFrozen = isFrozen;\n        }\n        this.options.frozen = true;\n        var id = updates.id;\n        updates.id = null;\n        if (this.isAsync() && id) cancelFrame(id);\n    },\n\n    unfreeze: function(opt) {\n        opt || (opt = {});\n        var updates = this._updates;\n        var key = opt.key;\n        var freezeKey = updates.freezeKey;\n        // key passed, but the paper is already freezed with another key\n        if (key && freezeKey && key !== freezeKey) return;\n        updates.freezeKey = null;\n        // key passed, but the paper is already freezed\n        if (key && key === freezeKey && updates.keyFrozen) return;\n        if (this.isAsync()) {\n            this.freeze();\n            this.updateViewsAsync(opt);\n        } else {\n            this.updateViews(opt);\n        }\n        this.options.frozen = updates.keyFrozen = false;\n        if (updates.sort) {\n            this.sortViews();\n            updates.sort = false;\n        }\n    },\n\n    isAsync: function() {\n        return !!this.options.async;\n    },\n\n    isFrozen: function() {\n        return !!this.options.frozen;\n    },\n\n    isExactSorting: function() {\n        return this.options.sorting === sortingTypes.EXACT;\n    },\n\n    onRemove: function() {\n\n        this.freeze();\n        this._updates.disabled = true;\n        //clean up all DOM elements/views to prevent memory leaks\n        this.removeLayers();\n        this.removeViews();\n    },\n\n    getComputedSize: function() {\n\n        var options = this.options;\n        var w = options.width;\n        var h = options.height;\n        if (!isNumber(w)) w = this.el.clientWidth;\n        if (!isNumber(h)) h = this.el.clientHeight;\n        return { width: w, height: h };\n    },\n\n    setDimensions: function(width, height) {\n        const { options } = this;\n        const { width: currentWidth, height: currentHeight } = options;\n        let w = (width === undefined) ? currentWidth : width;\n        let h = (height === undefined) ? currentHeight : height;\n        if (currentWidth === w && currentHeight === h) return;\n        options.width = w;\n        options.height = h;\n        this._setDimensions();\n        const computedSize = this.getComputedSize();\n        this.trigger('resize', computedSize.width, computedSize.height);\n    },\n\n    _setDimensions: function() {\n        const { options } = this;\n        let w = options.width;\n        let h = options.height;\n        if (isNumber(w)) w = Math.round(w);\n        if (isNumber(h)) h = Math.round(h);\n        this.$el.css({\n            width: (w === null) ? '' : w,\n            height: (h === null) ? '' : h\n        });\n    },\n\n    setOrigin: function(ox, oy) {\n        return this.translate(ox || 0, oy || 0);\n    },\n\n    // Expand/shrink the paper to fit the content.\n    // Alternatively signature function(opt)\n    fitToContent: function(gridWidth, gridHeight, padding, opt) {\n\n        if (isObject(gridWidth)) {\n            // first parameter is an option object\n            opt = gridWidth;\n        } else {\n            // Support for a deprecated signature\n            opt = assign({ gridWidth, gridHeight, padding }, opt);\n        }\n\n        const { x, y, width, height } = this.getFitToContentArea(opt);\n        const { sx, sy } = this.scale();\n\n        this.setOrigin(-x * sx, -y * sy);\n        this.setDimensions(width * sx, height * sy);\n\n        return new Rect(x, y, width, height);\n    },\n\n    getFitToContentArea: function(opt = {}) {\n\n        // Calculate the paper size to accommodate all the graph's elements.\n\n        const gridWidth = opt.gridWidth || 1;\n        const gridHeight = opt.gridHeight || 1;\n        const padding = normalizeSides(opt.padding || 0);\n\n        const minWidth = Math.max(opt.minWidth || 0, gridWidth);\n        const minHeight = Math.max(opt.minHeight || 0, gridHeight);\n        const maxWidth = opt.maxWidth || Number.MAX_VALUE;\n        const maxHeight = opt.maxHeight || Number.MAX_VALUE;\n        const newOrigin = opt.allowNewOrigin;\n\n        const area = ('contentArea' in opt) ? new Rect(opt.contentArea) : this.getContentArea(opt);\n        const { sx, sy } = this.scale();\n        area.x *= sx;\n        area.y *= sy;\n        area.width *= sx;\n        area.height *= sy;\n\n        let calcWidth = Math.ceil((area.width + area.x) / gridWidth);\n        let calcHeight = Math.ceil((area.height + area.y) / gridHeight);\n        if (!opt.allowNegativeBottomRight) {\n            calcWidth = Math.max(calcWidth, 1);\n            calcHeight = Math.max(calcHeight, 1);\n        }\n        calcWidth *= gridWidth;\n        calcHeight *= gridHeight;\n\n        let tx = 0;\n        if ((newOrigin === 'negative' && area.x < 0) || (newOrigin === 'positive' && area.x >= 0) || newOrigin === 'any') {\n            tx = Math.ceil(-area.x / gridWidth) * gridWidth;\n            tx += padding.left;\n            calcWidth += tx;\n        }\n\n        let ty = 0;\n        if ((newOrigin === 'negative' && area.y < 0) || (newOrigin === 'positive' && area.y >= 0) || newOrigin === 'any') {\n            ty = Math.ceil(-area.y / gridHeight) * gridHeight;\n            ty += padding.top;\n            calcHeight += ty;\n        }\n\n        calcWidth += padding.right;\n        calcHeight += padding.bottom;\n\n        // Make sure the resulting width and height are greater than minimum.\n        calcWidth = Math.max(calcWidth, minWidth);\n        calcHeight = Math.max(calcHeight, minHeight);\n\n        // Make sure the resulting width and height are lesser than maximum.\n        calcWidth = Math.min(calcWidth, maxWidth);\n        calcHeight = Math.min(calcHeight, maxHeight);\n\n        return new Rect(-tx / sx, -ty / sy, calcWidth / sx, calcHeight / sy);\n    },\n\n    transformToFitContent: function(opt) {\n        opt || (opt = {});\n\n        let contentBBox, contentLocalOrigin;\n        if ('contentArea' in opt) {\n            const contentArea = opt.contentArea;\n            contentBBox = this.localToPaperRect(contentArea);\n            contentLocalOrigin = new Point(contentArea);\n        } else {\n            contentBBox = this.getContentBBox(opt);\n            contentLocalOrigin = this.paperToLocalPoint(contentBBox);\n        }\n\n        if (!contentBBox.width || !contentBBox.height) return;\n\n        defaults(opt, {\n            padding: 0,\n            preserveAspectRatio: true,\n            scaleGrid: null,\n            minScale: 0,\n            maxScale: Number.MAX_VALUE,\n            verticalAlign: 'top',\n            horizontalAlign: 'left',\n            //minScaleX\n            //minScaleY\n            //maxScaleX\n            //maxScaleY\n            //fittingBBox\n        });\n\n        const padding = normalizeSides(opt.padding);\n\n        const minScaleX = opt.minScaleX || opt.minScale;\n        const maxScaleX = opt.maxScaleX || opt.maxScale;\n        const minScaleY = opt.minScaleY || opt.minScale;\n        const maxScaleY = opt.maxScaleY || opt.maxScale;\n\n        let fittingBBox;\n        if (opt.fittingBBox) {\n            fittingBBox = opt.fittingBBox;\n        } else {\n            const currentTranslate = this.translate();\n            const computedSize = this.getComputedSize();\n            fittingBBox = {\n                x: currentTranslate.tx,\n                y: currentTranslate.ty,\n                width: computedSize.width,\n                height: computedSize.height\n            };\n        }\n\n        fittingBBox = new Rect(fittingBBox).moveAndExpand({\n            x: padding.left,\n            y: padding.top,\n            width: -padding.left - padding.right,\n            height: -padding.top - padding.bottom\n        });\n\n        const currentScale = this.scale();\n\n        let newSx = fittingBBox.width / contentBBox.width * currentScale.sx;\n        let newSy = fittingBBox.height / contentBBox.height * currentScale.sy;\n\n        if (opt.preserveAspectRatio) {\n            newSx = newSy = Math.min(newSx, newSy);\n        }\n\n        // snap scale to a grid\n        if (opt.scaleGrid) {\n\n            const gridSize = opt.scaleGrid;\n\n            newSx = gridSize * Math.floor(newSx / gridSize);\n            newSy = gridSize * Math.floor(newSy / gridSize);\n        }\n\n        // scale min/max boundaries\n        newSx = Math.min(maxScaleX, Math.max(minScaleX, newSx));\n        newSy = Math.min(maxScaleY, Math.max(minScaleY, newSy));\n\n        const scaleDiff = {\n            x: newSx / currentScale.sx,\n            y: newSy / currentScale.sy\n        };\n\n        const origin = this.options.origin;\n        let newOx = fittingBBox.x - contentLocalOrigin.x * newSx - origin.x;\n        let newOy = fittingBBox.y - contentLocalOrigin.y * newSy - origin.y;\n\n        switch (opt.verticalAlign) {\n            case 'middle':\n                newOy = newOy + (fittingBBox.height - contentBBox.height * scaleDiff.y) / 2;\n                break;\n            case 'bottom':\n                newOy = newOy + (fittingBBox.height - contentBBox.height * scaleDiff.y);\n                break;\n            case 'top':\n            default:\n                break;\n        }\n\n        switch (opt.horizontalAlign) {\n            case 'middle':\n                newOx = newOx + (fittingBBox.width - contentBBox.width * scaleDiff.x) / 2;\n                break;\n            case 'right':\n                newOx = newOx + (fittingBBox.width - contentBBox.width * scaleDiff.x);\n                break;\n            case 'left':\n            default:\n                break;\n        }\n\n        this.scale(newSx, newSy);\n        this.translate(newOx, newOy);\n    },\n\n    scaleContentToFit: function(opt) {\n        this.transformToFitContent(opt);\n    },\n\n    // Return the dimensions of the content area in local units (without transformations).\n    getContentArea: function(opt) {\n\n        if (opt && opt.useModelGeometry) {\n            return this.model.getBBox() || new Rect();\n        }\n\n        return V(this.cells).getBBox();\n    },\n\n    // Return the dimensions of the content bbox in the paper units (as it appears on screen).\n    getContentBBox: function(opt) {\n\n        return this.localToPaperRect(this.getContentArea(opt));\n    },\n\n    // Returns a geometry rectangle representing the entire\n    // paper area (coordinates from the left paper border to the right one\n    // and the top border to the bottom one).\n    getArea: function() {\n\n        return this.paperToLocalRect(this.getComputedSize());\n    },\n\n    getRestrictedArea: function(...args) {\n\n        const { restrictTranslate } = this.options;\n\n        let restrictedArea;\n        if (isFunction(restrictTranslate)) {\n            // A method returning a bounding box\n            restrictedArea = restrictTranslate.apply(this, args);\n        } else if (restrictTranslate === true) {\n            // The paper area\n            restrictedArea = this.getArea();\n        } else if (!restrictTranslate) {\n            // falsy value\n            restrictedArea = null;\n        } else {\n            // any other value\n            restrictedArea = new Rect(restrictTranslate);\n        }\n\n        return restrictedArea;\n    },\n\n    createViewForModel: function(cell) {\n\n        const { options } = this;\n        // A class taken from the paper options.\n        var optionalViewClass;\n\n        // A default basic class (either dia.ElementView or dia.LinkView)\n        var defaultViewClass;\n\n        // A special class defined for this model in the corresponding namespace.\n        // e.g. joint.shapes.basic.Rect searches for joint.shapes.basic.RectView\n        var namespace = options.cellViewNamespace;\n        var type = cell.get('type') + 'View';\n        var namespaceViewClass = getByPath(namespace, type, '.');\n\n        if (cell.isLink()) {\n            optionalViewClass = options.linkView;\n            defaultViewClass = LinkView;\n        } else {\n            optionalViewClass = options.elementView;\n            defaultViewClass = ElementView;\n        }\n\n        // a) the paper options view is a class (deprecated)\n        //  1. search the namespace for a view\n        //  2. if no view was found, use view from the paper options\n        // b) the paper options view is a function\n        //  1. call the function from the paper options\n        //  2. if no view was return, search the namespace for a view\n        //  3. if no view was found, use the default\n        var ViewClass = (optionalViewClass.prototype instanceof Backbone.View)\n            ? namespaceViewClass || optionalViewClass\n            : optionalViewClass.call(this, cell) || namespaceViewClass || defaultViewClass;\n\n        return new ViewClass({\n            model: cell,\n            interactive: options.interactive,\n            labelsLayer: options.labelsLayer === true ? LayersNames.LABELS : options.labelsLayer\n        });\n    },\n\n    removeView: function(cell) {\n\n        const { id } = cell;\n        const { _views, _updates } = this;\n        const view = _views[id];\n        if (view) {\n            var { cid } = view;\n            const { mounted, unmounted } = _updates;\n            view.remove();\n            delete _views[id];\n            delete mounted[cid];\n            delete unmounted[cid];\n        }\n        return view;\n    },\n\n    renderView: function(cell, opt) {\n\n        const { id } = cell;\n        const views = this._views;\n        let view, flag;\n        let create = true;\n        if (id in views) {\n            view = views[id];\n            if (view.model === cell) {\n                flag = view.FLAG_INSERT;\n                create = false;\n            } else {\n                // The view for this `id` already exist.\n                // The cell is a new instance of the model with identical id\n                // We simply remove the existing view and create a new one\n                this.removeView(cell);\n            }\n        }\n        if (create) {\n            view = views[id] = this.createViewForModel(cell);\n            view.paper = this;\n            flag = this.registerUnmountedView(view) | this.FLAG_INIT | view.getFlag(result(view, 'initFlag'));\n        }\n        this.requestViewUpdate(view, flag, view.UPDATE_PRIORITY, opt);\n        return view;\n    },\n\n    onImageDragStart: function() {\n        // This is the only way to prevent image dragging in Firefox that works.\n        // Setting -moz-user-select: none, draggable=\"false\" attribute or user-drag: none didn't help.\n\n        return false;\n    },\n\n    resetViews: function(cells, opt) {\n        opt || (opt = {});\n        cells || (cells = []);\n        this._resetUpdates();\n        // clearing views removes any event listeners\n        this.removeViews();\n        // Allows to unfreeze normally while in the idle state using autoFreeze option\n        const key = this.options.autoFreeze ? null : 'reset';\n        this.freeze({ key });\n        for (var i = 0, n = cells.length; i < n; i++) {\n            this.renderView(cells[i], opt);\n        }\n        this.unfreeze({ key });\n        this.sortViews();\n    },\n\n    removeViews: function() {\n\n        invoke(this._views, 'remove');\n\n        this._views = {};\n    },\n\n    sortViews: function() {\n\n        if (!this.isExactSorting()) {\n            // noop\n            return;\n        }\n        if (this.isFrozen()) {\n            // sort views once unfrozen\n            this._updates.sort = true;\n            return;\n        }\n        this.sortViewsExact();\n    },\n\n    sortViewsExact: function() {\n\n        // Run insertion sort algorithm in order to efficiently sort DOM elements according to their\n        // associated model `z` attribute.\n\n        var $cells = $(this.cells).children('[model-id]');\n        var cells = this.model.get('cells');\n\n        sortElements($cells, function(a, b) {\n            var cellA = cells.get(a.getAttribute('model-id'));\n            var cellB = cells.get(b.getAttribute('model-id'));\n            var zA = cellA.attributes.z || 0;\n            var zB = cellB.attributes.z || 0;\n            return (zA === zB) ? 0 : (zA < zB) ? -1 : 1;\n        });\n    },\n\n    insertView: function(view, isInitialInsert) {\n        const layerView = this.getLayerView(LayersNames.CELLS);\n        const { el, model } = view;\n        switch (this.options.sorting) {\n            case sortingTypes.APPROX:\n                layerView.insertSortedNode(el, model.get('z'));\n                break;\n            case sortingTypes.EXACT:\n            default:\n                layerView.insertNode(el);\n                break;\n        }\n        view.onMount(isInitialInsert);\n    },\n\n    detachView(view) {\n        view.unmount();\n        view.onDetach();\n    },\n\n    scale: function(sx, sy, ox, oy) {\n\n        // getter\n        if (sx === undefined) {\n            return V.matrixToScale(this.matrix());\n        }\n\n        // setter\n        if (sy === undefined) {\n            sy = sx;\n        }\n        if (ox === undefined) {\n            ox = 0;\n            oy = 0;\n        }\n\n        var translate = this.translate();\n\n        if (ox || oy || translate.tx || translate.ty) {\n            var newTx = translate.tx - ox * (sx - 1);\n            var newTy = translate.ty - oy * (sy - 1);\n            this.translate(newTx, newTy);\n        }\n\n        sx = Math.max(sx || 0, this.MIN_SCALE);\n        sy = Math.max(sy || 0, this.MIN_SCALE);\n\n        var ctm = this.matrix();\n        ctm.a = sx;\n        ctm.d = sy;\n\n        this.matrix(ctm);\n\n        this.trigger('scale', sx, sy, ox, oy);\n\n        return this;\n    },\n\n    // Experimental - do not use in production.\n    rotate: function(angle, cx, cy) {\n\n        // getter\n        if (angle === undefined) {\n            return V.matrixToRotate(this.matrix());\n        }\n\n        // setter\n\n        // If the origin is not set explicitely, rotate around the center. Note that\n        // we must use the plain bounding box (`this.el.getBBox()` instead of the one that gives us\n        // the real bounding box (`bbox()`) including transformations).\n        if (cx === undefined) {\n            var bbox = this.cells.getBBox();\n            cx = bbox.width / 2;\n            cy = bbox.height / 2;\n        }\n\n        var ctm = this.matrix().translate(cx, cy).rotate(angle).translate(-cx, -cy);\n        this.matrix(ctm);\n\n        return this;\n    },\n\n    translate: function(tx, ty) {\n\n        // getter\n        if (tx === undefined) {\n            return V.matrixToTranslate(this.matrix());\n        }\n\n        const { options } = this;\n        const { origin, drawGrid } = options;\n\n        // setter\n        tx || (tx = 0);\n        ty || (ty = 0);\n\n        const ctm = this.matrix();\n        if (ctm.e === tx && ctm.f === ty) return this;\n        ctm.e = tx;\n        ctm.f = ty;\n\n        this.matrix(ctm);\n\n        const { tx: ox, ty: oy } = this.translate();\n        origin.x = ox;\n        origin.y = oy;\n\n        this.trigger('translate', ox, oy);\n\n        if (drawGrid) {\n            this.drawGrid();\n        }\n\n        return this;\n    },\n\n    // Find the first view climbing up the DOM tree starting at element `el`. Note that `el` can also\n    // be a selector or a jQuery object.\n    findView: function($el) {\n\n        var el = isString($el)\n            ? this.cells.querySelector($el)\n            : $el instanceof $ ? $el[0] : $el;\n\n        var id = this.findAttribute('model-id', el);\n        if (id) return this._views[id];\n\n        return undefined;\n    },\n\n    // Find a view for a model `cell`. `cell` can also be a string or number representing a model `id`.\n    findViewByModel: function(cell) {\n\n        var id = (isString(cell) || isNumber(cell)) ? cell : (cell && cell.id);\n\n        return this._views[id];\n    },\n\n    // Find all views at given point\n    findViewsFromPoint: function(p) {\n\n        p = new Point(p);\n\n        var views = this.model.getElements().map(this.findViewByModel, this);\n\n        return views.filter(function(view) {\n            return view && view.vel.getBBox({ target: this.cells }).containsPoint(p);\n        }, this);\n    },\n\n    // Find all views in given area\n    findViewsInArea: function(rect, opt) {\n\n        opt = defaults(opt || {}, { strict: false });\n        rect = new Rect(rect);\n\n        var views = this.model.getElements().map(this.findViewByModel, this);\n        var method = opt.strict ? 'containsRect' : 'intersect';\n\n        return views.filter(function(view) {\n            return view && rect[method](view.vel.getBBox({ target: this.cells }));\n        }, this);\n    },\n\n    removeTools: function() {\n        this.dispatchToolsEvent('remove');\n        return this;\n    },\n\n    hideTools: function() {\n        this.dispatchToolsEvent('hide');\n        return this;\n    },\n\n    showTools: function() {\n        this.dispatchToolsEvent('show');\n        return this;\n    },\n\n    dispatchToolsEvent: function(event, ...args) {\n        if (typeof event !== 'string') return;\n        this.trigger('tools:event', event, ...args);\n    },\n\n\n    getModelById: function(id) {\n\n        return this.model.getCell(id);\n    },\n\n    snapToGrid: function(x, y) {\n\n        // Convert global coordinates to the local ones of the `viewport`. Otherwise,\n        // improper transformation would be applied when the viewport gets transformed (scaled/rotated).\n        return this.clientToLocalPoint(x, y).snapToGrid(this.options.gridSize);\n    },\n\n    localToPaperPoint: function(x, y) {\n        // allow `x` to be a point and `y` undefined\n        var localPoint = new Point(x, y);\n        var paperPoint = V.transformPoint(localPoint, this.matrix());\n        return paperPoint;\n    },\n\n    localToPaperRect: function(x, y, width, height) {\n        // allow `x` to be a rectangle and rest arguments undefined\n        var localRect = new Rect(x, y, width, height);\n        var paperRect = V.transformRect(localRect, this.matrix());\n        return paperRect;\n    },\n\n    paperToLocalPoint: function(x, y) {\n        // allow `x` to be a point and `y` undefined\n        var paperPoint = new Point(x, y);\n        var localPoint = V.transformPoint(paperPoint, this.matrix().inverse());\n        return localPoint;\n    },\n\n    paperToLocalRect: function(x, y, width, height) {\n        // allow `x` to be a rectangle and rest arguments undefined\n        var paperRect = new Rect(x, y, width, height);\n        var localRect = V.transformRect(paperRect, this.matrix().inverse());\n        return localRect;\n    },\n\n    localToClientPoint: function(x, y) {\n        // allow `x` to be a point and `y` undefined\n        var localPoint = new Point(x, y);\n        var clientPoint = V.transformPoint(localPoint, this.clientMatrix());\n        return clientPoint;\n    },\n\n    localToClientRect: function(x, y, width, height) {\n        // allow `x` to be a point and `y` undefined\n        var localRect = new Rect(x, y, width, height);\n        var clientRect = V.transformRect(localRect, this.clientMatrix());\n        return clientRect;\n    },\n\n    // Transform client coordinates to the paper local coordinates.\n    // Useful when you have a mouse event object and you'd like to get coordinates\n    // inside the paper that correspond to `evt.clientX` and `evt.clientY` point.\n    // Example: var localPoint = paper.clientToLocalPoint({ x: evt.clientX, y: evt.clientY });\n    clientToLocalPoint: function(x, y) {\n        // allow `x` to be a point and `y` undefined\n        var clientPoint = new Point(x, y);\n        var localPoint = V.transformPoint(clientPoint, this.clientMatrix().inverse());\n        return localPoint;\n    },\n\n    clientToLocalRect: function(x, y, width, height) {\n        // allow `x` to be a point and `y` undefined\n        var clientRect = new Rect(x, y, width, height);\n        var localRect = V.transformRect(clientRect, this.clientMatrix().inverse());\n        return localRect;\n    },\n\n    localToPagePoint: function(x, y) {\n\n        return this.localToPaperPoint(x, y).offset(this.pageOffset());\n    },\n\n    localToPageRect: function(x, y, width, height) {\n\n        return this.localToPaperRect(x, y, width, height).offset(this.pageOffset());\n    },\n\n    pageToLocalPoint: function(x, y) {\n\n        var pagePoint = new Point(x, y);\n        var paperPoint = pagePoint.difference(this.pageOffset());\n        return this.paperToLocalPoint(paperPoint);\n    },\n\n    pageToLocalRect: function(x, y, width, height) {\n\n        var pageOffset = this.pageOffset();\n        var paperRect = new Rect(x, y, width, height);\n        paperRect.x -= pageOffset.x;\n        paperRect.y -= pageOffset.y;\n        return this.paperToLocalRect(paperRect);\n    },\n\n    clientOffset: function() {\n\n        var clientRect = this.svg.getBoundingClientRect();\n        return new Point(clientRect.left, clientRect.top);\n    },\n\n    pageOffset: function() {\n\n        return this.clientOffset().offset(window.scrollX, window.scrollY);\n    },\n\n    linkAllowed: function(linkView) {\n\n        if (!(linkView instanceof LinkView)) {\n            throw new Error('Must provide a linkView.');\n        }\n\n        var link = linkView.model;\n        var paperOptions = this.options;\n        var graph = this.model;\n        var ns = graph.constructor.validations;\n\n        if (!paperOptions.multiLinks) {\n            if (!ns.multiLinks.call(this, graph, link)) return false;\n        }\n\n        if (!paperOptions.linkPinning) {\n            // Link pinning is not allowed and the link is not connected to the target.\n            if (!ns.linkPinning.call(this, graph, link)) return false;\n        }\n\n        if (typeof paperOptions.allowLink === 'function') {\n            if (!paperOptions.allowLink.call(this, linkView, this)) return false;\n        }\n\n        return true;\n    },\n\n    getDefaultLink: function(cellView, magnet) {\n\n        return isFunction(this.options.defaultLink)\n        // default link is a function producing link model\n            ? this.options.defaultLink.call(this, cellView, magnet)\n        // default link is the Backbone model\n            : this.options.defaultLink.clone();\n    },\n\n    // Cell highlighting.\n    // ------------------\n\n    resolveHighlighter: function(opt = {}) {\n\n        let { highlighter: highlighterDef, type } = opt;\n        const { highlighting,highlighterNamespace  } = this.options;\n\n        /*\n            Expecting opt.highlighter to have the following structure:\n            {\n                name: 'highlighter-name',\n                options: {\n                    some: 'value'\n                }\n            }\n        */\n        if (highlighterDef === undefined) {\n\n            // Is highlighting disabled?\n            if (!highlighting) return false;\n            // check for built-in types\n            if (type) {\n                highlighterDef = highlighting[type];\n                // Is a specific type highlight disabled?\n                if (highlighterDef === false) return false;\n            }\n            if (!highlighterDef) {\n                // Type not defined use default highlight\n                highlighterDef = highlighting['default'];\n            }\n        }\n\n        // Do nothing if opt.highlighter is falsy.\n        // This allows the case to not highlight cell(s) in certain cases.\n        // For example, if you want to NOT highlight when embedding elements\n        // or use a custom highlighter.\n        if (!highlighterDef) return false;\n\n        // Allow specifying a highlighter by name.\n        if (isString(highlighterDef)) {\n            highlighterDef = {\n                name: highlighterDef\n            };\n        }\n\n        const name = highlighterDef.name;\n        const highlighter = highlighterNamespace[name];\n\n        // Highlighter validation\n        if (!highlighter) {\n            throw new Error('Unknown highlighter (\"' + name + '\")');\n        }\n        if (typeof highlighter.highlight !== 'function') {\n            throw new Error('Highlighter (\"' + name + '\") is missing required highlight() method');\n        }\n        if (typeof highlighter.unhighlight !== 'function') {\n            throw new Error('Highlighter (\"' + name + '\") is missing required unhighlight() method');\n        }\n\n        return {\n            highlighter,\n            options: highlighterDef.options || {},\n            name\n        };\n    },\n\n    onCellHighlight: function(cellView, magnetEl, opt) {\n        const highlighterDescriptor = this.resolveHighlighter(opt);\n        if (!highlighterDescriptor) return;\n        const { highlighter, options } = highlighterDescriptor;\n        highlighter.highlight(cellView, magnetEl, options);\n    },\n\n    onCellUnhighlight: function(cellView, magnetEl, opt) {\n        const highlighterDescriptor = this.resolveHighlighter(opt);\n        if (!highlighterDescriptor) return;\n        const { highlighter, options } = highlighterDescriptor;\n        highlighter.unhighlight(cellView, magnetEl, options);\n    },\n\n    // Interaction.\n    // ------------\n\n    pointerdblclick: function(evt) {\n\n        evt.preventDefault();\n\n        // magnetpointerdblclick can stop propagation\n\n        evt = normalizeEvent(evt);\n\n        var view = this.findView(evt.target);\n        if (this.guard(evt, view)) return;\n\n        var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n        if (view) {\n            view.pointerdblclick(evt, localPoint.x, localPoint.y);\n\n        } else {\n            this.trigger('blank:pointerdblclick', evt, localPoint.x, localPoint.y);\n        }\n    },\n\n    pointerclick: function(evt) {\n\n        // magnetpointerclick can stop propagation\n\n        var data = this.eventData(evt);\n        // Trigger event only if mouse has not moved.\n        if (data.mousemoved <= this.options.clickThreshold) {\n\n            evt = normalizeEvent(evt);\n\n            var view = this.findView(evt.target);\n            if (this.guard(evt, view)) return;\n\n            var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n            if (view) {\n                view.pointerclick(evt, localPoint.x, localPoint.y);\n\n            } else {\n                this.trigger('blank:pointerclick', evt, localPoint.x, localPoint.y);\n            }\n        }\n    },\n\n    contextmenu: function(evt) {\n\n        if (this.options.preventContextMenu) evt.preventDefault();\n\n        if (this.contextMenuFired) {\n            this.contextMenuFired = false;\n            return;\n        }\n\n        evt = normalizeEvent(evt);\n\n        this.contextMenuTrigger(evt);\n    },\n\n    contextMenuTrigger: function(evt) {\n        var view = this.findView(evt.target);\n        if (this.guard(evt, view)) return;\n\n        var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n        if (view) {\n            view.contextmenu(evt, localPoint.x, localPoint.y);\n\n        } else {\n            this.trigger('blank:contextmenu', evt, localPoint.x, localPoint.y);\n        }\n    },\n\n    pointerdown: function(evt) {\n\n        evt = normalizeEvent(evt);\n\n        const { target, button } = evt;\n        const view = this.findView(target);\n        const isContextMenu = (button === 2);\n\n        if (view) {\n\n            if (!isContextMenu && this.guard(evt, view)) return;\n\n            const isTargetFormNode = this.FORM_CONTROL_TAG_NAMES.includes(target.tagName);\n\n            if (this.options.preventDefaultViewAction && !isTargetFormNode) {\n                // If the target is a form element, we do not want to prevent the default action.\n                // For example, we want to be able to select text in a text input or\n                // to be able to click on a checkbox.\n                evt.preventDefault();\n            }\n\n            if (isTargetFormNode) {\n                // If the target is a form element, we do not want to start dragging the element.\n                // For example, we want to be able to select text by dragging the mouse.\n                view.preventDefaultInteraction(evt);\n            }\n\n            const rootViewEl = view.el;\n\n            // Custom event\n            const eventNode = target.closest('[event]');\n            if (eventNode && rootViewEl !== eventNode && view.el.contains(eventNode)) {\n                const eventEvt = normalizeEvent($.Event(evt.originalEvent, {\n                    data: evt.data,\n                    // Originally the event listener was attached to the event element.\n                    currentTarget: eventNode\n                }));\n                this.onevent(eventEvt);\n                if (eventEvt.isDefaultPrevented()) {\n                    evt.preventDefault();\n                }\n                // `onevent` can stop propagation\n                if (eventEvt.isPropagationStopped()) return;\n                evt.data = eventEvt.data;\n            }\n\n            // Element magnet\n            const magnetNode = target.closest('[magnet]');\n            if (magnetNode && view.el !== magnetNode && view.el.contains(magnetNode)) {\n                const magnetEvt = normalizeEvent($.Event(evt.originalEvent, {\n                    data: evt.data,\n                    // Originally the event listener was attached to the magnet element.\n                    currentTarget: magnetNode\n                }));\n                this.onmagnet(magnetEvt);\n                if (magnetEvt.isDefaultPrevented()) {\n                    evt.preventDefault();\n                }\n                // `onmagnet` stops propagation when `addLinkFromMagnet` is allowed\n                if (magnetEvt.isPropagationStopped()) {\n                    // `magnet:pointermove` and `magnet:pointerup` events must be fired\n                    if (isContextMenu) return;\n                    this.delegateDragEvents(view, magnetEvt.data);\n                    return;\n                }\n                evt.data = magnetEvt.data;\n            }\n        }\n\n        if (isContextMenu) {\n            this.contextMenuFired = true;\n            const contextmenuEvt = $.Event(evt.originalEvent, { type: 'contextmenu', data: evt.data });\n            this.contextMenuTrigger(contextmenuEvt);\n        } else {\n            const localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n            if (view) {\n                view.pointerdown(evt, localPoint.x, localPoint.y);\n            } else {\n                if (this.options.preventDefaultBlankAction) {\n                    evt.preventDefault();\n                }\n                this.trigger('blank:pointerdown', evt, localPoint.x, localPoint.y);\n            }\n\n            this.delegateDragEvents(view, evt.data);\n        }\n\n    },\n\n    pointermove: function(evt) {\n\n        // mouse moved counter\n        var data = this.eventData(evt);\n        if (!data.mousemoved) {\n            data.mousemoved = 0;\n            // Make sure that events like `mouseenter` and `mouseleave` are\n            // not triggered while the user is dragging a cellView.\n            this.undelegateEvents();\n            // Note: the events are undelegated after the first `pointermove` event.\n            // Not on `pointerdown` to make sure that `dbltap` is recognized.\n        }\n\n        var mousemoved = ++data.mousemoved;\n\n        if (mousemoved <= this.options.moveThreshold) return;\n\n        evt = normalizeEvent(evt);\n\n        var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n\n        var view = data.sourceView;\n        if (view) {\n            view.pointermove(evt, localPoint.x, localPoint.y);\n        } else {\n            this.trigger('blank:pointermove', evt, localPoint.x, localPoint.y);\n        }\n\n        this.eventData(evt, data);\n    },\n\n    pointerup: function(evt) {\n\n        this.undelegateDocumentEvents();\n\n        var normalizedEvt = normalizeEvent(evt);\n\n        var localPoint = this.snapToGrid(normalizedEvt.clientX, normalizedEvt.clientY);\n\n        var view = this.eventData(evt).sourceView;\n        if (view) {\n            view.pointerup(normalizedEvt, localPoint.x, localPoint.y);\n        } else {\n            this.trigger('blank:pointerup', normalizedEvt, localPoint.x, localPoint.y);\n        }\n\n        if (!normalizedEvt.isPropagationStopped()) {\n            this.pointerclick($.Event(evt.originalEvent, { type: 'click', data: evt.data }));\n        }\n\n        this.delegateEvents();\n    },\n\n    mouseover: function(evt) {\n\n        evt = normalizeEvent(evt);\n\n        var view = this.findView(evt.target);\n        if (this.guard(evt, view)) return;\n\n        if (view) {\n            view.mouseover(evt);\n\n        } else {\n            if (this.el === evt.target) return; // prevent border of paper from triggering this\n            this.trigger('blank:mouseover', evt);\n        }\n    },\n\n    mouseout: function(evt) {\n\n        evt = normalizeEvent(evt);\n\n        var view = this.findView(evt.target);\n        if (this.guard(evt, view)) return;\n\n        if (view) {\n            view.mouseout(evt);\n\n        } else {\n            if (this.el === evt.target) return; // prevent border of paper from triggering this\n            this.trigger('blank:mouseout', evt);\n        }\n    },\n\n    mouseenter: function(evt) {\n\n        evt = normalizeEvent(evt);\n\n        const {\n            target, // The EventTarget the pointing device entered to\n            relatedTarget, // The EventTarget the pointing device exited from\n            currentTarget // The EventTarget on which the event listener was registered\n        } = evt;\n        const view = this.findView(target);\n        if (this.guard(evt, view)) return;\n        const relatedView = this.findView(relatedTarget);\n        if (view) {\n            if (relatedView === view) {\n                // Mouse left a cell tool\n                return;\n            }\n            view.mouseenter(evt);\n            if (this.el.contains(relatedTarget)) {\n                // The pointer remains inside the paper.\n                return;\n            }\n        }\n        if (relatedView) {\n            return;\n        }\n        // prevent double `mouseenter` event if the `relatedTarget` is outside the paper\n        // (mouseenter method would be fired twice)\n        if (currentTarget === this.el) {\n            // `paper` (more descriptive), not `blank`\n            this.trigger('paper:mouseenter', evt);\n        }\n    },\n\n    mouseleave: function(evt) {\n\n        evt = normalizeEvent(evt);\n\n        const {\n            target, // The EventTarget the pointing device exited from\n            relatedTarget, // The EventTarget the pointing device entered to\n            currentTarget // The EventTarget on which the event listener was registered\n        } = evt;\n        const view = this.findView(target);\n        if (this.guard(evt, view)) return;\n        const relatedView = this.findView(relatedTarget);\n        if (view) {\n            if (relatedView === view) {\n                // Mouse entered a cell tool\n                return;\n            }\n            view.mouseleave(evt);\n            if (this.el.contains(relatedTarget)) {\n                // The pointer has exited a cellView. The pointer is still inside of the paper.\n                return;\n            }\n        }\n        if (relatedView) {\n            // The pointer has entered a new cellView\n            return;\n        }\n        // prevent double `mouseleave` event if the `relatedTarget` is outside the paper\n        // (mouseleave method would be fired twice)\n        if (currentTarget === this.el) {\n            // There is no cellView under the pointer, nor the blank area of the paper\n            this.trigger('paper:mouseleave', evt);\n        }\n    },\n\n    _processMouseWheelEvtBuf: debounce(function() {\n        const { event, deltas } = this._mw_evt_buffer;\n        const deltaY = deltas.reduce((acc, deltaY) => acc + cap(deltaY, WHEEL_CAP), 0);\n\n        const scale = Math.pow(0.995, deltaY); // 1.005 for inverted pinch/zoom\n        const { x, y } = this.clientToLocalPoint(event.clientX, event.clientY);\n        this.trigger('paper:pinch', event, x, y, scale);\n\n        this._mw_evt_buffer = {\n            event: null,\n            deltas: [],\n        };\n    }, WHEEL_WAIT_MS, { maxWait: WHEEL_WAIT_MS }),\n\n    mousewheel: function(evt) {\n\n        evt = normalizeEvent(evt);\n\n        const view = this.findView(evt.target);\n        if (this.guard(evt, view)) return;\n\n        const originalEvent = evt.originalEvent;\n        const localPoint = this.snapToGrid(originalEvent.clientX, originalEvent.clientY);\n        const { deltaX, deltaY } = normalizeWheel(originalEvent);\n\n        const pinchHandlers = this._events['paper:pinch'];\n\n        // Touchpad devices will send a fake CTRL press when a pinch is performed\n        //\n        // We also check if there are any subscribers to paper:pinch event. If there are none,\n        // just skip the entire block of code (we don't want to blindly call\n        // .preventDefault() if we really don't have to).\n        if (evt.ctrlKey && pinchHandlers && pinchHandlers.length > 0) {\n            // This is a pinch gesture, it's safe to assume that we must call .preventDefault()\n            originalEvent.preventDefault();\n            this._mw_evt_buffer.event = originalEvent;\n            this._mw_evt_buffer.deltas.push(deltaY);\n            this._processMouseWheelEvtBuf();\n        } else {\n            const delta = Math.max(-1, Math.min(1, originalEvent.wheelDelta));\n            if (view) {\n                view.mousewheel(evt, localPoint.x, localPoint.y, delta);\n\n            } else {\n                this.trigger('blank:mousewheel', evt, localPoint.x, localPoint.y, delta);\n            }\n\n            this.trigger('paper:pan', evt, deltaX, deltaY);\n        }\n    },\n\n    onevent: function(evt) {\n\n        var eventNode = evt.currentTarget;\n        var eventName = eventNode.getAttribute('event');\n        if (eventName) {\n            var view = this.findView(eventNode);\n            if (view) {\n\n                evt = normalizeEvent(evt);\n                if (this.guard(evt, view)) return;\n\n                var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n                view.onevent(evt, eventName, localPoint.x, localPoint.y);\n            }\n        }\n    },\n\n    magnetEvent: function(evt, handler) {\n\n        var magnetNode = evt.currentTarget;\n        var magnetValue = magnetNode.getAttribute('magnet');\n        if (magnetValue) {\n            var view = this.findView(magnetNode);\n            if (view) {\n                evt = normalizeEvent(evt);\n                if (this.guard(evt, view)) return;\n                var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n                handler.call(this, view, evt, magnetNode, localPoint.x, localPoint.y);\n            }\n        }\n    },\n\n    onmagnet: function(evt) {\n\n        if (evt.button === 2) {\n            this.contextMenuFired = true;\n            this.magnetContextMenuFired = true;\n            const contextmenuEvt = $.Event(evt.originalEvent, {\n                type: 'contextmenu',\n                data: evt.data,\n                currentTarget: evt.currentTarget,\n            });\n            this.magnetContextMenuTrigger(contextmenuEvt);\n            if (contextmenuEvt.isPropagationStopped()) {\n                evt.stopPropagation();\n            }\n        } else {\n            this.magnetEvent(evt, function(view, evt, _, x, y) {\n                view.onmagnet(evt, x, y);\n            });\n        }\n    },\n\n    magnetpointerdblclick: function(evt) {\n\n        this.magnetEvent(evt, function(view, evt, magnet, x, y) {\n            view.magnetpointerdblclick(evt, magnet, x, y);\n        });\n    },\n\n    magnetcontextmenu: function(evt) {\n        if (this.options.preventContextMenu) evt.preventDefault();\n\n        if (this.magnetContextMenuFired) {\n            this.magnetContextMenuFired = false;\n            return;\n        }\n\n        this.magnetContextMenuTrigger(evt);\n    },\n\n    magnetContextMenuTrigger: function(evt) {\n        this.magnetEvent(evt, function(view, evt, magnet, x, y) {\n            view.magnetcontextmenu(evt, magnet, x, y);\n        });\n    },\n\n    onlabel: function(evt) {\n\n        var labelNode = evt.currentTarget;\n        var view = this.findView(labelNode);\n        if (view) {\n\n            evt = normalizeEvent(evt);\n            if (this.guard(evt, view)) return;\n\n            var localPoint = this.snapToGrid(evt.clientX, evt.clientY);\n            view.onlabel(evt, localPoint.x, localPoint.y);\n        }\n    },\n\n    getPointerArgs(evt) {\n        const normalizedEvt = normalizeEvent(evt);\n        const { x, y } = this.snapToGrid(normalizedEvt.clientX, normalizedEvt.clientY);\n        return [normalizedEvt, x, y];\n    },\n\n    delegateDragEvents: function(view, data) {\n\n        data || (data = {});\n        this.eventData({ data: data }, { sourceView: view || null, mousemoved: 0 });\n        this.delegateDocumentEvents(null, data);\n    },\n\n    // Guard the specified event. If the event should be ignored, guard returns `true`.\n    // Otherwise, it returns `false`.\n    guard: function(evt, view) {\n\n        if (evt.type === 'mousedown' && evt.button === 2) {\n            // handled as `contextmenu` type\n            return true;\n        }\n\n        if (this.options.guard && this.options.guard(evt, view)) {\n            return true;\n        }\n\n        if (evt.data && evt.data.guarded !== undefined) {\n            return evt.data.guarded;\n        }\n\n        const { target } = evt;\n\n        if (this.GUARDED_TAG_NAMES.includes(target.tagName)) {\n            return true;\n        }\n\n        if (view && view.model && (view.model instanceof Cell)) {\n            return false;\n        }\n\n        if (this.svg === target || this.el === target || $.contains(this.svg, target)) {\n            return false;\n        }\n\n        return true;    // Event guarded. Paper should not react on it in any way.\n    },\n\n    setGridSize: function(gridSize) {\n\n        const { options } = this;\n        options.gridSize = gridSize;\n\n        if (options.drawGrid && !options.drawGridSize) {\n            // Do not redraw the grid if the `drawGridSize` is set.\n            this.drawGrid();\n        }\n\n        return this;\n    },\n\n    clearGrid: function() {\n\n        if (this.$grid) {\n            this.$grid.css('backgroundImage', 'none');\n        }\n        return this;\n    },\n\n    _getGridRefs: function() {\n\n        if (!this._gridCache) {\n\n            this._gridCache = {\n                root: V('svg', { width: '100%', height: '100%' }, V('defs')),\n                patterns: {},\n                add: function(id, vel) {\n                    V(this.root.node.childNodes[0]).append(vel);\n                    this.patterns[id] = vel;\n                    this.root.append(V('rect', { width: '100%', height: '100%', fill: 'url(#' + id + ')' }));\n                },\n                get: function(id) {\n                    return this.patterns[id];\n                },\n                exist: function(id) {\n                    return this.patterns[id] !== undefined;\n                }\n            };\n        }\n\n        return this._gridCache;\n    },\n\n    setGrid: function(drawGrid) {\n\n        this.clearGrid();\n\n        this._gridCache = null;\n        this._gridSettings = [];\n\n        var optionsList = Array.isArray(drawGrid) ? drawGrid : [drawGrid || {}];\n        optionsList.forEach(function(item) {\n            this._gridSettings.push.apply(this._gridSettings, this._resolveDrawGridOption(item));\n        }, this);\n        return this;\n    },\n\n    _resolveDrawGridOption: function(opt) {\n\n        var namespace = this.constructor.gridPatterns;\n        if (isString(opt) && Array.isArray(namespace[opt])) {\n            return namespace[opt].map(function(item) {\n                return assign({}, item);\n            });\n        }\n\n        var options = opt || { args: [{}] };\n        var isArray = Array.isArray(options);\n        var name = options.name;\n\n        if (!isArray && !name && !options.markup) {\n            name = 'dot';\n        }\n\n        if (name && Array.isArray(namespace[name])) {\n            var pattern = namespace[name].map(function(item) {\n                return assign({}, item);\n            });\n\n            var args = Array.isArray(options.args) ? options.args : [options.args || {}];\n\n            defaults(args[0], omit(opt, 'args'));\n            for (var i = 0; i < args.length; i++) {\n                if (pattern[i]) {\n                    assign(pattern[i], args[i]);\n                }\n            }\n            return pattern;\n        }\n\n        return isArray ? options : [options];\n    },\n\n    drawGrid: function(opt) {\n\n        const gridSize = this.options.drawGridSize || this.options.gridSize;\n        if (gridSize <= 1) {\n            return this.clearGrid();\n        }\n\n        var localOptions = Array.isArray(opt) ? opt : [opt];\n\n        var ctm = this.matrix();\n        var refs = this._getGridRefs();\n\n        this._gridSettings.forEach(function(gridLayerSetting, index) {\n\n            var id = 'pattern_' + index;\n            var options = merge(gridLayerSetting, localOptions[index], {\n                sx: ctm.a || 1,\n                sy: ctm.d || 1,\n                ox: ctm.e || 0,\n                oy: ctm.f || 0\n            });\n\n            options.width = gridSize * (ctm.a || 1) * (options.scaleFactor || 1);\n            options.height = gridSize * (ctm.d || 1) * (options.scaleFactor || 1);\n\n            if (!refs.exist(id)) {\n                refs.add(id, V('pattern', { id: id, patternUnits: 'userSpaceOnUse' }, V(options.markup)));\n            }\n\n            var patternDefVel = refs.get(id);\n\n            if (isFunction(options.update)) {\n                options.update(patternDefVel.node.childNodes[0], options);\n            }\n\n            var x = options.ox % options.width;\n            if (x < 0) x += options.width;\n\n            var y = options.oy % options.height;\n            if (y < 0) y += options.height;\n\n            patternDefVel.attr({\n                x: x,\n                y: y,\n                width: options.width,\n                height: options.height\n            });\n        });\n\n        var patternUri = new XMLSerializer().serializeToString(refs.root.node);\n        patternUri = 'url(data:image/svg+xml;base64,' + btoa(patternUri) + ')';\n\n        this.$grid.css('backgroundImage', patternUri);\n\n        return this;\n    },\n\n    updateBackgroundImage: function(opt) {\n\n        opt = opt || {};\n\n        var backgroundPosition = opt.position || 'center';\n        var backgroundSize = opt.size || 'auto auto';\n\n        var currentScale = this.scale();\n        var currentTranslate = this.translate();\n\n        // backgroundPosition\n        if (isObject(backgroundPosition)) {\n            var x = currentTranslate.tx + (currentScale.sx * (backgroundPosition.x || 0));\n            var y = currentTranslate.ty + (currentScale.sy * (backgroundPosition.y || 0));\n            backgroundPosition = x + 'px ' + y + 'px';\n        }\n\n        // backgroundSize\n        if (isObject(backgroundSize)) {\n            backgroundSize = new Rect(backgroundSize).scale(currentScale.sx, currentScale.sy);\n            backgroundSize = backgroundSize.width + 'px ' + backgroundSize.height + 'px';\n        }\n\n        this.$background.css({\n            backgroundSize: backgroundSize,\n            backgroundPosition: backgroundPosition\n        });\n    },\n\n    drawBackgroundImage: function(img, opt) {\n\n        // Clear the background image if no image provided\n        if (!(img instanceof HTMLImageElement)) {\n            this.$background.css('backgroundImage', '');\n            return;\n        }\n\n        if (!this._background || this._background.id !== opt.id) {\n            // Draw only the last image requested (see drawBackground())\n            return;\n        }\n\n        opt = opt || {};\n\n        var backgroundImage;\n        var backgroundSize = opt.size;\n        var backgroundRepeat = opt.repeat || 'no-repeat';\n        var backgroundOpacity = opt.opacity || 1;\n        var backgroundQuality = Math.abs(opt.quality) || 1;\n        var backgroundPattern = this.constructor.backgroundPatterns[camelCase(backgroundRepeat)];\n\n        if (isFunction(backgroundPattern)) {\n            // 'flip-x', 'flip-y', 'flip-xy', 'watermark' and custom\n            img.width *= backgroundQuality;\n            img.height *= backgroundQuality;\n            var canvas = backgroundPattern(img, opt);\n            if (!(canvas instanceof HTMLCanvasElement)) {\n                throw new Error('dia.Paper: background pattern must return an HTML Canvas instance');\n            }\n\n            backgroundImage = canvas.toDataURL('image/png');\n            backgroundRepeat = 'repeat';\n            if (isObject(backgroundSize)) {\n                // recalculate the tile size if an object passed in\n                backgroundSize.width *= canvas.width / img.width;\n                backgroundSize.height *= canvas.height / img.height;\n            } else if (backgroundSize === undefined) {\n                // calculate the tile size if no provided\n                opt.size = {\n                    width: canvas.width / backgroundQuality,\n                    height: canvas.height / backgroundQuality\n                };\n            }\n        } else {\n            // backgroundRepeat:\n            // no-repeat', 'round', 'space', 'repeat', 'repeat-x', 'repeat-y'\n            backgroundImage = img.src;\n            if (backgroundSize === undefined) {\n                // pass the image size for  the backgroundSize if no size provided\n                opt.size = {\n                    width: img.width,\n                    height: img.height\n                };\n            }\n        }\n\n        this.$background.css({\n            opacity: backgroundOpacity,\n            backgroundRepeat: backgroundRepeat,\n            backgroundImage: 'url(' + backgroundImage + ')'\n        });\n\n        this.updateBackgroundImage(opt);\n    },\n\n    updateBackgroundColor: function(color) {\n\n        this.$el.css('backgroundColor', color || '');\n    },\n\n    drawBackground: function(opt) {\n\n        opt = opt || {};\n\n        this.updateBackgroundColor(opt.color);\n\n        if (opt.image) {\n            opt = this._background = cloneDeep(opt);\n            guid(opt);\n            var img = document.createElement('img');\n            img.onload = this.drawBackgroundImage.bind(this, img, opt);\n            img.src = opt.image;\n        } else {\n            this.drawBackgroundImage(null);\n            this._background = null;\n        }\n\n        return this;\n    },\n\n    setInteractivity: function(value) {\n\n        this.options.interactive = value;\n\n        invoke(this._views, 'setInteractivity', value);\n    },\n\n    // Paper definitions.\n    // ------------------\n\n    isDefined: function(defId) {\n\n        return !!this.svg.getElementById(defId);\n    },\n\n    defineFilter: function(filter) {\n\n        if (!isObject(filter)) {\n            throw new TypeError('dia.Paper: defineFilter() requires 1. argument to be an object.');\n        }\n\n        var filterId = filter.id;\n        var name = filter.name;\n        // Generate a hash code from the stringified filter definition. This gives us\n        // a unique filter ID for different definitions.\n        if (!filterId) {\n            filterId = name + this.svg.id + hashCode(JSON.stringify(filter));\n        }\n        // If the filter already exists in the document,\n        // we're done and we can just use it (reference it using `url()`).\n        // If not, create one.\n        if (!this.isDefined(filterId)) {\n\n            var namespace = _filter;\n            var filterSVGString = namespace[name] && namespace[name](filter.args || {});\n            if (!filterSVGString) {\n                throw new Error('Non-existing filter ' + name);\n            }\n\n            // Set the filter area to be 3x the bounding box of the cell\n            // and center the filter around the cell.\n            var filterAttrs = assign({\n                filterUnits: 'objectBoundingBox',\n                x: -1,\n                y: -1,\n                width: 3,\n                height: 3\n            }, filter.attrs, {\n                id: filterId\n            });\n\n            V(filterSVGString, filterAttrs).appendTo(this.defs);\n        }\n\n        return filterId;\n    },\n\n    defineGradient: function(gradient) {\n        if (!isObject(gradient)) {\n            throw new TypeError('dia.Paper: defineGradient() requires 1. argument to be an object.');\n        }\n        const { svg, defs } = this;\n        const {\n            type,\n            // Generate a hash code from the stringified filter definition. This gives us\n            // a unique filter ID for different definitions.\n            id = type + svg.id + hashCode(JSON.stringify(gradient)),\n            stops,\n            attrs = {}\n        } = gradient;\n        // If the gradient already exists in the document,\n        // we're done and we can just use it (reference it using `url()`).\n        if (this.isDefined(id)) return id;\n        // If not, create one.\n        const stopVEls = toArray(stops).map(({ offset, color, opacity }) => {\n            return V('stop').attr({\n                'offset': offset,\n                'stop-color': color,\n                'stop-opacity': Number.isFinite(opacity) ? opacity : 1\n            });\n        });\n        const gradientVEl = V(type, attrs, stopVEls);\n        gradientVEl.id = id;\n        gradientVEl.appendTo(defs);\n        return id;\n    },\n\n    definePattern: function(pattern) {\n        if (!isObject(pattern)) {\n            throw new TypeError('dia.Paper: definePattern() requires 1. argument to be an object.');\n        }\n        const { svg, defs } = this;\n        const {\n            // Generate a hash code from the stringified filter definition. This gives us\n            // a unique filter ID for different definitions.\n            id = svg.id + hashCode(JSON.stringify(pattern)),\n            markup,\n            attrs = {}\n        } = pattern;\n        if (!markup) {\n            throw new TypeError('dia.Paper: definePattern() requires markup.');\n        }\n        // If the gradient already exists in the document,\n        // we're done and we can just use it (reference it using `url()`).\n        if (this.isDefined(id)) return id;\n        // If not, create one.\n        const patternVEl = V('pattern', {\n            patternUnits: 'userSpaceOnUse'\n        });\n        patternVEl.id = id;\n        patternVEl.attr(attrs);\n        if (typeof markup === 'string') {\n            patternVEl.append(V(markup));\n        } else {\n            const { fragment } = parseDOMJSON(markup);\n            patternVEl.append(fragment);\n        }\n        patternVEl.appendTo(defs);\n        return id;\n    },\n\n    defineMarker: function(marker) {\n        if (!isObject(marker)) {\n            throw new TypeError('dia.Paper: defineMarker() requires the first argument to be an object.');\n        }\n        const { svg, defs } = this;\n        const {\n            // Generate a hash code from the stringified filter definition. This gives us\n            // a unique filter ID for different definitions.\n            id = svg.id + hashCode(JSON.stringify(marker)),\n            // user-provided markup\n            // (e.g. defined when creating link via `attrs/line/sourceMarker/markup`)\n            markup,\n            // user-provided attributes\n            // (e.g. defined when creating link via `attrs/line/sourceMarker/attrs`)\n            // note: `transform` attrs are ignored by browsers\n            attrs = {},\n            // deprecated - use `attrs/markerUnits` instead (which has higher priority)\n            markerUnits = 'userSpaceOnUse'\n        } = marker;\n        // If the marker already exists in the document,\n        // we're done and we can just use it (reference it using `url()`).\n        if (this.isDefined(id)) return id;\n        // If not, create one.\n        const markerVEl = V('marker', {\n            orient: 'auto',\n            overflow: 'visible',\n            markerUnits: markerUnits\n        });\n        markerVEl.id = id;\n        markerVEl.attr(attrs);\n        let markerContentVEl;\n        if (markup) {\n            let markupVEl;\n            if (typeof markup === 'string') {\n                // Marker object has a `markup` property of type string.\n                // - Construct V from the provided string.\n                markupVEl = V(markup);\n                // `markupVEl` is now either a single VEl, or an array of VEls.\n                // - Coerce it to an array.\n                markupVEl = (Array.isArray(markupVEl) ? markupVEl : [markupVEl]);\n            } else {\n                // Marker object has a `markup` property of type object.\n                // - Construct V from the object by parsing it as DOM JSON.\n                const { fragment } = parseDOMJSON(markup);\n                markupVEl = V(fragment).children();\n            }\n            // `markupVEl` is an array with one or more VEls inside.\n            // - If there are multiple VEls, wrap them in a newly-constructed <g> element\n            if (markupVEl.length > 1) {\n                markerContentVEl = V('g').append(markupVEl);\n            } else {\n                markerContentVEl = markupVEl[0];\n            }\n        } else {\n            // Marker object is a flat structure.\n            // - Construct a new V of type `marker.type`.\n            const { type = 'path' } = marker;\n            markerContentVEl = V(type);\n        }\n        // `markerContentVEl` is a single VEl.\n        // Assign additional attributes to it (= context attributes + marker attributes):\n        // - Attribute values are taken from non-special properties of `marker`.\n        const markerAttrs = omit(marker, 'type', 'id', 'markup', 'attrs', 'markerUnits');\n        const markerAttrsKeys = Object.keys(markerAttrs);\n        markerAttrsKeys.forEach((key) => {\n            const value = markerAttrs[key];\n            const markupValue = markerContentVEl.attr(key); // value coming from markupVEl (if any) = higher priority\n            if (markupValue == null) {\n                // Default logic:\n                markerContentVEl.attr(key, value);\n            } else {\n                // Properties with special logic should be added as cases to this switch block:\n                switch(key) {\n                    case 'transform':\n                        // - Prepend `transform` to existing value.\n                        markerContentVEl.attr(key, (value + ' ' + markupValue));\n                        break;\n                }\n            }\n        });\n        markerContentVEl.appendTo(markerVEl);\n        markerVEl.appendTo(defs);\n        return id;\n    }\n\n}, {\n\n    sorting: sortingTypes,\n\n    Layers: LayersNames,\n\n    backgroundPatterns: {\n\n        flipXy: function(img) {\n            // d b\n            // q p\n\n            var canvas = document.createElement('canvas');\n            var imgWidth = img.width;\n            var imgHeight = img.height;\n\n            canvas.width = 2 * imgWidth;\n            canvas.height = 2 * imgHeight;\n\n            var ctx = canvas.getContext('2d');\n            // top-left image\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n            // xy-flipped bottom-right image\n            ctx.setTransform(-1, 0, 0, -1, canvas.width, canvas.height);\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n            // x-flipped top-right image\n            ctx.setTransform(-1, 0, 0, 1, canvas.width, 0);\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n            // y-flipped bottom-left image\n            ctx.setTransform(1, 0, 0, -1, 0, canvas.height);\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\n            return canvas;\n        },\n\n        flipX: function(img) {\n            // d b\n            // d b\n\n            var canvas = document.createElement('canvas');\n            var imgWidth = img.width;\n            var imgHeight = img.height;\n\n            canvas.width = imgWidth * 2;\n            canvas.height = imgHeight;\n\n            var ctx = canvas.getContext('2d');\n            // left image\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n            // flipped right image\n            ctx.translate(2 * imgWidth, 0);\n            ctx.scale(-1, 1);\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\n            return canvas;\n        },\n\n        flipY: function(img) {\n            // d d\n            // q q\n\n            var canvas = document.createElement('canvas');\n            var imgWidth = img.width;\n            var imgHeight = img.height;\n\n            canvas.width = imgWidth;\n            canvas.height = imgHeight * 2;\n\n            var ctx = canvas.getContext('2d');\n            // top image\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n            // flipped bottom image\n            ctx.translate(0, 2 * imgHeight);\n            ctx.scale(1, -1);\n            ctx.drawImage(img, 0, 0, imgWidth, imgHeight);\n\n            return canvas;\n        },\n\n        watermark: function(img, opt) {\n            //   d\n            // d\n\n            opt = opt || {};\n\n            var imgWidth = img.width;\n            var imgHeight = img.height;\n\n            var canvas = document.createElement('canvas');\n            canvas.width = imgWidth * 3;\n            canvas.height = imgHeight * 3;\n\n            var ctx = canvas.getContext('2d');\n            var angle = isNumber(opt.watermarkAngle) ? -opt.watermarkAngle : -20;\n            var radians = toRad(angle);\n            var stepX = canvas.width / 4;\n            var stepY = canvas.height / 4;\n\n            for (var i = 0; i < 4; i++) {\n                for (var j = 0; j < 4; j++) {\n                    if ((i + j) % 2 > 0) {\n                        // reset the current transformations\n                        ctx.setTransform(1, 0, 0, 1, (2 * i - 1) * stepX, (2 * j - 1) * stepY);\n                        ctx.rotate(radians);\n                        ctx.drawImage(img, -imgWidth / 2, -imgHeight / 2, imgWidth, imgHeight);\n                    }\n                }\n            }\n\n            return canvas;\n        }\n    },\n\n    gridPatterns: {\n        dot: [{\n            color: '#AAAAAA',\n            thickness: 1,\n            markup: 'rect',\n            update: function(el, opt) {\n                V(el).attr({\n                    width: opt.thickness * opt.sx,\n                    height: opt.thickness * opt.sy,\n                    fill: opt.color\n                });\n            }\n        }],\n        fixedDot: [{\n            color: '#AAAAAA',\n            thickness: 1,\n            markup: 'rect',\n            update: function(el, opt) {\n                var size = opt.sx <= 1 ? opt.thickness * opt.sx : opt.thickness;\n                V(el).attr({ width: size, height: size, fill: opt.color });\n            }\n        }],\n        mesh: [{\n            color: '#AAAAAA',\n            thickness: 1,\n            markup: 'path',\n            update: function(el, opt) {\n\n                var d;\n                var width = opt.width;\n                var height = opt.height;\n                var thickness = opt.thickness;\n\n                if (width - thickness >= 0 && height - thickness >= 0) {\n                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');\n                } else {\n                    d = 'M 0 0 0 0';\n                }\n\n                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });\n            }\n        }],\n        doubleMesh: [{\n            color: '#AAAAAA',\n            thickness: 1,\n            markup: 'path',\n            update: function(el, opt) {\n\n                var d;\n                var width = opt.width;\n                var height = opt.height;\n                var thickness = opt.thickness;\n\n                if (width - thickness >= 0 && height - thickness >= 0) {\n                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');\n                } else {\n                    d = 'M 0 0 0 0';\n                }\n\n                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });\n            }\n        }, {\n            color: '#000000',\n            thickness: 3,\n            scaleFactor: 4,\n            markup: 'path',\n            update: function(el, opt) {\n\n                var d;\n                var width = opt.width;\n                var height = opt.height;\n                var thickness = opt.thickness;\n\n                if (width - thickness >= 0 && height - thickness >= 0) {\n                    d = ['M', width, 0, 'H0 M0 0 V0', height].join(' ');\n                } else {\n                    d = 'M 0 0 0 0';\n                }\n\n                V(el).attr({ 'd': d, stroke: opt.color, 'stroke-width': opt.thickness });\n            }\n        }]\n    }\n});\n\n","import * as mvc from '../mvc/index.mjs';\nimport * as util from '../util/index.mjs';\nimport { CellView } from './CellView.mjs';\nimport { LayersNames } from './PaperLayer.mjs';\nimport { ToolView } from './ToolView.mjs';\n\nexport const ToolsView = mvc.View.extend({\n    tagName: 'g',\n    className: 'tools',\n    svgElement: true,\n    tools: null,\n    isRendered: false,\n    options: {\n        tools: null,\n        relatedView: null,\n        name: null,\n        // layer?: LayersNames.TOOLS\n        // z?: number\n    },\n\n    configure: function(options) {\n        options = util.assign(this.options, options);\n        var tools = options.tools;\n        if (!Array.isArray(tools)) return this;\n        var relatedView = options.relatedView;\n        if (!(relatedView instanceof CellView)) return this;\n        var views = this.tools = [];\n        for (var i = 0, n = tools.length; i < n; i++) {\n            var tool = tools[i];\n            if (!(tool instanceof ToolView)) continue;\n            tool.configure(relatedView, this);\n            this.vel.append(tool.el);\n            views.push(tool);\n        }\n        this.isRendered = false;\n        relatedView.requestUpdate(relatedView.getFlag('TOOLS'));\n        return this;\n    },\n\n    getName: function() {\n        return this.options.name;\n    },\n\n    update: function(opt) {\n\n        opt || (opt = {});\n        var tools = this.tools;\n        if (!tools) return this;\n        var isRendered = this.isRendered;\n        for (var i = 0, n = tools.length; i < n; i++) {\n            var tool = tools[i];\n            if (!isRendered) {\n                // First update executes render()\n                tool.render();\n            } else if (opt.tool !== tool.cid && tool.isVisible()) {\n                tool.update();\n            }\n        }\n        if (!this.isMounted()) {\n            this.mount();\n        }\n        if (!isRendered) {\n            // Make sure tools are visible (if they were hidden and the tool removed)\n            this.blurTool();\n            this.isRendered = true;\n        }\n        return this;\n    },\n\n    focusTool: function(focusedTool) {\n\n        var tools = this.tools;\n        if (!tools) return this;\n        for (var i = 0, n = tools.length; i < n; i++) {\n            var tool = tools[i];\n            if (focusedTool === tool) {\n                tool.show();\n            } else {\n                tool.hide();\n            }\n        }\n        return this;\n    },\n\n    blurTool: function(blurredTool) {\n        var tools = this.tools;\n        if (!tools) return this;\n        for (var i = 0, n = tools.length; i < n; i++) {\n            var tool = tools[i];\n            if (tool !== blurredTool && !tool.isVisible()) {\n                tool.show();\n                tool.update();\n            }\n        }\n        return this;\n    },\n\n    hide: function() {\n        return this.focusTool(null);\n    },\n\n    show: function() {\n        return this.blurTool(null);\n    },\n\n    onRemove: function() {\n        var tools = this.tools;\n        if (!tools) return this;\n        for (var i = 0, n = tools.length; i < n; i++) {\n            tools[i].remove();\n        }\n        this.tools = null;\n    },\n\n    mount: function() {\n        const { options, el } = this;\n        const { relatedView, layer = LayersNames.TOOLS, z } = options;\n        if (relatedView) {\n            if (layer) {\n                relatedView.paper.getLayerView(layer).insertSortedNode(el, z);\n            } else {\n                relatedView.el.appendChild(el);\n            }\n        }\n        return this;\n    }\n\n});\n","export const env = {\n\n    _results: {},\n\n    _tests: {\n\n        svgforeignobject: function() {\n            return !!document.createElementNS &&\n                /SVGForeignObject/.test(({}).toString.call(document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject')));\n        }\n    },\n\n    addTest: function(name, fn) {\n\n        return this._tests[name] = fn;\n    },\n\n    test: function(name) {\n\n        var fn = this._tests[name];\n\n        if (!fn) {\n            throw new Error('Test not defined (\"' + name + '\"). Use `joint.env.addTest(name, fn) to add a new test.`');\n        }\n\n        var result = this._results[name];\n\n        if (typeof result !== 'undefined') {\n            return result;\n        }\n\n        try {\n            result = fn();\n        } catch (error) {\n            result = false;\n        }\n\n        // Cache the test result.\n        this._results[name] = result;\n\n        return result;\n    }\n};\n","import { Element } from '../dia/Element.mjs';\nimport { ElementView } from '../dia/ElementView.mjs';\nimport { omit, assign, sanitizeHTML, merge, has, breakText, setByPath } from '../util/index.mjs';\nimport { env } from '../env/index.mjs';\n\nexport const Generic = Element.define('basic.Generic', {\n    attrs: {\n        '.': { fill: '#ffffff', stroke: 'none' }\n    }\n});\n\nexport const Rect = Generic.define('basic.Rect', {\n    attrs: {\n        'rect': {\n            fill: '#ffffff',\n            stroke: '#000000',\n            width: 100,\n            height: 60\n        },\n        'text': {\n            fill: '#000000',\n            text: '',\n            'font-size': 14,\n            'ref-x': .5,\n            'ref-y': .5,\n            'text-anchor': 'middle',\n            'y-alignment': 'middle',\n            'font-family': 'Arial, helvetica, sans-serif'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect/></g><text/></g>'\n});\n\nexport const TextView = ElementView.extend({\n\n    presentationAttributes: ElementView.addPresentationAttributes({\n        // The element view is not automatically re-scaled to fit the model size\n        // when the attribute 'attrs' is changed.\n        attrs: ['SCALE']\n    }),\n\n    confirmUpdate: function() {\n        var flags = ElementView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'SCALE')) {\n            this.resize();\n            flags = this.removeFlag(flags, 'SCALE');\n        }\n        return flags;\n    }\n});\n\nexport const Text = Generic.define('basic.Text', {\n    attrs: {\n        'text': {\n            'font-size': 18,\n            fill: '#000000'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><text/></g></g>',\n});\n\nexport const Circle = Generic.define('basic.Circle', {\n    size: { width: 60, height: 60 },\n    attrs: {\n        'circle': {\n            fill: '#ffffff',\n            stroke: '#000000',\n            r: 30,\n            cx: 30,\n            cy: 30\n        },\n        'text': {\n            'font-size': 14,\n            text: '',\n            'text-anchor': 'middle',\n            'ref-x': .5,\n            'ref-y': .5,\n            'y-alignment': 'middle',\n            fill: '#000000',\n            'font-family': 'Arial, helvetica, sans-serif'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle/></g><text/></g>',\n});\n\nexport const Ellipse = Generic.define('basic.Ellipse', {\n    size: { width: 60, height: 40 },\n    attrs: {\n        'ellipse': {\n            fill: '#ffffff',\n            stroke: '#000000',\n            rx: 30,\n            ry: 20,\n            cx: 30,\n            cy: 20\n        },\n        'text': {\n            'font-size': 14,\n            text: '',\n            'text-anchor': 'middle',\n            'ref-x': .5,\n            'ref-y': .5,\n            'y-alignment': 'middle',\n            fill: '#000000',\n            'font-family': 'Arial, helvetica, sans-serif'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><ellipse/></g><text/></g>',\n});\n\nexport const Polygon = Generic.define('basic.Polygon', {\n    size: { width: 60, height: 40 },\n    attrs: {\n        'polygon': {\n            fill: '#ffffff',\n            stroke: '#000000'\n        },\n        'text': {\n            'font-size': 14,\n            text: '',\n            'text-anchor': 'middle',\n            'ref-x': .5,\n            'ref-dy': 20,\n            'y-alignment': 'middle',\n            fill: '#000000',\n            'font-family': 'Arial, helvetica, sans-serif'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polygon/></g><text/></g>',\n});\n\nexport const Polyline = Generic.define('basic.Polyline', {\n    size: { width: 60, height: 40 },\n    attrs: {\n        'polyline': {\n            fill: '#ffffff',\n            stroke: '#000000'\n        },\n        'text': {\n            'font-size': 14,\n            text: '',\n            'text-anchor': 'middle',\n            'ref-x': .5,\n            'ref-dy': 20,\n            'y-alignment': 'middle',\n            fill: '#000000',\n            'font-family': 'Arial, helvetica, sans-serif'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polyline/></g><text/></g>',\n});\n\nexport const Image = Generic.define('basic.Image', {\n    attrs: {\n        'text': {\n            'font-size': 14,\n            text: '',\n            'text-anchor': 'middle',\n            'ref-x': .5,\n            'ref-dy': 20,\n            'y-alignment': 'middle',\n            fill: '#000000',\n            'font-family': 'Arial, helvetica, sans-serif'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><image/></g><text/></g>',\n});\n\nexport const Path = Generic.define('basic.Path', {\n    size: { width: 60, height: 60 },\n    attrs: {\n        'path': {\n            fill: '#ffffff',\n            stroke: '#000000'\n        },\n        'text': {\n            'font-size': 14,\n            text: '',\n            'text-anchor': 'middle',\n            'ref': 'path',\n            'ref-x': .5,\n            'ref-dy': 10,\n            fill: '#000000',\n            'font-family': 'Arial, helvetica, sans-serif'\n        }\n    }\n\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><path/></g><text/></g>',\n});\n\nexport const Rhombus = Path.define('basic.Rhombus', {\n    attrs: {\n        'path': {\n            d: 'M 30 0 L 60 30 30 60 0 30 z'\n        },\n        'text': {\n            'ref-y': .5,\n            'ref-dy': null,\n            'y-alignment': 'middle'\n        }\n    }\n});\n\nconst svgForeignObjectSupported = env.test('svgforeignobject');\n\nexport const TextBlock = Generic.define('basic.TextBlock', {\n    // see joint.css for more element styles\n    attrs: {\n        rect: {\n            fill: '#ffffff',\n            stroke: '#000000',\n            width: 80,\n            height: 100\n        },\n        text: {\n            fill: '#000000',\n            'font-size': 14,\n            'font-family': 'Arial, helvetica, sans-serif'\n        },\n        '.content': {\n            text: '',\n            'ref-x': .5,\n            'ref-y': .5,\n            'y-alignment': 'middle',\n            'x-alignment': 'middle'\n        }\n    },\n\n    content: ''\n}, {\n    markup: [\n        '<g class=\"rotatable\">',\n        '<g class=\"scalable\"><rect/></g>',\n        svgForeignObjectSupported\n            ? '<foreignObject class=\"fobj\"><body xmlns=\"http://www.w3.org/1999/xhtml\"><div class=\"content\"/></body></foreignObject>'\n            : '<text class=\"content\"/>',\n        '</g>'\n    ].join(''),\n\n    initialize: function() {\n\n        this.listenTo(this, 'change:size', this.updateSize);\n        this.listenTo(this, 'change:content', this.updateContent);\n        this.updateSize(this, this.get('size'));\n        this.updateContent(this, this.get('content'));\n        Generic.prototype.initialize.apply(this, arguments);\n    },\n\n    updateSize: function(cell, size) {\n\n        // Selector `foreignObject' doesn't work across all browsers, we're using class selector instead.\n        // We have to clone size as we don't want attributes.div.style to be same object as attributes.size.\n        this.attr({\n            '.fobj': assign({}, size),\n            div: {\n                style: assign({}, size)\n            }\n        });\n    },\n\n    updateContent: function(cell, content) {\n\n        if (svgForeignObjectSupported) {\n\n            // Content element is a <div> element.\n            this.attr({\n                '.content': {\n                    html: sanitizeHTML(content)\n                }\n            });\n\n        } else {\n\n            // Content element is a <text> element.\n            // SVG elements don't have innerHTML attribute.\n            this.attr({\n                '.content': {\n                    text: content\n                }\n            });\n        }\n    },\n\n    // Here for backwards compatibility:\n    setForeignObjectSize: function() {\n\n        this.updateSize.apply(this, arguments);\n    },\n\n    // Here for backwards compatibility:\n    setDivContent: function() {\n\n        this.updateContent.apply(this, arguments);\n    }\n});\n\n// TextBlockView implements the fallback for IE when no foreignObject exists and\n// the text needs to be manually broken.\nexport const TextBlockView = ElementView.extend({\n\n    presentationAttributes: svgForeignObjectSupported\n        ? ElementView.prototype.presentationAttributes\n        : ElementView.addPresentationAttributes({\n            content: ['CONTENT'],\n            size: ['CONTENT']\n        }),\n\n    initFlag: ['RENDER', 'CONTENT'],\n\n    confirmUpdate: function() {\n        var flags = ElementView.prototype.confirmUpdate.apply(this, arguments);\n        if (this.hasFlag(flags, 'CONTENT')) {\n            this.updateContent(this.model);\n            flags = this.removeFlag(flags, 'CONTENT');\n        }\n        return flags;\n    },\n\n    update: function(_, renderingOnlyAttrs) {\n\n        var model = this.model;\n\n        if (!svgForeignObjectSupported) {\n\n            // Update everything but the content first.\n            var noTextAttrs = omit(renderingOnlyAttrs || model.get('attrs'), '.content');\n            ElementView.prototype.update.call(this, model, noTextAttrs);\n\n            if (!renderingOnlyAttrs || has(renderingOnlyAttrs, '.content')) {\n                // Update the content itself.\n                this.updateContent(model, renderingOnlyAttrs);\n            }\n\n        } else {\n\n            ElementView.prototype.update.call(this, model, renderingOnlyAttrs);\n        }\n    },\n\n    updateContent: function(cell, renderingOnlyAttrs) {\n\n        // Create copy of the text attributes\n        var textAttrs = merge({}, (renderingOnlyAttrs || cell.get('attrs'))['.content']);\n\n        textAttrs = omit(textAttrs, 'text');\n\n        // Break the content to fit the element size taking into account the attributes\n        // set on the model.\n        var text = breakText(cell.get('content'), cell.get('size'), textAttrs, {\n            // measuring sandbox svg document\n            svgDocument: this.paper.svg\n        });\n\n        // Create a new attrs with same structure as the model attrs { text: { *textAttributes* }}\n        var attrs = setByPath({}, '.content', textAttrs, '/');\n\n        // Replace text attribute with the one we just processed.\n        attrs['.content'].text = text;\n\n        // Update the view using renderingOnlyAttributes parameter.\n        ElementView.prototype.update.call(this, cell, attrs);\n    }\n});\n","import V from '../V/index.mjs';\nimport { Element } from '../dia/Element.mjs';\nimport { Link as LinkBase } from '../dia/Link.mjs';\nimport { isPercentage, assign } from '../util/index.mjs';\nimport { attributes } from '../dia/attributes/index.mjs';\nimport { env } from '../env/index.mjs';\n\n\n// ELEMENTS\n\nexport const Rectangle = Element.define('standard.Rectangle', {\n    attrs: {\n        body: {\n            refWidth: '100%',\n            refHeight: '100%',\n            strokeWidth: 2,\n            stroke: '#000000',\n            fill: '#FFFFFF'\n        },\n        label: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '50%',\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'rect',\n        selector: 'body',\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const Circle = Element.define('standard.Circle', {\n    attrs: {\n        body: {\n            refCx: '50%',\n            refCy: '50%',\n            refR: '50%',\n            strokeWidth: 2,\n            stroke: '#333333',\n            fill: '#FFFFFF'\n        },\n        label: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '50%',\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'circle',\n        selector: 'body'\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const Ellipse = Element.define('standard.Ellipse', {\n    attrs: {\n        body: {\n            refCx: '50%',\n            refCy: '50%',\n            refRx: '50%',\n            refRy: '50%',\n            strokeWidth: 2,\n            stroke: '#333333',\n            fill: '#FFFFFF'\n        },\n        label: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '50%',\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'ellipse',\n        selector: 'body'\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const Path = Element.define('standard.Path', {\n    attrs: {\n        body: {\n            refD: 'M 0 0 L 10 0 10 10 0 10 Z',\n            strokeWidth: 2,\n            stroke: '#333333',\n            fill: '#FFFFFF'\n        },\n        label: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '50%',\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'path',\n        selector: 'body'\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const Polygon = Element.define('standard.Polygon', {\n    attrs: {\n        body: {\n            refPoints: '0 0 10 0 10 10 0 10',\n            strokeWidth: 2,\n            stroke: '#333333',\n            fill: '#FFFFFF'\n        },\n        label: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '50%',\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'polygon',\n        selector: 'body'\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const Polyline = Element.define('standard.Polyline', {\n    attrs: {\n        body: {\n            refPoints: '0 0 10 0 10 10 0 10 0 0',\n            strokeWidth: 2,\n            stroke: '#333333',\n            fill: '#FFFFFF'\n        },\n        label: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '50%',\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'polyline',\n        selector: 'body'\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const Image = Element.define('standard.Image', {\n    attrs: {\n        image: {\n            refWidth: '100%',\n            refHeight: '100%',\n            // xlinkHref: '[URL]'\n        },\n        label: {\n            textVerticalAnchor: 'top',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '100%',\n            refY2: 10,\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'image',\n        selector: 'image'\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const BorderedImage = Element.define('standard.BorderedImage', {\n    attrs: {\n        border: {\n            refWidth: '100%',\n            refHeight: '100%',\n            stroke: '#333333',\n            strokeWidth: 2\n        },\n        background: {\n            refWidth: -1,\n            refHeight: -1,\n            x: 0.5,\n            y: 0.5,\n            fill: '#FFFFFF'\n        },\n        image: {\n            // xlinkHref: '[URL]'\n            refWidth: -1,\n            refHeight: -1,\n            x: 0.5,\n            y: 0.5\n        },\n        label: {\n            textVerticalAnchor: 'top',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '100%',\n            refY2: 10,\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'rect',\n        selector: 'background',\n        attributes: {\n            'stroke': 'none'\n        }\n    }, {\n        tagName: 'image',\n        selector: 'image'\n    }, {\n        tagName: 'rect',\n        selector: 'border',\n        attributes: {\n            'fill': 'none'\n        }\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const EmbeddedImage = Element.define('standard.EmbeddedImage', {\n    attrs: {\n        body: {\n            refWidth: '100%',\n            refHeight: '100%',\n            stroke: '#333333',\n            fill: '#FFFFFF',\n            strokeWidth: 2\n        },\n        image: {\n            // xlinkHref: '[URL]'\n            refWidth: '30%',\n            refHeight: -20,\n            x: 10,\n            y: 10,\n            preserveAspectRatio: 'xMidYMin'\n        },\n        label: {\n            textVerticalAnchor: 'top',\n            textAnchor: 'left',\n            refX: '30%',\n            refX2: 20, // 10 + 10\n            refY: 10,\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'rect',\n        selector: 'body'\n    }, {\n        tagName: 'image',\n        selector: 'image'\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const InscribedImage = Element.define('standard.InscribedImage', {\n    attrs: {\n        border: {\n            refRx: '50%',\n            refRy: '50%',\n            refCx: '50%',\n            refCy: '50%',\n            stroke: '#333333',\n            strokeWidth: 2\n        },\n        background: {\n            refRx: '50%',\n            refRy: '50%',\n            refCx: '50%',\n            refCy: '50%',\n            fill: '#FFFFFF'\n        },\n        image: {\n            // The image corners touch the border when its size is Math.sqrt(2) / 2 = 0.707.. ~= 70%\n            refWidth: '68%',\n            refHeight: '68%',\n            // The image offset is calculated as (100% - 68%) / 2\n            refX: '16%',\n            refY: '16%',\n            preserveAspectRatio: 'xMidYMid'\n            // xlinkHref: '[URL]'\n        },\n        label: {\n            textVerticalAnchor: 'top',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '100%',\n            refY2: 10,\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'ellipse',\n        selector: 'background'\n    }, {\n        tagName: 'image',\n        selector: 'image'\n    }, {\n        tagName: 'ellipse',\n        selector: 'border',\n        attributes: {\n            'fill': 'none'\n        }\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }]\n});\n\nexport const HeaderedRectangle = Element.define('standard.HeaderedRectangle', {\n    attrs: {\n        body: {\n            refWidth: '100%',\n            refHeight: '100%',\n            strokeWidth: 2,\n            stroke: '#000000',\n            fill: '#FFFFFF'\n        },\n        header: {\n            refWidth: '100%',\n            height: 30,\n            strokeWidth: 2,\n            stroke: '#000000',\n            fill: '#FFFFFF'\n        },\n        headerText: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: 15,\n            fontSize: 16,\n            fill: '#333333'\n        },\n        bodyText: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '50%',\n            refY2: 15,\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'rect',\n        selector: 'body'\n    }, {\n        tagName: 'rect',\n        selector: 'header'\n    }, {\n        tagName: 'text',\n        selector: 'headerText'\n    }, {\n        tagName: 'text',\n        selector: 'bodyText'\n    }]\n});\n\nvar CYLINDER_TILT = 10;\n\nexport const Cylinder = Element.define('standard.Cylinder', {\n    attrs: {\n        body: {\n            lateralArea: CYLINDER_TILT,\n            fill: '#FFFFFF',\n            stroke: '#333333',\n            strokeWidth: 2\n        },\n        top: {\n            refCx: '50%',\n            cy: CYLINDER_TILT,\n            refRx: '50%',\n            ry: CYLINDER_TILT,\n            fill: '#FFFFFF',\n            stroke: '#333333',\n            strokeWidth: 2\n        },\n        label: {\n            textVerticalAnchor: 'middle',\n            textAnchor: 'middle',\n            refX: '50%',\n            refY: '100%',\n            refY2: 15,\n            fontSize: 14,\n            fill: '#333333'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'path',\n        selector: 'body'\n    }, {\n        tagName: 'ellipse',\n        selector: 'top'\n    }, {\n        tagName: 'text',\n        selector: 'label'\n    }],\n\n    topRy: function(t, opt) {\n        // getter\n        if (t === undefined) return this.attr('body/lateralArea');\n\n        // setter\n        var isPercentageSetter = isPercentage(t);\n\n        var bodyAttrs = { lateralArea: t };\n        var topAttrs = isPercentageSetter\n            ? { refCy: t, refRy: t, cy: null, ry: null }\n            : { refCy: null, refRy: null, cy: t, ry: t };\n\n        return this.attr({ body: bodyAttrs, top: topAttrs }, opt);\n    }\n\n}, {\n    attributes: {\n        lateralArea: {\n            set: function(t, refBBox) {\n                var isPercentageSetter = isPercentage(t);\n                if (isPercentageSetter) t = parseFloat(t) / 100;\n\n                var x = refBBox.x;\n                var y = refBBox.y;\n                var w = refBBox.width;\n                var h = refBBox.height;\n\n                // curve control point variables\n                var rx = w / 2;\n                var ry = isPercentageSetter ? (h * t) : t;\n\n                var kappa = V.KAPPA;\n                var cx = kappa * rx;\n                var cy = kappa * (isPercentageSetter ? (h * t) : t);\n\n                // shape variables\n                var xLeft = x;\n                var xCenter = x + (w / 2);\n                var xRight = x + w;\n\n                var ySideTop = y + ry;\n                var yCurveTop = ySideTop - ry;\n                var ySideBottom = y + h - ry;\n                var yCurveBottom = y + h;\n\n                // return calculated shape\n                var data = [\n                    'M', xLeft, ySideTop,\n                    'L', xLeft, ySideBottom,\n                    'C', x, (ySideBottom + cy), (xCenter - cx), yCurveBottom, xCenter, yCurveBottom,\n                    'C', (xCenter + cx), yCurveBottom, xRight, (ySideBottom + cy), xRight, ySideBottom,\n                    'L', xRight, ySideTop,\n                    'C', xRight, (ySideTop - cy), (xCenter + cx), yCurveTop, xCenter, yCurveTop,\n                    'C', (xCenter - cx), yCurveTop, xLeft, (ySideTop - cy), xLeft, ySideTop,\n                    'Z'\n                ];\n                return { d: data.join(' ') };\n            }\n        }\n    }\n});\n\nvar foLabelMarkup = {\n    tagName: 'foreignObject',\n    selector: 'foreignObject',\n    attributes: {\n        'overflow': 'hidden'\n    },\n    children: [{\n        tagName: 'div',\n        namespaceURI: 'http://www.w3.org/1999/xhtml',\n        selector: 'label',\n        style: {\n            width: '100%',\n            height: '100%',\n            position: 'static',\n            backgroundColor: 'transparent',\n            textAlign: 'center',\n            margin: 0,\n            padding: '0px 5px',\n            boxSizing: 'border-box',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center'\n        }\n    }]\n};\n\nvar svgLabelMarkup = {\n    tagName: 'text',\n    selector: 'label',\n    attributes: {\n        'text-anchor': 'middle'\n    }\n};\n\nvar labelMarkup = (env.test('svgforeignobject')) ? foLabelMarkup : svgLabelMarkup;\n\nexport const TextBlock = Element.define('standard.TextBlock', {\n    attrs: {\n        body: {\n            refWidth: '100%',\n            refHeight: '100%',\n            stroke: '#333333',\n            fill: '#ffffff',\n            strokeWidth: 2\n        },\n        foreignObject: {\n            refWidth: '100%',\n            refHeight: '100%'\n        },\n        label: {\n            style: {\n                fontSize: 14\n            }\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'rect',\n        selector: 'body'\n    }, labelMarkup]\n}, {\n    attributes: {\n        text: {\n            set: function(text, refBBox, node, attrs) {\n                if (node instanceof HTMLElement) {\n                    node.textContent = text;\n                } else {\n                    // No foreign object\n                    var style = attrs.style || {};\n                    var wrapValue = { text: text, width: -5, height: '100%' };\n                    var wrapAttrs = assign({ textVerticalAnchor: 'middle' }, style);\n                    attributes.textWrap.set.call(this, wrapValue, refBBox, node, wrapAttrs);\n                    return { fill: style.color || null };\n                }\n            },\n            position: function(text, refBBox, node) {\n                // No foreign object\n                if (node instanceof SVGElement) return refBBox.center();\n            }\n        }\n    }\n});\n\n// LINKS\n\nexport const Link = LinkBase.define('standard.Link', {\n    attrs: {\n        line: {\n            connection: true,\n            stroke: '#333333',\n            strokeWidth: 2,\n            strokeLinejoin: 'round',\n            targetMarker: {\n                'type': 'path',\n                'd': 'M 10 -5 0 0 10 5 z'\n            }\n        },\n        wrapper: {\n            connection: true,\n            strokeWidth: 10,\n            strokeLinejoin: 'round'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'path',\n        selector: 'wrapper',\n        attributes: {\n            'fill': 'none',\n            'cursor': 'pointer',\n            'stroke': 'transparent',\n            'stroke-linecap': 'round'\n        }\n    }, {\n        tagName: 'path',\n        selector: 'line',\n        attributes: {\n            'fill': 'none',\n            'pointer-events': 'none'\n        }\n    }]\n});\n\nexport const DoubleLink = LinkBase.define('standard.DoubleLink', {\n    attrs: {\n        line: {\n            connection: true,\n            stroke: '#DDDDDD',\n            strokeWidth: 4,\n            strokeLinejoin: 'round',\n            targetMarker: {\n                type: 'path',\n                stroke: '#000000',\n                d: 'M 10 -3 10 -10 -2 0 10 10 10 3'\n            }\n        },\n        outline: {\n            connection: true,\n            stroke: '#000000',\n            strokeWidth: 6,\n            strokeLinejoin: 'round'\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'path',\n        selector: 'outline',\n        attributes: {\n            'fill': 'none'\n        }\n    }, {\n        tagName: 'path',\n        selector: 'line',\n        attributes: {\n            'fill': 'none'\n        }\n    }]\n});\n\nexport const ShadowLink = LinkBase.define('standard.ShadowLink', {\n    attrs: {\n        line: {\n            connection: true,\n            stroke: '#FF0000',\n            strokeWidth: 20,\n            strokeLinejoin: 'round',\n            targetMarker: {\n                'type': 'path',\n                'stroke': 'none',\n                'd': 'M 0 -10 -10 0 0 10 z'\n            },\n            sourceMarker: {\n                'type': 'path',\n                'stroke': 'none',\n                'd': 'M -10 -10 0 0 -10 10 0 10 0 -10 z'\n            }\n        },\n        shadow: {\n            connection: true,\n            refX: 3,\n            refY: 6,\n            stroke: '#000000',\n            strokeOpacity: 0.2,\n            strokeWidth: 20,\n            strokeLinejoin: 'round',\n            targetMarker: {\n                'type': 'path',\n                'd': 'M 0 -10 -10 0 0 10 z',\n                'stroke': 'none'\n            },\n            sourceMarker: {\n                'type': 'path',\n                'stroke': 'none',\n                'd': 'M -10 -10 0 0 -10 10 0 10 0 -10 z'\n            }\n        }\n    }\n}, {\n    markup: [{\n        tagName: 'path',\n        selector: 'shadow',\n        attributes: {\n            'fill': 'none'\n        }\n    }, {\n        tagName: 'path',\n        selector: 'line',\n        attributes: {\n            'fill': 'none'\n        }\n    }]\n});\n","import { Generic } from './basic.mjs';\nimport { Link as LinkBase } from '../dia/Link.mjs';\nimport { uniq, difference, assign, toArray, without, isObject } from '../util/index.mjs';\n\n/**\n * @deprecated use the port api instead\n */\nexport const Model = Generic.define('devs.Model', {\n    inPorts: [],\n    outPorts: [],\n    size: {\n        width: 80,\n        height: 80\n    },\n    attrs: {\n        '.': {\n            magnet: false\n        },\n        '.label': {\n            text: 'Model',\n            'ref-x': .5,\n            'ref-y': 10,\n            'font-size': 18,\n            'text-anchor': 'middle',\n            fill: '#000'\n        },\n        '.body': {\n            'ref-width': '100%',\n            'ref-height': '100%',\n            stroke: '#000'\n        }\n    },\n    ports: {\n        groups: {\n            'in': {\n                position: {\n                    name: 'left'\n                },\n                attrs: {\n                    '.port-label': {\n                        fill: '#000'\n                    },\n                    '.port-body': {\n                        fill: '#fff',\n                        stroke: '#000',\n                        r: 10,\n                        magnet: true\n                    }\n                },\n                label: {\n                    position: {\n                        name: 'left',\n                        args: {\n                            y: 10\n                        }\n                    }\n                }\n            },\n            'out': {\n                position: {\n                    name: 'right'\n                },\n                attrs: {\n                    '.port-label': {\n                        fill: '#000'\n                    },\n                    '.port-body': {\n                        fill: '#fff',\n                        stroke: '#000',\n                        r: 10,\n                        magnet: true\n                    }\n                },\n                label: {\n                    position: {\n                        name: 'right',\n                        args: {\n                            y: 10\n                        }\n                    }\n                }\n            }\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><rect class=\"body\"/><text class=\"label\"/></g>',\n    portMarkup: '<circle class=\"port-body\"/>',\n    portLabelMarkup: '<text class=\"port-label\"/>',\n\n    initialize: function() {\n\n        Generic.prototype.initialize.apply(this, arguments);\n\n        this.on('change:inPorts change:outPorts', this.updatePortItems, this);\n        this.updatePortItems();\n    },\n\n    updatePortItems: function(model, changed, opt) {\n\n        // Make sure all ports are unique.\n        var inPorts = uniq(this.get('inPorts'));\n        var outPorts = difference(uniq(this.get('outPorts')), inPorts);\n\n        var inPortItems = this.createPortItems('in', inPorts);\n        var outPortItems = this.createPortItems('out', outPorts);\n\n        this.prop('ports/items', inPortItems.concat(outPortItems), assign({ rewrite: true }, opt));\n    },\n\n    createPortItem: function(group, port) {\n\n        return {\n            id: port,\n            group: group,\n            attrs: {\n                '.port-label': {\n                    text: port\n                }\n            }\n        };\n    },\n\n    createPortItems: function(group, ports) {\n\n        return toArray(ports).map(this.createPortItem.bind(this, group));\n    },\n\n    _addGroupPort: function(port, group, opt) {\n\n        var ports = this.get(group);\n        return this.set(group, Array.isArray(ports) ? ports.concat(port) : [port], opt);\n    },\n\n    addOutPort: function(port, opt) {\n\n        return this._addGroupPort(port, 'outPorts', opt);\n    },\n\n    addInPort: function(port, opt) {\n\n        return this._addGroupPort(port, 'inPorts', opt);\n    },\n\n    _removeGroupPort: function(port, group, opt) {\n\n        return this.set(group, without(this.get(group), port), opt);\n    },\n\n    removeOutPort: function(port, opt) {\n\n        return this._removeGroupPort(port, 'outPorts', opt);\n    },\n\n    removeInPort: function(port, opt) {\n\n        return this._removeGroupPort(port, 'inPorts', opt);\n    },\n\n    _changeGroup: function(group, properties, opt) {\n\n        return this.prop('ports/groups/' + group, isObject(properties) ? properties : {}, opt);\n    },\n\n    changeInGroup: function(properties, opt) {\n\n        return this._changeGroup('in', properties, opt);\n    },\n\n    changeOutGroup: function(properties, opt) {\n\n        return this._changeGroup('out', properties, opt);\n    }\n});\n\nexport const Atomic = Model.define('devs.Atomic', {\n    size: {\n        width: 80,\n        height: 80\n    },\n    attrs: {\n        '.label': {\n            text: 'Atomic'\n        }\n    }\n});\n\nexport const Coupled = Model.define('devs.Coupled', {\n    size: {\n        width: 200,\n        height: 300\n    },\n    attrs: {\n        '.label': {\n            text: 'Coupled'\n        }\n    }\n});\n\nexport const Link = LinkBase.define('devs.Link', {\n    attrs: {\n        '.connection': {\n            'stroke-width': 2\n        }\n    }\n});\n\n","import { Generic } from './basic.mjs';\nimport { Link } from '../dia/Link.mjs';\n\nexport const Gate = Generic.define('logic.Gate', {\n    size: { width: 80, height: 40 },\n    attrs: {\n        '.': { magnet: false },\n        '.body': { width: 100, height: 50 },\n        circle: { r: 7, stroke: 'black', fill: 'transparent', 'stroke-width': 2 }\n    }\n}, {\n    operation: function() {\n        return true;\n    }\n});\n\nexport const IO = Gate.define('logic.IO', {\n    size: { width: 60, height: 30 },\n    attrs: {\n        '.body': { fill: 'white', stroke: 'black', 'stroke-width': 2 },\n        '.wire': { ref: '.body', 'ref-y': .5, stroke: 'black' },\n        text: {\n            fill: 'black',\n            ref: '.body', 'ref-x': .5, 'ref-y': .5, 'y-alignment': 'middle',\n            'text-anchor': 'middle',\n            'font-weight': 'bold',\n            'font-variant': 'small-caps',\n            'text-transform': 'capitalize',\n            'font-size': '14px'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"body\"/></g><path class=\"wire\"/><circle/><text/></g>',\n});\n\nexport const Input = IO.define('logic.Input', {\n    attrs: {\n        '.wire': { 'ref-dx': 0, d: 'M 0 0 L 23 0' },\n        circle: { ref: '.body', 'ref-dx': 30, 'ref-y': 0.5, magnet: true, 'class': 'output', port: 'out' },\n        text: { text: 'input' }\n    }\n});\n\nexport const Output = IO.define('logic.Output', {\n    attrs: {\n        '.wire': { 'ref-x': 0, d: 'M 0 0 L -23 0' },\n        circle: { ref: '.body', 'ref-x': -30, 'ref-y': 0.5, magnet: 'passive', 'class': 'input', port: 'in' },\n        text: { text: 'output' }\n    }\n});\n\nexport const Gate11 = Gate.define('logic.Gate11', {\n    attrs: {\n        '.input': { ref: '.body', 'ref-x': -2, 'ref-y': 0.5, magnet: 'passive', port: 'in' },\n        '.output': { ref: '.body', 'ref-dx': 2, 'ref-y': 0.5, magnet: true, port: 'out' }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><image class=\"body\"/></g><circle class=\"input\"/><circle class=\"output\"/></g>',\n});\n\nexport const Gate21 = Gate.define('logic.Gate21', {\n    attrs: {\n        '.input1': { ref: '.body', 'ref-x': -2, 'ref-y': 0.3, magnet: 'passive', port: 'in1' },\n        '.input2': { ref: '.body', 'ref-x': -2, 'ref-y': 0.7, magnet: 'passive', port: 'in2' },\n        '.output': { ref: '.body', 'ref-dx': 2, 'ref-y': 0.5, magnet: true, port: 'out' }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><image class=\"body\"/></g><circle class=\"input input1\"/><circle  class=\"input input2\"/><circle class=\"output\"/></g>',\n});\n\nexport const Repeater = Gate11.define('logic.Repeater', {\n    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzIuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICA8L2c+Cjwvc3ZnPgo=' }}\n}, {\n    operation: function(input) {\n        return input;\n    }\n});\n\nexport const Not = Gate11.define('logic.Not', {\n    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PVCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjgiCiAgICAgaW5rc2NhcGU6Y3g9Ijg0LjY4NTM1MiIKICAgICBpbmtzY2FwZTpjeT0iMTUuMjg4NjI4IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzkuMTU2OTEsMjUgTCA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAyOS4wNDM0NzgsMjUgTCA1LjA0MzQ3ODEsMjUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgZD0iTSAyOC45Njg3NSwyLjU5Mzc1IEwgMjguOTY4NzUsNSBMIDI4Ljk2ODc1LDQ1IEwgMjguOTY4NzUsNDcuNDA2MjUgTCAzMS4xMjUsNDYuMzQzNzUgTCA3Mi4xNTYyNSwyNi4zNDM3NSBMIDcyLjE1NjI1LDIzLjY1NjI1IEwgMzEuMTI1LDMuNjU2MjUgTCAyOC45Njg3NSwyLjU5Mzc1IHogTSAzMS45Njg3NSw3LjQwNjI1IEwgNjguMDkzNzUsMjUgTCAzMS45Njg3NSw0Mi41OTM3NSBMIDMxLjk2ODc1LDcuNDA2MjUgeiIKICAgICAgIGlkPSJwYXRoMjYzOCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2NjY2NjY2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDI2NzEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzYiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA4MCwyNSBBIDQsNCAwIDEgMSA3MiwyNSBBIDQsNCAwIDEgMSA4MCwyNSB6IgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEsMCkiIC8+CiAgPC9nPgo8L3N2Zz4K' }}\n}, {\n    operation: function(input) {\n        return !input;\n    }\n});\n\nexport const Or = Gate21.define('logic.Or', {\n    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik9SIEFOU0kuc3ZnIgogICBpbmtzY2FwZTpvdXRwdXRfZXh0ZW5zaW9uPSJvcmcuaW5rc2NhcGUub3V0cHV0LnN2Zy5pbmtzY2FwZSI+CiAgPGRlZnMKICAgICBpZD0iZGVmczQiPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTAgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjcxNCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iMSA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMC41IDogMC4zMzMzMzMzMyA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODA2IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyODE5IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjM3Mi4wNDcyNCA6IDM1MC43ODczOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzc3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49Ijc1IDogNDAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTUwIDogNjAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDYwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMyNzUiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNTAgOiAzMy4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iMTAwIDogNTAgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDUwIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTU1MzMiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzIgOiAyMS4zMzMzMzMgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNjQgOiAzMiA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMzIgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjU1NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDE2LjY2NjY2NyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDI1IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAyNSA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iNCIKICAgICBpbmtzY2FwZTpjeD0iMTEzLjAwMDM5IgogICAgIGlua3NjYXBlOmN5PSIxMi44OTM3MzEiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9InB4IgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImcyNTYwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTpncmlkLWJib3g9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1wb2ludHM9InRydWUiCiAgICAgZ3JpZHRvbGVyYW5jZT0iMTAwMDAiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzk5IgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg3NCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMzciCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii00IgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gNzAsMjUgYyAyMCwwIDI1LDAgMjUsMCIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMSwxNSA1LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzIsMzUgNSwzNSIKICAgICAgIGlkPSJwYXRoMzk0NCIgLz4KICAgIDxnCiAgICAgICBpZD0iZzI1NjAiCiAgICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2LjUsLTM5LjUpIj4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICA8L2c+Cjwvc3ZnPgo=' }}\n}, {\n    operation: function(input1, input2) {\n        return input1 || input2;\n    }\n});\n\nexport const And = Gate21.define('logic.And', {\n    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IkFORCBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI4IgogICAgIGlua3NjYXBlOmN4PSI1Ni42OTgzNDgiCiAgICAgaW5rc2NhcGU6Y3k9IjI1LjMyNjg5OSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZvbnQtc2l6ZTptZWRpdW07Zm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDt0ZXh0LWluZGVudDowO3RleHQtYWxpZ246c3RhcnQ7dGV4dC1kZWNvcmF0aW9uOm5vbmU7bGluZS1oZWlnaHQ6bm9ybWFsO2xldHRlci1zcGFjaW5nOm5vcm1hbDt3b3JkLXNwYWNpbmc6bm9ybWFsO3RleHQtdHJhbnNmb3JtOm5vbmU7ZGlyZWN0aW9uOmx0cjtibG9jay1wcm9ncmVzc2lvbjp0Yjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDozO21hcmtlcjpub25lO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGU7Zm9udC1mYW1pbHk6Qml0c3RyZWFtIFZlcmEgU2FuczstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOkJpdHN0cmVhbSBWZXJhIFNhbnMiCiAgICAgICBkPSJNIDMwLDUgTCAzMCw2LjQyODU3MTQgTCAzMCw0My41NzE0MjkgTCAzMCw0NSBMIDMxLjQyODU3MSw0NSBMIDUwLjQ3NjE5LDQ1IEMgNjEuNzQ0MDk4LDQ1IDcwLjQ3NjE5LDM1Ljk5OTk1NSA3MC40NzYxOSwyNSBDIDcwLjQ3NjE5LDE0LjAwMDA0NSA2MS43NDQwOTksNS4wMDAwMDAyIDUwLjQ3NjE5LDUgQyA1MC40NzYxOSw1IDUwLjQ3NjE5LDUgMzEuNDI4NTcxLDUgTCAzMCw1IHogTSAzMi44NTcxNDMsNy44NTcxNDI5IEMgNDAuODM0MjY0LDcuODU3MTQyOSA0NS45MTgzNjgsNy44NTcxNDI5IDQ4LjA5NTIzOCw3Ljg1NzE0MjkgQyA0OS4yODU3MTQsNy44NTcxNDI5IDQ5Ljg4MDk1Miw3Ljg1NzE0MjkgNTAuMTc4NTcxLDcuODU3MTQyOSBDIDUwLjMyNzM4MSw3Ljg1NzE0MjkgNTAuNDA5MjI3LDcuODU3MTQyOSA1MC40NDY0MjksNy44NTcxNDI5IEMgNTAuNDY1MDI5LDcuODU3MTQyOSA1MC40NzE1NDMsNy44NTcxNDI5IDUwLjQ3NjE5LDcuODU3MTQyOSBDIDYwLjIzNjg1Myw3Ljg1NzE0MyA2Ny4xNDI4NTcsMTUuNDk3MDk4IDY3LjE0Mjg1NywyNSBDIDY3LjE0Mjg1NywzNC41MDI5MDIgNTkuNzYwNjYyLDQyLjE0Mjg1NyA1MCw0Mi4xNDI4NTcgTCAzMi44NTcxNDMsNDIuMTQyODU3IEwgMzIuODU3MTQzLDcuODU3MTQyOSB6IgogICAgICAgaWQ9InBhdGgyODg0IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2NjY2NzY2NjY3Nzc3NzY2NjIiAvPgogIDwvZz4KPC9zdmc+Cg==' }}\n\n}, {\n    operation: function(input1, input2) {\n        return input1 && input2;\n    }\n});\n\nexport const Nor = Gate21.define('logic.Nor', {\n    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5PUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjEiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjY3NzY0NCIKICAgICBpbmtzY2FwZTpjeT0iMjIuMTAyMzQ0IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjM3IgogICAgIGlua3NjYXBlOndpbmRvdy15PSItNCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc5LDI1IEMgOTksMjUgOTUsMjUgOTUsMjUiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEsMTUgNSwxNSIKICAgICAgIGlkPSJwYXRoMzA2MSIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjk5OTk5OTg4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMyLDM1IDUsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHNvZGlwb2RpOnR5cGU9ImFyYyIKICAgICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWpvaW46bWl0ZXI7bWFya2VyOm5vbmU7c3Ryb2tlLW9wYWNpdHk6MTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlIgogICAgICAgICBpZD0icGF0aDI2MDQiCiAgICAgICAgIHNvZGlwb2RpOmN4PSI3NSIKICAgICAgICAgc29kaXBvZGk6Y3k9IjI1IgogICAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgICAgc29kaXBvZGk6cnk9IjQiCiAgICAgICAgIGQ9Ik0gNzksMjUgQSA0LDQgMCAxIDEgNzEsMjUgQSA0LDQgMCAxIDEgNzksMjUgeiIKICAgICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTI2LjUsMzkuNSkiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K' }}\n}, {\n    operation: function(input1, input2) {\n        return !(input1 || input2);\n    }\n});\n\nexport const Nand = Gate21.define('logic.Nand', {\n    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9Ik5BTkQgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogIDwvZGVmcz4KICA8c29kaXBvZGk6bmFtZWR2aWV3CiAgICAgaWQ9ImJhc2UiCiAgICAgcGFnZWNvbG9yPSIjZmZmZmZmIgogICAgIGJvcmRlcmNvbG9yPSIjNjY2NjY2IgogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMC4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6em9vbT0iMTYiCiAgICAgaW5rc2NhcGU6Y3g9Ijc4LjI4MzMwNyIKICAgICBpbmtzY2FwZTpjeT0iMTYuNDQyODQzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJweCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6Z3JpZC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtcG9pbnRzPSJ0cnVlIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwMDAwIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM5OSIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI4NzQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjMzIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOnNuYXAtYmJveD0idHJ1ZSI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgaWQ9IkdyaWRGcm9tUHJlMDQ2U2V0dGluZ3MiCiAgICAgICB0eXBlPSJ4eWdyaWQiCiAgICAgICBvcmlnaW54PSIwcHgiCiAgICAgICBvcmlnaW55PSIwcHgiCiAgICAgICBzcGFjaW5neD0iMXB4IgogICAgICAgc3BhY2luZ3k9IjFweCIKICAgICAgIGNvbG9yPSIjMDAwMGZmIgogICAgICAgZW1wY29sb3I9IiMwMDAwZmYiCiAgICAgICBvcGFjaXR5PSIwLjIiCiAgICAgICBlbXBvcGFjaXR5PSIwLjQiCiAgICAgICBlbXBzcGFjaW5nPSI1IgogICAgICAgdmlzaWJsZT0idHJ1ZSIKICAgICAgIGVuYWJsZWQ9InRydWUiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNyI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gNzksMjUgQyA5MS44LDI1IDk1LDI1IDk1LDI1IgogICAgICAgaWQ9InBhdGgzMDU5IgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDMxLDE1IDUsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMiwzNSA1LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmb250LXNpemU6bWVkaXVtO2ZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7dGV4dC1pbmRlbnQ6MDt0ZXh0LWFsaWduOnN0YXJ0O3RleHQtZGVjb3JhdGlvbjpub25lO2xpbmUtaGVpZ2h0Om5vcm1hbDtsZXR0ZXItc3BhY2luZzpub3JtYWw7d29yZC1zcGFjaW5nOm5vcm1hbDt0ZXh0LXRyYW5zZm9ybTpub25lO2RpcmVjdGlvbjpsdHI7YmxvY2stcHJvZ3Jlc3Npb246dGI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOnN0YXJ0O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MzttYXJrZXI6bm9uZTt2aXNpYmlsaXR5OnZpc2libGU7ZGlzcGxheTppbmxpbmU7b3ZlcmZsb3c6dmlzaWJsZTtlbmFibGUtYmFja2dyb3VuZDphY2N1bXVsYXRlO2ZvbnQtZmFtaWx5OkJpdHN0cmVhbSBWZXJhIFNhbnM7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjpCaXRzdHJlYW0gVmVyYSBTYW5zIgogICAgICAgZD0iTSAzMCw1IEwgMzAsNi40Mjg1NzE0IEwgMzAsNDMuNTcxNDI5IEwgMzAsNDUgTCAzMS40Mjg1NzEsNDUgTCA1MC40NzYxOSw0NSBDIDYxLjc0NDA5OCw0NSA3MC40NzYxOSwzNS45OTk5NTUgNzAuNDc2MTksMjUgQyA3MC40NzYxOSwxNC4wMDAwNDUgNjEuNzQ0MDk5LDUuMDAwMDAwMiA1MC40NzYxOSw1IEMgNTAuNDc2MTksNSA1MC40NzYxOSw1IDMxLjQyODU3MSw1IEwgMzAsNSB6IE0gMzIuODU3MTQzLDcuODU3MTQyOSBDIDQwLjgzNDI2NCw3Ljg1NzE0MjkgNDUuOTE4MzY4LDcuODU3MTQyOSA0OC4wOTUyMzgsNy44NTcxNDI5IEMgNDkuMjg1NzE0LDcuODU3MTQyOSA0OS44ODA5NTIsNy44NTcxNDI5IDUwLjE3ODU3MSw3Ljg1NzE0MjkgQyA1MC4zMjczODEsNy44NTcxNDI5IDUwLjQwOTIyNyw3Ljg1NzE0MjkgNTAuNDQ2NDI5LDcuODU3MTQyOSBDIDUwLjQ2NTAyOSw3Ljg1NzE0MjkgNTAuNDcxNTQzLDcuODU3MTQyOSA1MC40NzYxOSw3Ljg1NzE0MjkgQyA2MC4yMzY4NTMsNy44NTcxNDMgNjcuMTQyODU3LDE1LjQ5NzA5OCA2Ny4xNDI4NTcsMjUgQyA2Ny4xNDI4NTcsMzQuNTAyOTAyIDU5Ljc2MDY2Miw0Mi4xNDI4NTcgNTAsNDIuMTQyODU3IEwgMzIuODU3MTQzLDQyLjE0Mjg1NyBMIDMyLjg1NzE0Myw3Ljg1NzE0MjkgeiIKICAgICAgIGlkPSJwYXRoMjg4NCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY2Njc2NjY2Nzc3Nzc2NjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDQwMDgiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg==' }}\n}, {\n    operation: function(input1, input2) {\n        return !(input1 && input2);\n    }\n});\n\nexport const Xor = Gate21.define('logic.Xor', {\n    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhPUiBBTlNJLnN2ZyIKICAgaW5rc2NhcGU6b3V0cHV0X2V4dGVuc2lvbj0ib3JnLmlua3NjYXBlLm91dHB1dC5zdmcuaW5rc2NhcGUiPgogIDxkZWZzCiAgICAgaWQ9ImRlZnM0Ij4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSI1MCA6IDE1IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIyNSA6IDEwIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3MTQiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEgOiAwLjUgOiAxIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjAuNSA6IDAuMzMzMzMzMzMgOiAxIgogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgwNiIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjgxOSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNzQ0LjA5NDQ4IDogNTI2LjE4MTA5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMjc3NyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI3NSA6IDQwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjE1MCA6IDYwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA2MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUzMjc1IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjUwIDogMzMuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjEwMCA6IDUwIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MCA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmU1NTMzIgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjMyIDogMjEuMzMzMzMzIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjY0IDogMzIgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDMyIDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI1NTciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxNi42NjY2NjcgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAyNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMjUgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICA8L2RlZnM+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjUuNjU2ODU0MiIKICAgICBpbmtzY2FwZTpjeD0iMjUuOTM4MTE2IgogICAgIGlua3NjYXBlOmN5PSIxNy4yMzAwNSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDcwLDI1IGMgMjAsMCAyNSwwIDI1LDAiCiAgICAgICBpZD0icGF0aDMwNTkiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5ODg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzAuMzg1NzE3LDE1IEwgNC45OTk5OTk4LDE1IgogICAgICAgaWQ9InBhdGgzMDYxIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuOTk5OTk5NzY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Ik0gMzEuMzYyMDkxLDM1IEwgNC45OTk5OTk4LDM1IgogICAgICAgaWQ9InBhdGgzOTQ0IiAvPgogICAgPGcKICAgICAgIGlkPSJnMjU2MCIKICAgICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjYuNSwtMzkuNSkiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDM1MTYiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi4yNSw4MS41MDAwMDUgQyAtMy44NDczNzQsODQuMTQ0NDA1IC00LjUsODQuNTAwMDA1IC00LjUsODQuNTAwMDA1IEwgLTguMTU2MjUsODQuNTAwMDA1IEwgLTYuMTU2MjUsODIuMDYyNTA1IEMgLTYuMTU2MjUsODIuMDYyNTA1IC0wLjUsNzUuMDYyNDUxIC0wLjUsNjQuNSBDIC0wLjUsNTMuOTM3NTQ5IC02LjE1NjI1LDQ2LjkzNzUgLTYuMTU2MjUsNDYuOTM3NSBMIC04LjE1NjI1LDQ0LjUgTCAtNC41LDQ0LjUgQyAtMy43MTg3NSw0NS40Mzc1IC0zLjA3ODEyNSw0Ni4xNTYyNSAtMi4yODEyNSw0Ny41IEMgLTAuNDA4NTMxLDUwLjU5OTgxNSAyLjUsNTYuNTI2NjQ2IDIuNSw2NC41IEMgMi41LDcyLjQ1MDY1IC0wLjM5NjY5Nyw3OC4zNzk0MjUgLTIuMjUsODEuNTAwMDA1IHoiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NjY3NjY2Njc2MiIC8+CiAgICAgIDxwYXRoCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjM7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgZD0iTSAtMi40MDYyNSw0NC41IEwgLTAuNDA2MjUsNDYuOTM3NSBDIC0wLjQwNjI1LDQ2LjkzNzUgNS4yNSw1My45Mzc1NDkgNS4yNSw2NC41IEMgNS4yNSw3NS4wNjI0NTEgLTAuNDA2MjUsODIuMDYyNSAtMC40MDYyNSw4Mi4wNjI1IEwgLTIuNDA2MjUsODQuNSBMIDAuNzUsODQuNSBMIDE0Ljc1LDg0LjUgQyAxNy4xNTgwNzYsODQuNTAwMDAxIDIyLjQzOTY5OSw4NC41MjQ1MTQgMjguMzc1LDgyLjA5Mzc1IEMgMzQuMzEwMzAxLDc5LjY2Mjk4NiA0MC45MTE1MzYsNzQuNzUwNDg0IDQ2LjA2MjUsNjUuMjE4NzUgTCA0NC43NSw2NC41IEwgNDYuMDYyNSw2My43ODEyNSBDIDM1Ljc1OTM4Nyw0NC43MTU1OSAxOS41MDY1NzQsNDQuNSAxNC43NSw0NC41IEwgMC43NSw0NC41IEwgLTIuNDA2MjUsNDQuNSB6IE0gMy40Njg3NSw0Ny41IEwgMTQuNzUsNDcuNSBDIDE5LjQzNDE3Myw0Ny41IDMzLjAzNjg1LDQ3LjM2OTc5MyA0Mi43MTg3NSw2NC41IEMgMzcuOTUxOTY0LDcyLjkyOTA3NSAzMi4xOTc0NjksNzcuMTgzOTEgMjcsNzkuMzEyNSBDIDIxLjYzOTMzOSw4MS41MDc5MjQgMTcuMTU4MDc1LDgxLjUwMDAwMSAxNC43NSw4MS41IEwgMy41LDgxLjUgQyA1LjM3MzU4ODQsNzguMzkxNTY2IDguMjUsNzIuNDUwNjUgOC4yNSw2NC41IEMgOC4yNSw1Ni41MjY2NDYgNS4zNDE0Njg2LDUwLjU5OTgxNSAzLjQ2ODc1LDQ3LjUgeiIKICAgICAgICAgaWQ9InBhdGg0OTczIgogICAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjc2NjY2NzY2NjY2NjY2Njc2Njc2MiIC8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K' }}\n}, {\n    operation: function(input1, input2) {\n        return (!input1 || input2) && (input1 || !input2);\n    }\n});\n\nexport const Xnor = Gate21.define('logic.Xnor', {\n    attrs: { image: { 'xlink:href': 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgo8c3ZnCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHdpZHRoPSIxMDAiCiAgIGhlaWdodD0iNTAiCiAgIGlkPSJzdmcyIgogICBzb2RpcG9kaTp2ZXJzaW9uPSIwLjMyIgogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2IgogICB2ZXJzaW9uPSIxLjAiCiAgIHNvZGlwb2RpOmRvY25hbWU9IlhOT1IgQU5TSS5zdmciCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzNCI+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogMTUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfej0iNTAgOiAxNSA6IDEiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMjUgOiAxMCA6IDEiCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNzE0IiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDAuNSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxIDogMC41IDogMSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIwLjUgOiAwLjMzMzMzMzMzIDogMSIKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MDYiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI4MTkiCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9Ijc0NC4wOTQ0OCA6IDUyNi4xODEwOSA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUKICAgICAgIGlkPSJwZXJzcGVjdGl2ZTI3NzciCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iNzUgOiA0MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxNTAgOiA2MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNjAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzI3NSIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSI1MCA6IDMzLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSIxMDAgOiA1MCA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF95PSIwIDogMTAwMCA6IDAiCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTAgOiAxIgogICAgICAgc29kaXBvZGk6dHlwZT0iaW5rc2NhcGU6cGVyc3AzZCIgLz4KICAgIDxpbmtzY2FwZTpwZXJzcGVjdGl2ZQogICAgICAgaWQ9InBlcnNwZWN0aXZlNTUzMyIKICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzMiA6IDIxLjMzMzMzMyA6IDEiCiAgICAgICBpbmtzY2FwZTp2cF96PSI2NCA6IDMyIDogMSIKICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCIKICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiAzMiA6IDEiCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPgogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlCiAgICAgICBpZD0icGVyc3BlY3RpdmUyNTU3IgogICAgICAgaW5rc2NhcGU6cGVyc3AzZC1vcmlnaW49IjI1IDogMTYuNjY2NjY3IDogMSIKICAgICAgIGlua3NjYXBlOnZwX3o9IjUwIDogMjUgOiAxIgogICAgICAgaW5rc2NhcGU6dnBfeT0iMCA6IDEwMDAgOiAwIgogICAgICAgaW5rc2NhcGU6dnBfeD0iMCA6IDI1IDogMSIKICAgICAgIHNvZGlwb2RpOnR5cGU9Imlua3NjYXBlOnBlcnNwM2QiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSI0IgogICAgIGlua3NjYXBlOmN4PSI5NS43MjM2NiIKICAgICBpbmtzY2FwZTpjeT0iLTI2Ljc3NTAyMyIKICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0ibGF5ZXIxIgogICAgIHNob3dncmlkPSJ0cnVlIgogICAgIGlua3NjYXBlOmdyaWQtYmJveD0idHJ1ZSIKICAgICBpbmtzY2FwZTpncmlkLXBvaW50cz0idHJ1ZSIKICAgICBncmlkdG9sZXJhbmNlPSIxMDAwMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzOTkiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iODc0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIzMyIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMCIKICAgICBpbmtzY2FwZTpzbmFwLWJib3g9InRydWUiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIGlkPSJHcmlkRnJvbVByZTA0NlNldHRpbmdzIgogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgb3JpZ2lueD0iMHB4IgogICAgICAgb3JpZ2lueT0iMHB4IgogICAgICAgc3BhY2luZ3g9IjFweCIKICAgICAgIHNwYWNpbmd5PSIxcHgiCiAgICAgICBjb2xvcj0iIzAwMDBmZiIKICAgICAgIGVtcGNvbG9yPSIjMDAwMGZmIgogICAgICAgb3BhY2l0eT0iMC4yIgogICAgICAgZW1wb3BhY2l0eT0iMC40IgogICAgICAgZW1wc3BhY2luZz0iNSIKICAgICAgIHZpc2libGU9InRydWUiCiAgICAgICBlbmFibGVkPSJ0cnVlIiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTciPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIj4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjAwMDAwMDI0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDc4LjMzMzMzMiwyNSBDIDkxLjY2NjY2NiwyNSA5NSwyNSA5NSwyNSIKICAgICAgIGlkPSJwYXRoMzA1OSIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk4ODtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMC4zODU3MTcsMTUgTCA0Ljk5OTk5OTgsMTUiCiAgICAgICBpZD0icGF0aDMwNjEiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS45OTk5OTk3NjtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSAzMS4zNjIwOTEsMzUgTCA0Ljk5OTk5OTgsMzUiCiAgICAgICBpZD0icGF0aDM5NDQiIC8+CiAgICA8ZwogICAgICAgaWQ9ImcyNTYwIgogICAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyNi41LC0zOS41KSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMzUxNiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjI1LDgxLjUwMDAwNSBDIC0zLjg0NzM3NCw4NC4xNDQ0MDUgLTQuNSw4NC41MDAwMDUgLTQuNSw4NC41MDAwMDUgTCAtOC4xNTYyNSw4NC41MDAwMDUgTCAtNi4xNTYyNSw4Mi4wNjI1MDUgQyAtNi4xNTYyNSw4Mi4wNjI1MDUgLTAuNSw3NS4wNjI0NTEgLTAuNSw2NC41IEMgLTAuNSw1My45Mzc1NDkgLTYuMTU2MjUsNDYuOTM3NSAtNi4xNTYyNSw0Ni45Mzc1IEwgLTguMTU2MjUsNDQuNSBMIC00LjUsNDQuNSBDIC0zLjcxODc1LDQ1LjQzNzUgLTMuMDc4MTI1LDQ2LjE1NjI1IC0yLjI4MTI1LDQ3LjUgQyAtMC40MDg1MzEsNTAuNTk5ODE1IDIuNSw1Ni41MjY2NDYgMi41LDY0LjUgQyAyLjUsNzIuNDUwNjUgLTAuMzk2Njk3LDc4LjM3OTQyNSAtMi4yNSw4MS41MDAwMDUgeiIKICAgICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjY2Njc2NjY2NzYyIgLz4KICAgICAgPHBhdGgKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBkPSJNIC0yLjQwNjI1LDQ0LjUgTCAtMC40MDYyNSw0Ni45Mzc1IEMgLTAuNDA2MjUsNDYuOTM3NSA1LjI1LDUzLjkzNzU0OSA1LjI1LDY0LjUgQyA1LjI1LDc1LjA2MjQ1MSAtMC40MDYyNSw4Mi4wNjI1IC0wLjQwNjI1LDgyLjA2MjUgTCAtMi40MDYyNSw4NC41IEwgMC43NSw4NC41IEwgMTQuNzUsODQuNSBDIDE3LjE1ODA3Niw4NC41MDAwMDEgMjIuNDM5Njk5LDg0LjUyNDUxNCAyOC4zNzUsODIuMDkzNzUgQyAzNC4zMTAzMDEsNzkuNjYyOTg2IDQwLjkxMTUzNiw3NC43NTA0ODQgNDYuMDYyNSw2NS4yMTg3NSBMIDQ0Ljc1LDY0LjUgTCA0Ni4wNjI1LDYzLjc4MTI1IEMgMzUuNzU5Mzg3LDQ0LjcxNTU5IDE5LjUwNjU3NCw0NC41IDE0Ljc1LDQ0LjUgTCAwLjc1LDQ0LjUgTCAtMi40MDYyNSw0NC41IHogTSAzLjQ2ODc1LDQ3LjUgTCAxNC43NSw0Ny41IEMgMTkuNDM0MTczLDQ3LjUgMzMuMDM2ODUsNDcuMzY5NzkzIDQyLjcxODc1LDY0LjUgQyAzNy45NTE5NjQsNzIuOTI5MDc1IDMyLjE5NzQ2OSw3Ny4xODM5MSAyNyw3OS4zMTI1IEMgMjEuNjM5MzM5LDgxLjUwNzkyNCAxNy4xNTgwNzUsODEuNTAwMDAxIDE0Ljc1LDgxLjUgTCAzLjUsODEuNSBDIDUuMzczNTg4NCw3OC4zOTE1NjYgOC4yNSw3Mi40NTA2NSA4LjI1LDY0LjUgQyA4LjI1LDU2LjUyNjY0NiA1LjM0MTQ2ODYsNTAuNTk5ODE1IDMuNDY4NzUsNDcuNSB6IgogICAgICAgICBpZD0icGF0aDQ5NzMiCiAgICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2NzY2NjY3NjY2NjY2NjY2NzY2NzYyIgLz4KICAgIDwvZz4KICAgIDxwYXRoCiAgICAgICBzb2RpcG9kaTp0eXBlPSJhcmMiCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lam9pbjptaXRlcjttYXJrZXI6bm9uZTtzdHJva2Utb3BhY2l0eToxO3Zpc2liaWxpdHk6dmlzaWJsZTtkaXNwbGF5OmlubGluZTtvdmVyZmxvdzp2aXNpYmxlO2VuYWJsZS1iYWNrZ3JvdW5kOmFjY3VtdWxhdGUiCiAgICAgICBpZD0icGF0aDM1NTEiCiAgICAgICBzb2RpcG9kaTpjeD0iNzUiCiAgICAgICBzb2RpcG9kaTpjeT0iMjUiCiAgICAgICBzb2RpcG9kaTpyeD0iNCIKICAgICAgIHNvZGlwb2RpOnJ5PSI0IgogICAgICAgZD0iTSA3OSwyNSBBIDQsNCAwIDEgMSA3MSwyNSBBIDQsNCAwIDEgMSA3OSwyNSB6IiAvPgogIDwvZz4KPC9zdmc+Cg==' }}\n}, {\n    operation: function(input1, input2) {\n        return (!input1 || !input2) && (input1 || input2);\n    }\n});\n\nexport const Wire = Link.define('logic.Wire', {\n    attrs: {\n        '.connection': { 'stroke-width': 2 },\n        '.marker-vertex': { r: 7 }\n    },\n\n    router: { name: 'orthogonal' },\n    connector: { name: 'rounded', args: { radius: 10 }}\n}, {\n    arrowheadMarkup: [\n        '<g class=\"marker-arrowhead-group marker-arrowhead-group-<%= end %>\">',\n        '<circle class=\"marker-arrowhead\" end=\"<%= end %>\" r=\"7\"/>',\n        '</g>'\n    ].join(''),\n\n    vertexMarkup: [\n        '<g class=\"marker-vertex-group\" transform=\"translate(<%= x %>, <%= y %>)\">',\n        '<circle class=\"marker-vertex\" idx=\"<%= idx %>\" r=\"10\" />',\n        '<g class=\"marker-vertex-remove-group\">',\n        '<path class=\"marker-vertex-remove-area\" idx=\"<%= idx %>\" d=\"M16,5.333c-7.732,0-14,4.701-14,10.5c0,1.982,0.741,3.833,2.016,5.414L2,25.667l5.613-1.441c2.339,1.317,5.237,2.107,8.387,2.107c7.732,0,14-4.701,14-10.5C30,10.034,23.732,5.333,16,5.333z\" transform=\"translate(5, -33)\"/>',\n        '<path class=\"marker-vertex-remove\" idx=\"<%= idx %>\" transform=\"scale(.8) translate(9.5, -37)\" d=\"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z\">',\n        '<title>Remove vertex.</title>',\n        '</path>',\n        '</g>',\n        '</g>'\n    ].join('')\n});\n","import { Generic } from './basic.mjs';\n\nexport const KingWhite = Generic.define('chess.KingWhite', {\n    size: { width: 42, height: 38 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\"><path      d=\"M 22.5,11.63 L 22.5,6\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path      d=\"M 20,8 L 25,8\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path      d=\"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\"      style=\"fill:#ffffff; stroke:#000000; stroke-linecap:butt; stroke-linejoin:miter;\" />    <path      d=\"M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z \"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 11.5,30 C 17,27 27,27 32.5,30\"      style=\"fill:none; stroke:#000000;\" />    <path      d=\"M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5\"      style=\"fill:none; stroke:#000000;\" />    <path      d=\"M 11.5,37 C 17,34 27,34 32.5,37\"      style=\"fill:none; stroke:#000000;\" />  </g></g></g>'\n});\n\nexport const KingBlack = Generic.define('chess.KingBlack', {\n    size: { width: 42, height: 38 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path       d=\"M 22.5,11.63 L 22.5,6\"       style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\"       id=\"path6570\" />    <path       d=\"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\"       style=\"fill:#000000;fill-opacity:1; stroke-linecap:butt; stroke-linejoin:miter;\" />    <path       d=\"M 11.5,37 C 17,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 19,16 9.5,13 6.5,19.5 C 3.5,25.5 11.5,29.5 11.5,29.5 L 11.5,37 z \"       style=\"fill:#000000; stroke:#000000;\" />    <path       d=\"M 20,8 L 25,8\"       style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />    <path       d=\"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.51,26.6 L 22.5,24.5 C 20,18 9.906,14 6.997,19.85 C 4.5,25.5 11.85,28.85 11.85,28.85\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 11.5,30 C 17,27 27,27 32.5,30 M 11.5,33.5 C 17,30.5 27,30.5 32.5,33.5 M 11.5,37 C 17,34 27,34 32.5,37\"       style=\"fill:none; stroke:#ffffff;\" />  </g></g></g>'\n});\n\nexport const QueenWhite = Generic.define('chess.QueenWhite', {\n    size: { width: 42, height: 38 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(-1,-1)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(15.5,-5.5)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(32,-1)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(7,-4.5)\" />    <path      d=\"M 9 13 A 2 2 0 1 1  5,13 A 2 2 0 1 1  9 13 z\"      transform=\"translate(24,-4)\" />    <path      d=\"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38,14 L 31,25 L 31,11 L 25.5,24.5 L 22.5,9.5 L 19.5,24.5 L 14,10.5 L 14,25 L 7,14 L 9,26 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11.5,30 C 15,29 30,29 33.5,30\"      style=\"fill:none;\" />    <path      d=\"M 12,33.5 C 18,32.5 27,32.5 33,33.5\"      style=\"fill:none;\" />  </g></g></g>'\n});\n\nexport const QueenBlack = Generic.define('chess.QueenBlack', {\n    size: { width: 42, height: 38 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#000000; stroke:none;\">      <circle cx=\"6\"    cy=\"12\" r=\"2.75\" />      <circle cx=\"14\"   cy=\"9\"  r=\"2.75\" />      <circle cx=\"22.5\" cy=\"8\"  r=\"2.75\" />      <circle cx=\"31\"   cy=\"9\"  r=\"2.75\" />      <circle cx=\"39\"   cy=\"12\" r=\"2.75\" />    </g>    <path       d=\"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\"       style=\"stroke-linecap:butt; stroke:#000000;\" />    <path       d=\"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 10.5,36 10.5,36 C 9,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z\"       style=\"stroke-linecap:butt;\" />    <path       d=\"M 11,38.5 A 35,35 1 0 0 34,38.5\"       style=\"fill:none; stroke:#000000; stroke-linecap:butt;\" />    <path       d=\"M 11,29 A 35,35 1 0 1 34,29\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 12.5,31.5 L 32.5,31.5\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5\"       style=\"fill:none; stroke:#ffffff;\" />    <path       d=\"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5\"       style=\"fill:none; stroke:#ffffff;\" />  </g></g></g>'\n});\n\nexport const RookWhite = Generic.define('chess.RookWhite', {\n    size: { width: 32, height: 34 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14\"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 34,14 L 31,17 L 14,17 L 11,14\" />    <path      d=\"M 31,17 L 31,29.5 L 14,29.5 L 14,17\"      style=\"stroke-linecap:butt; stroke-linejoin:miter;\" />    <path      d=\"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5\" />    <path      d=\"M 11,14 L 34,14\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />  </g></g></g>'\n});\n\nexport const RookBlack = Generic.define('chess.RookBlack', {\n    size: { width: 32, height: 34 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z \"      style=\"stroke-linecap:butt;stroke-linejoin:miter;\" />    <path      d=\"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z \"      style=\"stroke-linecap:butt;\" />    <path      d=\"M 12,35.5 L 33,35.5 L 33,35.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 13,31.5 L 32,31.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 14,29.5 L 31,29.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 14,16.5 L 31,16.5\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />    <path      d=\"M 11,14 L 34,14\"      style=\"fill:none; stroke:#ffffff; stroke-width:1; stroke-linejoin:miter;\" />  </g></g></g>'\n});\n\nexport const BishopWhite = Generic.define('chess.BishopWhite', {\n    size: { width: 38, height: 38 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#ffffff; stroke:#000000; stroke-linecap:butt;\">       <path        d=\"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z\" />      <path        d=\"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\" />      <path        d=\"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\" />    </g>    <path      d=\"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\"      style=\"fill:none; stroke:#000000; stroke-linejoin:miter;\" />  </g></g></g>'\n});\n\nexport const BishopBlack = Generic.define('chess.BishopBlack', {\n    size: { width: 38, height: 38 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-rule:evenodd; fill-opacity:1; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:round; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <g style=\"fill:#000000; stroke:#000000; stroke-linecap:butt;\">       <path        d=\"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.646,38.99 6.677,38.97 6,38 C 7.354,36.06 9,36 9,36 z\" />      <path        d=\"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\" />      <path        d=\"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\" />    </g>    <path       d=\"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\"       style=\"fill:none; stroke:#ffffff; stroke-linejoin:miter;\" />  </g></g></g>'\n});\n\nexport const KnightWhite = Generic.define('chess.KnightWhite', {\n    size: { width: 38, height: 37 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\"      style=\"fill:#ffffff; stroke:#000000;\" />    <path      d=\"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\"      transform=\"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\"      style=\"fill:#000000; stroke:#000000;\" />  </g></g></g>'\n});\n\nexport const KnightBlack = Generic.define('chess.KnightBlack', {\n    size: { width: 38, height: 37 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><g style=\"opacity:1; fill:none; fill-opacity:1; fill-rule:evenodd; stroke:#000000; stroke-width:1.5; stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\">    <path      d=\"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\"      style=\"fill:#000000; stroke:#000000;\" />    <path      d=\"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\"      style=\"fill:#ffffff; stroke:#ffffff;\" />    <path      d=\"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\"      transform=\"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\"      style=\"fill:#ffffff; stroke:#ffffff;\" />    <path      d=\"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z \"      style=\"fill:#ffffff; stroke:none;\" />  </g></g></g>'\n});\n\nexport const PawnWhite = Generic.define('chess.PawnWhite', {\n    size: { width: 28, height: 33 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><path d=\"M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z \"  style=\"opacity:1; fill:#ffffff; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\" /></g></g>'\n});\n\nexport const PawnBlack = Generic.define('chess.PawnBlack', {\n    size: { width: 28, height: 33 }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><path d=\"M 22,9 C 19.79,9 18,10.79 18,13 C 18,13.89 18.29,14.71 18.78,15.38 C 16.83,16.5 15.5,18.59 15.5,21 C 15.5,23.03 16.44,24.84 17.91,26.03 C 14.91,27.09 10.5,31.58 10.5,39.5 L 33.5,39.5 C 33.5,31.58 29.09,27.09 26.09,26.03 C 27.56,24.84 28.5,23.03 28.5,21 C 28.5,18.59 27.17,16.5 25.22,15.38 C 25.71,14.71 26,13.89 26,13 C 26,10.79 24.21,9 22,9 z \"  style=\"opacity:1; fill:#000000; fill-opacity:1; fill-rule:nonzero; stroke:#000000; stroke-width:1.5; stroke-linecap:round; stroke-linejoin:miter; stroke-miterlimit:4; stroke-dasharray:none; stroke-opacity:1;\" /></g></g>'\n});\n\n","import { Element } from '../dia/Element.mjs';\nimport { Link } from '../dia/Link.mjs';\n\nexport const Entity = Element.define('erd.Entity', {\n    size: { width: 150, height: 60 },\n    attrs: {\n        '.outer': {\n            fill: '#2ECC71', stroke: '#27AE60', 'stroke-width': 2,\n            points: '100,0 100,60 0,60 0,0'\n        },\n        '.inner': {\n            fill: '#2ECC71', stroke: '#27AE60', 'stroke-width': 2,\n            points: '95,5 95,55 5,55 5,5',\n            display: 'none'\n        },\n        text: {\n            text: 'Entity',\n            'font-family': 'Arial', 'font-size': 14,\n            'ref-x': .5, 'ref-y': .5,\n            'y-alignment': 'middle', 'text-anchor': 'middle'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polygon class=\"outer\"/><polygon class=\"inner\"/></g><text/></g>',\n});\n\nexport const WeakEntity = Entity.define('erd.WeakEntity', {\n    attrs: {\n        '.inner': { display: 'auto' },\n        text: { text: 'Weak Entity' }\n    }\n});\n\nexport const Relationship = Element.define('erd.Relationship', {\n    size: { width: 80, height: 80 },\n    attrs: {\n        '.outer': {\n            fill: '#3498DB', stroke: '#2980B9', 'stroke-width': 2,\n            points: '40,0 80,40 40,80 0,40'\n        },\n        '.inner': {\n            fill: '#3498DB', stroke: '#2980B9', 'stroke-width': 2,\n            points: '40,5 75,40 40,75 5,40',\n            display: 'none'\n        },\n        text: {\n            text: 'Relationship',\n            'font-family': 'Arial', 'font-size': 12,\n            'ref-x': .5, 'ref-y': .5,\n            'y-alignment': 'middle', 'text-anchor': 'middle'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polygon class=\"outer\"/><polygon class=\"inner\"/></g><text/></g>',\n});\n\nexport const IdentifyingRelationship = Relationship.define('erd.IdentifyingRelationship', {\n    attrs: {\n        '.inner': { display: 'auto' },\n        text: { text: 'Identifying' }\n    }\n});\n\nexport const Attribute = Element.define('erd.Attribute', {\n    size: { width: 100, height: 50 },\n    attrs: {\n        'ellipse': {\n            transform: 'translate(50, 25)'\n        },\n        '.outer': {\n            stroke: '#D35400', 'stroke-width': 2,\n            cx: 0, cy: 0, rx: 50, ry: 25,\n            fill: '#E67E22'\n        },\n        '.inner': {\n            stroke: '#D35400', 'stroke-width': 2,\n            cx: 0, cy: 0, rx: 45, ry: 20,\n            fill: '#E67E22', display: 'none'\n        },\n        text: {\n            'font-family': 'Arial', 'font-size': 14,\n            'ref-x': .5, 'ref-y': .5,\n            'y-alignment': 'middle', 'text-anchor': 'middle'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><ellipse class=\"outer\"/><ellipse class=\"inner\"/></g><text/></g>',\n});\n\nexport const Multivalued = Attribute.define('erd.Multivalued', {\n    attrs: {\n        '.inner': { display: 'block' },\n        text: { text: 'multivalued' }\n    }\n});\n\nexport const Derived = Attribute.define('erd.Derived', {\n    attrs: {\n        '.outer': { 'stroke-dasharray': '3,5' },\n        text: { text: 'derived' }\n    }\n});\n\nexport const Key = Attribute.define('erd.Key', {\n    attrs: {\n        ellipse: { 'stroke-width': 4 },\n        text: { text: 'key', 'font-weight': '800', 'text-decoration': 'underline' }\n    }\n});\n\nexport const Normal = Attribute.define('erd.Normal', {\n    attrs: { text: { text: 'Normal' }}\n});\n\nexport const ISA = Element.define('erd.ISA', {\n    type: 'erd.ISA',\n    size: { width: 100, height: 50 },\n    attrs: {\n        polygon: {\n            points: '0,0 50,50 100,0',\n            fill: '#F1C40F', stroke: '#F39C12', 'stroke-width': 2\n        },\n        text: {\n            text: 'ISA', 'font-size': 18,\n            'ref-x': .5, 'ref-y': .3,\n            'y-alignment': 'middle', 'text-anchor': 'middle'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><polygon/></g><text/></g>',\n});\n\nexport const Line = Link.define('erd.Line', {}, {\n    cardinality: function(value) {\n        this.set('labels', [{ position: -20, attrs: { text: { dy: -8, text: value }}}]);\n    }\n});\n","import { Circle } from './basic.mjs';\nimport { Element } from '../dia/Element.mjs';\nimport { Link } from '../dia/Link.mjs';\n\nexport const State = Circle.define('fsa.State', {\n    attrs: {\n        circle: { 'stroke-width': 3 },\n        text: { 'font-weight': '800' }\n    }\n});\n\nexport const StartState = Element.define('fsa.StartState', {\n    size: { width: 20, height: 20 },\n    attrs: {\n        circle: {\n            transform: 'translate(10, 10)',\n            r: 10,\n            fill: '#000000'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle/></g></g>',\n});\n\nexport const EndState = Element.define('fsa.EndState', {\n    size: { width: 20, height: 20 },\n    attrs: {\n        '.outer': {\n            transform: 'translate(10, 10)',\n            r: 10,\n            fill: '#ffffff',\n            stroke: '#000000'\n        },\n\n        '.inner': {\n            transform: 'translate(10, 10)',\n            r: 6,\n            fill: '#000000'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"outer\"/><circle class=\"inner\"/></g></g>',\n});\n\nexport const Arrow = Link.define('fsa.Arrow', {\n    attrs: { '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' }},\n    smooth: true\n});\n\n\n","import { Element } from '../dia/Element.mjs';\nimport { Link } from '../dia/Link.mjs';\n\nexport const Member = Element.define('org.Member', {\n    size: { width: 180, height: 70 },\n    attrs: {\n        rect: { width: 170, height: 60 },\n\n        '.card': {\n            fill: '#FFFFFF', stroke: '#000000', 'stroke-width': 2,\n            'pointer-events': 'visiblePainted', rx: 10, ry: 10\n        },\n\n        image: {\n            width: 48, height: 48,\n            ref: '.card', 'ref-x': 10, 'ref-y': 5\n        },\n\n        '.rank': {\n            'text-decoration': 'underline',\n            ref: '.card', 'ref-x': 0.9, 'ref-y': 0.2,\n            'font-family': 'Courier New', 'font-size': 14,\n            'text-anchor': 'end'\n        },\n\n        '.name': {\n            'font-weight': '800',\n            ref: '.card', 'ref-x': 0.9, 'ref-y': 0.6,\n            'font-family': 'Courier New', 'font-size': 14,\n            'text-anchor': 'end'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"card\"/><image/></g><text class=\"rank\"/><text class=\"name\"/></g>',\n});\n\nexport const Arrow = Link.define('org.Arrow', {\n    source: { selector: '.card' }, target: { selector: '.card' },\n    attrs: { '.connection': { stroke: '#585858', 'stroke-width': 3 }},\n    z: -1\n});\n\n","import { Generic } from './basic.mjs';\nimport { ElementView } from '../dia/ElementView.mjs';\nimport V from '../V/index.mjs';\nimport { Link as diaLink } from '../dia/Link.mjs';\n\nexport const Place = Generic.define('pn.Place', {\n    size: { width: 50, height: 50 },\n    attrs: {\n        '.root': {\n            r: 25,\n            fill: '#ffffff',\n            stroke: '#000000',\n            transform: 'translate(25, 25)'\n        },\n        '.label': {\n            'text-anchor': 'middle',\n            'ref-x': .5,\n            'ref-y': -20,\n            ref: '.root',\n            fill: '#000000',\n            'font-size': 12\n        },\n        '.tokens > circle': {\n            fill: '#000000',\n            r: 5\n        },\n        '.tokens.one > circle': { transform: 'translate(25, 25)' },\n\n        '.tokens.two > circle:nth-child(1)': { transform: 'translate(19, 25)' },\n        '.tokens.two > circle:nth-child(2)': { transform: 'translate(31, 25)' },\n\n        '.tokens.three > circle:nth-child(1)': { transform: 'translate(18, 29)' },\n        '.tokens.three > circle:nth-child(2)': { transform: 'translate(25, 19)' },\n        '.tokens.three > circle:nth-child(3)': { transform: 'translate(32, 29)' },\n\n        '.tokens.alot > text': {\n            transform: 'translate(25, 18)',\n            'text-anchor': 'middle',\n            fill: '#000000'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"root\"/><g class=\"tokens\" /></g><text class=\"label\"/></g>',\n});\n\nexport const PlaceView = ElementView.extend({\n\n    presentationAttributes: ElementView.addPresentationAttributes({\n        tokens: ['TOKENS']\n    }),\n\n    initFlag: ElementView.prototype.initFlag.concat(['TOKENS']),\n\n    confirmUpdate: function(...args) {\n        let flags = ElementView.prototype.confirmUpdate.call(this, ...args);\n        if (this.hasFlag(flags, 'TOKENS')) {\n            this.renderTokens();\n            this.update();\n            flags = this.removeFlag(flags, 'TOKENS');\n        }\n        return flags;\n    },\n\n    renderTokens: function() {\n\n        const vTokens = this.vel.findOne('.tokens').empty();\n        ['one', 'two', 'three', 'alot'].forEach(function(className) {\n            vTokens.removeClass(className);\n        });\n\n        var tokens = this.model.get('tokens');\n        if (!tokens) return;\n\n        switch (tokens) {\n\n            case 1:\n                vTokens.addClass('one');\n                vTokens.append(V('circle'));\n                break;\n\n            case 2:\n                vTokens.addClass('two');\n                vTokens.append([V('circle'), V('circle')]);\n                break;\n\n            case 3:\n                vTokens.addClass('three');\n                vTokens.append([V('circle'), V('circle'), V('circle')]);\n                break;\n\n            default:\n                vTokens.addClass('alot');\n                vTokens.append(V('text').text(tokens + ''));\n                break;\n        }\n    }\n});\n\nexport const Transition = Generic.define('pn.Transition', {\n    size: { width: 12, height: 50 },\n    attrs: {\n        'rect': {\n            width: 12,\n            height: 50,\n            fill: '#000000',\n            stroke: '#000000'\n        },\n        '.label': {\n            'text-anchor': 'middle',\n            'ref-x': .5,\n            'ref-y': -20,\n            ref: 'rect',\n            fill: '#000000',\n            'font-size': 12\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect class=\"root\"/></g></g><text class=\"label\"/>',\n});\n\nexport const Link = diaLink.define('pn.Link', {\n    attrs: { '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' }}\n});\n","import { ElementView } from '../dia/ElementView.mjs';\nimport { Link } from '../dia/Link.mjs';\nimport { Generic, Circle } from './basic.mjs';\n\nexport const Class = Generic.define('uml.Class', {\n    attrs: {\n        rect: { 'width': 200 },\n\n        '.uml-class-name-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#3498db' },\n        '.uml-class-attrs-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#2980b9' },\n        '.uml-class-methods-rect': { 'stroke': 'black', 'stroke-width': 2, 'fill': '#2980b9' },\n\n        '.uml-class-name-text': {\n            'ref': '.uml-class-name-rect',\n            'ref-y': .5,\n            'ref-x': .5,\n            'text-anchor': 'middle',\n            'y-alignment': 'middle',\n            'font-weight': 'bold',\n            'fill': 'black',\n            'font-size': 12,\n            'font-family': 'Times New Roman'\n        },\n        '.uml-class-attrs-text': {\n            'ref': '.uml-class-attrs-rect', 'ref-y': 5, 'ref-x': 5,\n            'fill': 'black', 'font-size': 12, 'font-family': 'Times New Roman'\n        },\n        '.uml-class-methods-text': {\n            'ref': '.uml-class-methods-rect', 'ref-y': 5, 'ref-x': 5,\n            'fill': 'black', 'font-size': 12, 'font-family': 'Times New Roman'\n        }\n    },\n\n    name: [],\n    attributes: [],\n    methods: []\n}, {\n    markup: [\n        '<g class=\"rotatable\">',\n        '<g class=\"scalable\">',\n        '<rect class=\"uml-class-name-rect\"/><rect class=\"uml-class-attrs-rect\"/><rect class=\"uml-class-methods-rect\"/>',\n        '</g>',\n        '<text class=\"uml-class-name-text\"/><text class=\"uml-class-attrs-text\"/><text class=\"uml-class-methods-text\"/>',\n        '</g>'\n    ].join(''),\n\n    initialize: function() {\n\n        this.on('change:name change:attributes change:methods', function() {\n            this.updateRectangles();\n            this.trigger('uml-update');\n        }, this);\n\n        this.updateRectangles();\n\n        Generic.prototype.initialize.apply(this, arguments);\n    },\n\n    getClassName: function() {\n        return this.get('name');\n    },\n\n    updateRectangles: function() {\n\n        var attrs = this.get('attrs');\n\n        var rects = [\n            { type: 'name', text: this.getClassName() },\n            { type: 'attrs', text: this.get('attributes') },\n            { type: 'methods', text: this.get('methods') }\n        ];\n\n        var offsetY = 0;\n\n        rects.forEach(function(rect) {\n\n            var lines = Array.isArray(rect.text) ? rect.text : [rect.text];\n            var rectHeight = lines.length * 20 + 20;\n\n            attrs['.uml-class-' + rect.type + '-text'].text = lines.join('\\n');\n            attrs['.uml-class-' + rect.type + '-rect'].height = rectHeight;\n            attrs['.uml-class-' + rect.type + '-rect'].transform = 'translate(0,' + offsetY + ')';\n\n            offsetY += rectHeight;\n        });\n    }\n\n});\n\nexport const ClassView = ElementView.extend({\n\n    initialize: function() {\n\n        ElementView.prototype.initialize.apply(this, arguments);\n\n        this.listenTo(this.model, 'uml-update', function() {\n            this.update();\n            this.resize();\n        });\n    }\n});\n\nexport const Abstract = Class.define('uml.Abstract', {\n    attrs: {\n        '.uml-class-name-rect': { fill: '#e74c3c' },\n        '.uml-class-attrs-rect': { fill: '#c0392b' },\n        '.uml-class-methods-rect': { fill: '#c0392b' }\n    }\n}, {\n\n    getClassName: function() {\n        return ['<<Abstract>>', this.get('name')];\n    }\n\n});\nexport const AbstractView = ClassView;\n\nexport const Interface = Class.define('uml.Interface', {\n    attrs: {\n        '.uml-class-name-rect': { fill: '#f1c40f' },\n        '.uml-class-attrs-rect': { fill: '#f39c12' },\n        '.uml-class-methods-rect': { fill: '#f39c12' }\n    }\n}, {\n    getClassName: function() {\n        return ['<<Interface>>', this.get('name')];\n    }\n});\nexport const InterfaceView = ClassView;\n\nexport const Generalization = Link.define('uml.Generalization', {\n    attrs: { '.marker-target': { d: 'M 20 0 L 0 10 L 20 20 z', fill: 'white' }}\n});\n\nexport const Implementation = Link.define('uml.Implementation', {\n    attrs: {\n        '.marker-target': { d: 'M 20 0 L 0 10 L 20 20 z', fill: 'white' },\n        '.connection': { 'stroke-dasharray': '3,3' }\n    }\n});\n\nexport const Aggregation = Link.define('uml.Aggregation', {\n    attrs: { '.marker-target': { d: 'M 40 10 L 20 20 L 0 10 L 20 0 z', fill: 'white' }}\n});\n\nexport const Composition = Link.define('uml.Composition', {\n    attrs: { '.marker-target': { d: 'M 40 10 L 20 20 L 0 10 L 20 0 z', fill: 'black' }}\n});\n\nexport const Association = Link.define('uml.Association');\n\n// Statechart\n\nexport const State = Generic.define('uml.State', {\n    attrs: {\n        '.uml-state-body': {\n            'width': 200, 'height': 200, 'rx': 10, 'ry': 10,\n            'fill': '#ecf0f1', 'stroke': '#bdc3c7', 'stroke-width': 3\n        },\n        '.uml-state-separator': {\n            'stroke': '#bdc3c7', 'stroke-width': 2\n        },\n        '.uml-state-name': {\n            'ref': '.uml-state-body', 'ref-x': .5, 'ref-y': 5, 'text-anchor': 'middle',\n            'fill': '#000000', 'font-family': 'Courier New', 'font-size': 14\n        },\n        '.uml-state-events': {\n            'ref': '.uml-state-separator', 'ref-x': 5, 'ref-y': 5,\n            'fill': '#000000', 'font-family': 'Courier New', 'font-size': 14\n        }\n    },\n\n    name: 'State',\n    events: []\n\n}, {\n    markup: [\n        '<g class=\"rotatable\">',\n        '<g class=\"scalable\">',\n        '<rect class=\"uml-state-body\"/>',\n        '</g>',\n        '<path class=\"uml-state-separator\"/>',\n        '<text class=\"uml-state-name\"/>',\n        '<text class=\"uml-state-events\"/>',\n        '</g>'\n    ].join(''),\n\n    initialize: function() {\n\n        this.on({\n            'change:name': this.updateName,\n            'change:events': this.updateEvents,\n            'change:size': this.updatePath\n        }, this);\n\n        this.updateName();\n        this.updateEvents();\n        this.updatePath();\n\n        Generic.prototype.initialize.apply(this, arguments);\n    },\n\n    updateName: function() {\n\n        this.attr('.uml-state-name/text', this.get('name'));\n    },\n\n    updateEvents: function() {\n\n        this.attr('.uml-state-events/text', this.get('events').join('\\n'));\n    },\n\n    updatePath: function() {\n\n        var d = 'M 0 20 L ' + this.get('size').width + ' 20';\n\n        // We are using `silent: true` here because updatePath() is meant to be called\n        // on resize and there's no need to to update the element twice (`change:size`\n        // triggers also an update).\n        this.attr('.uml-state-separator/d', d, { silent: true });\n    }\n});\n\nexport const StartState = Circle.define('uml.StartState', {\n    type: 'uml.StartState',\n    attrs: { circle: { 'fill': '#34495e', 'stroke': '#2c3e50', 'stroke-width': 2, 'rx': 1 }}\n});\n\nexport const EndState = Generic.define('uml.EndState', {\n    size: { width: 20, height: 20 },\n    attrs: {\n        'circle.outer': {\n            transform: 'translate(10, 10)',\n            r: 10,\n            fill: '#ffffff',\n            stroke: '#2c3e50'\n        },\n\n        'circle.inner': {\n            transform: 'translate(10, 10)',\n            r: 6,\n            fill: '#34495e'\n        }\n    }\n}, {\n    markup: '<g class=\"rotatable\"><g class=\"scalable\"><circle class=\"outer\"/><circle class=\"inner\"/></g></g>',\n});\n\nexport const Transition = Link.define('uml.Transition', {\n    attrs: {\n        '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z', fill: '#34495e', stroke: '#2c3e50' },\n        '.connection': { stroke: '#2c3e50' }\n    }\n});\n","import * as connectionStrategies from '../connectionStrategies/index.mjs';\n\nexport function getViewBBox(view, useModelGeometry) {\n    const { model } = view;\n    if (useModelGeometry) return model.getBBox();\n    return (model.isLink()) ? view.getConnection().bbox() : view.getNodeUnrotatedBBox(view.el);\n}\n\nexport function getAnchor(coords, view, magnet) {\n    // take advantage of an existing logic inside of the\n    // pin relative connection strategy\n    var end = connectionStrategies.pinRelative.call(\n        this.paper,\n        {},\n        view,\n        magnet,\n        coords,\n        this.model\n    );\n    return end.anchor;\n}\n\nexport function snapAnchor(coords, view, magnet, type, relatedView, toolView) {\n    var snapRadius = toolView.options.snapRadius;\n    var isSource = (type === 'source');\n    var refIndex = (isSource ? 0 : -1);\n    var ref = this.model.vertex(refIndex) || this.getEndAnchor(isSource ? 'target' : 'source');\n    if (ref) {\n        if (Math.abs(ref.x - coords.x) < snapRadius) coords.x = ref.x;\n        if (Math.abs(ref.y - coords.y) < snapRadius) coords.y = ref.y;\n    }\n    return coords;\n}\n","\nimport * as util from '../util/index.mjs';\nimport { ToolView } from '../dia/ToolView.mjs';\nimport { getViewBBox } from './helpers.mjs';\n\nexport const Boundary = ToolView.extend({\n    name: 'boundary',\n    tagName: 'rect',\n    options: {\n        padding: 10,\n        useModelGeometry: false,\n    },\n    attributes: {\n        'fill': 'none',\n        'stroke': '#33334F',\n        'stroke-width': .5,\n        'stroke-dasharray': '5, 5',\n        'pointer-events': 'none'\n    },\n    onRender: function() {\n        this.update();\n    },\n    update: function() {\n        const { relatedView: view, options, vel } = this;\n        const { useModelGeometry, rotate } = options;\n        const padding = util.normalizeSides(options.padding);\n        let bbox = getViewBBox(view, useModelGeometry).moveAndExpand({\n            x: -padding.left,\n            y: -padding.top,\n            width: padding.left + padding.right,\n            height: padding.top + padding.bottom\n        });\n        var model = view.model;\n        if (model.isElement()) {\n            var angle = model.angle();\n            if (angle) {\n                if (rotate) {\n                    var origin = model.getBBox().center();\n                    vel.rotate(angle, origin.x, origin.y, { absolute: true });\n                } else {\n                    bbox = bbox.bbox(angle);\n                }\n            }\n        }\n        vel.attr(bbox.toJSON());\n        return this;\n    }\n});\n","import { dia, shapes, linkTools, elementTools } from \"jointjs\";\r\nimport { NormalResizeTool, RotateTool, updateLabelText } from \"./tools\";\r\n\r\nexport function defineNamespace() {\r\n  const Path = dia.Element.define(\r\n    \"bleuon.Path\",\r\n    {\r\n      attrs: {\r\n        body: {\r\n          width: \"calc(w)\",\r\n          height: \"calc(h)\",\r\n          fill: \"#fcfcfc\",\r\n          stroke: \"#333333\",\r\n          strokeWidth: 1.5,\r\n          cursor: \"grab\",\r\n          \"stroke-dasharray\": \"none\"\r\n        },\r\n        label: {\r\n          text: \"\",\r\n          textVerticalAnchor: \"middle\",\r\n          textAnchor: \"middle\",\r\n          fill: \"#333333\",\r\n          fontWeight: \"normal\",\r\n          fontSize: 18,\r\n          fontFamily: \"微软雅黑\",\r\n          refX: \"50%\",\r\n          refY: \"50%\"\r\n        }\r\n      }\r\n    },\r\n    {\r\n      updateLabelText,\r\n      addClickedTools(elementView: dia.ElementView) {\r\n        const boundaryTool = new elementTools.Boundary();\r\n        const resizeTool = new NormalResizeTool();\r\n        const rotateTool = new RotateTool();\r\n\r\n        elementView.addTools(\r\n          new dia.ToolsView({\r\n            name: \"path-clicked-tools\",\r\n            tools: [boundaryTool, resizeTool, rotateTool]\r\n          })\r\n        );\r\n      },\r\n      removeClickedTools(elementView: dia.ElementView) {\r\n        if (elementView.hasTools(\"path-clicked-tools\")) {\r\n          elementView.removeTools();\r\n        }\r\n      }\r\n    }\r\n  );\r\n\r\n  const Link = shapes.standard.Link.define(\r\n    \"bleuon.Link\",\r\n    {\r\n      router: { name: \"manhattan\" },\r\n      attrs: {\r\n        line: {\r\n          fill: \"none\",\r\n          stroke: \"#333333\",\r\n          strokeWidth: 2\r\n        }\r\n      }\r\n    },\r\n    {\r\n      updateLabelText(linkView: dia.LinkView, textInput: HTMLInputElement) {\r\n        // @ts-ignore\r\n        const { model } = linkView;\r\n        const label = model.label(0);\r\n        const cellText = label?.attrs?.text?.text || \"\";\r\n\r\n        const bbox = linkView.getBBox();\r\n        const centerX = bbox.x + bbox.width / 2;\r\n        const centerY = bbox.y + bbox.height / 2;\r\n        const oneThirdWidth = bbox.width / 3;\r\n        textInput.value = cellText;\r\n\r\n        textInput.style.top = centerY - 10 + \"px\";\r\n        textInput.style.left = centerX - oneThirdWidth / 2 + \"px\";\r\n        textInput.style.width = oneThirdWidth + \"px\";\r\n        textInput.style.height = 20 + \"px\";\r\n        textInput.style.display = \"block\";\r\n\r\n        function handleKeydownEvent(event: any) {\r\n          if (event.key === \"Enter\") {\r\n            let newCellText = textInput.value;\r\n\r\n            model.label(0, {\r\n              position: 0.5,\r\n              attrs: { text: { text: newCellText } }\r\n            });\r\n\r\n            textInput.style.display = \"none\";\r\n            textInput.removeEventListener(\"keydown\", handleKeydownEvent);\r\n          }\r\n        }\r\n\r\n        textInput.value = \"\";\r\n        textInput.addEventListener(\"keydown\", handleKeydownEvent);\r\n        textInput.focus();\r\n      },\r\n      addClickedTools(linkView: any) {\r\n        // const verticesTool = new linkTools.Vertices();\r\n        // const segmentsTool = new linkTools.Segments();\r\n        // const sourceArrowheadTool = new linkTools.SourceArrowhead();\r\n        // const targetArrowheadTool = new linkTools.TargetArrowhead();\r\n        // const sourceAnchorTool = new linkTools.SourceAnchor();\r\n        // const targetAnchorTool = new linkTools.TargetAnchor();\r\n        const boundaryTool = new linkTools.Boundary();\r\n\r\n        linkView.addTools(\r\n          new dia.ToolsView({\r\n            name: \"link-tools\",\r\n            tools: [\r\n              // verticesTool,\r\n              // segmentsTool,\r\n              boundaryTool\r\n              // sourceArrowheadTool,\r\n              // targetArrowheadTool,\r\n              // sourceAnchorTool,\r\n              // targetAnchorTool\r\n            ]\r\n          })\r\n        );\r\n      },\r\n      removeClickedTools(linkView: any) {\r\n        if (linkView.hasTools(\"link-tools\")) {\r\n          linkView.removeTools();\r\n        }\r\n      }\r\n    }\r\n  );\r\n\r\n  return Object.assign(shapes, {\r\n    bleuon: {\r\n      Path,\r\n      Link\r\n    }\r\n  });\r\n}\r\n","/**\r\n * @description jointjs 初始化\r\n * @author 郑人滏 42020306\r\n * @since 2023/9/9\r\n * @link https://github.com/himmelbleu/bleuon-app\r\n */\r\n\r\nimport { dia, shapes } from \"jointjs\";\r\nimport { defineNamespace } from \"./namespace\";\r\n\r\n/**\r\n * 初始化 jointjs\r\n *\r\n * @param config 配置 jointjs\r\n * @returns paper, graph\r\n */\r\nexport function initJointJs(config: {\r\n  el: string;\r\n  bgColor: string;\r\n  height: string;\r\n  width: string;\r\n  gridSize: number;\r\n  drawGrid: boolean | dia.Paper.GridOptions | dia.Paper.GridOptions[];\r\n  isPreventLinkFromInputPorts?: boolean;\r\n  isPreventLinkFromOutputToInputWithinOneElement?: boolean;\r\n  isPreventLinkToOutputPorts?: boolean;\r\n}) {\r\n  const namespace = defineNamespace();\r\n  const graph = new dia.Graph({}, { cellNamespace: namespace });\r\n  const paper = new dia.Paper({\r\n    el: document.getElementById(config.el),\r\n    model: graph,\r\n    height: config.height,\r\n    width: config.width,\r\n    gridSize: config.gridSize,\r\n    drawGrid: config.drawGrid,\r\n    background: {\r\n      color: config.bgColor\r\n    },\r\n    snapLabels: true,\r\n    snapLinks: { radius: 5 },\r\n    interactive: {\r\n      linkMove: false,\r\n      labelMove: true,\r\n      arrowheadMove: false,\r\n      vertexMove: false,\r\n      vertexAdd: false,\r\n      vertexRemove: false,\r\n      useLinkTools: false\r\n    },\r\n    cellViewNamespace: namespace,\r\n    // @ts-ignore\r\n    defaultLink: () => new shapes.bleuon.Link(),\r\n    defaultConnectionPoint: { name: \"boundary\" },\r\n    validateConnection: function (cellViewS, magnetS, cellViewT, magnetT, end, linkView) {\r\n      if (config.isPreventLinkFromInputPorts || false) {\r\n        if (magnetS && magnetS.getAttribute(\"port-group\") === \"in\") return false;\r\n      }\r\n\r\n      if (config.isPreventLinkFromOutputToInputWithinOneElement || false) {\r\n        if (cellViewS === cellViewT) return false;\r\n      }\r\n\r\n      if (config.isPreventLinkToOutputPorts || false) {\r\n        return magnetT && magnetT.getAttribute(\"port-group\") === \"in\";\r\n      }\r\n\r\n      return true;\r\n    }\r\n  });\r\n\r\n  return {\r\n    paper,\r\n    graph\r\n  };\r\n}\r\n","/**\r\n * @description Diagraming 工具\r\n * @author 郑人滏 42020306\r\n * @since 2023/9/22\r\n * @link https://github.com/himmelbleu/bleuon-app\r\n */\r\n\r\nexport function getLinkOrElementAttr(model: any, attrKey: string) {\r\n  if (model.isLink()) {\r\n    attrKey = \"line/\" + attrKey;\r\n  } else {\r\n    attrKey = \"body/\" + attrKey;\r\n  }\r\n  return attrKey;\r\n}\r\n","/**\r\n * @description link 以及 element 共同业务\r\n * @author 郑人滏 42020306\r\n * @since 2023/9/24\r\n * @link https://github.com/himmelbleu/bleuon-app\r\n */\r\n\r\nimport { dia } from \"@mainapp/lib\";\r\nimport { getLinkOrElementAttr } from \"./utils\";\r\n\r\n/**\r\n * 修改路由样式\r\n *\r\n * @param config\r\n * @param paper\r\n */\r\nexport function changeRouterConfig(config: Ref<any>, paper: dia.Paper) {\r\n  if (!paper?.options?.defaultRouter) return;\r\n  paper.options.defaultRouter = config.value;\r\n}\r\n\r\n/**\r\n * 修改连线样式\r\n *\r\n * @param config\r\n * @param paper\r\n */\r\nexport function changeConnectorConfig(config: Ref<any>, paper: dia.Paper) {\r\n  if (!paper?.options?.defaultConnector) return;\r\n  paper.options.defaultConnector = config.value;\r\n}\r\n\r\n/**\r\n * 修改文本粗细\r\n *\r\n * @param currView 点击的图形\r\n */\r\nexport function changeTextBold(currView: dia.ElementView) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n  const isLink = model.isLink();\r\n  let weight = \"normal\";\r\n\r\n  if (isLink) {\r\n    weight = model.label(0).attrs.text.fontWeight || \"normal\";\r\n  } else {\r\n    weight = model.attr(\"label/fontWeight\");\r\n  }\r\n\r\n  if (weight === \"bold\") {\r\n    weight = \"normal\";\r\n  } else weight = \"bold\";\r\n\r\n  if (isLink) {\r\n    model.label(0, {\r\n      attrs: {\r\n        text: {\r\n          fontWeight: weight\r\n        }\r\n      }\r\n    });\r\n  } else {\r\n    model.attr(\"label/fontWeight\", weight);\r\n  }\r\n}\r\n\r\n/**\r\n * 修改文本斜体\r\n *\r\n * @param currView 点击的图形\r\n */\r\nexport function changeTextItalic(currView: dia.ElementView) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n  const isLink = model.isLink();\r\n\r\n  let style = \"normal\";\r\n\r\n  if (isLink) {\r\n    style = model.label(0).attrs.text.fontStyle || \"normal\";\r\n  } else {\r\n    style = model.attr(\"label/fontStyle\");\r\n  }\r\n\r\n  if (style === \"italic\") {\r\n    style = \"normal\";\r\n  } else style = \"italic\";\r\n\r\n  if (isLink) {\r\n    model.label(0, {\r\n      attrs: {\r\n        text: {\r\n          fontStyle: style\r\n        }\r\n      }\r\n    });\r\n  } else {\r\n    model.attr(\"label/fontStyle\", style);\r\n  }\r\n}\r\n\r\n/**\r\n * 修改文本下划线\r\n *\r\n * @param currView 点击的图形\r\n */\r\nexport function changeTextUnderline(currView: dia.ElementView) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n  const isLink = model.isLink();\r\n\r\n  let style = \"normal\";\r\n\r\n  if (isLink) {\r\n    style = model.label(0).attrs.text.textDecoration || \"normal\";\r\n  } else {\r\n    style = model.attr(\"label/textDecoration\");\r\n  }\r\n\r\n  if (style === \"underline\") {\r\n    style = \"normal\";\r\n  } else style = \"underline\";\r\n\r\n  if (isLink) {\r\n    model.label(0, {\r\n      attrs: {\r\n        text: {\r\n          textDecoration: style\r\n        }\r\n      }\r\n    });\r\n  } else {\r\n    model.attr(\"label/textDecoration\", style);\r\n  }\r\n}\r\n\r\n/**\r\n * 修改文本颜色\r\n *\r\n * @param currView 点击的图形\r\n * @param color\r\n */\r\nexport function changeTextColor(currView: dia.ElementView, color: string) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n  const isLink = model.isLink();\r\n\r\n  if (isLink) {\r\n    model.label(0, {\r\n      attrs: {\r\n        text: {\r\n          fill: color\r\n        }\r\n      }\r\n    });\r\n  } else {\r\n    model.attr(\"label/fill\", color);\r\n  }\r\n}\r\n\r\n/**\r\n * 修改字号\r\n *\r\n * @param currView 点击的图形\r\n * @param size\r\n */\r\nexport function changeTextSize(currView: dia.ElementView, size: number) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n  const isLink = model.isLink();\r\n\r\n  if (isLink) {\r\n    model.label(0, {\r\n      attrs: {\r\n        text: {\r\n          fontSize: size\r\n        }\r\n      }\r\n    });\r\n  } else {\r\n    model.attr(\"label/fontSize\", size);\r\n  }\r\n}\r\n\r\n/**\r\n * 修改字体\r\n *\r\n * @param currView 点击的图形\r\n * @param family\r\n */\r\nexport function changeTextFamily(currView: dia.ElementView, family: string) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n  const isLink = model.isLink();\r\n\r\n  if (isLink) {\r\n    model.label(0, {\r\n      attrs: {\r\n        text: {\r\n          fontFamily: family\r\n        }\r\n      }\r\n    });\r\n  } else {\r\n    model.attr(\"label/fontFamily\", family);\r\n  }\r\n}\r\n\r\n/**\r\n * 修改连线粗细\r\n *\r\n * @param currView 点击的图形\r\n * @param strokeWidth\r\n */\r\nexport function changeStrokeWidth(currView: dia.ElementView, strokeWidth: number) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n\r\n  const attrKey = getLinkOrElementAttr(model, \"strokeWidth\");\r\n  model.attr(attrKey, strokeWidth);\r\n}\r\n\r\n/**\r\n * 修改连线样式\r\n *\r\n * @param currView 点击的图形\r\n * @param style \"solid\" | \"dashed\" | \"dotted\" | \"dashed-dotted\"\r\n */\r\nexport function changeBorderStyle(\r\n  currView: dia.ElementView,\r\n  style: \"solid\" | \"dashed\" | \"dotted\" | \"dashed-dotted\"\r\n) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n  const attrKey = getLinkOrElementAttr(model, \"strokeDasharray\");\r\n\r\n  let lattice = \"none\";\r\n\r\n  if (style === \"dashed-dotted\") {\r\n    lattice = \"5,2,1,2\";\r\n  } else if (style === \"dotted\") {\r\n    lattice = \"1,2\";\r\n  } else if (style === \"dashed\") {\r\n    lattice = \"5,2\";\r\n  } else {\r\n    lattice = \"none\";\r\n  }\r\n\r\n  model.attr(attrKey, lattice);\r\n}\r\n\r\n/**\r\n * 修改图形背景颜色\r\n *\r\n * @param currView 点击的图形\r\n * @param color rgb、十六进制、rgba\r\n */\r\nexport function changeBackground(currView: dia.ElementView, color: string) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n  model.attr(\"body/fill\", color);\r\n}\r\n\r\n/**\r\n * 修改 Link 色\r\n *\r\n * @param currView 点击的连线\r\n * @param color rgb、十六进制、rgba\r\n */\r\nexport function changeLinkColor(currView: dia.ElementView, color: string) {\r\n  // @ts-ignore\r\n  const model = currView.model;\r\n\r\n  const attrKey = getLinkOrElementAttr(model, \"stroke\");\r\n  model.attr(attrKey, color);\r\n}\r\n\r\n/**\r\n * 关闭颜色选择器\r\n */\r\nexport function closeColorPicker(el: any) {\r\n  setTimeout(() => {\r\n    el.hide();\r\n  }, 200);\r\n}\r\n\r\n/**\r\n * 打开颜色选择器\r\n *\r\n * @param el ref 模板引用\r\n */\r\nexport function openColorPicker(el: any) {\r\n  setTimeout(() => {\r\n    el.show();\r\n  }, 100);\r\n}\r\n","/**\r\n * @description Diagraming 数据\r\n * @author 郑人滏 42020306\r\n * @since 2023/9/18\r\n * @link https://github.com/himmelbleu/bleuon-app\r\n */\r\n\r\n/**\r\n * Link 两端样式下拉框\r\n */\r\nexport const linkConnectorOptions = [\r\n  {\r\n    value: \"straight\",\r\n    label: \"straight\"\r\n  },\r\n  {\r\n    value: \"jumpover\",\r\n    label: \"jumpover\"\r\n  },\r\n  {\r\n    value: \"normal\",\r\n    label: \"normal\"\r\n  },\r\n  {\r\n    value: \"rounded\",\r\n    label: \"rounded\"\r\n  },\r\n  {\r\n    value: \"smooth\",\r\n    label: \"smooth\"\r\n  },\r\n  {\r\n    value: \"curve\",\r\n    label: \"curve\"\r\n  }\r\n];\r\n\r\n/**\r\n * Link 两端连接配置\r\n */\r\nexport const linkConnectorConfig = ref({\r\n  name: \"normal\"\r\n});\r\n\r\n/**\r\n * Link 路由 name 下拉框\r\n */\r\nexport const linkRouterOptions = [\r\n  {\r\n    value: \"manhattan\",\r\n    label: \"manhattan\"\r\n  },\r\n  {\r\n    value: \"metro\",\r\n    label: \"metro\"\r\n  },\r\n  {\r\n    value: \"normal\",\r\n    label: \"normal\"\r\n  },\r\n  {\r\n    value: \"orthogonal\",\r\n    label: \"orthogonal\"\r\n  },\r\n  {\r\n    value: \"rightAngle\",\r\n    label: \"rightAngle\"\r\n  }\r\n];\r\n\r\n/**\r\n * Link 路由配置\r\n */\r\nexport const linkRouterConfig = ref({\r\n  name: \"normal\"\r\n});\r\n\r\n/**\r\n * 点击的上一次图形 View，包含图形 View 对象和图形的 model 对象\r\n */\r\nexport const clickedLastView = ref({\r\n  view: null,\r\n  model: null\r\n});\r\n\r\n/**\r\n * 点击的当前图形 View\r\n */\r\nexport const clickedCurrView = ref(null);\r\n\r\n/**\r\n * 字体颜色\r\n */\r\nexport const textColor = ref(\"\");\r\n\r\n/**\r\n * 字体大小\r\n */\r\nexport const textSize = ref(14);\r\n\r\n/**\r\n * 字体样式\r\n */\r\nexport const fontFamilyOptions = [\r\n  {\r\n    value: \"微软雅黑\",\r\n    label: \"微软雅黑\"\r\n  },\r\n  {\r\n    value: \"Arial\",\r\n    label: \"Arial\"\r\n  },\r\n  {\r\n    value: \"Bahnschrift\",\r\n    label: \"Bahnschrift\"\r\n  },\r\n  {\r\n    value: \"BIZ UDGothic\",\r\n    label: \"BIZ UDGothic\"\r\n  },\r\n  {\r\n    value: \"Calibri\",\r\n    label: \"Calibri\"\r\n  },\r\n  {\r\n    value: \"Cambria\",\r\n    label: \"Cambria\"\r\n  },\r\n  {\r\n    value: \"Candara\",\r\n    label: \"Candara\"\r\n  },\r\n  {\r\n    value: \"Comic Sans MS\",\r\n    label: \"Comic Sans MS\"\r\n  },\r\n  {\r\n    value: \"Consolas\",\r\n    label: \"Consolas\"\r\n  },\r\n  {\r\n    value: \"Constantia\",\r\n    label: \"Constantia\"\r\n  },\r\n  {\r\n    value: \"Corbel\",\r\n    label: \"Corbel\"\r\n  }\r\n];\r\n\r\n// 文本字体\r\nexport const fontFamily = ref(\"微软雅黑\");\r\n\r\n/**\r\n * 图形边框线条粗细\r\n */\r\nexport const shapeStrokeWidthOptions = [\r\n  {\r\n    value: 0,\r\n    label: \"0px\"\r\n  },\r\n  {\r\n    value: 0.5,\r\n    label: \"0.5px\"\r\n  },\r\n  {\r\n    value: 1,\r\n    label: \"1px\"\r\n  },\r\n  {\r\n    value: 1.5,\r\n    label: \"1.5px\"\r\n  },\r\n  {\r\n    value: 2,\r\n    label: \"2px\"\r\n  },\r\n  {\r\n    value: 3,\r\n    label: \"3px\"\r\n  },\r\n  {\r\n    value: 4,\r\n    label: \"4px\"\r\n  },\r\n  {\r\n    value: 5,\r\n    label: \"5px\"\r\n  },\r\n  {\r\n    value: 6,\r\n    label: \"6px\"\r\n  },\r\n  {\r\n    value: 8,\r\n    label: \"8px\"\r\n  },\r\n  {\r\n    value: 10,\r\n    label: \"10px\"\r\n  }\r\n];\r\n\r\n/**\r\n * 图形 stroke 宽度\r\n */\r\nexport const shapeStrokeWidth = ref(1.5);\r\n\r\n/**\r\n * 图形背景颜色\r\n */\r\nexport const shapeBackground = ref(\"white\");\r\n\r\n/**\r\n * 图形 stroke 样式\r\n */\r\nexport const shapeBorderStyle = ref(\"solid\");\r\n\r\n/**\r\n * 定义 paper 缩放比例\r\n */\r\nexport const currentScale = ref(1);\r\n\r\n/**\r\n * 计算当前缩放的值，适应 slider 显示\r\n */\r\nexport const calcCurrentScale = computed({\r\n  get() {\r\n    return Number((currentScale.value * 100).toFixed(0));\r\n  },\r\n  set(value) {\r\n    currentScale.value = value / 100;\r\n  }\r\n});\r\n\r\n/**\r\n * 定义 paper 水平偏移量\r\n */\r\nexport const currentOffsetX = ref(0);\r\n\r\n/**\r\n * 定义 paper 垂直偏移量\r\n */\r\nexport const currentOffsetY = ref(0);\r\n\r\n/**\r\n * 是否点击了 Link 元素\r\n */\r\nexport const isClickedLink = ref(false);\r\n\r\n/**\r\n * 是否点击了 Element 元素\r\n */\r\nexport const isClickedElement = ref(false);\r\n","/**\r\n * @description jointjs 事件监听、以及页面上的一些 change 事件\r\n * @author 郑人滏 42020306\r\n * @since 2023/9/24\r\n * @link https://github.com/himmelbleu/bleuon-app\r\n */\r\n\r\nimport { dia } from \"@mainapp/lib\";\r\nimport * as Data from \"@mainapp/data/diagraming/flowchart\";\r\n\r\n/**\r\n * 安装 Link 工具\r\n *\r\n * @param currView 当前点击的 Link\r\n */\r\nexport function mountToolsLink(\r\n  currView: dia.LinkView,\r\n  clickedLastView: Ref<{ model: any; view: dia.LinkView }>\r\n) {\r\n  clickedLastView.value.model?.removeClickedTools(clickedLastView.value.view);\r\n\r\n  // @ts-ignore\r\n  currView.model.addClickedTools(currView);\r\n\r\n  clickedLastView.value = {\r\n    // @ts-ignore\r\n    model: currView.model,\r\n    view: currView\r\n  };\r\n}\r\n\r\n/**\r\n * 卸载 Link 工具\r\n *\r\n * @param clickedLastView 上一次点击的 Link\r\n */\r\nexport function unmountToolsLink(clickedLastView: Ref<{ model: any; view: dia.ElementView }>) {\r\n  clickedLastView.value.model?.removeClickedTools(clickedLastView.value.view);\r\n\r\n  clickedLastView.value = {\r\n    model: null,\r\n    view: null\r\n  };\r\n}\r\n\r\n/**\r\n * 安装元素工具\r\n *\r\n * @param currView 当前点击的图形\r\n * @param clickedLastView 保存当前点击的图形作为上一次点击的图形\r\n */\r\nexport function mountToolsElement(\r\n  currView: dia.ElementView,\r\n  clickedLastView: Ref<{ model: any; view: dia.ElementView }>\r\n) {\r\n  clickedLastView.value.model?.removeClickedTools(clickedLastView.value.view);\r\n\r\n  // @ts-ignore\r\n  currView.model.addClickedTools(currView);\r\n\r\n  clickedLastView.value = {\r\n    // @ts-ignore\r\n    model: currView.model,\r\n    view: currView\r\n  };\r\n}\r\n\r\n/**\r\n * 卸载元素工具\r\n *\r\n * @param clickedLastView 上一次点击的图形\r\n */\r\nexport function unmountToolsElement(clickedLastView: Ref<{ model: any; view: dia.ElementView }>) {\r\n  clickedLastView.value.model?.removeClickedTools(clickedLastView.value.view);\r\n\r\n  clickedLastView.value = {\r\n    model: null,\r\n    view: null\r\n  };\r\n}\r\n\r\n/**\r\n * 当鼠标点击了 paper 时，卸载元素和 Link 上的工具\r\n */\r\nexport function onPointerClickBlank() {\r\n  // 改变布尔变量，让头部工具根据这些变量设置 disabled\r\n  Data.isClickedElement.value = false;\r\n  Data.isClickedLink.value = false;\r\n\r\n  unmountToolsLink(Data.clickedLastView);\r\n  unmountToolsElement(Data.clickedLastView);\r\n}\r\n\r\n/**\r\n * 当鼠标点击了元素时，不是 Link 元素\r\n *\r\n * @param view\r\n */\r\nexport function onPointerClickElement(view: dia.ElementView) {\r\n  // 改变布尔变量，让头部工具根据这些变量设置 disabled\r\n  Data.isClickedElement.value = true;\r\n  Data.isClickedLink.value = false;\r\n\r\n  // 存储当前点击的元素对象\r\n  Data.clickedCurrView.value = view;\r\n\r\n  // 安装元素定义的工具\r\n  mountToolsElement(view, Data.clickedLastView);\r\n}\r\n\r\n/**\r\n * 当鼠标点击了 Link 时\r\n *\r\n * @param view\r\n */\r\nexport function onPointerClickLink(view: dia.LinkView) {\r\n  // 改变布尔变量，让头部工具根据这些变量设置 disabled\r\n  Data.isClickedLink.value = true;\r\n  Data.isClickedElement.value = false;\r\n\r\n  // 存储当前点击的元素对象\r\n  Data.clickedCurrView.value = view;\r\n  // 安装 link 定义的工具\r\n  mountToolsLink(view, Data.clickedLastView);\r\n}\r\n\r\n/**\r\n * 当鼠标在 paper 上滚动鼠标滚轮时\r\n *\r\n * @param evt\r\n * @param paper\r\n */\r\nexport function onMousewheelBlank(evt: any, paper: dia.Paper) {\r\n  evt.preventDefault(); // 防止浏览器默认滚动行为\r\n  const delta = evt.originalEvent.deltaY; // 获取滚动方向\r\n  const scrollFactor = 30; // 滚动因子\r\n  const scaleFactor = 0.1; // 缩放因子\r\n\r\n  if (evt.ctrlKey) {\r\n    if (delta > 0) {\r\n      // 向下滚动，缩小画布\r\n      Data.currentScale.value -= scaleFactor;\r\n      if (Data.currentScale.value < 0.2) {\r\n        Data.currentScale.value = 0.2;\r\n      }\r\n    } else {\r\n      // 向上滚动，放大画布\r\n      Data.currentScale.value += scaleFactor;\r\n      if (Data.currentScale.value > 2) {\r\n        Data.currentScale.value = 2;\r\n      }\r\n    }\r\n\r\n    paper.scale(Data.currentScale.value, Data.currentScale.value);\r\n  } else if (evt.shiftKey) {\r\n    if (delta > 0) {\r\n      // 向下滚动，向右移动画布\r\n      Data.currentOffsetX.value += scrollFactor;\r\n    } else {\r\n      // 向上滚动，向左移动画布\r\n      Data.currentOffsetX.value -= scrollFactor;\r\n    }\r\n  } else {\r\n    if (delta > 0) {\r\n      // 向上滚动，向上移动画布\r\n      Data.currentOffsetY.value -= scrollFactor;\r\n    } else {\r\n      // 向下滚动，向下移动画布\r\n      Data.currentOffsetY.value += scrollFactor;\r\n    }\r\n  }\r\n\r\n  paper.setOrigin(Data.currentOffsetX.value, Data.currentOffsetY.value); // 重置画布的原点\r\n}\r\n\r\n/**\r\n * 监听键盘按下的事件监听。\r\n *\r\n * 一：当按下键盘 delete 或回退键时删除选中的元素\r\n * 二：当按下 Ctrl+S 保存数据到数据库中\r\n */\r\nexport function onKeydown(shortcutKey: { ctrlS: Function }) {\r\n  document.addEventListener(\"keydown\", event => {\r\n    if (event.ctrlKey) {\r\n      if (event.key === \"s\") {\r\n        event.preventDefault();\r\n        shortcutKey.ctrlS();\r\n      }\r\n    }\r\n\r\n    if (event.key === \"Backspace\" || event.key === \"Delete\") {\r\n      if (Data.clickedCurrView.value?.model) {\r\n        Data.isClickedElement.value = false;\r\n        Data.isClickedLink.value = false;\r\n        Data.clickedCurrView.value.model.remove();\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * 双击时\r\n *\r\n * @param currView\r\n * @param input\r\n */\r\nexport function onPointerDbclickElement(\r\n  currView: dia.ElementView | dia.LinkView,\r\n  input: HTMLInputElement\r\n) {\r\n  Data.clickedCurrView.value = null;\r\n\r\n  // @ts-ignore\r\n  const { model } = currView;\r\n  if (model?.updateLabelText) {\r\n    model.updateLabelText(currView, input);\r\n  }\r\n}\r\n","<script setup lang=\"ts\">\r\n/**\r\n * @description Flowchat 头部工具\r\n * @author 郑人滏 42020306\r\n * @since 2023/9/21\r\n * @link https://github.com/himmelbleu/bleuon-app\r\n */\r\n\r\nimport { dia } from \"@mainapp/lib\";\r\nimport * as Data from \"@mainapp/data/diagraming/flowchart\";\r\nimport { CellService } from \"@mainapp/service/diagraming/flowchart\";\r\n\r\nconst paper = inject<dia.Paper>(KeyVals.BLEUON_FLOWCHART_PAPER);\r\n\r\ndefineProps({\r\n  isClickedElement: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  isClickedLink: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n});\r\n\r\nconst textColorPickerRef = ref();\r\nconst linkColorPickerRef = ref();\r\nconst shapeBgColorPickerRef = ref();\r\n</script>\r\n\r\n<template>\r\n  <div class=\"f-c-s\">\r\n    <div class=\"tools__text\">\r\n      <div class=\"tools__title\">\r\n        <div class=\"i-tabler-typography mr-1\"></div>\r\n        编辑图形文本\r\n      </div>\r\n      <div class=\"tools__items f-c-c\">\r\n        <div class=\"font-tool\">\r\n          <el-tooltip content=\"字体\" placement=\"bottom\">\r\n            <el-select\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              style=\"width: 100px\"\r\n              @change=\"value => CellService.changeTextFamily(Data.clickedCurrView.value, value)\"\r\n              v-model=\"Data.fontFamily.value\"\r\n              placeholder=\"请选择字体\">\r\n              <el-option\r\n                v-for=\"item in Data.fontFamilyOptions\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\" />\r\n            </el-select>\r\n          </el-tooltip>\r\n        </div>\r\n        <div class=\"bold-tool ml-2\">\r\n          <el-tooltip content=\"加粗\" placement=\"bottom\">\r\n            <el-button\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              text\r\n              bg\r\n              @click=\"CellService.changeTextBold(Data.clickedCurrView.value)\">\r\n              <template #icon>\r\n                <div class=\"i-tabler-bold\"></div>\r\n              </template>\r\n            </el-button>\r\n          </el-tooltip>\r\n        </div>\r\n        <div class=\"italic-tool ml-2\">\r\n          <el-tooltip content=\"斜体\" placement=\"bottom\">\r\n            <el-button\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              text\r\n              bg\r\n              @click=\"CellService.changeTextItalic(Data.clickedCurrView.value)\">\r\n              <template #icon>\r\n                <div class=\"i-tabler-italic\"></div>\r\n              </template>\r\n            </el-button>\r\n          </el-tooltip>\r\n        </div>\r\n        <div class=\"underline-tool ml-2\">\r\n          <el-tooltip content=\"下划线\" placement=\"bottom\">\r\n            <el-button\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              text\r\n              bg\r\n              @click=\"CellService.changeTextUnderline(Data.clickedCurrView.value)\">\r\n              <template #icon>\r\n                <div class=\"i-tabler-underline\"></div>\r\n              </template>\r\n            </el-button>\r\n          </el-tooltip>\r\n        </div>\r\n        <div class=\"font-color-tool ml-2\">\r\n          <el-tooltip content=\"字体颜色\" placement=\"bottom\">\r\n            <el-button\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              text\r\n              bg\r\n              @click=\"CellService.openColorPicker(textColorPickerRef)\">\r\n              <template #icon>\r\n                <div class=\"i-tabler-text-color\"></div>\r\n              </template>\r\n            </el-button>\r\n          </el-tooltip>\r\n          <div class=\"hidden\">\r\n            <el-color-picker\r\n              ref=\"textColorPickerRef\"\r\n              @change=\"value => CellService.changeTextColor(Data.clickedCurrView.value, value)\"\r\n              v-model=\"Data.textColor.value\" />\r\n          </div>\r\n        </div>\r\n        <div class=\"font-size-tool ml-2\">\r\n          <el-tooltip content=\"字号(px)\" placement=\"bottom\">\r\n            <el-input-number\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              style=\"width: 85px\"\r\n              v-model=\"Data.textSize.value\"\r\n              :min=\"14\"\r\n              :max=\"30\"\r\n              controls-position=\"right\"\r\n              @change=\"value => CellService.changeTextSize(Data.clickedCurrView.value, value)\" />\r\n          </el-tooltip>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"mx-4 left-divider\"></div>\r\n    <div class=\"tools__cellview\">\r\n      <div class=\"tools__title\">\r\n        <div class=\"i-tabler-circles mr-1\"></div>\r\n        编辑图形样式\r\n      </div>\r\n      <div class=\"tools__items f-c-c\">\r\n        <div class=\"border-bold-tool\">\r\n          <el-tooltip content=\"连线粗细\" placement=\"bottom\">\r\n            <el-select\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              style=\"width: 85px\"\r\n              @change=\"value => CellService.changeStrokeWidth(Data.clickedCurrView.value, value)\"\r\n              v-model=\"Data.shapeStrokeWidth.value\"\r\n              placeholder=\"请选择连线粗细\">\r\n              <el-option\r\n                v-for=\"item in Data.shapeStrokeWidthOptions\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\" />\r\n            </el-select>\r\n          </el-tooltip>\r\n        </div>\r\n        <div class=\"border-style-tool ml-2\">\r\n          <el-tooltip content=\"连线样式\" placement=\"bottom\">\r\n            <el-select\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              style=\"width: 130px\"\r\n              @change=\"value => CellService.changeBorderStyle(Data.clickedCurrView.value, value)\"\r\n              v-model=\"Data.shapeBorderStyle.value\"\r\n              placeholder=\"请选择连线样式\">\r\n              <el-option label=\"实线\" value=\"solid\">\r\n                <img\r\n                  class=\"object-cover w-100% h-100%\"\r\n                  src=\"https://www.processon.com/v5_editor/compile/zhixian.ee583027.png\" />\r\n              </el-option>\r\n              <el-option label=\"虚线\" value=\"dashed\">\r\n                <img\r\n                  class=\"object-cover w-100% h-100%\"\r\n                  src=\"https://www.processon.com/v5_editor/compile/xuxian.a1d63600.png\" />\r\n              </el-option>\r\n              <el-option label=\"点线\" value=\"dotted\">\r\n                <img\r\n                  class=\"object-cover w-100% h-100%\"\r\n                  src=\"https://www.processon.com/v5_editor/compile/dianxian.5180ceef.png\" />\r\n              </el-option>\r\n              <el-option label=\"虚线和点线\" value=\"dashed-dotted\">\r\n                <img\r\n                  class=\"object-cover w-100% h-100%\"\r\n                  src=\"https://www.processon.com/v5_editor/compile/dianhuaxian.ab5e6f5b.png\" />\r\n              </el-option>\r\n            </el-select>\r\n          </el-tooltip>\r\n        </div>\r\n        <div class=\"shape-bg-tool ml-2\">\r\n          <el-tooltip content=\"图形背景色\" placement=\"bottom\">\r\n            <el-button\r\n              :disabled=\"!isClickedElement\"\r\n              text\r\n              bg\r\n              @click=\"CellService.openColorPicker(shapeBgColorPickerRef)\">\r\n              <template #icon>\r\n                <div class=\"i-tabler-paint\"></div>\r\n              </template>\r\n            </el-button>\r\n          </el-tooltip>\r\n          <div class=\"hidden\">\r\n            <el-color-picker\r\n              ref=\"shapeBgColorPickerRef\"\r\n              @change=\"value => CellService.changeBackground(Data.clickedCurrView.value, value)\"\r\n              v-model=\"Data.shapeBackground.value\" />\r\n          </div>\r\n        </div>\r\n        <div class=\"link-color-tool ml-2\">\r\n          <el-tooltip content=\"连线颜色\" placement=\"bottom\">\r\n            <el-button\r\n              :disabled=\"!isClickedElement && !isClickedLink\"\r\n              text\r\n              bg\r\n              @click=\"CellService.openColorPicker(linkColorPickerRef)\">\r\n              <template #icon>\r\n                <div class=\"i-tabler-pencil-minus\"></div>\r\n              </template>\r\n            </el-button>\r\n          </el-tooltip>\r\n          <div class=\"hidden\">\r\n            <el-color-picker\r\n              ref=\"linkColorPickerRef\"\r\n              @change=\"value => CellService.changeLinkColor(Data.clickedCurrView.value, value)\"\r\n              v-model=\"Data.textColor.value\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"mx-4 left-divider\"></div>\r\n    <div class=\"tools__config\">\r\n      <div class=\"tools__title\">\r\n        <div class=\"i-tabler-world mr-1\"></div>\r\n        全局设置\r\n      </div>\r\n      <div class=\"tools__items f-c-c\">\r\n        <div class=\"router-config-tool\">\r\n          <el-tooltip content=\"路由模式\" placement=\"bottom\">\r\n            <el-select\r\n              style=\"width: 90px\"\r\n              @change=\"CellService.changeRouterConfig(Data.linkRouterConfig, paper)\"\r\n              v-model=\"Data.linkRouterConfig.value.name\"\r\n              placeholder=\"请选择路由模式\">\r\n              <el-option\r\n                v-for=\"item in Data.linkRouterOptions\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\" />\r\n            </el-select>\r\n          </el-tooltip>\r\n        </div>\r\n        <div class=\"link-config-tool ml-2\">\r\n          <el-tooltip content=\"连接端样式\" placement=\"bottom\">\r\n            <el-select\r\n              style=\"width: 90px\"\r\n              @change=\"CellService.changeConnectorConfig(Data.linkConnectorConfig, paper)\"\r\n              v-model=\"Data.linkConnectorConfig.value.name\"\r\n              placeholder=\"请选择连接端样式\">\r\n              <el-option\r\n                v-for=\"item in Data.linkConnectorOptions\"\r\n                :key=\"item.value\"\r\n                :label=\"item.label\"\r\n                :value=\"item.value\" />\r\n            </el-select>\r\n          </el-tooltip>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n.left-divider {\r\n  height: 50px;\r\n  width: 0;\r\n  --uno: b-l-1 b-l-solid b-border-primary;\r\n}\r\n\r\n.tools__title {\r\n  --uno: text-gray-600 mb-2 text-0.8rem f-c-s;\r\n}\r\n</style>\r\n","/**\r\n * @description element-plus 组件的通用数据\r\n * @author 郑人滏 42020306\r\n * @since 2023/10/1\r\n * @link https://github.com/himmelbleu/bleuon-app\r\n */\r\n\r\nexport const shortcuts = [\r\n  {\r\n    text: \"明天\",\r\n    value: () => {\r\n      const date = new Date();\r\n      date.setTime(date.getTime() + 3600 * 1000 * 24);\r\n      return date;\r\n    }\r\n  },\r\n  {\r\n    text: \"一周后\",\r\n    value: () => {\r\n      const date = new Date();\r\n      date.setTime(date.getTime() + 3600 * 1000 * 24 * 7);\r\n      return date;\r\n    }\r\n  },\r\n  {\r\n    text: \"两周后\",\r\n    value: () => {\r\n      const date = new Date();\r\n      date.setTime(date.getTime() + 3600 * 1000 * 24 * 14);\r\n      return date;\r\n    }\r\n  },\r\n  {\r\n    text: \"一月后\",\r\n    value: () => {\r\n      const date = new Date();\r\n      date.setTime(date.getTime() + 3600 * 1000 * 24 * 30);\r\n      return date;\r\n    }\r\n  },\r\n  {\r\n    text: \"两月后\",\r\n    value: () => {\r\n      const date = new Date();\r\n      date.setTime(date.getTime() + 3600 * 1000 * 24 * 30);\r\n      return date;\r\n    }\r\n  }\r\n];\r\n","<script setup lang=\"ts\">\r\nimport { dia } from \"@mainapp/lib\";\r\nimport { convertSvgToImage } from \"@mainapp/lib/tools\";\r\nimport MenuAvatar from \"@mainapp/components/MenuAvatar.vue\";\r\nimport { formatted } from \"@common/utils/date\";\r\nimport { shortcuts } from \"@common/data/el-components\";\r\nimport { FlowchartApi } from \"@mainapp/apis\";\r\n\r\nimport type { FormInstance, FormRules } from \"element-plus\";\r\n\r\nconst paper = inject<Ref<dia.Paper>>(KeyVals.BLEUON_FLOWCHART_PAPER);\r\nconst graph = inject<Ref<dia.Graph>>(KeyVals.BLEUON_FLOWCHART_GRAPH);\r\nconst flowchartData = inject<Ref<FlowchartData>>(KeyVals.BLEUON_FLOWCHART_DATA);\r\nconst token = localStorage.getStorageWithAge(KeyVals.MAINAPP_TOKEN_KEY);\r\n\r\nconst editFile = ref(false);\r\n\r\nconst props = defineProps({\r\n  data: {\r\n    type: Object\r\n  },\r\n  type: {\r\n    type: String as PropType<\"share\" | \"privacy\">,\r\n    default: \"privacy\"\r\n  }\r\n});\r\nconst emits = defineEmits([\"change\"]);\r\n\r\nfunction download() {\r\n  const { width, height } = paper.value.getArea();\r\n  flowchartData.value.width = width;\r\n  flowchartData.value.height = height;\r\n  convertSvgToImage(\r\n    paper.value,\r\n    graph.value,\r\n    \"jpeg\",\r\n    flowchartData.value,\r\n    () => {\r\n      ElMessage.success(\"下载成功！\");\r\n    },\r\n    () => {\r\n      ElMessage.error(\"下载失败！\");\r\n    }\r\n  );\r\n}\r\n\r\nconst calcFileName = computed({\r\n  get() {\r\n    if (!flowchartData.value.fileName) {\r\n      flowchartData.value.fileName = \"未命名的文件\";\r\n    }\r\n    return flowchartData.value.fileName;\r\n  },\r\n  set(value) {\r\n    flowchartData.value.fileName = value;\r\n  }\r\n});\r\n\r\nfunction confirmChangeFileName() {\r\n  emits(\"change\");\r\n  editFile.value = !editFile.value;\r\n}\r\n\r\nconst dialogVisible = ref(false);\r\nconst formRef = ref<FormInstance>();\r\nconst formRules = reactive<FormRules<any>>({\r\n  deadShareDate: [\r\n    {\r\n      type: \"date\",\r\n      required: true,\r\n      message: \"请选择一个截止日期\",\r\n      trigger: \"change\"\r\n    },\r\n    {\r\n      type: \"date\",\r\n      required: true,\r\n      message: \"请选择一个截止日期\",\r\n      trigger: \"blur\"\r\n    }\r\n  ]\r\n});\r\n\r\nasync function confirmShare() {\r\n  if (props.type === \"share\") {\r\n    // 直接粘贴链接\r\n  } else {\r\n    if (!formRef.value) return;\r\n    await formRef.value.validate((valid, fields) => {\r\n      if (valid) {\r\n        flowchartData.value.isPublic = 1;\r\n        FlowchartApi.updateOne(flowchartData.value, data => {\r\n          if (data.code === 200) {\r\n            ElMessage.success(\"分享成功，复制链接浏览！\");\r\n          } else {\r\n            flowchartData.value.isPublic = 0;\r\n            ElMessage.error(\"分享失败！\");\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction cancelShare() {\r\n  flowchartData.value.isPublic = 0;\r\n  flowchartData.value.deadShareDate = null;\r\n  FlowchartApi.updateOne(flowchartData.value, data => {\r\n    if (data.code === 200) {\r\n      ElMessage.success(\"取消分享成功！\");\r\n    } else {\r\n      flowchartData.value.isPublic = 1;\r\n      ElMessage.error(\"取消分享失败！\");\r\n    }\r\n  });\r\n}\r\n\r\nfunction importFlowchart() {\r\n  flowchartData.value.fileName = \"导入模板_\" + flowchartData.value.fileName;\r\n  FlowchartApi.copyOne(flowchartData.value, () => {\r\n    ElMessage.success(\"导入成功，回到自己工作台查看吧！\");\r\n  });\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"b-border-primary b-b-1 b-b-solid f-c-b pb-4\">\r\n    <div class=\"left f-c-s\">\r\n      <el-button @click=\"$router.back()\" type=\"primary\" bg text>\r\n        <template #icon>\r\n          <div class=\"i-tabler-chevron-left\"></div>\r\n        </template>\r\n      </el-button>\r\n      <img\r\n        @click=\"$router.push('/home')\"\r\n        src=\"/bleuon-icon.png\"\r\n        class=\"mr-4 w-30 h-15 object-cover cursor-pointer\" />\r\n      <div>\r\n        <div v-show=\"editFile\" @keyup.enter=\"confirmChangeFileName\">\r\n          <el-input v-model=\"calcFileName\" size=\"small\" placeholder=\"请输入文件名\" />\r\n        </div>\r\n        <div class=\"text-gray-700\" v-show=\"!editFile\" @click=\"editFile = !editFile\">\r\n          {{ calcFileName }}\r\n        </div>\r\n        <div class=\"mt-2\">\r\n          <div class=\"text-gray-500 text-0.8rem f-c-c\">\r\n            <div class=\"i-tabler-clock mr-1\"></div>\r\n            上次更新：{{ formatted(\"yyyy-MM-dd HH:mm:ss\", new Date(flowchartData.modifyDate)) }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"right f-c-s\">\r\n      <div class=\"mr-6 f-c-s text-gray-700 text-1.5rem\">\r\n        <el-tooltip content=\"下载\">\r\n          <div @click=\"download\" class=\"hover mr-4 i-tabler-download\"></div>\r\n        </el-tooltip>\r\n        <el-tooltip content=\"分享\">\r\n          <div @click=\"dialogVisible = !dialogVisible\" class=\"hover i-tabler-share\"></div>\r\n        </el-tooltip>\r\n        <!-- 用户没有登陆 -->\r\n        <el-tooltip content=\"导入模板\" v-if=\"token\">\r\n          <div\r\n            v-if=\"type === 'share'\"\r\n            @click=\"importFlowchart\"\r\n            class=\"hover i-tabler-file-import ml-4\"></div>\r\n        </el-tooltip>\r\n      </div>\r\n      <MenuAvatar v-if=\"token\" />\r\n    </div>\r\n    <el-dialog v-model=\"dialogVisible\" title=\"分享流程图\" width=\"40%\">\r\n      <el-form\r\n        ref=\"formRef\"\r\n        :rules=\"formRules\"\r\n        :model=\"flowchartData\"\r\n        label-width=\"100px\"\r\n        label-position=\"right\">\r\n        <el-form-item label=\"状态\">\r\n          <div v-if=\"!flowchartData.isPublic\">流程图没有公开，点击创建链接</div>\r\n          <div v-else>流程图已经公开，点击链接浏览</div>\r\n        </el-form-item>\r\n        <el-form-item v-if=\"flowchartData.isPublic\" label=\"链接地址\">\r\n          <el-link type=\"primary\" @click=\"$router.push('/share/flowchart/' + flowchartData.id)\">\r\n            http://localhost:5173/#/share/flowchart/{{ flowchartData.id }}\r\n          </el-link>\r\n        </el-form-item>\r\n        <el-form-item prop=\"deadShareDate\" label=\"截止日期\">\r\n          <el-date-picker\r\n            :disabled=\"type === 'share'\"\r\n            v-model=\"flowchartData.deadShareDate\"\r\n            type=\"datetime\"\r\n            :shortcuts=\"shortcuts\" />\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span v-if=\"type === 'privacy'\" class=\"dialog-footer\">\r\n          <el-button :disabled=\"!!flowchartData.isPublic\" type=\"primary\" @click=\"confirmShare\">\r\n            <template #icon>\r\n              <div class=\"i-tabler-check\"></div>\r\n            </template>\r\n            确定公开\r\n          </el-button>\r\n          <el-button :disabled=\"!flowchartData.isPublic\" @click=\"cancelShare\">\r\n            <template #icon>\r\n              <div class=\"i-tabler-x\"></div>\r\n            </template>\r\n            取消公开\r\n          </el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\"></style>\r\n","<script setup lang=\"ts\">\r\n/**\r\n * @description Flowchat 底部工具\r\n * @author 郑人滏 42020306\r\n * @since 2023/9/24\r\n * @link https://github.com/himmelbleu/bleuon-app\r\n */\r\n\r\nimport { dia } from \"@mainapp/lib\";\r\nimport * as Data from \"@mainapp/data/diagraming/flowchart\";\r\n\r\nconst paper = inject<Ref<dia.Paper>>(KeyVals.BLEUON_FLOWCHART_PAPER);\r\n\r\n/**\r\n * 监听当 slider 组件变化时，重设置 paper 的 scale\r\n */\r\nfunction onSliderChange() {\r\n  paper.value.scale(Data.currentScale.value, Data.currentScale.value);\r\n}\r\n\r\n/**\r\n * 重置 slider 以及 paper sacle 为初始状态\r\n */\r\nfunction resetSlider() {\r\n  Data.currentScale.value = 1;\r\n  paper.value.scale(Data.currentScale.value, Data.currentScale.value);\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div\r\n    class=\"bleuon__flowchat-footer-tools b-border-primary b-t-1 b-t-solid bg-#f6f7f8 f-c-e px-4 text-0.8rem\">\r\n    <div class=\"scale-tool f-c-c\">\r\n      <div class=\"mr-4\">\r\n        <input\r\n          type=\"range\"\r\n          @change=\"onSliderChange\"\r\n          v-model=\"Data.calcCurrentScale.value\"\r\n          min=\"20\"\r\n          max=\"200\"\r\n          step=\"1\" />\r\n      </div>\r\n      <el-tooltip content=\"重置缩放\" placement=\"top\">\r\n        <div class=\"cursor-pointer\" @click=\"resetSlider\">{{ Data.calcCurrentScale.value }}%</div>\r\n      </el-tooltip>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\"></style>\r\n"],"names":["getClientXY","event","clientX","clientY","spreadableSymbol","Symbol","isFlattenable","value","isArray","isArguments","baseFlatten","array","depth","predicate","isStrict","result","index","length","arrayPush","flatten","datePickTypes","castArray","arr","t","e","module","this","n","r","i","s","u","a","o","f","h","c","d","l","$","y","M","m","v","g","D","p","_","S","w","O","T","Y","timeUnits","DEFAULT_FORMATS_TIME","DEFAULT_FORMATS_DATE","DEFAULT_FORMATS_DATEPICKER","buildTimeList","bound","rangeArr","extractDateFormat","format","extractTimeFormat","dateEquals","b","aIsDate","isDate","bIsDate","valueEquals","aIsArray","bIsArray","item","parseDate","date","lang","day","isEmpty","dayjs","formatter","makeList","total","method","_a","disabledArr","disabledTimeListsProps","buildProps","definePropType","timePanelSharedProps","timePickerDefaultProps","CircleClose","useSizeProp","_hoisted_1","_hoisted_2","__default__","defineComponent","_sfc_main","__props","expose","emit","props","attrs","useAttrs","useLocale","nsDate","useNamespace","nsInput","nsRange","form","formItem","useFormItem","elPopperOptions","inject","refPopper","ref","inputRef","pickerVisible","pickerActualVisible","valueOnOpen","hasJustTabExitedInput","ignoreFocusEvent","rangeInputKls","computed","pickerDisabled","pickerSize","clearIconKls","showClose","watch","val","nextTick","userInput","emitChange","isClear","err","debugWarn","emitInput","input","formatted","emitKeydown","refInput","_r","isRangeInput","setSelectionRange","start","end","pos","_inputs","focusOnInputBox","focus","onPick","visible","onBeforeShow","onShow","onKeydownPopperContent","EVENT_CODE","onHide","handleOpen","handleClose","focusStartInput","isIgnoreFocusEvent","leftInput","rightInput","unref","handleFocusInput","currentHandleBlurDeferCallback","handleBlurInput","handleBlurDefer","handleChange","parsedValue","dayOrDays","valueIsEmpty","pickerOptions","availableResult","isEqual","displayValue","formattedValue","formatDayjsToString","isTimePicker","isDatesPicker","isTimeLikePicker","triggerIcon","Clock","Calendar","onClearIconClick","modelValue","onMouseDownInput","onMouseEnter","onMouseLeave","onTouchStartInput","useFormSize","popperEl","_b","actualInputRef","onClickOutside","unrefedPopperEl","inputEl","parseUserInputToDayjs","isValidValue","handleKeydownInput","code","onUserInput","handleStartInput","target","handleEndInput","handleStartChange","values","parsedVal","newValue","handleEndChange","onSetPickerOption","onCalendarChange","onPanelChange","mode","view","provide","_ctx","_cache","openBlock","createBlock","ElTooltip","mergeProps","withCtx","createElementBlock","normalizeClass","normalizeStyle","ElIcon","withModifiers","resolveDynamicComponent","createCommentVNode","createElementVNode","renderSlot","toDisplayString","ElInput","CommonPicker","_export_sfc","panelTimePickerProps","useTimePanel","getAvailableHours","getAvailableMinutes","getAvailableSeconds","getAvailableTime","role","first","compareDate","availableTimeGetters","type","availableTimeSlots","timePickerOptions","key","makeAvailableArr","disabledList","trueOrNumber","isDisabled","getNumber","getTimeLists","disabledHours","disabledMinutes","disabledSeconds","compare","hour","minute","buildAvailableTimeSlotGetter","getHoursList","getMinutesList","getSecondsList","useOldValue","oldValue","REPEAT_INTERVAL","REPEAT_DELAY","vRepeatClick","el","binding","interval","delay","isFunction","intervalId","delayId","handler","clear","evt","basicTimeSpinnerProps","ns","isScrolling","currentScrollbar","listHoursRef","listMinutesRef","listSecondsRef","listRefsMap","spinnerItems","timePartials","spinnerDate","hours","minutes","seconds","timeList","arrowControlTimeList","debouncedResetScroll","debounce","adjustCurrentSpinner","getAmPmFlag","isCapital","content","emitSelectRange","range","left","right","adjustSpinner","adjustSpinners","getScrollbarElement","scrollbar","typeItemHeight","listItem","getStyle","onIncrement","scrollDown","onDecrement","step","label","now","next","findNextUnDisabled","modifyDateField","list","changeTo","handleClick","disabled","handleScroll","scrollBarHeight","bindScrollEvent","bindFunction","onMounted","setRef","Fragment","renderList","ElScrollbar","$event","createTextVNode","withDirectives","createVNode","ArrowUp","ArrowDown","time","TimeSpinner","pickerBase","arrowControl","defaultValue","selectionRange","transitionName","isUndefined","showSeconds","amPmMode","_date","parsedDate","getRangeAvailableTime","handleCancel","handleConfirm","changeSelectionRange","mapping","handleKeydown","up","down","onSetOption","parseUserInput","formatToString","getDefaultValue","Transition","TimePickPanel","alphaSliderProps","isDragging","draggable","element","options","isClient","moveFn","upFn","downFn","useAlphaSlider","instance","getCurrentInstance","thumb","shallowRef","bar","handleDrag","rect","top","useAlphaSliderDOM","thumbLeft","thumbTop","background","getThumbLeft","alpha","getThumbTop","getBackground","update","dragConfig","rootKls","barKls","thumbKls","barStyle","thumbStyle","addUnit","COMPONENT_NAME","args","AlphaSlider","hueValue","hue","_sfc_render","$props","$setup","$data","$options","HueSlider","colorPickerProps","colorPickerEmits","UPDATE_MODEL_EVENT","isString","isNil","CHANGE_EVENT","colorPickerContextKey","hsv2hsl","sat","isOnePointZero","isPercentage","bound01","max","processPercent","INT_HEX_MAP","hexOne","high","low","toHex","HEX_INT_MAP","parseHexChannel","hex","hsl2hsv","light","smin","lmin","sv","rgb2hsv","min","hsv2rgb","q","mod","Color","option","hasOwn","prop","fromHSV","parts","color","_hue","_saturation","_value","_alpha","hsl","currentColor","rgbaColors","parseColors","watchEffect","handleSelect","colors","Predefine","cursorTop","cursorLeft","colorValue","saturation","width","height","SvPanel","colorSize","colorDisabled","useFormDisabled","buttonId","isLabeledByFormItem","useFormItemInputId","popper","shouldActiveChange","reactive","showPicker","showPanelColor","customInput","displayedColor","displayedRgb","buttonAriaLabel","buttonAriaLabelledby","btnKls","color2","showAlpha","setShowPicker","debounceSetShowPicker","show","hide","resetColor","handleTrigger","confirmValue","newColor","newVal","_c","withKeys","ElButton","ClickOutside","vShow","Close","ColorPicker","ElColorPicker","withInstall","ROOT_PICKER_INJECTION_KEY","datePickerProps","selectionModes","datePickerSharedProps","panelSharedProps","panelRangeSharedProps","selectionModeWithDefault","panelDatePickProps","basicDateTableProps","basicDateTableEmits","isValidRange","unit","unlinkPanels","buildPickerTable","dimension","rows","columnIndexOffset","startDate","nextEndDate","relativeDateGetter","setCellMetadata","setRowMetadata","rowIndex","row","columnIndex","cell","nextStartDate","isNormalDay","useBasicDateTable","tbodyRef","currentCellRef","lastRow","lastColumn","tableRows","focusWithClick","firstDayOfWeek","WEEKS_CONSTANT","offsetDay","startDayOfMonth","WEEKS","hasCurrent","days","startOfMonth","startOfMonthDay","dateCountOfMonth","dateCountOfLastMonth","selectedDate","setDateText","count","offset","numberOfDaysFromPreviousMonth","disabledDate","cellClassName","_selectedDate","shouldIncrement","cellDate","isCurrent","isActive","isWeekActive","minDate","maxDate","rangeState","showWeekNumber","rows_","dateUnit","idx","cellMatchesDate","getDateOfCell","column","offsetFromStart","handleMouseMove","isSelectedCell","handleFocus","handlePickDate","handleMouseDown","handleMouseUp","handleRangePick","newDate","handleWeekPick","weekNumber","handleDatesPick","selected","isKeyboardMovement","dayOffset","useBasicDateTableDOM","tableKls","tableLabel","weekLabel","classes","basicCellProps","ElDatePickerCell","slots","_hoisted_3","_hoisted_4","getCellClasses","getRowKls","week","rowKey","columnKey","DateTable","basicMonthTableProps","datesInMonth","year","month","lang2","firstDay","numOfDays","months","rows2","j","calTime","calEndDate","getCellStyle","style","today","handleMonthTableClick","hasClass","key_","MonthTable","basicYearTableProps","datesInYear","startYear","getCellKls","kls","handleYearTableClick","__","YearTable","_hoisted_5","contextEmit","timeWithinRange","___","ppNs","dpNs","useSlots","TOOLTIP_INJECTION_KEY","shortcuts","defaultTime","toRef","currentViewRef","innerDate","isChangeToNow","isShortcut","defaultTimeD","selectableRange","userInputDate","userInputTime","checkDateWithinRange","formatEmit","emitDayjs","visibleTime","showTime","dates","handleDatePick","keepOpen","selectionMode","moveByMonth","forward","action","handlePanelChange","moveByYear","currentDate","currentView","yearLabel","yearTranslation","handleShortcutClick","shortcut","shortcutValue","keyboardMode","hasShortcuts","handleMonthPick","month2","handleFocusPicker","handleYearPick","year2","footerVisible","disabledConfirm","onConfirm","defaultTimeD2","defaultValueD","disabledNow","changeToNow","nowDate","timeFormat","dateFormat","visibleDate","timePickerVisible","onTimePickerInputFocus","handleTimePickClose","getUnits","handleTimePick","second","handleVisibleTimeChange","handleVisibleDateChange","defaultTimeDValue","handleKeyControl","handleKeydownTable","home","pageUp","pageDown","map","DArrowLeft","ArrowLeft","ArrowRight","DArrowRight","DatePickPanel","panelDateRangeProps","useShortcut","shortcutValues","useRangePicker","leftDate","rightDate","onParsedValueChanged","pickerNs","drpNs","handleChangeRange","handleRangeConfirm","_minDate","_maxDate","onSelect","selecting","restoreDefault","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","clearable","dateUserInput","timeUserInput","leftLabel","rightLabel","leftYear","leftMonth","rightYear","rightMonth","minVisibleDate","maxVisibleDate","minVisibleTime","maxVisibleTime","leftPrevYear","leftPrevMonth","rightNextYear","rightNextMonth","leftNextYear","leftNextMonth","rightPrevYear","rightPrevMonth","enableMonthArrow","nextMonth","yearOffset","enableYearArrow","btnDisabled","close","min_","max_","minDate_","maxDate_","minTimePickerVisible","maxTimePickerVisible","handleMinTimeClose","handleMaxTimeClose","handleDateInput","parsedValueD","handleDateChange","handleTimeInput","handleTimeChange","handleMinTimePick","handleMaxTimePick","handleClear","minDate2","maxDate2","minDateYear","minDateMonth","maxDateYear","maxDateMonth","DateRangePickPanel","panelMonthRangeProps","panelMonthRangeEmits","useMonthRangeHeader","MonthRangePickPanel","getPanel","localeData","advancedFormat","customParseFormat","weekOfYear","weekYear","dayOfYear","isSameOrAfter","isSameOrBefore","DatePicker","commonPicker","onModelValueUpdated","Component","scopedProps","_DatePicker","app","ElDatePicker","inputNumberProps","isNumber","inputNumberEmits","cur","prev","INPUT_EVENT","data","minDisabled","maxDisabled","numPrecision","stepPrecision","getPrecision","controlsAtRight","inputNumberSize","inputNumberDisabled","currentValue","toPrecision","num","pre","snum","pointPos","valueString","dotPosition","precision","ensurePrecision","coefficient","increase","setCurrentValue","decrease","verifyValue","stepStrictly","valueOnClear","throwError","oldVal","handleInput","handleInputChange","blur","handleBlur","innerInput","onUpdated","Minus","Plus","InputNumber","ElInputNumber","linkProps","iconPropType","linkEmits","linkKls","Link","ElLink","propsList","numberPattern","findSpacesRegex","parseExpressionRegExp","throwInvalid","expression","evalCalcExpression","bbox","match","multiply","property","divide","add","x","evalAddExpression","addExpression","sign","isCalcAttribute","calcStart","calcStartOffset","evalCalcAttribute","attributeValue","refBBox","startSearchIndex","calcIndex","calcEndIndex","brackets","findClosingBracket","calcValue","cloneCells","cells","uniq","cloneMap","toArray","clone","source","parent","embeds","newEmbeds","embed","validPropertiesList","validProperties","acc","properties","isPlainObject","node","props$1","setWrapper","attrName","isValuePercentage","attrValue","positionWrapper","axis","origin","valuePercentage","delta","refOrigin","point","Point","offsetWrapper","corner","nodeBBox","shapeWrapper","shapeConstructor","opt","cacheName","resetOffset","$node","cache","cachedShape","shape","shapeBBox","shapeOrigin","fitScale","sx","sy","dWrapper","pathConstructor","Path","V","path","pointsWrapper","Polyline","polyline","atConnectionWrapper","zeroVector","angle","tangent","setIfChangedWrapper","attribute","vel","isTextInUse","_node","isLinkView","contextMarker","context","marker","stroke","strokeOpacity","setPaintURL","def","paper","attributesNS","filter","assign","_text","text","textAttrs","pick","fontSizeAttr","fontSize","textHash","textPath","isObject","pathSelector","pathNode","size","wrappedText","breakTextFn","breakText","title","firstChild","titleNode","port","styles","html","widthFn","heightFn","fn","diagonalLength","rValue","stubs","segmentSubdivisions","sourceParts","targetParts","attributes","Cell","Backbone","defaults","uniqueId","merge","dx","dy","defaultAttrs","finalAttrs","forIn","attr","selector","defaultAttr","name","value2","name2","cloneDeep","omit","idAttribute","uuid","previousPorts","ports","removedPorts","id","inboundLinks","link","outboundLinks","graph","collection","parentCell","embeddedCells","sortedCells","sortBy","z","shouldUpdate","batchName","without","parentId","ancestors","embeddedIds","sortSiblings","queue","current","stack","cellId","delim","_isString","pathArray","pathArrayLength","initializer","prevProperty","pathItem","isArrayIndex","setByPath","baseAttributes","unsetByPath","getByPath","nestedPath","propertyValue","timing","interpolate","firstFrameTime","interpolatingFunction","setter","runtime","progress","nextFrame","_scheduledTransitionIds","initialId","initiator","callback","union","transitions","transitionId","_transitionIds","cancelFrame","flag","g.Point","g.Rect","defNS","globalDefNS","protoProps","staticProps","defaultsDeep","has","wrapWith","object","methods","wrapper","wrappers","Positions","getRectPoint","position","portTransformAttrs","trans","util.defaults","lineLayout","p1","p2","elBBox","argTransform","g.line","ellipseLayout","startAngle","stepFn","center","ratio","ellipse","g.Ellipse","theta","util.isPercentage","argPoint","absolute","transformation","line","bottom","ellipseSpread","stepAngle","labelAttributes","opt1","opt2","util.defaultsDeep","getBBoxAngles","tl","bl","br","tr","outsideLayout","portPosition","autoOrient","tx","ty","textAnchor","orientAngle","topLeftAngle","bottomLeftAngle","bottomRightAngle","topRightAngle","round","insideLayout","radialLayout","portCenterOffset","g.point","manual","_portPosition","_elBBox","outsideOriented","outside","insideOriented","inside","radial","radialOriented","setSource","setOpt","isCellProvided","isPointProvided","setTarget","router","isRouterProvided","localRouter","localOpt","connector","isConnectorProvided","localConnector","labels","vertex","vertices","setVertex","setVertices","sourceCell","targetCell","points","newParent","prevParent","sourceId","targetId","loop","sourceElement","targetElement","visited","connectionAncestor","ancestor","defaultLabel","portsEqual","PortData","clonedData","util.cloneDeep","Port","PortLabel","groupName","group","groupPosition","groupPositionName","namespace","groupArgs","portsArgs","groupPortTransformations","accumulator","util.toArray","res","portTransformation","labelPosition","util.isObject","groups","util.merge","evaluated","util.assign","util.isNumber","setDefault","positionName","util.isFunction","util.isString","setDefaults","ret","elementPortPrototype","currentItemsMap","previous","removed","util.isEmpty","groupPorts","portsMetrics","Rect","positions","metrics","before","portId","util.isPlainObject","portsAttr","errorMessages","util.uniq","portsForRemoval","newPorts","cp","rp","rpId","prevPortData","curPortData","added","prevPort","curPort","elementViewPortPrototype","elementReferences","elem","portsGropsByZ","util.groupBy","withoutZKey","portElement","groupNames","k","refs","containerElement","portElements","portCache","portRoot","portSelectors","groupsNames","util.invoke","labelElement","labelSelectors","portContainerElement","portMarkup","portDoc","portFragment","labelMarkupDef","fragment","selectors","childCount","portContainerSelectors","portRootSelector","labelRootSelector","labelTextSelector","labelNode","labelTextNode","elementBBox","cached","labelTransformation","transformData","initialAngle","matrix","Element","isSetter","parentRelative","deep","restrictedArea","parentPosition","x0","y0","elementPosition","ra","newPosition","translatedPosition","invoke","currentSize","normalizeAngle","quadrant","fixedPoint","imageFixedPoint","radius","toRad","scaledBBox","childElements","parentElement","siblingElements","elementsBBox","expandOnly","shrinkOnly","normalizeSides","resultBBox","intersectionBBox","rotate","elements","endType","endDef","portGroup","portsPositions","portCenter","GraphCells","models","util.has","ModelClass","util.getByPath","model","Graph","prevSource","prevTarget","json","util.omit","firstCell","lastCell","util.flattenDeep","preparedCells","indirect","inbound","outbound","links","edges","addOutbounds","addInbounds","util.forIn","edge","outCell","inCell","embeddedElements","exists","edgeCell","neighbors","cellsAncestors","commonAncestor","cellAncestors","subgraph","cellMap","iteratee","distance","neighbor","lastIndex","sources","sinks","elementA","elementB","isSuccessor","isPredecessor","isNeighbor","strict","searchBy","util.getRectPoint","memo","batches","names","batch","sourceModel","connectedLinks","sameLinks","_link","_source","_target","_graph","LayersNames","PaperLayer","View","addClassNamePrefix","pivotNodes","pivotNode","neighborZ","currentZ","neighborPivot","obj","HighlighterView","mvc.View","cellView","nodeSelector","isLink","layer","rotatableNode","nodeMatrix","MOUNTABLE","transformGroup","detachedTransformGroup","postponedUpdate","cellViewRoot","layerName","vGroup","updateRequested","translateMatrix","rotateMatrix","transformMatrix","prevNode","constructor","_cellView","cid","_views","views","hid","previousView","dirty","HighlightingTypes","Flags","CellView","classNames","flags","shift","presentationAttributes","initFlag","guid","markup","root","doc","parseDOMJSON","rootSelector","feature","interactive","isBoolean","nodes","eventName","magnet","magnetMatrix","mt","mr","cx","cy","rootNode","magnetAttribute","isMagnetRoot","proxyNode","prevSelector","nthChild","connectionStrategy","strategy","linkView","magnetThreshold","currentTarget","targetMagnet","attrVal","normalAttrs","setAttrs","positionAttrs","offsetAttrs","relatives","toKebabCase","rawAttrs","nodeAttrs","setResult","nodeTransform","nodePosition","translation","nodeScale","positioned","offseted","nodeBoundingRect","scalableNode","scale","selectorCache","nodeId","nodesAttrs","mergeIds","unique","prevNodeAttrs","selectedLength","sortIndex","sortedIndex","bboxCache","relativeItems","relativeRefItems","nodeData","processedAttrs","roAttrs","nodesAllAttrs","nodeAllAttrs","refSelector","refNode","itemIndex","refNodeId","getCommonAncestorNode","roProcessedAttrs","transform","isInitialMount","toolsView","defaultInteractionPrevented","sourceView","targetView","node1","node2","DragActions","ElementView","useCSSSelectors","config","transformHighlighters","updateHighlighters","renderingOnlyAttrs","modelAttrs","rotateString","scalable","recursive","scalableBBox","rotatable","rotation","rotatableBBox","initialZIndices","maxZ","findParentBy","frontParentOnly","validateEmbedding","candidates","newCandidateView","prevCandidateView","candidate","candidateView","validateUnembedding","initialParentId","whenNotAllowed","initialPosition","proxyPortNode","delegatedView","isPropagationAlreadyStopped","grid","pointerOffset","embedding","elX","snapToGrid","elY","normal","oneSide","side","padding","util.normalizeSides","sourceBBox","targetBBox","sourcePoint","targetPoint","coordinate","direction","opposites","radians","freeJoin","getBBoxSize","bearing","getBearing","from","to","getPointBox","getPaddingBox","sides","getSourceBBox","getTargetBBox","getSourceAnchor","getTargetAnchor","vertexVertex","d1","d2","opposite","elementVertex","fromBBox","vertexElement","toBBox","route","freePoints","pt","freeBearingPoints","util.difference","elementElement","fromBorder","toBorder","mid","g.Line","startRoute","endRoute","insideElement","boundary","reversed","p3","g.toRad","orthogonal","sourceAnchor","targetAnchor","orthogonalVertices","isOrthogonal","isOrthogonalLoop","cost","ObstacleMap","excludedEnds","excludedAncestors","util.union","mapGridSize","isExcludedType","isExcludedEnd","excluded","isExcludedAncestor","isExcluded","gridKey","mapKey","obstacle","SortedSet","util.sortedIndex","getDirectionAngle","numDirections","angleTheta","fixAngleEnd","normalizedAngle","g.normalizeAngle","diffX","diffY","gridStepsX","gridStepsY","distanceX","distanceY","getDirectionChange","angle1","angle2","directionChange","getGridOffsets","directions","getGrid","getGridDimension","diff","absDiff","numSteps","roundedDiff","remainder","stepCorrection","snappedX","g.snapToGrid","snappedY","align","getKey","normalizePoint","reconstructRoute","parents","tailPoint","prevDiff","currentKey","leadPoint","fromDiff","estimateCost","endPoints","len","getRectPoints","anchor","directionList","directionMap","anchorCenterVector","keys","dirList","rectPoints","endpoint","intersectionLine","intersections","numIntersections","farthestIntersectionDistance","farthestIntersection","currentIntersection","findRoute","isPointObstacle","startPoints","openSet","costs","startPoint","previousRouteDirectionAngle","isPathBeginning","endPointsKeys","endPoint","loopsRemaining","currentPoint","currentParent","currentCost","isRouteBeginning","isStart","previousDirectionAngle","samePoints","skipEndCheck","directionAngle","neighborPoint","neighborKey","isNeighborEnd","endDirectionAngle","endDirectionChange","neighborCost","neighborPenalty","costFromStart","resolveOptions","util.result","point1","point2","oldVertices","newVertices","partialRoute","isEndingAtPoint","dragFrom","dragTo","manhattan","diagonalCost","l1","l2","intersectionPoint","directionFrom","metro","Directions","DEFINED_DIRECTIONS","getDirectionForLinkConnection","linkOrigin","connectionPoint","rightAngleRouter","_vertices","margin","sourceDirection","targetDirection","isSourcePort","isTargetPort","sx0","sy0","sourceWidth","sourceHeight","tx0","ty0","targetWidth","targetHeight","tx1","ty1","sx1","sy1","smx0","smx1","smy0","smy1","tmx0","tmx1","tmy0","tmy1","sourceOutsidePoint","sourceSide","sourceLinkAnchorBBox","targetOutsidePoint","targetSide","targetLinkAnchorBBox","sox","soy","tox","toy","tcx","tcy","scx","scy","middleOfVerticalSides","middleOfHorizontalSides","y1","y2","x1","x2","rightAngle","CornerTypes","DEFINED_CORNER_TYPES","CORNER_RADIUS","PRECISION","straight","routePoints","cornerType","cornerRadius","cornerPreserveAspectRatio","raw","g.Polyline","g.Path","nextDistance","routePointsLength","curr","prevDistance","startMove","endMove","cornerStart","cornerEnd","_13","_23","control1","control2","JUMP_SIZE","JUMP_TYPES","RADIUS","CLOSE_PROXIMITY_PADDING","IGNORED_CONNECTORS","sortPointsAscending","swap","overlapExists","line1","line2","x3","y3","x4","y4","xMatch","yMatch","createLines","resultLines","nextPoint","setupUpdating","jumpOverLinkView","updateList","updateJumpOver","updateFlag","findLineIntersections","crossCheckLines","crossCheckLine","intersection","sortPoints","createJumps","jumpSize","lastLine","jumpStart","jumpEnd","endDistance","startDistance","jumpLine","buildPath","lines","jumpType","segment","xAxisRotate","midpoint","centerLine","halfLine","xOffset","yOffset","nextLine","buildRoundedSegment","roundedStart","roundedEnd","jumpover","ignoreConnectors","allLinks","thisModel","thisIndex","defaultConnector","linkViews","thisLines","linkLines","jumpingLines","thisLine","linkLinesToTest","overlapIndex","lineIntersections","rounded","smooth","curves","g.Curve","controlPointX","controlPointY","TangentDirections","curve","completeRoute","sourceTangent","getSourceTangentDirection","tangentLength","pointsVector","angleBetweenVectors","updatedLength","targetTangent","getTargetTangentDirection","last","bezierCurves","createCatmullRomCurves","catmullRomToBezier","getHorizontalSourceDirection","unrotatedBBox","getHorizontalTargetDirection","getVerticalSourceDirection","getVerticalTargetDirection","getAutoSourceDirection","getAutoTargetDirection","getClosestPointSourceDirection","getClosestPointTargetDirection","getOutwardsSourceDirection","sourceCenter","getOutwardsTargetDirection","targetCenter","rotateVector","vector","cos","sin","v1","v2","determinant","tau","coeff","distances","tangents","catmullRomCurves","tpPrev","tpNext","vAngle","rot","vectorDeterminant","pointsDeterminant","t1","t2","scaleFactor1","scaleFactor2","p0","bcp1","bcp2","Curve","LinkView","updateLabels","updateLegacyTools","updateAll","updateConnector","previousLabels","pathLength","labelExists","_labels","children","child","className","removeClassNamePrefix","labelMarkup","currentChild","vNode","childNodes","vLabels","labelCache","labelsCount","builtinDefaultLabel","builtinDefaultLabelMarkup","defaultLabelMarkup","defaultMarkup","_V","labelIndex","labelRoot","hasCustomMarkup","labelAttrs","defaultLabelAttrs","builtinDefaultLabelAttrs","labelSize","defaultLabelSize","canLabelMove","$tools","toolTemplate","template","tool","tool2","$markerVertices","markupTemplate","$markerArrowheads","numRoutePoints","polylinePoints","numPolylinePoints","anchors","connectionPoints","markerPoints","firstWaypoint","lastWaypoint","sourceMarkerPoint","targetMarkerPoint","firstEndType","firstRef","secondEndType","secondRef","firstAnchor","secondAnchor","firstAnchorRef","secondAnchorRef","firstDef","secondDef","firstView","secondView","firstMagnet","secondMagnet","firstVertex","lastVertex","sourceDef","targetDef","paperOptions","sourceMagnet","sourceConnectionPointDef","sourcePointRef","sourceLine","Line","targetConnectionPointDef","targetPointRef","targetLine","anchorDef","isConnection","anchorFn","anchorName","anchorNamespace","connectionPointDef","linkConnectionMagnet","connectionPointFn","connectionPointName","builtinDefaultLabelPosition","defaultLabelPosition","normalizedLabelPosition","normalizedDefaultLabelPosition","transformationMatrix","_labelSelectors","connectionLength","toolPosition","doubleLinkToolsOffset","endViewProperty","endId","endModel","endView","endMagnetProperty","connectedMagnet","sourceArrow","targetArrow","labelPositionArgs","defaultLabelPositionArgs","p4","localX","localY","localAngle","positionArgs","token","onAnimationEnd","vToken","duration","isReversed","animationAttributes","connection","routers","defaultRouter","routerFn","connectors","connectorFn","subdivisions","isDistanceRelative","isDistanceAbsoluteReverse","isOffsetAbsolute","pathOpt","labelPoint","labelDistance","labelOffset","closestPoint","labelOffsetDiff","labelAngle","labelOffsetCoordinates","positionOffset","isKeepGradient","isEnsureLegibility","vertexLength","currentVertex","currentVertexLength","dragData","linkTool","stopPropagation","vertexIdx","labelIdx","initialLabelPosition","coords","positionAngle","vertexNode","removeNode","arrowheadNode","arrowheadType","setOptions","arrowhead","initialEnd","currentEnd","endChanged","snapPoint","closestPointX","closestDistanceX","closestPointY","closestDistanceY","distX","distY","snapLinksSelf","snapLinks","isSnapped","viewsInArea","prevClosestView","prevClosestMagnet","prevMagnetProxy","minDistance","pointer","magnetProxy","closestView","closestMagnet","newClosestMagnet","prevEnd","prevX","prevY","viewUnderPointer","magnetUnderPointer","oppositeArrowhead","validateConnectionArgs","isMagnetAvailable","validate","magnets","availableMagnets","markedKeys","markedMagnets","useFirstSubpath","secondSubpathIndex","highlightMatrix","paddingMatrix","MASK_CLIP","forEachDescendant","descendants","descendant","mask","childEl","MASK_CHILD_ATTRIBUTE_BLACKLIST","MASK_REPLACE_TAGS","MASK_REMOVE_TAGS","childTagName","originalChild","originalNode","childBBox","replacement","ox","oy","rootEl","MASK_ROOT_ATTRIBUTE_BLACKLIST","tagName","maskRoot","maskChild","VISIBLE","INVISIBLE","strokeWidth","hasNodeFill","magnetStrokeWidth","minStrokeWidth","maxStrokeWidth","maskEl","maskNode","maskClip","highlighterBBox","opacity","util.addClassNamePrefix","addClass","elementView","gap","normalizedSize","isRowDirection","itemWidth","items","prevItems","comparison","unchanged","prevEls","itemsEls","prevEl","itemEl","itemsCount","listSize","connectionRatio","_magnet","_refPoint","_connectionPerpendicular","refPoint","OFFSET","verticalLine","horizontalLine","verticalIntersections","horizontalIntersections","getPointAtLink","connectionClosest","_connectionClosest","_opt","resolveRef","refView","connectionPerpendicular","offsetPoint","alignLine","anchorConnectionPoint","_view","alignOffset","bboxIntersection","rectangleIntersection","bboxWORotation","lineWORotation","findShapeNode","BNDR_SUBDIVISIONS","BNDR_SHAPE_BBOX","boundaryIntersection","localShape","targetMatrix","localMatrix","localLine","localRef","localBBox","cpOffset","rectangle","bboxWrapper","dxPercentage","dyPercentage","_perpendicular","topLeft","bottomRight","_midSide","_modelCenter","topRight","bottomLeft","perpendicular","midSide","modelCenter","sortingTypes","WHEEL_CAP","WHEEL_WAIT_MS","MOUNT_BATCH_SIZE","UPDATE_BATCH_SIZE","MIN_PRIORITY","defaultHighlighting","defaultLayers","Paper","_evt","cellViewS","_magnetS","cellViewT","_magnetT","_linkView","childView","parentView","priority","highlighters","linkAnchors","updateDelayingBatches","sortDelayingBatches","defaultConnectionPoint","defaultAnchor","defaultLinkAnchor","highlighting","cellViewNamespace","_layers","svg","defs","layers","sorted","layerView","cellsLayerView","toolsLayerView","labelsLayerView","ctm","viewport","transformString","ctmString","flagLabels","nextPriority","dumpOptions","sourceFlag","targetFlag","isAsync","stats","updates","FLAG_REMOVE","FLAG_INSERT","UPDATE_PRIORITY","priorityUpdates","prevPriorityUpdates","currentType","viewUpdateFn","shouldNotify","leftover","FLAG_INIT","isInitialInsert","passingOpt","batchStats","updateCount","batchCount","priorities","priorityIndexes","_key","checkStats","unmountCount","mountCount","processed","progressFn","beforeFn","afterFn","batchSize","postponeCount","maxPriority","empty","viewportFn","postponeViewFn","main","currentFlag","isDetached","leftoverFlag","unmountedCids","unmountedViews","mountedCids","mountedViews","unmounted","mounted","isUnmounted","isMounted","unmountedCount","mountedCount","isFrozen","freezeKey","currentWidth","currentHeight","computedSize","gridWidth","gridHeight","minWidth","minHeight","maxWidth","maxHeight","newOrigin","area","calcWidth","calcHeight","contentBBox","contentLocalOrigin","contentArea","minScaleX","maxScaleX","minScaleY","maxScaleY","fittingBBox","currentTranslate","currentScale","newSx","newSy","gridSize","scaleDiff","newOx","newOy","restrictTranslate","optionalViewClass","defaultViewClass","namespaceViewClass","ViewClass","_updates","create","$cells","sortElements","cellA","cellB","zA","zB","translate","newTx","newTy","drawGrid","$el","localPoint","paperPoint","localRect","paperRect","clientPoint","clientRect","pagePoint","pageOffset","highlighterDef","highlighterNamespace","highlighter","magnetEl","highlighterDescriptor","normalizeEvent","button","isContextMenu","isTargetFormNode","rootViewEl","eventNode","eventEvt","magnetNode","magnetEvt","contextmenuEvt","mousemoved","normalizedEvt","relatedTarget","relatedView","deltas","deltaY","cap","originalEvent","deltaX","normalizeWheel","pinchHandlers","magnetValue","optionsList","pattern","localOptions","gridLayerSetting","patternDefVel","patternUri","backgroundPosition","backgroundSize","img","backgroundImage","backgroundRepeat","backgroundOpacity","backgroundQuality","backgroundPattern","camelCase","canvas","defId","filterId","hashCode","_filter","filterSVGString","filterAttrs","gradient","stops","stopVEls","gradientVEl","patternVEl","markerUnits","markerVEl","markerContentVEl","markupVEl","markerAttrs","markupValue","imgWidth","imgHeight","ctx","stepX","stepY","thickness","ToolsView","tools","ToolView","isRendered","focusedTool","blurredTool","env","Generic","TextView","Text","Circle","Ellipse","Polygon","Image","Rhombus","svgForeignObjectSupported","TextBlock","sanitizeHTML","TextBlockView","noTextAttrs","Rectangle","BorderedImage","EmbeddedImage","InscribedImage","HeaderedRectangle","CYLINDER_TILT","Cylinder","isPercentageSetter","bodyAttrs","topAttrs","rx","ry","kappa","xLeft","xCenter","xRight","ySideTop","yCurveTop","ySideBottom","yCurveBottom","foLabelMarkup","svgLabelMarkup","wrapValue","wrapAttrs","LinkBase","DoubleLink","ShadowLink","Model","changed","inPorts","outPorts","difference","inPortItems","outPortItems","Atomic","Coupled","Gate","IO","Input","Output","Gate11","Gate21","Repeater","Not","Or","input1","input2","And","Nor","Nand","Xor","Xnor","Wire","KingWhite","KingBlack","QueenWhite","QueenBlack","RookWhite","RookBlack","BishopWhite","BishopBlack","KnightWhite","KnightBlack","PawnWhite","PawnBlack","Entity","WeakEntity","Relationship","IdentifyingRelationship","Attribute","Multivalued","Derived","Key","Normal","ISA","State","StartState","EndState","Arrow","Member","Place","PlaceView","vTokens","tokens","diaLink","Class","rects","offsetY","rectHeight","ClassView","Abstract","AbstractView","Interface","InterfaceView","Generalization","Implementation","Aggregation","Composition","Association","getViewBBox","useModelGeometry","Boundary","defineNamespace","dia.Element","updateLabelText","boundaryTool","elementTools.Boundary","resizeTool","NormalResizeTool","rotateTool","RotateTool","dia.ToolsView","shapes.standard.Link","textInput","cellText","centerX","centerY","oneThirdWidth","handleKeydownEvent","newCellText","linkTools.Boundary","shapes","initJointJs","dia.Graph","dia.Paper","shapes.bleuon","magnetS","magnetT","getLinkOrElementAttr","attrKey","changeRouterConfig","changeConnectorConfig","changeTextBold","currView","weight","changeTextItalic","changeTextUnderline","changeTextColor","changeTextSize","changeTextFamily","family","changeStrokeWidth","changeBorderStyle","lattice","changeBackground","changeLinkColor","closeColorPicker","openColorPicker","linkConnectorOptions","linkConnectorConfig","linkRouterOptions","linkRouterConfig","clickedLastView","clickedCurrView","textColor","textSize","fontFamilyOptions","fontFamily","shapeStrokeWidthOptions","shapeStrokeWidth","shapeBackground","shapeBorderStyle","calcCurrentScale","currentOffsetX","currentOffsetY","isClickedLink","isClickedElement","mountToolsLink","unmountToolsLink","mountToolsElement","unmountToolsElement","onPointerClickBlank","Data.isClickedElement","Data.isClickedLink","Data.clickedLastView","onPointerClickElement","Data.clickedCurrView","onPointerClickLink","onMousewheelBlank","scrollFactor","scaleFactor","Data.currentScale","Data.currentOffsetX","Data.currentOffsetY","onKeydown","shortcutKey","onPointerDbclickElement","KeyVals.BLEUON_FLOWCHART_PAPER","textColorPickerRef","linkColorPickerRef","shapeBgColorPickerRef","KeyVals.BLEUON_FLOWCHART_GRAPH","flowchartData","KeyVals.BLEUON_FLOWCHART_DATA","KeyVals.MAINAPP_TOKEN_KEY","editFile","download","convertSvgToImage","ElMessage","calcFileName","confirmChangeFileName","emits","dialogVisible","formRef","formRules","confirmShare","valid","fields","FlowchartApi.updateOne","cancelShare","importFlowchart","FlowchartApi.copyOne","onSliderChange","resetSlider"],"mappings":"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AC9CA,EAAA,KAAKyuC,EAASrkE,CAAK,CAC3B,CAKO,SAASslE,GAAiB1wE,EAAS,CACxC,WAAW,IAAM,CACfA,EAAG,KAAK,GACP,GAAG,CACR,CAOO,SAAS2wE,GAAgB3wE,EAAS,CACvC,WAAW,IAAM,CACfA,EAAG,KAAK,GACP,GAAG,CACR,kYC7Ra4wE,GAAuB,CAClC,CACE,MAAO,WACP,MAAO,UACT,EACA,CACE,MAAO,WACP,MAAO,UACT,EACA,CACE,MAAO,SACP,MAAO,QACT,EACA,CACE,MAAO,UACP,MAAO,SACT,EACA,CACE,MAAO,SACP,MAAO,QACT,EACA,CACE,MAAO,QACP,MAAO,OACT,CACF,EAKaC,GAAsBz6E,GAAI,CACrC,KAAM,QACR,CAAC,EAKY06E,GAAoB,CAC/B,CACE,MAAO,YACP,MAAO,WACT,EACA,CACE,MAAO,QACP,MAAO,OACT,EACA,CACE,MAAO,SACP,MAAO,QACT,EACA,CACE,MAAO,aACP,MAAO,YACT,EACA,CACE,MAAO,aACP,MAAO,YACT,CACF,EAKaC,GAAmB36E,GAAI,CAClC,KAAM,QACR,CAAC,EAKY46E,GAAkB56E,GAAI,CACjC,KAAM,KACN,MAAO,IACT,CAAC,EAKY66E,GAAkB76E,GAAI,IAAI,EAK1B86E,GAAY96E,GAAI,EAAE,EAKlB+6E,GAAW/6E,GAAI,EAAE,EAKjBg7E,GAAoB,CAC/B,CACE,MAAO,OACP,MAAO,MACT,EACA,CACE,MAAO,QACP,MAAO,OACT,EACA,CACE,MAAO,cACP,MAAO,aACT,EACA,CACE,MAAO,eACP,MAAO,cACT,EACA,CACE,MAAO,UACP,MAAO,SACT,EACA,CACE,MAAO,UACP,MAAO,SACT,EACA,CACE,MAAO,UACP,MAAO,SACT,EACA,CACE,MAAO,gBACP,MAAO,eACT,EACA,CACE,MAAO,WACP,MAAO,UACT,EACA,CACE,MAAO,aACP,MAAO,YACT,EACA,CACE,MAAO,SACP,MAAO,QACT,CACF,EAGaC,GAAaj7E,GAAI,MAAM,EAKvBk7E,GAA0B,CACrC,CACE,MAAO,EACP,MAAO,KACT,EACA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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121]}