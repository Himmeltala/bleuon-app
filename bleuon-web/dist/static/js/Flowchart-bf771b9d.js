import{i as E,o as P,a as O,b as A,c as R,d as L,h as T,_ as q,e as z,f as H,H as V,g as G,l as m,j as w}from"./FooterTools.vue_vue_type_script_setup_true_lang-b8c8b4f9.js";import{g as U,a as M}from"./el-overlay-ca182831.js";import{r as I}from"./parse-1c471e4f.js";import{d as p,N as W,n as N,o as i,h as k,w as K,c as u,F as y,E as x,S as Q,v as _,j as S,l as C,a as c,A as B,b as h,s as g,u as X,k as b,m as Y,B as Z,q as ee}from"./mainapp-b6e8cfa4.js";import{b as te,u as ae}from"./api-flowchart-d15db8f3.js";import{E as oe}from"./MenuAvatar-e34cf1a8.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import"./el-form-item-c34b0799.js";import"./el-button-0338fa73.js";import"./api-user-1de515ff.js";import"./el-select-6235e6e1.js";import"./bleuon-icon-ae86a734.js";import"./vnode-6865ae2b.js";function re(s,t){const a=Object.keys(t.attrs||{}).map(l=>({tagName:"path",selector:`${l}`})),o=new(void 0).Path({position:{x:t.x||30,y:t.y||30},ports:{groups:U()},attrs:{...t.attrs||{}},markup:[...a,{tagName:"text",selector:"label"}]});o.resize(t.width||140,t.height||70),o.addPorts([{group:"top"},{group:"bottom"},{group:"left"},{group:"right"}]),s.addCell(o)}const ne=Object.freeze(Object.defineProperty({__proto__:null,create:re},Symbol.toStringTag,{value:"Module"}));async function $(s){const{data:t}=await I.get("/cell/official/query/all",{params:{type:s}});return t.data}function le(s,t){let r=0;return function(...a){const o=Date.now();o-r>=t&&(s.apply(this,a),r=o)}}const ie=["viewBox"],ce=["d","fill","stroke-width","stroke"],ue=p({__name:"SVG",props:{viewBox:{type:String,required:!0},content:{type:String,required:!0},attrs:{type:Object,required:!0},width:{type:Number,default:140},height:{type:Number,default:70},flex:{type:String,default:"0 1 15%"}},setup(s){const t=W(N);return(r,a)=>{const o=oe;return i(),k(o,{content:s.content},{default:K(()=>[(i(),u("svg",{style:Q({flex:s.flex}),viewBox:s.viewBox,onClick:a[0]||(a[0]=l=>_(ne).create(_(t),{width:s.width,height:s.height,attrs:s.attrs})),xmlns:"http://www.w3.org/2000/svg"},[(i(!0),u(y,null,x(s.attrs,(l,e)=>(i(),u("path",{key:e,d:l.refD,fill:l.fill||"#ffffff","stroke-width":l.stwidth||"0.3",stroke:l.stroke||"#333333"},null,8,ce))),128))],12,ie))]),_:1},8,["content"])}}});const F=se(ue,[["__scopeId","data-v-a96a4a16"]]),de={class:"cells-for-flowchart"},_e=c("div",{class:"mb-4 text-0.8rem font-bold"},"Flowchart 图形",-1),he={class:"f-c-s flex-wrap flex-gap-3"},fe=p({__name:"CellsForFlowchart",async setup(s){let t,r;const a=S(null);return a.value=([t,r]=C(()=>$("flowchart")),t=await t,r(),t),(o,l)=>(i(),u("div",de,[_e,c("div",he,[_(a).length?(i(!0),u(y,{key:0},x(_(a),e=>(i(),k(F,{width:e.width,height:e.height,content:e.notes,"view-box":e.viewBox,attrs:JSON.parse(e.attrs)},null,8,["width","height","content","view-box","attrs"]))),256)):B("",!0)])]))}}),pe={class:"cells-for-flowchart"},ve=c("div",{class:"mb-4 text-0.8rem font-bold"},"基础图形",-1),me={class:"f-c-s flex-wrap flex-gap-3"},we=p({__name:"CellsForBasic",async setup(s){let t,r;const a=S(null);return a.value=([t,r]=C(()=>$("basic")),t=await t,r(),t),(o,l)=>(i(),u("div",pe,[ve,c("div",me,[_(a).length?(i(!0),u(y,{key:0},x(_(a),e=>(i(),k(F,{width:e.width,height:e.height,content:e.notes,"view-box":e.viewBox,attrs:JSON.parse(e.attrs)},null,8,["width","height","content","view-box","attrs"]))),256)):B("",!0)])]))}}),ge={class:"bleuon__flowchart-sidebar slim-slider h-100vh flow-auto bg-#f6f7f8 b-border-primary b-r-1 b-r-solid relative px-4 py-4"},be=p({__name:"Sidebar",setup(s){return(t,r)=>(i(),u("div",ge,[h(we,{class:"mb-4"}),h(fe,{class:"bg-#f6f7f8 border-#dfe2e5 border-t-1 border-t-solid pt-4"})]))}}),ke={class:"bleuon__flowchart-container h-100vh"},ye={class:"bleuon__flowchart-header h-22vh border-border-primary border-b-1 border-b-solid bg-#f6f7f8 px-4 py-4"},xe={class:"bleuon__flowchart-wrapper f-c-b"},Se={class:"left"},Ce={class:"right"},Oe=c("div",{id:"bleuon__flowchart-content"},null,-1),Ne={class:"bleuon__flowchart-extra"},ze=p({__name:"Flowchart",async setup(s){let t,r;const a=g(),o=g(),l=X(),e=S({}),v=g();b(Z,a),b(N,o),b(ee,e);async function J(){const d=await te({id:l.params.id.toString()});e.value=d}function j(){const{width:d,height:n}=a.value.getArea();e.value.width=d,e.value.height=n,e.value.id=l.params.id.toString(),e.value.json=JSON.stringify(o.value.toJSON()),e.value.connectorDefault=JSON.stringify(m.value),e.value.routerDefault=JSON.stringify(w.value),e.value.dataUri=M(a.value,o.value),ae(e.value,()=>{})}const f=le(j,3e3);function D(){e.value.json&&(a.value.freeze(),o.value.fromJSON(JSON.parse(e.value.json)),a.value.unfreeze()),m.value=JSON.parse(e.value.connectorDefault),w.value=JSON.parse(e.value.routerDefault),a.value.options.defaultConnector=m.value,a.value.options.defaultRouter=w.value}return[t,r]=C(()=>J()),await t,r(),Y(()=>{const d=E({el:"bleuon__flowchart-content",width:"85vw",height:"75vh",gridSize:e.value.gridSize,bgColor:e.value.bgColor,drawGrid:{name:"doubleMesh",args:[{color:"#333333",thickness:1},{color:"gray",scaleFactor:5,thickness:5}]}});a.value=d.paper,o.value=d.graph,D(),a.value.on({"element:pointerclick":n=>{P(n)},"element:pointerdblclick":n=>{O(n,v.value)},"link:pointerclick":n=>{A(n)},"link:pointerdblclick":n=>{O(n,v.value)},"blank:pointerclick":n=>{R()},"blank:mousewheel":n=>{L(n,a.value)}}),o.value.on("change",f),o.value.on("add",f),o.value.on("remove",f),T({ctrlS:f})}),(d,n)=>(i(),u("div",ke,[c("div",ye,[h(q,{onChange:_(f),class:"mb-4"},null,8,["onChange"]),h(V,{"is-clicked-element":z.value,"is-clicked-link":H.value},null,8,["is-clicked-element","is-clicked-link"])]),c("div",xe,[c("div",Se,[h(be,{class:"h-78vh"})]),c("div",Ce,[Oe,h(G,{class:"h-3vh"})]),c("div",Ne,[c("input",{ref_key:"textInputRef",ref:v,type:"text",class:"bleuon__flowchart-input absolute hidden"},null,512)])])]))}});export{ze as default};
//# sourceMappingURL=Flowchart-bf771b9d.js.map
